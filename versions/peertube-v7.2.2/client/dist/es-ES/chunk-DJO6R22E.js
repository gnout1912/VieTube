import{b as si}from"./chunk-5PLTSPIA.js";import{a as ui}from"./chunk-MLUQ7CKS.js";import{a as di,b as _i,d as mi,e as Ge,h as We,i as dt}from"./chunk-DUA2DJQ3.js";import{a as gi}from"./chunk-FJ2ZROHN.js";import{a as lt}from"./chunk-EBEN7JLX.js";import{a as st}from"./chunk-VM462Q6H.js";import{a as pi,b as fi}from"./chunk-4XG2BQGM.js";import{a as li}from"./chunk-4INQOBVN.js";import{a as ci}from"./chunk-SDLUASD2.js";import{a as gt,c as re}from"./chunk-BFVCLNOF.js";import{b as at}from"./chunk-3PB3Q4OH.js";import{a as ai}from"./chunk-6TRYPH2T.js";import{a as ri}from"./chunk-JVRBW57G.js";import{b as Ee,c as he}from"./chunk-25AA3I7H.js";import{c as oi}from"./chunk-2O3IZ566.js";import{a as ni}from"./chunk-EECS7F3M.js";import{d as ii}from"./chunk-UI5MIAKJ.js";import{a as He,b as oe}from"./chunk-WZVFW7AN.js";import{A as Jt,B as it,C as nt,E as Ve,F as Zt,c as Xt,m as qe,n as jt,o as Qt,p as Ye,q as Kt,s as ie,u as Je,v as qt,w as Ze,x as et,y as tt,z as Yt}from"./chunk-RT7DTAS6.js";import{B as U,C as Oe,c as Q,d as pt,g as z,h as ge,m as we,n as fe,p as Qe,q as ve,r as xe,t as Ce,u as $t,v as kt,w as Ht}from"./chunk-WO4VNXA3.js";import{a as $}from"./chunk-PE7TFI7A.js";import{Ab as _t,B as St,Bb as S,Bc as j,Cb as _,Cc as te,Da as ae,Db as Pe,Dc as x,Ea as Mt,Eb as Ie,Ha as a,Ic as be,Kg as rt,Lc as Vt,Mb as L,Na as V,Nb as W,Ob as w,Oc as je,Pb as R,Q as ht,Qb as Z,Qg as ti,Ra as Dt,Rb as b,S as At,Sa as N,Sb as Pt,Sd as Gt,Tb as It,Te as Bt,Ub as q,Uf as ut,Vb as Y,Wa as ue,Wb as J,Wd as Wt,Xf as ne,Ya as p,Zb as F,Zd as Ke,_b as bt,aa as f,ab as Nt,bb as yt,be as Fe,db as Xe,eb as l,ee as zt,fc as ee,ga as De,gc as Ae,gg as $e,ha as u,hc as ct,ia as g,j as Me,ja as Tt,jb as k,jc as H,ka as Rt,la as me,lb as Ne,lf as ot,lg as Se,m as Et,mb as ye,mc as wt,nb as s,nc as xt,ob as d,oc as Te,pb as v,pc as Ft,pd as Lt,pe as mt,pf as Be,qb as h,rb as A,re as Ut,sa as y,sb as le,sf as _e,sg as ei,ta as E,tb as M,vb as se,vf as Le,wb as de,xb as O,xg as ke,yb as P,zb as I}from"./chunk-F7FAPFPY.js";import{i as T,j as Re}from"./chunk-AI7IVZV2.js";var vi=(()=>{let r=class r{fromNowPipe=f(ni);date=E(void 0);toggled=Dt(!1);dateRelative;dateAbsolute;ngOnChanges(){this.updateDates();}toggle(){this.toggled.update(t=>!t);}getTitle(){let t=this.toggled()?this.dateRelative:this.dateAbsolute;return"Alternar el formato de fecha a \""+t+"\"";}getContent(){return this.toggled()?this.dateAbsolute:this.dateRelative;}updateDates(){this.dateRelative=this.fromNowPipe.transform(this.date()),this.dateAbsolute=this.date().toLocaleDateString();}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-date-toggle"]],inputs:{date:[1,"date"],toggled:[1,"toggled"]},outputs:{toggled:"toggledChange"},features:[De],decls:2,vars:3,consts:[["role","button","tabindex","0",1,"date-toggle",3,"click","keyup.enter","title","ariaLabel"]],template:function(n,o){n&1&&(s(0,"span",0),S("click",function(){return o.toggle();})("keyup.enter",function(){return o.toggle();}),R(1),d()),n&2&&(l("title",o.getTitle())("ariaLabel",o.getTitle()),a(),b(" ",o.getContent(),`
`));},styles:[`.date-toggle[_ngcontent-%COMP%]:hover{cursor:default}
/*# sourceMappingURL=date-toggle.component-IOB77EX6.css.map */`]}));let e=r;return e;})();function yi(e,r){if(e&1&&(h(0),O(1,0),ee(2,"myNumberFormatter"),A()),e&2){let i=_();a(2),P(i.viewers())(Ae(2,2,i.viewers())),I(1);}}function Pi(e,r){if(e&1&&(h(0),O(1,1),ee(2,"myNumberFormatter"),A()),e&2){let i=_();a(2),P(i.views())(Ae(2,2,i.views())),I(1);}}var Ci=(()=>{let r=class r{isLive=E.required({transform:Te});viewers=E.required();views=E.required();getExactNumberOfViews(){return this.isLive()?Be("{viewers, plural, =0 {Ning\xFAn espectador} =1 {1 espectador} other {{viewers} espectadores}}",{viewers:this.viewers()}):Be("{views, plural, =0 {Sin visualizaciones} =1 {1 visualizaci\xF3n} other {{views} visualizaciones}}",{views:this.views()});}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-views-counter"]],inputs:{isLive:[1,"isLive"],viewers:[1,"viewers"],views:[1,"views"]},decls:3,vars:2,consts:()=>{let t;t="{VAR_PLURAL, plural, =1 {1 espectador} other {{INTERPOLATION} espectadores}}",t=_t(t,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let n;n="\n          "+t+"\n        ";let o;o="{VAR_PLURAL, plural, =1 {1 visualizaci\xF3n} other {{INTERPOLATION} visualizaciones}}",o=_t(o,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let c;return c="\n          "+o+"\n        ",[n,c,[3,"title"]];},template:function(n,o){n&1&&(s(0,"span",2),p(1,yi,3,4,"ng-container")(2,Pi,3,4,"ng-container"),d()),n&2&&(l("title",o.getExactNumberOfViews()),a(),k(o.isLive()?1:2));},dependencies:[st],encapsulation:2,changeDetection:0}));let e=r;return e;})();var Ii=["modal"],bi=e=>({"input-error":e});function wi(e,r){if(e&1&&v(0,"div",27),e&2){let i=_(2).$implicit;l("innerHTML",i.help,ae);}}function xi(e,r){e&1&&p(0,wi,1,1,"ng-template",26);}function Fi(e,r){if(e&1&&(h(0,28),v(1,"div",27),A()),e&2){let i=_().$implicit;a(),l("innerHTML",i.description,ae);}}function Vi(e,r){if(e&1&&(s(0,"div",18)(1,"my-peertube-checkbox",24),p(2,xi,1,0,null,17)(3,Fi,2,1,"ng-container",25),d()()),e&2){let i=r.$implicit;a(),l("inputName",i.id)("formControlName",i.id)("labelText",i.label),a(),l("ngIf",i.help),a(),l("ngIf",i.description);}}function Li(e,r){if(e&1&&(se(0,2,1),le(1),de()),e&2){let i=_(2);a(),P(i.originHost),I(0);}}function $i(e,r){if(e&1&&(s(0,"div",29),R(1),d()),e&2){let i=_(2);a(),b(" ",i.formErrors.reason," ");}}function ki(e,r){if(e&1){let i=M();s(0,"div",3)(1,"h4",4),R(2),d(),s(3,"button",5),S("click",function(){u(i);let n=_();return g(n.hide());}),v(4,"my-global-icon",6),d()(),s(5,"div",7)(6,"form",8),S("ngSubmit",function(){u(i);let n=_();return g(n.report());}),s(7,"div",9)(8,"div",10)(9,"label",11),O(10,1),d(),s(11,"div",12),h(12,13),p(13,Vi,4,5,"div",14),A(),d()(),s(14,"div",15)(15,"div",16),se(16,2),p(17,Li,2,1,"ng-container",17),de(),d(),s(18,"div",18),v(19,"textarea",19),p(20,$i,2,1,"div",20),d()()(),s(21,"div",21)(22,"input",22),S("click",function(){u(i);let n=_();return g(n.hide());})("key.enter",function(){u(i);let n=_();return g(n.hide());}),d(),v(23,"input",23),d()()();}if(e&2){let i=_();a(2),Z(i.modalTitle),a(4),l("formGroup",i.form),a(7),l("ngForOf",i.predefinedReasons),a(4),l("ngIf",i.isRemote()),P(i.currentHost),I(16),a(2),l("ngClass",F(8,bi,i.formErrors.reason)),a(),l("ngIf",i.formErrors.reason),a(3),l("disabled",!i.form.valid);}}var hr=(()=>{let r=class r extends he{formReactiveService=f(Ee);modalService=f(ie);abuseService=f(We);notifier=f(ne);modal=V("modal");error=null;predefinedReasons=[];modalTitle;account=null;openedModal;get currentHost(){return window.location.host;}get originHost(){return this.isRemote()?this.account.host:"";}ngOnInit(){this.buildForm({reason:Ge,predefinedReasons:_e(Fe,t=>null)}),this.predefinedReasons=this.abuseService.getPrefefinedReasons("account");}show(t){this.account=t,this.modalTitle="Informe\n          "+this.account.displayName+"\n        ",this.openedModal=this.modalService.open(this.modal(),{centered:!0,keyboard:!1,size:"lg"});}hide(){this.openedModal.close(),this.openedModal=null;}report(){let t=this.form.get("reason").value,n=Object.keys(Le(this.form.get("predefinedReasons").value));this.abuseService.reportVideo({reason:t,predefinedReasons:n,account:{id:this.account.id}}).subscribe({next:()=>{this.notifier.success("Cuenta informada."),this.hide();},error:o=>this.notifier.error(o.message)});}isRemote(){return!this.account.isLocal;}};T(r,"\u0275fac",(()=>{let t;return function(o){return(t||(t=me(r)))(o||r);};})()),T(r,"\u0275cmp",N({type:r,selectors:[["my-account-report"]],viewQuery:function(n,o){n&1&&L(o.modal,Ii,5),n&2&&W();},features:[ue],decls:2,vars:0,consts:()=>{let t;t="Cerrar esta ventana";let n;n="Describe el problema\u2026";let o;o="Cancelar";let c;c="Enviar";let m;m="\xBFCu\xE1l es el problema?";let C;return C="Tu denuncia se enviar\xE1 a los moderadores de "+"\uFFFD0\uFFFD"+""+"\uFFFD*17:1\uFFFD\uFFFD#1:1\uFFFD"+" y ser\xE1 reenviada tambi\xE9n al origen del comentario ("+"\uFFFD0:1\uFFFD"+")"+"\uFFFD/#1:1\uFFFD\uFFFD/*17:1\uFFFD"+". ",[["modal",""],m,C,[1,"modal-header"],[1,"modal-title"],["title",t,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-5"],["for","reportPredefinedReasons"],[1,"ms-2","mt-2","d-flex","flex-column"],["formGroupName","predefinedReasons"],["class","form-group",4,"ngFor","ngForOf"],[1,"col-7"],[1,"information"],[4,"ngIf"],[1,"form-group"],["placeholder",n,"formControlName","reason","ngbAutofocus","",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",o,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",c,1,"peertube-button","primary-button",3,"disabled"],[3,"inputName","formControlName","labelText"],["ngProjectAs","description",5,["description"],4,"ngIf"],["ptTemplate","help"],[3,"innerHTML"],["ngProjectAs","description",5,["description"]],["role","alert",1,"form-error"]];},template:function(n,o){n&1&&p(0,ki,24,10,"ng-template",null,0,H);},dependencies:[$,U,fe,Q,z,ge,Oe,ve,Ce,xe,te,oe,x,He,j],styles:[`my-timestamp-input[_ngcontent-%COMP%]{width:100px}.information[_ngcontent-%COMP%]{margin-bottom:20px}textarea[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:100px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}.start-at[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]{width:300px;display:flex;align-items:center}.start-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%]{margin-inline-start:.625rem}
/*# sourceMappingURL=report.component-BWX5OIQS.css.map */`]}));let e=r;return e;})();var Hi=["modal"],Gi=e=>({"input-error":e});function Wi(e,r){if(e&1&&v(0,"div",27),e&2){let i=_(2).$implicit;l("innerHTML",i.help,ae);}}function zi(e,r){e&1&&p(0,Wi,1,1,"ng-template",26);}function Ui(e,r){if(e&1&&(h(0,28),v(1,"div",27),A()),e&2){let i=_().$implicit;a(),l("innerHTML",i.description,ae);}}function Bi(e,r){if(e&1&&(s(0,"div",18)(1,"my-peertube-checkbox",24),p(2,zi,1,0,null,17)(3,Ui,2,1,"ng-container",25),d()()),e&2){let i=r.$implicit;a(),l("inputName",i.id)("formControlName",i.id)("labelText",i.label),a(),l("ngIf",i.help),a(),l("ngIf",i.description);}}function Xi(e,r){if(e&1&&(se(0,2,1),le(1),de()),e&2){let i=_(2);a(),P(i.originHost),I(0);}}function ji(e,r){if(e&1&&(s(0,"div",29),R(1),d()),e&2){let i=_(2);a(),b(" ",i.formErrors.reason," ");}}function Qi(e,r){if(e&1){let i=M();s(0,"div",3)(1,"h4",4),R(2),d(),s(3,"button",5),S("click",function(){u(i);let n=_();return g(n.hide());}),v(4,"my-global-icon",6),d()(),s(5,"div",7)(6,"form",8),S("ngSubmit",function(){u(i);let n=_();return g(n.report());}),s(7,"div",9)(8,"div",10)(9,"label",11),O(10,1),d(),s(11,"div",12),h(12,13),p(13,Bi,4,5,"div",14),A(),d()(),s(14,"div",15)(15,"div",16),se(16,2),p(17,Xi,2,1,"ng-container",17),de(),d(),s(18,"div",18),v(19,"textarea",19),p(20,ji,2,1,"div",20),d()()(),s(21,"div",21)(22,"input",22),S("click",function(){u(i);let n=_();return g(n.hide());})("key.enter",function(){u(i);let n=_();return g(n.hide());}),d(),v(23,"input",23),d()()();}if(e&2){let i=_();a(2),Z(i.modalTitle),a(4),l("formGroup",i.form),a(7),l("ngForOf",i.predefinedReasons),a(4),l("ngIf",i.isRemote()),P(i.currentHost),I(16),a(2),l("ngClass",F(8,Gi,i.formErrors.reason)),a(),l("ngIf",i.formErrors.reason),a(3),l("disabled",!i.form.valid);}}var Hr=(()=>{let r=class r extends he{formReactiveService=f(Ee);modalService=f(ie);abuseService=f(We);notifier=f(ne);comment=E(null);modal=V("modal");modalTitle;error=null;predefinedReasons=[];openedModal;get currentHost(){return window.location.host;}get originHost(){return this.isRemote()?this.comment().account.host:"";}ngOnInit(){this.modalTitle="Informar comentario",this.buildForm({reason:Ge,predefinedReasons:_e(Fe,t=>null)}),this.predefinedReasons=this.abuseService.getPrefefinedReasons("comment");}show(){this.openedModal=this.modalService.open(this.modal(),{centered:!0,keyboard:!1,size:"lg"});}hide(){this.openedModal.close(),this.openedModal=null;}report(){let t=this.form.get("reason").value,n=Object.keys(Le(this.form.get("predefinedReasons").value));this.abuseService.reportVideo({reason:t,predefinedReasons:n,comment:{id:this.comment().id}}).subscribe({next:()=>{this.notifier.success("Comentario informado."),this.hide();},error:o=>this.notifier.error(o.message)});}isRemote(){return!this.comment().isLocal;}};T(r,"\u0275fac",(()=>{let t;return function(o){return(t||(t=me(r)))(o||r);};})()),T(r,"\u0275cmp",N({type:r,selectors:[["my-comment-report"]],viewQuery:function(n,o){n&1&&L(o.modal,Hi,5),n&2&&W();},inputs:{comment:[1,"comment"]},features:[ue],decls:2,vars:0,consts:()=>{let t;t="Cerrar esta ventana";let n;n="Describe el problema\u2026";let o;o="Cancelar";let c;c="Enviar";let m;m="\xBFCu\xE1l es el problema?";let C;return C="Tu denuncia se enviar\xE1 a los moderadores de "+"\uFFFD0\uFFFD"+""+"\uFFFD*17:1\uFFFD\uFFFD#1:1\uFFFD"+" y ser\xE1 reenviada tambi\xE9n al origen del comentario ("+"\uFFFD0:1\uFFFD"+")"+"\uFFFD/#1:1\uFFFD\uFFFD/*17:1\uFFFD"+". ",[["modal",""],m,C,[1,"modal-header"],[1,"modal-title"],["title",t,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-5"],["for","reportPredefinedReasons"],[1,"ms-2","mt-2","d-flex","flex-column"],["formGroupName","predefinedReasons"],["class","form-group",4,"ngFor","ngForOf"],[1,"col-7"],[1,"information"],[4,"ngIf"],[1,"form-group"],["placeholder",n,"formControlName","reason","ngbAutofocus","",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",o,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",c,1,"peertube-button","primary-button",3,"disabled"],[3,"inputName","formControlName","labelText"],["ngProjectAs","description",5,["description"],4,"ngIf"],["ptTemplate","help"],[3,"innerHTML"],["ngProjectAs","description",5,["description"]],["role","alert",1,"form-error"]];},template:function(n,o){n&1&&p(0,Qi,24,10,"ng-template",null,0,H);},dependencies:[$,U,fe,Q,z,ge,Oe,ve,Ce,xe,te,oe,x,He,j],styles:[`my-timestamp-input[_ngcontent-%COMP%]{width:100px}.information[_ngcontent-%COMP%]{margin-bottom:20px}textarea[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:100px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}.start-at[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]{width:300px;display:flex;align-items:center}.start-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%]{margin-inline-start:.625rem}
/*# sourceMappingURL=report.component-BWX5OIQS.css.map */`]}));let e=r;return e;})();var Ki=["modal"],qi=e=>({"input-error":e});function Yi(e,r){if(e&1&&v(0,"div",33),e&2){let i=_(2).$implicit;l("innerHTML",i.help,ae);}}function Ji(e,r){e&1&&p(0,Yi,1,1,"ng-template",32);}function Zi(e,r){if(e&1&&(h(0,34),v(1,"div",33),A()),e&2){let i=_().$implicit;a(),l("innerHTML",i.description,ae);}}function en(e,r){if(e&1&&(s(0,"div",24)(1,"my-peertube-checkbox",30),p(2,Ji,1,0,null,23)(3,Zi,2,1,"ng-container",31),d()()),e&2){let i=r.$implicit;a(),l("inputName",i.id)("formControlName",i.id)("labelText",i.label),a(),l("ngIf",i.help),a(),l("ngIf",i.description);}}function tn(e,r){if(e&1&&(s(0,"div",35),v(1,"my-peertube-checkbox",36)(2,"my-timestamp-input",37),d()),e&2){let i=_(2);a(2),l("timestamp",i.timestamp.endAt)("maxTimestamp",i.video().duration);}}function nn(e,r){if(e&1&&(se(0,3,1),le(1),de()),e&2){let i=_(2);a(),P(i.originHost),I(0);}}function on(e,r){if(e&1&&(s(0,"div",38),R(1),d()),e&2){let i=_(2);a(),b(" ",i.formErrors.reason," ");}}function rn(e,r){if(e&1){let i=M();s(0,"div",4)(1,"h4",5),O(2,1),d(),s(3,"button",6),S("click",function(){u(i);let n=_();return g(n.hide());}),v(4,"my-global-icon",7),d()(),s(5,"div",8)(6,"form",9),S("ngSubmit",function(){u(i);let n=_();return g(n.report());}),s(7,"div",10)(8,"div",11)(9,"label",12),O(10,2),d(),s(11,"div",13),h(12,14),p(13,en,4,5,"div",15),A(),d()(),s(14,"div",16),v(15,"my-embed",17),s(16,"div",18),v(17,"my-peertube-checkbox",19)(18,"my-timestamp-input",20),d(),p(19,tn,3,2,"div",21),s(20,"div",22),se(21,3),p(22,nn,2,1,"ng-container",23),de(),d(),s(23,"div",24),v(24,"textarea",25),p(25,on,2,1,"div",26),d()()(),s(26,"div",27)(27,"input",28),S("click",function(){u(i);let n=_();return g(n.hide());})("key.enter",function(){u(i);let n=_();return g(n.hide());}),d(),v(28,"input",29),d()()();}if(e&2){let i=_();a(2),P(i.video().name),I(2),a(4),l("formGroup",i.form),a(7),l("ngForOf",i.predefinedReasons),a(2),l("video",i.video()),a(3),l("timestamp",i.timestamp.startAt)("maxTimestamp",i.video().duration),a(),l("ngIf",i.timestamp.hasStart),a(3),l("ngIf",i.isRemote()),P(i.currentHost),I(21),a(2),l("ngClass",F(12,qi,i.formErrors.reason)),a(),l("ngIf",i.formErrors.reason),a(3),l("disabled",!i.form.valid);}}var Oi=(()=>{let r=class r extends he{formReactiveService=f(Ee);modalService=f(ie);abuseService=f(We);notifier=f(ne);video=E(null);modal=V("modal");error=null;predefinedReasons=[];openedModal;get currentHost(){return window.location.host;}get originHost(){return this.isRemote()?this.video().account.host:"";}get timestamp(){return this.form.get("timestamp").value;}ngOnInit(){this.buildForm({reason:Ge,predefinedReasons:_e(Fe,t=>null),timestamp:{hasStart:null,startAt:null,hasEnd:null,endAt:null}}),this.predefinedReasons=this.abuseService.getPrefefinedReasons("video");}show(){this.openedModal=this.modalService.open(this.modal(),{centered:!0,keyboard:!1,size:"lg"});}hide(){this.openedModal.close(),this.openedModal=null;}report(){let t=this.form.get("reason").value,n=Object.keys(Le(this.form.get("predefinedReasons").value)),{hasStart:o,startAt:c,hasEnd:m,endAt:C}=this.form.get("timestamp").value;this.abuseService.reportVideo({reason:t,predefinedReasons:n,video:{id:this.video().id,startAt:o&&c?c:void 0,endAt:m&&C?C:void 0}}).subscribe({next:()=>{this.notifier.success("V\xEDdeo reportado."),this.hide();},error:D=>this.notifier.error(D.message)});}isRemote(){return!this.video().isLocal;}};T(r,"\u0275fac",(()=>{let t;return function(o){return(t||(t=me(r)))(o||r);};})()),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-report"]],viewQuery:function(n,o){n&1&&L(o.modal,Ki,5),n&2&&W();},inputs:{video:[1,"video"]},features:[ue],decls:2,vars:0,consts:()=>{let t;t="Cerrar esta ventana";let n;n="Empezar en";let o;o="Describe el problema\u2026";let c;c="Cancelar";let m;m="Enviar";let C;C="Denunciar el video \""+"\uFFFD0\uFFFD"+"\"";let D;D="\xBFCu\xE1l es el problema?";let ce;ce="Su informe se enviar\xE1 a los moderadores de "+"\uFFFD0\uFFFD"+""+"\uFFFD*22:1\uFFFD\uFFFD#1:1\uFFFD"+" y se reenviar\xE1 tambi\xE9n al origen del video ("+"\uFFFD0:1\uFFFD"+")"+"\uFFFD/#1:1\uFFFD\uFFFD/*22:1\uFFFD"+". ";let pe;return pe="Detener en",[["modal",""],C,D,ce,[1,"modal-header"],[1,"modal-title"],["title",t,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-md-5"],["for","reportPredefinedReasons"],[1,"ms-2","mt-2","d-flex","flex-column"],["formGroupName","predefinedReasons"],["class","form-group",4,"ngFor","ngForOf"],[1,"col-12","col-md-7"],[3,"video"],["formGroupName","timestamp",1,"mb-1","mt-3","start-at"],["formControlName","hasStart","labelText",n],["formControlName","startAt","inputName","startAt",3,"timestamp","maxTimestamp"],["class","mb-3 stop-at","formGroupName","timestamp",4,"ngIf"],[1,"information"],[4,"ngIf"],[1,"form-group"],["placeholder",o,"formControlName","reason","ngbAutofocus","",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",c,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",m,1,"peertube-button","primary-button",3,"disabled"],[3,"inputName","formControlName","labelText"],["ngProjectAs","description",5,["description"],4,"ngIf"],["ptTemplate","help"],[3,"innerHTML"],["ngProjectAs","description",5,["description"]],["formGroupName","timestamp",1,"mb-3","stop-at"],["formControlName","hasEnd","labelText",pe],["formControlName","endAt","inputName","endAt",3,"timestamp","maxTimestamp"],["role","alert",1,"form-error"]];},template:function(n,o){n&1&&p(0,rn,29,14,"ng-template",null,0,H);},dependencies:[$,U,fe,Q,z,ge,Oe,ve,Ce,xe,te,oe,x,He,gi,ui,j],styles:[`my-timestamp-input[_ngcontent-%COMP%]{width:100px}.information[_ngcontent-%COMP%]{margin-bottom:20px}textarea[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:100px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}.start-at[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]{width:300px;display:flex;align-items:center}.start-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%]{margin-inline-start:.625rem}
/*# sourceMappingURL=report.component-BWX5OIQS.css.map */`]}));let e=r;return e;})();var Ei={VALIDATORS:[pt.minLength(2),pt.maxLength(300)],MESSAGES:{minlength:"El motivo del bloque debe tener al menos 2 caracteres de longitud.",maxlength:"El motivo del bloqueo no puede tener m\xE1s de 300 caracteres."}};var an=["modal"],ln=e=>({"input-error":e});function sn(e,r){if(e&1&&(h(0),s(1,"h4",21),O(2,1),d(),A()),e&2){let i=_(2);a(2),P(i.videos.length),I(2);}}function dn(e,r){if(e&1&&(s(0,"h4",21),O(1,2),d()),e&2){let i=_(3);a(),P(i.getSingleVideo().name),I(1);}}function _n(e,r){if(e&1&&(s(0,"h4",21),O(1,3),d()),e&2){let i=_(3);a(),P(i.getSingleVideo().name),I(1);}}function cn(e,r){if(e&1&&(h(0),p(1,dn,2,1,"h4",22)(2,_n,2,1,"h4",22),A()),e&2){let i=_(2);a(),l("ngIf",!i.getSingleVideo().isLive),a(),l("ngIf",i.getSingleVideo().isLive);}}function pn(e,r){if(e&1&&(s(0,"div",23),R(1),d()),e&2){let i=_(2);a(),b(" ",i.formErrors.reason," ");}}function mn(e,r){e&1&&(s(0,"span"),O(1,4),d());}function un(e,r){e&1&&(s(0,"span"),O(1,5),d());}function gn(e,r){if(e&1&&(s(0,"div",13)(1,"my-peertube-checkbox",24),h(2,25),p(3,mn,2,0,"span",8)(4,un,2,0,"span",8),A(),d()()),e&2){let i=_(2);a(3),l("ngIf",i.isMultiple()),a(),l("ngIf",!i.isMultiple());}}function fn(e,r){e&1&&(s(0,"strong",26),O(1,6),d());}function vn(e,r){if(e&1){let i=M();s(0,"div",7),p(1,sn,3,1,"ng-container",8)(2,cn,3,2,"ng-container",8),s(3,"button",9),S("click",function(){u(i);let n=_();return g(n.hide());}),v(4,"my-global-icon",10),d()(),s(5,"div",11)(6,"form",12),S("ngSubmit",function(){u(i);let n=_();return g(n.block());}),s(7,"div",13),v(8,"textarea",14),p(9,pn,2,1,"div",15),d(),p(10,gn,5,2,"div",16)(11,fn,2,0,"strong",17),s(12,"div",18)(13,"input",19),S("click",function(){u(i);let n=_();return g(n.hide());})("key.enter",function(){u(i);let n=_();return g(n.hide());}),d(),v(14,"input",20),d()()();}if(e&2){let i=_();a(),l("ngIf",i.isMultiple()),a(),l("ngIf",!i.isMultiple()),a(4),l("formGroup",i.form),a(2),l("ngClass",F(8,ln,i.formErrors.reason)),a(),l("ngIf",i.formErrors.reason),a(),l("ngIf",i.hasLocal()),a(),l("ngIf",i.hasLive()),a(3),l("disabled",!i.form.valid);}}var Si=(()=>{let r=class r extends he{formReactiveService=f(Ee);modalService=f(ie);videoBlocklistService=f(dt);notifier=f(ne);modal=V("modal");videoBlocked=y();videos;error=null;openedModal;ngOnInit(){let t={unfederate:"true"};this.buildForm({reason:Ei,unfederate:null},t);}isMultiple(){return this.videos.length>1;}getSingleVideo(){return this.videos[0];}hasLive(){return this.videos.some(t=>t.isLive);}hasLocal(){return this.videos.some(t=>t.isLocal);}show(t){this.videos=t,this.openedModal=this.modalService.open(this.modal(),{centered:!0,keyboard:!1});}hide(){this.openedModal.close(),this.openedModal=null;}block(){let t=this.videos.map(n=>({videoId:n.id,reason:this.form.value.reason||void 0,unfederate:n.isLocal?this.form.value.unfederate:void 0}));this.videoBlocklistService.blockVideo(t).subscribe({next:()=>{let n=Be("{count, plural, =1 {Bloqueado {videoName}.} other {Bloqueados {count} videos.}}",{count:this.videos.length,videoName:this.getSingleVideo().name});this.notifier.success(n),this.hide();for(let o of t){let c=this.videos.find(m=>m.id===o.videoId);c.blacklisted=!0,c.blacklistedReason=o.reason;}this.videoBlocked.emit();},error:n=>this.notifier.error(n.message)});}};T(r,"\u0275fac",(()=>{let t;return function(o){return(t||(t=me(r)))(o||r);};})()),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-block"]],viewQuery:function(n,o){n&1&&L(o.modal,an,5),n&2&&W();},outputs:{videoBlocked:"videoBlocked"},features:[ue],decls:2,vars:0,consts:()=>{let t;t="Cerrar esta ventana";let n;n="Describe la raz\xF3n\u2026";let o;o="Cancelar";let c;c="Bloquear";let m;m="Bloquear el v\xEDdeo "+"\uFFFD0\uFFFD"+"";let C;C="Bloquear video \xAB"+"\uFFFD0\uFFFD"+"\xBB";let D;D="Bloquear directo \xAB"+"\uFFFD0\uFFFD"+"\xBB";let ce;ce="No federado";let pe;pe="Esto le pedir\xE1 a las instancias remotas que eliminen los v\xEDdeos locales";let G;G="Esto le pedir\xE1 a las instancias remotas que eliminen este video";let Ue;return Ue="El bloqueo de un directo terminar\xE1 autom\xE1ticamente la emisi\xF3n en directo.",[["modal",""],m,C,D,pe,G,Ue,[1,"modal-header"],[4,"ngIf"],["title",t,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["placeholder",n,"formControlName","reason",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["class","form-group",4,"ngIf"],["class","live-info",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",o,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",c,1,"peertube-button","primary-button",3,"disabled"],[1,"modal-title"],["class","modal-title",4,"ngIf"],["role","alert",1,"form-error"],["inputName","unfederate","formControlName","unfederate","labelText",ce],["ngProjectAs","description",5,["description"]],[1,"live-info"]];},template:function(n,o){n&1&&p(0,vn,15,10,"ng-template",null,0,H);},dependencies:[x,$,U,fe,Q,z,ge,Oe,ve,Ce,j,oe],styles:[`textarea[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:100px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}.live-info[_ngcontent-%COMP%]{margin:40px 0 20px}
/*# sourceMappingURL=video-block.component-IAMJPKCG.css.map */`]}));let e=r;return e;})();var Cn=[[["cancel-button"]]],On=["cancel-button"];function En(e,r){e&1&&(h(0),O(1,1),A());}function Sn(e,r){if(e&1&&(s(0,"div",11),v(1,"my-input-text",12),d()),e&2){let i=_(2);a(),l("show",!0)("readonly",!0)("withCopy",!0)("withToggle",!1)("value",i.getCaptionLink());}}function hn(e,r){if(e&1&&(s(0,"li",7)(1,"button",8),R(2),p(3,En,2,0,"ng-container",9),d(),p(4,Sn,2,5,"ng-template",10),d()),e&2){let i=r.$implicit;l("ngbNavItem",i.language.id),a(2),b(" ",i.language.label," "),a(),l("ngIf",i.automaticallyGenerated);}}var hi=(()=>{let r=class r{videoCaptions=E.required();downloaded=y();activeNavId;getCaptions(){let t=this.videoCaptions();return t||[];}ngOnInit(){this.hasCaptions()&&(this.activeNavId=this.videoCaptions()[0].language.id);}download(){window.location.assign(this.getCaptionLink()),this.downloaded.emit();}hasCaptions(){return this.getCaptions().length!==0;}getCaption(){let t=this.getCaptions().find(n=>n.language.id===this.activeNavId);if(!t){ot.error(`Cannot find caption ${this.activeNavId}`);return;}return t;}getCaptionLink(){let t=this.getCaption();return t?t.fileUrl:"";}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-subtitle-files-download"]],inputs:{videoCaptions:[1,"videoCaptions"]},outputs:{downloaded:"downloaded"},ngContentSelectors:On,decls:7,vars:3,consts:()=>{let t;t="Descargar";let n;n="(generado autom\xE1ticamente)";let o;return o="URL de subt\xEDtulos",[["nav","ngbNav"],n,["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem",4,"ngFor","ngForOf"],[1,"mt-2",3,"ngbNavOutlet"],[1,"modal-footer","inputs"],["type","submit","value",t,1,"peertube-button","primary-button",3,"click"],[3,"ngbNavItem"],["ngbNavLink",""],[4,"ngIf"],["ngbNavContent",""],[1,"nav-content"],["inputId","subtitle-url","ariaLabel",o,3,"show","readonly","withCopy","withToggle","value"]];},template:function(n,o){if(n&1){let c=M();Pe(Cn),s(0,"ul",2,0),J("activeIdChange",function(C){return u(c),Y(o.activeNavId,C)||(o.activeNavId=C),g(C);}),p(2,hn,5,3,"li",3),d(),v(3,"div",4),s(4,"div",5),Ie(5),s(6,"input",6),S("click",function(){return u(c),g(o.download());}),d()();}if(n&2){let c=w(1);q("activeId",o.activeNavId),a(2),l("ngForOf",o.getCaptions()),a(),l("ngbNavOutlet",c);}},dependencies:[x,te,at,nt,Je,et,Ze,qt,Yt,tt,it],encapsulation:2}));let e=r;return e;})();var An=[[["cancel-button"]]],Tn=["cancel-button"],vt=e=>({$implicit:e}),Ct=(e,r)=>r.key;function Rn(e,r){e&1&&(s(0,"my-alert",35),O(1,7),d());}function Mn(e,r){if(e&1&&(s(0,"div",36),v(1,"my-input-text",37),d()),e&2){let i=_();a(),l("show",!0)("readonly",!0)("withCopy",!0)("withToggle",!1)("value",i.getVideoFileLink());}}function Dn(e,r){}function Nn(e,r){if(e&1&&p(0,Dn,0,0,"ng-template",40),e&2){_(2);let i=w(4);l("ngTemplateOutlet",i);}}function yn(e,r){e&1&&(h(0,38),s(1,"a",22),h(2),O(3,8),A(),v(4,"my-global-icon",39),d(),p(5,Nn,1,1,"ng-template",23),A());}function Pn(e,r){}function In(e,r){if(e&1&&p(0,Pn,0,0,"ng-template",40),e&2){_(2);let i=w(4);l("ngTemplateOutlet",i);}}function bn(e,r){if(e&1&&(h(0,41),s(1,"a",22),R(2),d(),p(3,In,1,1,"ng-template",23),A()),e&2){let i=r.$implicit;l("ngbNavItem",i.resolution.id),a(2),Z(i.resolution.label);}}function wn(e,r){if(e&1&&(s(0,"span"),R(1),d()),e&2){let i=_().$implicit;a(),Z(i.value.value);}}function xn(e,r){e&1&&(s(0,"span"),O(1,9),d());}function Fn(e,r){if(e&1&&(s(0,"div",42)(1,"span"),R(2),d(),p(3,wn,2,1,"span")(4,xn,2,0,"span"),d()),e&2){let i=r.$implicit;a(2),Z(i.value.label),a(),k(i.value.value?3:4);}}function Vn(e,r){}function Ln(e,r){if(e&1&&p(0,Vn,0,0,"ng-template",44),e&2){let i=r.$implicit;_(2);let t=w(12);l("ngTemplateOutlet",t)("ngTemplateOutletContext",F(2,vt,i));}}function $n(e,r){if(e&1&&(s(0,"div",43),Ne(1,Ln,1,4,null,44,Ct),ee(3,"keyvalue"),d()),e&2){let i=_();a(),ye(Ae(3,0,i.videoFileMetadataFormat));}}function kn(e,r){}function Hn(e,r){if(e&1&&p(0,kn,0,0,"ng-template",44),e&2){let i=r.$implicit;_(3);let t=w(12);l("ngTemplateOutlet",t)("ngTemplateOutletContext",F(2,vt,i));}}function Gn(e,r){if(e&1&&(s(0,"div",43),Ne(1,Hn,1,4,null,44,Ct),ee(3,"keyvalue"),d()),e&2){let i=_(2);a(),ye(Ae(3,0,i.videoFileMetadataVideoStream));}}function Wn(e,r){e&1&&(h(0,21),s(1,"a",22),O(2,10),d(),p(3,Gn,4,2,"ng-template",23),A());}function zn(e,r){}function Un(e,r){if(e&1&&p(0,zn,0,0,"ng-template",44),e&2){let i=r.$implicit;_(3);let t=w(12);l("ngTemplateOutlet",t)("ngTemplateOutletContext",F(2,vt,i));}}function Bn(e,r){if(e&1&&(s(0,"div",43),Ne(1,Un,1,4,null,44,Ct),ee(3,"keyvalue"),d()),e&2){let i=_(2);a(),ye(Ae(3,0,i.videoFileMetadataAudioStream));}}function Xn(e,r){e&1&&(h(0,21),s(1,"a",22),O(2,11),d(),p(3,Bn,4,2,"ng-template",23),A());}function jn(e,r){if(e&1&&v(0,"div",18),e&2){_();let i=w(10);l("ngbNavOutlet",i);}}function Qn(e,r){e&1&&(v(0,"span",45),h(1),O(2,12),A());}function Kn(e,r){e&1&&(v(0,"span",46),h(1),O(2,13),A());}var Ai=(()=>{let r=class r{localeId=f(wt);videoService=f(re);video=E.required();originalVideoFile=E(void 0);videoFileToken=E(void 0);downloaded=y();downloadType="direct";activeResolutionId=-1;videoFileMetadataFormat;videoFileMetadataVideoStream;videoFileMetadataAudioStream;isAdvancedCustomizationCollapsed=!0;bytesPipe;numbersPipe;constructor(){this.bytesPipe=new lt(),this.numbersPipe=new st(this.localeId);}ngOnInit(){this.hasFiles()&&this.onResolutionIdChange(this.getVideoFiles()[0].resolution.id);}getVideoFiles(){let t=this.video();if(!t)return[];if(t.files.length!==0)return t.files;let n=t.getHlsPlaylist();return n?n.files:[];}download(){window.location.assign(this.getVideoFileLink()),this.downloaded.emit();}onResolutionIdChange(t){return Re(this,null,function*(){this.activeResolutionId=t;let n;if(this.activeResolutionId==="original")n=this.originalVideoFile().metadata;else{let o=this.getVideoFile();if(!o)return;!o.metadata&&o.metadataUrl&&(yield this.hydrateMetadataFromMetadataUrl(o)),n=o.metadata;}n&&(this.videoFileMetadataFormat=this.getMetadataFormat(n.format),this.videoFileMetadataVideoStream=this.getMetadataStream(n.streams,"video"),this.videoFileMetadataAudioStream=this.getMetadataStream(n.streams,"audio"));});}hasFiles(){return this.getVideoFiles().length!==0;}getVideoFile(){if(this.activeResolutionId==="original")return;let t=this.getVideoFiles().find(n=>n.resolution.id===this.activeResolutionId);if(!t){ot.error(`Could not find file with resolution ${this.activeResolutionId}`);return;}return t;}getVideoFileLink(){let t=this.activeResolutionId==="original"||this.isConfidentialVideo()?"?videoFileToken="+this.videoFileToken():"";if(this.activeResolutionId==="original")return this.originalVideoFile().fileDownloadUrl+t;let n=this.getVideoFile();if(!n)return"";switch(this.downloadType){case"direct":return n.fileDownloadUrl+t;case"torrent":return n.torrentDownloadUrl+t;}}isConfidentialVideo(){return this.activeResolutionId==="original"||$e(this.video());}hasMetadata(){return!!this.videoFileMetadataFormat;}getMetadataFormat(t){let n={encoder:c=>({label:"Codificador",value:c}),format_long_name:c=>({label:"Nombre del formato",value:c}),size:c=>({label:"Tama\xF1o",value:this.bytesPipe.transform(+c,2)}),bit_rate:c=>({label:"Bitrate",value:`${this.numbersPipe.transform(+c)}bps`})},o=Object.assign(t,t.tags);return delete o.tags,_e(mt(o,Ut(n)),(c,m)=>n[m](c));}getMetadataStream(t,n){let o=t.find(m=>m.codec_type===n);if(!o)return;let c={codec_long_name:m=>({label:"Codec",value:m}),profile:m=>({label:"Perfil",value:m}),bit_rate:m=>({label:"Bitrate",value:isNaN(+m)?void 0:`${this.numbersPipe.transform(+m)}bps`})};return n==="video"?c=Object.assign(c,{width:m=>({label:"Resoluci\xF3n",value:`${m}x${o.height}`}),display_aspect_ratio:m=>({label:"Relaci\xF3n de aspecto",value:m}),avg_frame_rate:m=>({label:"Velocidad de fotogramas media",value:m}),pix_fmt:m=>({label:"Formato de p\xEDxeles",value:m})}):c=Object.assign(c,{sample_rate:m=>({label:"Frecuencia de muestreo",value:m}),channel_layout:m=>({label:"Dise\xF1o de canal",value:m})}),_e(mt(o,Object.keys(c)),(m,C)=>c[C](m));}hydrateMetadataFromMetadataUrl(t){let n=this.videoService.getVideoFileMetadata(t.metadataUrl).pipe(At(o=>t.metadata=o));return Et(n);}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-files-download"]],inputs:{video:[1,"video"],originalVideoFile:[1,"originalVideoFile"],videoFileToken:[1,"videoFileToken"]},outputs:{downloaded:"downloaded"},ngContentSelectors:Tn,decls:35,vars:15,consts:()=>{let t;t="Descargar";let n;n="Formato";let o;o="Descarga directa";let c;c="Torrent (archivo .torrent)";let m;m="El siguiente link contiene un token privado y no deber\xEDa ser compartido con nadie.";let C;C="Link al archivo de v\xEDdeo";let D;D="Otros usuarios no pueden descargar el archivo original";let ce;ce="Archivo original";let pe;pe="Desconocido";let G;G="Flujo de v\xEDdeo";let Ue;Ue="Pista de audio";let B;B="M\xE1s informaci\xF3n/opciones";let Ot;return Ot="Menos informaci\xF3n/opciones",[["resolutionNav","ngbNav"],["rootNavContent",""],["navMetadata","ngbNav"],["metadataInfo",""],n,o,c,m,ce,pe,G,Ue,B,Ot,["type","warning",4,"ngIf"],["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],["ngbNavItem","original",4,"ngIf"],[3,"ngbNavItem",4,"ngFor","ngForOf"],[3,"ngbNavOutlet"],[1,"advanced-filters",3,"ngbCollapse","animation"],["ngbNav","",1,"nav-tabs","nav-metadata"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","",4,"ngIf"],[3,"ngbNavOutlet",4,"ngIf"],[1,"download-type",3,"hidden"],[1,"peertube-radio-container"],["type","radio","name","download","id","download-direct","value","direct",3,"ngModelChange","ngModel"],["for","download-direct"],["type","radio","name","download","id","download-torrent","value","torrent",3,"ngModelChange","ngModel"],["for","download-torrent"],["aria-controls","collapseBasic",1,"advanced-filters-button","button-unstyle",3,"click"],[1,"modal-footer","inputs"],["type","submit","value",t,1,"peertube-button","primary-button",3,"click"],["type","warning"],[1,"nav-content"],["inputId","video-file-link","ariaLabel",C,3,"show","readonly","withCopy","withToggle","value"],["ngbNavItem","original"],["ngbTooltip",D,"iconName","shield"],[3,"ngTemplateOutlet"],[3,"ngbNavItem"],[1,"metadata-attribute"],[1,"file-metadata"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"chevron-down"],[1,"chevron-up"]];},template:function(n,o){if(n&1){let c=M();Pe(An),p(0,Rn,2,0,"my-alert",14),s(1,"div",15,0),S("activeIdChange",function(C){return u(c),g(o.onResolutionIdChange(C));}),p(3,Mn,2,5,"ng-template",null,1,H)(5,yn,6,0,"ng-container",16)(6,bn,4,2,"ng-container",17),d(),v(7,"div",18),s(8,"div",19)(9,"div",20,2),p(11,Fn,5,2,"ng-template",null,3,H),h(13,21),s(14,"a",22),O(15,4),d(),p(16,$n,4,2,"ng-template",23),A(),p(17,Wn,4,0,"ng-container",24)(18,Xn,4,0,"ng-container",24),d(),p(19,jn,1,1,"div",25),s(20,"div",26)(21,"div",27)(22,"input",28),J("ngModelChange",function(C){return u(c),Y(o.downloadType,C)||(o.downloadType=C),g(C);}),d(),s(23,"label",29),O(24,5),d()(),s(25,"div",27)(26,"input",30),J("ngModelChange",function(C){return u(c),Y(o.downloadType,C)||(o.downloadType=C),g(C);}),d(),s(27,"label",31),O(28,6),d()()()(),s(29,"button",32),S("click",function(){return u(c),g(o.isAdvancedCustomizationCollapsed=!o.isAdvancedCustomizationCollapsed);}),p(30,Qn,3,0)(31,Kn,3,0),d(),s(32,"div",33),Ie(33),s(34,"input",34),S("click",function(){return u(c),g(o.download());}),d()();}if(n&2){let c,m=w(2);l("ngIf",o.isConfidentialVideo()),a(),l("activeId",o.activeResolutionId),a(4),l("ngIf",o.originalVideoFile()),a(),l("ngForOf",o.getVideoFiles()),a(),l("ngbNavOutlet",m),a(),l("ngbCollapse",o.isAdvancedCustomizationCollapsed)("animation",!0),a(9),l("ngIf",o.videoFileMetadataVideoStream!==void 0),a(),l("ngIf",o.videoFileMetadataAudioStream!==void 0),a(),l("ngIf",o.hasMetadata()),a(),l("hidden",o.originalVideoFile()||!((c=o.getVideoFile())!=null&&c.torrentDownloadUrl)),a(2),q("ngModel",o.downloadType),a(4),q("ngModel",o.downloadType),a(3),Xe("aria-expanded",!o.isAdvancedCustomizationCollapsed),a(),k(o.isAdvancedCustomizationCollapsed?30:31);}},dependencies:[x,U,Q,Qe,z,we,$,te,nt,Je,et,Ze,Jt,tt,it,at,Xt,Vt,Ve,be,ri],styles:[`.advanced-filters-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:20px;font-weight:600;cursor:pointer}.advanced-filters-button[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{margin-top:10x}.nav-metadata[_ngcontent-%COMP%]{margin-top:20px}.file-metadata[_ngcontent-%COMP%]{padding:1rem}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]{font-size:13px;display:block;margin-bottom:12px}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:first-child{min-width:142px;display:inline-block;color:var(--fg-300);font-weight:700;padding-inline-end:.3125rem}.download-type[_ngcontent-%COMP%]{margin-top:20px}.download-type[_ngcontent-%COMP%]   .peertube-radio-container[_ngcontent-%COMP%]{display:inline-block;margin-inline-end:calc(1.3125rem + .75vw)}@media (min-width: 1200px){.download-type[_ngcontent-%COMP%]   .peertube-radio-container[_ngcontent-%COMP%]{margin-inline-end:1.875rem}}
/*# sourceMappingURL=video-files-download.component-NUXQHABS.css.map */`]}));let e=r;return e;})();var qn=[[["cancel-button"]]],Yn=["cancel-button"],Jn=(e,r)=>r.id;function Zn(e,r){if(e&1){let i=M();s(0,"div",4)(1,"input",8),J("ngModelChange",function(n){u(i);let o=_();return Y(o.videoFileChosen,n)||(o.videoFileChosen=n),g(n);}),d(),s(2,"label",9)(3,"strong"),O(4,0),d(),s(5,"span",10),R(6),ee(7,"bytes"),d(),v(8,"my-global-icon",11),d()();}if(e&2){let i=_();a(),q("ngModel",i.videoFileChosen),a(5),It("",ct(7,4,i.originalVideoFile().size,1)," | ",i.originalVideoFile().width,"x",i.originalVideoFile().height,"");}}function eo(e,r){if(e&1&&R(0),e&2){let i=_().$implicit;Pt(" | ",i.width,"x",i.height," ");}}function to(e,r){if(e&1&&(R(0," | "),h(1),O(2,1),A()),e&2){let i=_().$implicit;a(2),P(i.fps),I(2);}}function io(e,r){if(e&1){let i=M();s(0,"div",4)(1,"input",12),J("ngModelChange",function(n){u(i);let o=_();return Y(o.videoFileChosen,n)||(o.videoFileChosen=n),g(n);}),d(),s(2,"label",13)(3,"strong"),R(4),d(),s(5,"span",10),R(6),ee(7,"bytes"),p(8,eo,1,2)(9,to,3,1),d()()();}if(e&2){let i=r.$implicit,t=_();a(),l("id","file-"+i.id),q("ngModel",t.videoFileChosen),l("value","file-"+i.id),a(),l("for","file-"+i.id),a(2),Z(t.getLabel(i)),a(2),b(" ",ct(7,8,t.getFileSize(i),1)," "),a(2),k(i.width?8:-1),a(),k(i.fps&&i.fps>=50?9:-1);}}function no(e,r){if(e&1){let i=M();s(0,"div",2)(1,"my-peertube-checkbox",14),J("ngModelChange",function(n){u(i);let o=_();return Y(o.includeAudio,n)||(o.includeAudio=n),g(n);}),d()();}if(e&2){let i=_();a(),q("ngModel",i.includeAudio);}}var Ti=(()=>{let r=class r{videoService=f(re);video=E.required();originalVideoFile=E(void 0);videoFileToken=E(void 0);downloaded=y();includeAudio=!0;videoFileChosen="";videoFiles;ngOnInit(){this.videoFiles=this.buildVideoFiles(),this.videoFiles.length!==0&&(this.videoFileChosen="file-"+zt(this.videoFiles,"resolution").id);}getLabel(t){return Bt(t.resolution.label,t.fps);}getFileSize(t){if(t.hasAudio&&t.hasVideo||t.hasAudio)return t.size;if(this.includeAudio){let n=this.findAudioFileOnly();return t.size+(n?.size||0);}return t.size;}hasAudioSplitted(){return this.videoFileChosen==="file-original"?!1:this.findCurrentFile().hasAudio===!1&&this.videoFiles.some(t=>t.hasVideo===!1&&t.hasAudio===!0);}download(){window.location.assign(this.getVideoFileLink()),this.downloaded.emit();}getVideoFileLink(){let t=this.videoFileChosen==="file-original"||this.isConfidentialVideo()?"?videoFileToken="+this.videoFileToken():"";if(this.videoFileChosen==="file-original")return this.originalVideoFile().fileDownloadUrl+t;let n=this.findCurrentFile();if(!n)return"";let o=[n];return this.hasAudioSplitted()&&this.includeAudio&&o.push(this.findAudioFileOnly()),this.videoService.generateDownloadUrl({video:this.video(),videoFileToken:this.videoFileToken(),files:o});}isConfidentialVideo(){return this.videoFileChosen==="file-original"||$e(this.video());}buildVideoFiles(){let t=this.video();if(!t)return[];let n=t.getHlsPlaylist();return n?n.files:t.files;}findCurrentFile(){return this.videoFiles.find(t=>this.videoFileChosen==="file-"+t.id);}findAudioFileOnly(){return this.videoFiles.find(t=>t.resolution.id===Gt.H_NOVIDEO);}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-generate-download"]],inputs:{video:[1,"video"],originalVideoFile:[1,"originalVideoFile"],videoFileToken:[1,"videoFileToken"]},outputs:{downloaded:"downloaded"},ngContentSelectors:Yn,decls:8,vars:2,consts:()=>{let t;t="Descargar";let n;n="Otros usuarios no pueden descargar el archivo original";let o;o="Archivo original";let c;c=""+"\uFFFD0\uFFFD"+"fps";let m;return m="Incluir audio",[o,c,[1,"form-group"],["class","peertube-radio-container",4,"ngIf"],[1,"peertube-radio-container"],["class","form-group",4,"ngIf"],[1,"modal-footer","inputs"],["type","submit","value",t,1,"peertube-button","primary-button",3,"click"],["type","radio","name","video-file","id","original-file","value","file-original",3,"ngModelChange","ngModel"],["for","original-file"],[1,"muted"],["ngbTooltip",n,"iconName","shield"],["type","radio","name","video-file",3,"ngModelChange","id","ngModel","value"],[3,"for"],["inputName","includeAudio","labelText",m,3,"ngModelChange","ngModel"]];},template:function(n,o){n&1&&(Pe(qn),s(0,"div",2),p(1,Zn,9,7,"div",3),Ne(2,io,10,11,"div",4,Jn),d(),p(4,no,2,1,"div",5),s(5,"div",6),Ie(6),s(7,"input",7),S("click",function(){return o.download();}),d()()),n&2&&(a(),l("ngIf",o.originalVideoFile()),a(),ye(o.videoFiles),a(2),l("ngIf",o.hasAudioSplitted()));},dependencies:[x,U,Q,Qe,z,we,$,oe,Ve,lt],styles:[`.peertube-radio-container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:inline-block;min-width:80px;margin-inline-end:.5rem}
/*# sourceMappingURL=video-generate-download.component-HZOYCSFG.css.map */`]}));let e=r;return e;})();var oo=["modal"],ro=e=>({"opacity-0":e});function ao(e,r){e&1&&(s(0,"option",19),O(1,5),d());}function lo(e,r){if(e&1){let i=M();s(0,"input",20),S("click",function(){u(i);let n=_().close;return g(n());})("key.enter",function(){u(i);let n=_().close;return g(n());}),d();}}function so(e,r){}function _o(e,r){if(e&1){let i=M();s(0,"my-video-generate-download",21),S("downloaded",function(){u(i);let n=_(2);return g(n.onDownloaded());}),h(1,22),p(2,so,0,0,"ng-template",23),A(),d();}if(e&2){_();let i=w(15),t=_();l("video",t.video)("originalVideoFile",t.originalVideoFile)("videoFileToken",t.videoFileToken),a(2),l("ngTemplateOutlet",i);}}function co(e,r){}function po(e,r){if(e&1){let i=M();s(0,"my-video-files-download",21),S("downloaded",function(){u(i);let n=_(2);return g(n.onDownloaded());}),h(1,22),p(2,co,0,0,"ng-template",23),A(),d();}if(e&2){_();let i=w(15),t=_();l("video",t.video)("originalVideoFile",t.originalVideoFile)("videoFileToken",t.videoFileToken),a(2),l("ngTemplateOutlet",i);}}function mo(e,r){}function uo(e,r){if(e&1){let i=M();s(0,"my-subtitle-files-download",24),S("downloaded",function(){u(i);let n=_(2);return g(n.onDownloaded());}),h(1,22),p(2,mo,0,0,"ng-template",23),A(),d();}if(e&2){_();let i=w(15),t=_();l("videoCaptions",t.getCaptions()),a(2),l("ngTemplateOutlet",i);}}function go(e,r){if(e&1){let i=M();s(0,"div",6)(1,"div",7)(2,"h4",8),O(3,2),d(),s(4,"div",9)(5,"select",10),J("ngModelChange",function(n){u(i);let o=_();return Y(o.type,n)||(o.type=n),g(n);}),s(6,"option",11),O(7,3),d(),s(8,"option",12),O(9,4),d(),p(10,ao,2,0,"option",13),d()()(),s(11,"button",14),S("click",function(){let n=u(i).close;return g(n());}),v(12,"my-global-icon",15),d()(),s(13,"div",16),p(14,lo,1,0,"ng-template",null,1,H)(16,_o,3,4,"my-video-generate-download",17)(17,po,3,4,"my-video-files-download",17)(18,uo,3,2,"my-subtitle-files-download",18),d();}if(e&2){let i,t=_();a(5),q("ngModel",t.type),a(5),l("ngIf",t.hasCaptions()),a(3),l("ngClass",F(4,ro,!t.loaded)),a(3),k((i=t.type)==="video-generate"?16:i==="video-files"?17:i==="subtitle-files"?18:-1);}}var Ri=(()=>{let r=class r{modalService=f(ie);authService=f(Se);videoService=f(re);videoFileTokenService=f(fi);hooks=f(ti);modal=V("modal");videoPassword=E(void 0);video;type="video-generate";videoFileToken;originalVideoFile;loaded=!1;videoCaptions;activeModal;getCaptions(){return this.videoCaptions?this.videoCaptions:[];}show(t,n){this.loaded=!1,this.videoFileToken=void 0,this.originalVideoFile=void 0,this.video=t,this.videoCaptions=n,this.activeModal=this.modalService.open(this.modal(),{centered:!0}),this.getOriginalVideoFileObs().subscribe(o=>{o?.fileDownloadUrl&&(this.originalVideoFile=o),this.originalVideoFile||$e(this.video)?this.videoFileTokenService.getVideoFileToken({videoUUID:this.video.uuid,videoPassword:this.videoPassword()}).subscribe(({token:c})=>{this.videoFileToken=c,this.loaded=!0;}):this.loaded=!0;}),this.activeModal.shown.subscribe(()=>{this.hooks.runAction("action:modal.video-download.shown","common");});}getOriginalVideoFileObs(){if(!this.video.isLocal||!this.authService.isLoggedIn())return Me(void 0);let t=this.authService.getUser();return this.video.isOwnerOrHasSeeAllVideosRight(t)?this.videoService.getSource(this.video.id).pipe(St(n=>(console.error("Cannot get source file",n),Me(void 0)))):Me(void 0);}onDownloaded(){this.activeModal.close();}hasCaptions(){return this.getCaptions().length!==0;}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-download"]],viewQuery:function(n,o){n&1&&L(o.modal,oo,5),n&2&&W();},inputs:{videoPassword:[1,"videoPassword"]},decls:2,vars:0,consts:()=>{let t;t="Cerrar esta ventana";let n;n="Descargar";let o;o="V\xEDdeo";let c;c="Archivos de video";let m;m="Archivos de subt\xEDtulos";let C;return C="Cancelar",[["modal",""],["cancelBlock",""],n,o,c,m,[1,"modal-header"],[1,"d-flex","align-items-center","me-auto"],[1,"modal-title"],[1,"peertube-select-container","title-select","ms-2"],["id","type","name","type",1,"form-control",3,"ngModelChange","ngModel"],["value","video-generate"],["value","video-files"],["value","subtitle-files",4,"ngIf"],["title",t,1,"border-0","p-0","align-self-start",3,"click"],["iconName","cross"],[1,"modal-body",3,"ngClass"],[3,"video","originalVideoFile","videoFileToken"],[3,"videoCaptions"],["value","subtitle-files"],["type","button","role","button","value",C,1,"peertube-button","secondary-button",3,"click","key.enter"],[3,"downloaded","video","originalVideoFile","videoFileToken"],["ngProjectAs","cancel-button",5,["cancel-button"]],[3,"ngTemplateOutlet"],[3,"downloaded","videoCaptions"]];},template:function(n,o){n&1&&p(0,go,19,6,"ng-template",null,0,H);},dependencies:[hi,Ai,Ti,$,x,U,kt,Ht,$t,z,we,j,be],styles:[`.modal-body[_ngcontent-%COMP%]     .nav-content{margin-top:30px}.modal-body[_ngcontent-%COMP%]     my-global-icon[iconName=shield]{position:relative;top:-1px;display:inline-block;width:16px;height:16px;line-height:16px;margin-inline-start:.625rem}.modal-body[_ngcontent-%COMP%]     .modal-footer{padding-inline-end:0;margin-top:1rem}.modal-body[_ngcontent-%COMP%]     .modal-footer>*:last-child{margin-inline-end:0}.peertube-select-container.title-select[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container.title-select[_ngcontent-%COMP%]{width:100%}}.peertube-select-container.title-select[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container.title-select[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container.title-select[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container.title-select[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container.title-select[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}#dropdown-download-type[_ngcontent-%COMP%]{cursor:pointer}
/*# sourceMappingURL=video-download.component-AFNJXMRR.css.map */`]}));let e=r;return e;})();var fo=["playlistDropdown"],vo=["playlistAdd"],Co=["videoDownloadModal"],Oo=["videoReportModal"],Eo=["videoBlockModal"],So=()=>[import("./chunk-EU3L332R.js").then(e=>e.VideoAddToPlaylistComponent)],ho=e=>({video:e});function Ao(e,r){if(e&1){let i=M();s(0,"my-video-add-to-playlist",13,4),S("videoExistsInPlaylistChange",function(){u(i);let n=_(3);return g(n.videoExistsInPlaylistChange.emit());}),d();}if(e&2){let i=_(3);l("video",i.video());}}function To(e,r){if(e&1&&(s(0,"div",10,3),v(2,"span",11),s(3,"div",12),p(4,Ao,2,1),Nt(5,4,So),d()()),e&2){let i=_(2);l("placement",i.getPlaylistDropdownPlacement()),a(5),yt(i.dropdownOpened);}}function Ro(e,r){if(e&1){let i=M();h(0),p(1,To,7,2,"div",6),s(2,"my-action-dropdown",7),S("openChange",function(){u(i);let n=_();return g(n.dropdownOpened=!0);}),d(),v(3,"my-video-download",null,0)(5,"my-video-report",8,1),s(7,"my-video-block",9,2),S("videoBlocked",function(){u(i);let n=_();return g(n.onVideoBlocked());}),d(),A();}if(e&2){let i=_();a(),l("ngIf",i.isUserLoggedIn()&&i.displayOptions().playlist),a(),l("actions",i.videoActions)("label",i.label())("entry",F(9,ho,i.video()))("buttonSize",i.buttonSize())("placement",i.placement())("buttonDirection",i.buttonDirection())("buttonStyled",i.buttonStyled()),a(3),l("video",i.video());}}var Mi=(()=>{let r=class r{authService=f(Se);notifier=f(ne);confirmService=f(ei);blocklistService=f(mi);videoBlocklistService=f(dt);screenService=f(rt);videoService=f(re);videoCaptionService=f(ci);redundancyService=f(pi);serverService=f(ke);playlistDropdown=V("playlistDropdown");playlistAdd=V("playlistAdd");videoDownloadModal=V("videoDownloadModal");videoReportModal=V("videoReportModal");videoBlockModal=V("videoBlockModal");video=E(void 0);videoCaptions=E([]);displayOptions=E({playlist:!1,download:!0,update:!0,blacklist:!0,delete:!0,report:!0,duplicate:!0,mute:!0,liveInfo:!1,removeFiles:!1,transcoding:!1,generateTranscription:!1,transcriptionWidget:!1});placement=E("auto");moreActions=E([]);actionAvailabilityHint=E(!1,{transform:Te});label=E(void 0);buttonStyled=E(!1,{transform:Te});buttonSize=E("normal");buttonDirection=E("vertical");transcriptionWidgetOpened=E(void 0);videoFilesRemoved=y();videoRemoved=y();videoUnblocked=y();videoBlocked=y();videoAccountMuted=y();transcodingCreated=y();modalOpened=y();videoExistsInPlaylistChange=y();showTranscriptionWidget=y();hideTranscriptionWidget=y();videoActions=[];dropdownOpened=!1;hasMutedAccount=!1;get user(){return this.authService.getUser();}ngOnChanges(){let t=this.playlistAdd();t&&t.reload(),this.buildActions();}isUserLoggedIn(){return this.authService.isLoggedIn();}showDownloadModal(){this.modalOpened.emit();let t=this.video();(t instanceof gt?Me(t):this.videoService.getVideo({videoId:t.uuid})).subscribe(o=>{this.videoDownloadModal().show(o,this.videoCaptions());});}showReportModal(){this.modalOpened.emit(),this.videoReportModal().show();}showBlockModal(){this.modalOpened.emit(),this.videoBlockModal().show([this.video()]);}isVideoUpdatable(){return this.user?this.video().isUpdatableBy(this.user):!1;}isVideoEditable(){return this.user?this.video().isEditableBy(this.user,this.serverService.getHTMLConfig().videoStudio.enabled):!1;}isVideoStatsAvailable(){if(!this.user)return!1;let t=this.video();return t.isLocal&&t.isOwnerOrHasSeeAllVideosRight(this.user);}isVideoRemovable(){return this.user?this.video().isRemovableBy(this.user):!1;}isVideoBlockable(){return this.user?this.video().isBlockableBy(this.user):!1;}isVideoUnblockable(){return this.user?this.video().isUnblockableBy(this.user):!1;}isVideoLiveInfoAvailable(){return this.user?this.video().isLiveInfoAvailableBy(this.user):!1;}canGenerateTranscription(){return this.user?this.video().canGenerateTranscription(this.user,this.serverService.getHTMLConfig().videoTranscription.enabled):!1;}isVideoDownloadableByAnonymous(){let t=this.video();return t&&t.isLive!==!0&&t instanceof gt&&t.downloadEnabled;}isVideoDownloadableByUser(){if(!this.user)return!1;let t=this.video();return t&&t.isLive!==!0&&t.isOwnerOrHasSeeAllVideosRight(this.user);}canVideoBeDuplicated(){if(!this.user)return!1;let t=this.video();return!t.isLive&&t.canBeDuplicatedBy(this.user);}isVideoAccountMutable(){return this.user?this.video().account.id!==this.user.account.id:!1;}canRemoveVideoFiles(){return this.user?this.video().canRemoveAllHLSOrWebFiles(this.user):!1;}canRunTranscoding(){return this.user?this.video().canRunTranscoding(this.user):!1;}unblockVideo(){return Re(this,null,function*(){let t="\xBFDe verdad quieres desbloquear "+this.video().name+"?Estar\xE1 disponible nuevamente en la lista de videos.";(yield this.confirmService.confirm(t,"Desbloqu\xE9a"+this.video().name+""))!==!1&&this.videoBlocklistService.unblockVideo(this.video().id).subscribe({next:()=>{let o=this.video();this.notifier.success("Video "+o.name+" desbloqueado."),o.blacklisted=!1,o.blacklistedReason=null,this.videoUnblocked.emit();},error:o=>this.notifier.error(o.message)});});}removeVideo(){return Re(this,null,function*(){this.modalOpened.emit();let t="\xBFDe verdad quieres eliminar\n          "+this.video().name+"?\n        ",n=this.video();n.isLive&&(t+=" "+"La transmisi\xF3n en vivo finalizar\xE1 autom\xE1ticamente y las repeticiones no se guardar\xE1n."),(yield this.confirmService.confirm(t,"Suprimir "+n.name+""))!==!1&&this.videoService.removeVideo(n.id).subscribe({next:()=>{this.notifier.success("V\xEDdeo "+this.video().name+" eliminado."),this.videoRemoved.emit();},error:c=>this.notifier.error(c.message)});});}duplicateVideo(){this.redundancyService.addVideoRedundancy(this.video()).subscribe({next:()=>{let t=""+this.video().name+" ser\xE1 duplicado por tu plataforma.";this.notifier.success(t);},error:t=>this.notifier.error(t.message)});}muteVideoAccount(){let t={nameWithHost:ut.CREATE_BY_STRING(this.video().account.name,this.video().account.host)};this.blocklistService.blockAccountByUser(t).subscribe({next:()=>{this.notifier.success("Cuenta "+t.nameWithHost+" silenciada."),this.hasMutedAccount=!0,this.videoAccountMuted.emit();},error:n=>this.notifier.error(n.message)});}unmuteVideoAccount(){let t={nameWithHost:ut.CREATE_BY_STRING(this.video().account.name,this.video().account.host)};this.blocklistService.unblockAccountByUser(t).subscribe({next:()=>{this.hasMutedAccount=!1,this.notifier.success("La cuenta "+t.nameWithHost+" ya no est\xE1 silenciada.");},error:n=>this.notifier.error(n.message)});}removeVideoFiles(t,n){return Re(this,null,function*(){let o="\xBFRealmente desea eliminar el archivo "+this.video().name+"?";(yield this.confirmService.confirm(o,"Eliminar el archivo\""+this.video().name+"\""))!==!1&&this.videoService.removeVideoFiles([t.id],n).subscribe({next:()=>{this.notifier.success("Archivos eliminados de "+t.name+"."),this.videoFilesRemoved.emit();},error:m=>this.notifier.error(m.message)});});}runTranscoding(t,n){this.videoService.runTranscoding({videos:[t],type:n}).subscribe({next:()=>{this.notifier.success("Trabajo de transcodificaci\xF3n creado para \""+t.name+"\"."),this.transcodingCreated.emit();},error:o=>this.notifier.error(o.message)});}generateCaption(t){this.videoCaptionService.generateCaption({videos:[t]}).subscribe({next:n=>{n.success?this.notifier.success("Trabajo de transcripci\xF3n creado para \""+t.name+"\"."):n.alreadyBeingTranscribed?this.notifier.info("Este video ya est\xE1 siendo transcrito."):n.alreadyHasCaptions&&this.notifier.info("Este video ya tiene subt\xEDtulos.");},error:n=>this.notifier.error(n.message)});}onVideoBlocked(){this.videoBlocked.emit();}getPlaylistDropdownPlacement(){return this.screenService.isInSmallView()?"bottom-right auto":"bottom-left bottom-right auto";}buildActions(){this.videoActions=[[{label:"Guardar en lista de reproducci\xF3n",handler:()=>this.playlistDropdown().toggle(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().playlist,iconName:"playlist-add"}],[{label:"Descargar",handler:()=>this.showDownloadModal(),isDisplayed:()=>this.displayOptions().download?this.isVideoDownloadableByAnonymous()||this.isVideoDownloadableByUser():!1,iconName:"download",ownerOrModeratorPrivilege:()=>{if(this.actionAvailabilityHint()&&!this.isVideoDownloadableByAnonymous())return"Esta opci\xF3n es solo visible para ti";}},{label:"Mostrar transcripci\xF3n",handler:()=>this.showTranscriptionWidget.emit(),isDisplayed:()=>{if(!this.displayOptions().transcriptionWidget||this.transcriptionWidgetOpened())return!1;let t=this.videoCaptions();return Array.isArray(t)&&t.length!==0;},iconName:"video-lang"},{label:"Ocultar transcripci\xF3n",handler:()=>this.hideTranscriptionWidget.emit(),isDisplayed:()=>this.displayOptions().transcriptionWidget?this.transcriptionWidgetOpened()===!0:!1,iconName:"video-lang"}],[{label:"Informaci\xF3n en vivo",linkBuilder:({video:t})=>["/videos/manage",t.shortUUID,"live-settings"],isDisplayed:()=>this.displayOptions().liveInfo&&this.isVideoLiveInfoAvailable(),iconName:"live"},{label:"Gestionar",linkBuilder:({video:t})=>["/videos/manage",t.shortUUID],iconName:"film",isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().update&&this.isVideoUpdatable()},{label:"Bloquear",handler:()=>this.showBlockModal(),iconName:"no",isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().blacklist&&this.isVideoBlockable()},{label:"Desbloquear",handler:()=>this.unblockVideo(),iconName:"undo",isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().blacklist&&this.isVideoUnblockable()},{label:"Espejo",handler:()=>this.duplicateVideo(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().duplicate&&this.canVideoBeDuplicated(),iconName:"cloud-download"},{label:"Eliminar",handler:()=>this.removeVideo(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().delete&&this.isVideoRemovable(),iconName:"delete"},{label:"Reportar",handler:()=>this.showReportModal(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().report,iconName:"flag"}],[{label:"Ejecute la transcodificaci\xF3n HLS",handler:({video:t})=>this.runTranscoding(t,"hls"),isDisplayed:()=>this.displayOptions().transcoding&&this.canRunTranscoding(),iconName:"cog"},{label:"Ejecutar transcodificaci\xF3n de v\xEDdeo web",handler:({video:t})=>this.runTranscoding(t,"web-video"),isDisplayed:()=>this.displayOptions().transcoding&&this.canRunTranscoding(),iconName:"cog"},{label:"Eliminar archivos HLS",handler:({video:t})=>this.removeVideoFiles(t,"hls"),isDisplayed:()=>this.displayOptions().removeFiles&&this.canRemoveVideoFiles(),iconName:"delete"},{label:"Borrar archivos de v\xEDdeo web",handler:({video:t})=>this.removeVideoFiles(t,"web-videos"),isDisplayed:()=>this.displayOptions().removeFiles&&this.canRemoveVideoFiles(),iconName:"delete"}],[{label:"Generate caption",handler:({video:t})=>this.generateCaption(t),isDisplayed:()=>this.displayOptions().generateTranscription&&this.canGenerateTranscription(),iconName:"video-lang"}],[{label:"Silenciar cuenta",handler:()=>this.muteVideoAccount(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().mute&&this.isVideoAccountMutable(),iconName:"no"},{label:"Cuenta de-silenciada",handler:()=>this.unmuteVideoAccount(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions().mute&&this.isVideoAccountMutable()&&this.hasMutedAccount,iconName:"undo"}]],this.videoActions=this.videoActions.concat(this.moreActions());}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-actions-dropdown"]],viewQuery:function(n,o){n&1&&(L(o.playlistDropdown,fo,5),L(o.playlistAdd,vo,5),L(o.videoDownloadModal,Co,5),L(o.videoReportModal,Oo,5),L(o.videoBlockModal,Eo,5)),n&2&&W(5);},inputs:{video:[1,"video"],videoCaptions:[1,"videoCaptions"],displayOptions:[1,"displayOptions"],placement:[1,"placement"],moreActions:[1,"moreActions"],actionAvailabilityHint:[1,"actionAvailabilityHint"],label:[1,"label"],buttonStyled:[1,"buttonStyled"],buttonSize:[1,"buttonSize"],buttonDirection:[1,"buttonDirection"],transcriptionWidgetOpened:[1,"transcriptionWidgetOpened"]},outputs:{videoFilesRemoved:"videoFilesRemoved",videoRemoved:"videoRemoved",videoUnblocked:"videoUnblocked",videoBlocked:"videoBlocked",videoAccountMuted:"videoAccountMuted",transcodingCreated:"transcodingCreated",modalOpened:"modalOpened",videoExistsInPlaylistChange:"videoExistsInPlaylistChange",showTranscriptionWidget:"showTranscriptionWidget",hideTranscriptionWidget:"hideTranscriptionWidget"},features:[De],decls:1,vars:1,consts:()=>{let t;return t="Abrir acciones de video",[["videoDownloadModal",""],["videoReportModal",""],["videoBlockModal",""],["playlistDropdown","ngbDropdown"],["playlistAdd",""],[4,"ngIf"],["role","button","aria-label",t,"class","playlist-dropdown","ngbDropdown","","autoClose","outside","container","body",3,"placement",4,"ngIf"],["container","body",3,"openChange","actions","label","entry","buttonSize","placement","buttonDirection","buttonStyled"],[3,"video"],[3,"videoBlocked"],["role","button","aria-label",t,"ngbDropdown","","autoClose","outside","container","body",1,"playlist-dropdown",3,"placement"],["ngbDropdownAnchor","",1,"anchor"],["ngbDropdownMenu",""],[3,"videoExistsInPlaylistChange","video"]];},template:function(n,o){n&1&&p(0,Ro,9,11,"ng-container",5),n&2&&l("ngIf",o.videoActions.length!==0);},dependencies:[x,Ye,jt,qe,_i,Ri,Oi,Si],styles:[`[_nghost-%COMP%]{position:relative}.playlist-dropdown[_ngcontent-%COMP%]{position:absolute}.playlist-dropdown[_ngcontent-%COMP%]   .anchor[_ngcontent-%COMP%]{display:block;opacity:0}[_nghost-%COMP%]     .icon-playlist-add{left:2px}
/*# sourceMappingURL=video-actions-dropdown.component-4VRGYK5L.css.map */`]}));let e=r;return e;})();var Mo=["dropdown"],Do=(e,r)=>({host:e,searchTarget:r}),Di=(()=>{let r=class r{auth=f(Se);server=f(ke);dropdown=V("dropdown");host=E.required();title;searchTarget;ngOnChanges(){this.title="Obtener m\xE1s informaci\xF3n de "+this.host()+"";let t=this.server.getHTMLConfig(),n=this.auth.isLoggedIn()?t.search.remoteUri.users:t.search.remoteUri.anonymous;this.searchTarget=n?"search-index":"local";}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-actor-host"]],viewQuery:function(n,o){n&1&&L(o.dropdown,Mo,5),n&2&&W();},inputs:{host:[1,"host"]},features:[De],decls:21,vars:9,consts:()=>{let t;t="\xBFQu\xE9 es esto?";let n;n="Mostrar todas nuestras suscripciones";let o;return o="M\xE1s contenido de "+"\uFFFD0\uFFFD"+"",[["dropdown","ngbDropdown"],t,n,o,["ngbDropdown","","autoClose","outside","placement","bottom-end auto","container","body"],["ngbDropdownToggle","","type","button",1,"host","button-unstyle","ellipsis",3,"title"],["width","8","height","19","viewBox","0 0 8 19","fill","none","xmlns","http://www.w3.org/2000/svg",1,"left"],["d","M0 19V0L7.45757 8.85586C7.77102 9.22809 7.77102 9.77191 7.45757 10.1441L0 19Z"],["width","9","height","19","viewBox","0 0 9 19","xmlns","http://www.w3.org/2000/svg",1,"right"],["d","m 8.0900763,0 h -7.08835 C 0.19446632,0 -0.28009268,0.907181 0.18029632,1.5703 L 5.4485063,9.15841 c 0.24316,0.35023 0.23751,0.81611 -0.01406,1.16039 L 0.25209632,17.41 c -0.482855,0.6607 -0.01097,1.59 0.80737998,1.59 h 7.0306 z"],["ngbDropdownMenu","",1,"content"],[1,"question","mb-3"],[1,"answer","mb-3"],["target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["routerLink","/about/follows",1,"mt-3","mb-3","d-block","peertube-button-link","secondary-button",3,"click"],["theme","primary","ptRouterLink","/search",1,"d-block",3,"click","ptQueryParams"]];},template:function(n,o){if(n&1){let c=M();s(0,"div",4,0)(2,"button",5),Tt(),s(3,"svg",6),v(4,"path",7),d(),R(5),s(6,"svg",8),v(7,"path",9),d()(),Rt(),s(8,"div",10)(9,"strong",11),O(10,1),d(),s(11,"div",12),R(12," This video comes from "),s(13,"a",13),R(14),v(15,"my-global-icon",14),d(),R(16," platform, to which we have subscribed. "),d(),s(17,"a",15),S("click",function(){u(c);let C=w(1);return g(C.close());}),O(18,2),d(),s(19,"my-button",16),S("click",function(){u(c);let C=w(1);return g(C.close());}),O(20,3),d()()();}n&2&&(a(2),l("title",o.title),a(3),b(" ",o.host()," "),a(8),l("href","https://"+o.host(),Mt),a(),b("",o.host()," "),a(5),l("ptQueryParams",bt(6,Do,o.host(),o.searchTarget)),a(),P(o.host()),I(20));},dependencies:[je,Kt,Ye,Qt,qe,$,oi,Lt],styles:[`.content[_ngcontent-%COMP%]{background-color:var(--bg-secondary-450);border-radius:14px;max-width:400px;border:0;padding-inline-start:calc(1.275rem + .3vw);padding-inline-end:calc(1.275rem + .3vw);padding-top:calc(1.275rem + .3vw);padding-bottom:calc(1.275rem + .3vw)}@media (min-width: 1200px){.content[_ngcontent-%COMP%]{padding-inline-start:1.5rem}}@media (min-width: 1200px){.content[_ngcontent-%COMP%]{padding-inline-end:1.5rem}}@media (min-width: 1200px){.content[_ngcontent-%COMP%]{padding-top:1.5rem}}@media (min-width: 1200px){.content[_ngcontent-%COMP%]{padding-bottom:1.5rem}}.question[_ngcontent-%COMP%]{color:var(--fg-350);font-weight:700;font-size:1.25rem}.secondary-button[_ngcontent-%COMP%]{border-color:var(--secondary-icon-color)!important}.answer[_ngcontent-%COMP%]{color:var(--fg-300)}.answer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--fg-400);font-weight:700;text-decoration:underline}.answer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{color:var(--fg-400);top:0}.host[_ngcontent-%COMP%]{position:relative;max-width:100%}.host[_ngcontent-%COMP%]:hover{opacity:.8}.host[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--bg);z-index:2;width:auto;height:calc(100% + 2px);top:-1px;position:absolute}.host[_ngcontent-%COMP%]   svg.left[_ngcontent-%COMP%]{left:-2px}.host[_ngcontent-%COMP%]   svg.right[_ngcontent-%COMP%]{right:-2px}.host[_ngcontent-%COMP%]{color:var(--fg-450);font-weight:700;background:linear-gradient(to right,var(--bg-secondary-400),var(--bg-secondary-500));position:relative;padding:4px 12px;font-size:.625rem}.host[_ngcontent-%COMP%]:after{display:none}
/*# sourceMappingURL=actor-host.component-PXN4NB5U.css.map */`]}));let e=r;return e;})();var Ni=e=>["/c",e];function No(e,r){e&1&&(h(0,19),O(1,1),A());}function yo(e,r){e&1&&(h(0,20),O(1,2),A());}function Po(e,r){e&1&&(h(0,20),O(1,3),A());}function Io(e,r){if(e&1&&(s(0,"button",22),v(1,"my-global-icon",23),d()),e&2){let i=_(2);l("ngbTooltip",i.nsfwTooltip),Xe("aria-label",i.nsfwTooltip);}}function bo(e,r){if(e&1&&p(0,Io,2,2,"button",21),e&2){let i=_();l("ngIf",i.hasNSFWWarning());}}function wo(e,r){if(e&1&&v(0,"my-actor-avatar",26),e&2){let i=_(3);l("title",i.channelLinkTitle)("size",i.actorImageSize())("actor",i.video().channel)("internalHref",F(4,Ni,i.video().byVideoChannel));}}function xo(e,r){if(e&1&&v(0,"my-actor-avatar",27),e&2){let i=_(3);l("title",i.channelLinkTitle)("size",i.actorImageSize())("actor",i.video().account)("internalHref",F(4,Ni,i.video().byVideoChannel));}}function Fo(e,r){if(e&1&&p(0,wo,1,6,"my-actor-avatar",26)(1,xo,1,6,"my-actor-avatar",27),e&2){let i=_(2);k(i.displayOwnerVideoChannel()?0:i.displayOwnerAccount()?1:-1);}}function Vo(e,r){if(e&1&&R(0),e&2){let i=_(3);b(" ",i.authorAccount," ");}}function Lo(e,r){if(e&1&&R(0),e&2){let i=_(3);b(" ",i.authorChannel," ");}}function $o(e,r){if(e&1&&v(0,"my-actor-host",31),e&2){let i=_(3);l("host",i.video().account.host);}}function ko(e,r){e&1&&le(0);}function Ho(e,r){if(e&1&&p(0,ko,1,0,"ng-container",32),e&2){_(3);let i=w(6);l("ngTemplateOutlet",i);}}function Go(e,r){if(e&1&&(s(0,"div",28)(1,"my-link",29),p(2,Vo,1,1)(3,Lo,1,1),d(),p(4,$o,1,1,"my-actor-host",30)(5,Ho,1,1,"ng-container"),d()),e&2){let i=_(2);a(),l("internalLink",i.ownerRouterLink)("href",i.ownerHref)("target",i.ownerTarget)("ariaLabel",i.getAriaLabel())("title",i.displayOwnerAccount()?i.authorAccount:i.authorChannel),a(),k(i.displayOwnerAccount()?2:i.displayOwnerVideoChannel()?3:-1),a(2),l("ngIf",!i.video().isLocal),a(),k(i.displayAsRow()?-1:5);}}function Wo(e,r){if(e&1&&(s(0,"div",24),p(1,Fo,2,1)(2,Go,6,8,"div",25),d()),e&2){let i=_();a(),k(i.displayOptions().avatar?1:-1),a(),l("ngIf",i.displayOptions().by);}}function zo(e,r){if(e&1){let i=M();s(0,"my-video-actions-dropdown",33),S("videoRemoved",function(){u(i);let n=_();return g(n.onVideoRemoved());})("videoBlocked",function(){u(i);let n=_();return g(n.onVideoBlocked());})("videoUnblocked",function(){u(i);let n=_();return g(n.onVideoUnblocked());})("videoAccountMuted",function(){u(i);let n=_();return g(n.onVideoAccountMuted());}),d();}if(e&2){let i=_();l("video",i.video())("displayOptions",i.videoActionsDisplayOptions());}}function Uo(e,r){e&1&&le(0);}function Bo(e,r){if(e&1&&p(0,Uo,1,0,"ng-container",32),e&2){_();let i=w(6);l("ngTemplateOutlet",i);}}function Xo(e,r){if(e&1&&v(0,"my-date-toggle",34),e&2){let i=_();l("date",i.video().publishedAt);}}function jo(e,r){e&1&&(h(0),R(1," \u2022 "),A());}function Qo(e,r){if(e&1&&v(0,"my-video-views-counter",35),e&2){let i=_();l("isLive",i.video().isLive)("viewers",i.video().viewers)("views",i.video().views);}}var Ns=(()=>{let r=class r{screenService=f(rt);serverService=f(ke);authService=f(Se);videoPlaylistService=f(si);videoService=f(re);cd=f(xt);user=E.required();video=E.required();displayOptions=E({date:!0,views:!0,by:!0,avatar:!0,privacyLabel:!1,forceChannelInBy:!1});displayVideoActions=E(!0);videoActionsDisplayOptions=E({playlist:!0,download:!1,update:!0,blacklist:!0,delete:!0,report:!0,duplicate:!0,mute:!0});actorImageSize=E(34,{transform:Ft});displayAsRow=E(!1,{transform:Te});videoLinkType=E("internal");videoBlocked=y();videoUnblocked=y();videoRemoved=y();videoAccountMuted=y();showActions=!1;serverConfig;addToWatchLaterText;addedToWatchLaterText;inWatchLaterPlaylist;channelLinkTitle="";watchLaterPlaylist;videoRouterLink=[];videoHref;videoTarget;ownerRouterLink=[];ownerHref;ownerTarget;nsfwTooltip;ownerDisplayType;actionsLoaded=!1;get preferAuthorDisplayName(){return this.serverConfig.client.videos.miniature.preferAuthorDisplayName;}get authorAccount(){return this.preferAuthorDisplayName?this.video().account.displayName:this.video().account.name;}get authorChannel(){return this.preferAuthorDisplayName?this.video().channel.displayName:this.video().channel.name;}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig(),this.buildVideoLink(),this.buildOwnerLink(),this.setUpBy(),this.nsfwTooltip=this.videoService.buildNSFWTooltip(this.video()),this.channelLinkTitle=""+this.video().channel.name+" (p\xE1gina del canal)\n        ",this.screenService.isInTouchScreen()&&this.loadActions();}buildVideoLink(){let t=this.videoLinkType(),n=this.video();if(t==="internal"||!n.url){this.videoRouterLink=ii.buildWatchUrl(n);return;}if(t==="external"){this.videoRouterLink=null,this.videoHref=n.url,this.videoTarget="_blank";return;}this.videoRouterLink=["/search/lazy-load-video",{url:n.url}];}buildOwnerLink(){let t=this.video(),n=this.videoLinkType();if(n==="internal"||!t.channel.url){this.ownerRouterLink=`/c/${t.byVideoChannel}`;return;}if(n==="external"){this.ownerRouterLink=null,this.ownerHref=t.channel.url,this.ownerTarget="_blank";return;}this.ownerRouterLink=["/search/lazy-load-channel",{url:t.channel.url}];}displayOwnerAccount(){return this.ownerDisplayType==="account";}displayOwnerVideoChannel(){return this.ownerDisplayType==="videoChannel";}isUnlistedVideo(){return this.video().privacy.id===Ke.UNLISTED;}isPrivateVideo(){return this.video().privacy.id===Ke.PRIVATE;}isPasswordProtectedVideo(){return this.video().privacy.id===Ke.PASSWORD_PROTECTED;}getAriaLabel(){return"Mira el v\xEDdeo "+this.video().name+"";}loadActions(){this.actionsLoaded||(this.displayVideoActions()&&(this.showActions=!0),this.loadWatchLater(),this.actionsLoaded=!0);}onVideoBlocked(){this.videoBlocked.emit();}onVideoUnblocked(){this.videoUnblocked.emit();}onVideoRemoved(){this.videoRemoved.emit();}onVideoAccountMuted(){this.videoAccountMuted.emit();}isUserLoggedIn(){return this.authService.isLoggedIn();}onWatchLaterClick(t){t===!0?this.removeFromWatchLater():this.addToWatchLater(),this.inWatchLaterPlaylist=!t;}addToWatchLater(){let t={videoId:this.video().id};this.videoPlaylistService.addVideoInPlaylist(this.watchLaterPlaylist.id,t).subscribe(n=>{this.watchLaterPlaylist.playlistElementId=n.videoPlaylistElement.id;});}removeFromWatchLater(){this.videoPlaylistService.removeVideoFromPlaylist(this.watchLaterPlaylist.id,this.watchLaterPlaylist.playlistElementId,this.video().id).subscribe(t=>{});}isWatchLaterPlaylistDisplayed(){return!this.screenService.isInTouchScreen()&&this.displayVideoActions()&&this.isUserLoggedIn()&&this.inWatchLaterPlaylist!==void 0;}getClasses(){return{"display-as-row":this.displayAsRow(),"has-avatar":this.displayOptions().avatar};}hasNSFWWarning(){return this.video().isNSFWWarnedForUser(this.user(),this.serverConfig);}hasNSFWBlur(){return this.video().isNSFWBlurForUser(this.user(),this.serverConfig);}setUpBy(){if(this.displayOptions().forceChannelInBy){this.ownerDisplayType="videoChannel";return;}this.ownerDisplayType=this.videoService.buildDefaultOwnerDisplayType(this.video());}loadWatchLater(){this.screenService.isInTouchScreen()||!this.displayVideoActions()||!this.isUserLoggedIn()||(this.authService.userInformationLoaded.pipe(ht(()=>this.videoPlaylistService.listenToVideoPlaylistChange(this.video().id))).subscribe(t=>{let n=this.authService.getUser().specialPlaylists.find(c=>c.type===Wt.WATCH_LATER),o=t.find(c=>c.playlistId===n.id);this.inWatchLaterPlaylist=!1,this.watchLaterPlaylist={id:n.id},o&&(this.inWatchLaterPlaylist=!0,this.watchLaterPlaylist.playlistElementId=o.playlistElementId),this.cd.markForCheck();}),this.videoPlaylistService.runVideoExistsInPlaylistCheck(this.video().id));}};T(r,"\u0275fac",function(n){return new(n||r)();}),T(r,"\u0275cmp",N({type:r,selectors:[["my-video-miniature"]],inputs:{user:[1,"user"],video:[1,"video"],displayOptions:[1,"displayOptions"],displayVideoActions:[1,"displayVideoActions"],videoActionsDisplayOptions:[1,"videoActionsDisplayOptions"],actorImageSize:[1,"actorImageSize"],displayAsRow:[1,"displayAsRow"],videoLinkType:[1,"videoLinkType"]},outputs:{videoBlocked:"videoBlocked",videoUnblocked:"videoUnblocked",videoRemoved:"videoRemoved",videoAccountMuted:"videoAccountMuted"},decls:20,vars:24,consts:()=>{let t;t="No listado";let n;n="Privado";let o;return o="Protegido por contrase\xF1a",[["nsfwWarningButton",""],t,n,o,[1,"video-miniature",3,"mouseenter","focusin","ngClass"],[3,"watchLaterClick","ariaLabel","blur","video","videoRouterLink","videoHref","videoTarget","displayWatchLaterPlaylist","inWatchLaterPlaylist"],["ngProjectAs","label-warning",5,["label-warning"],4,"ngIf"],["ngProjectAs","label-danger",5,["label-danger"],4,"ngIf"],[1,"video-info"],["class","owner min-width-0",4,"ngIf"],[1,"video-name-container"],["inheritParentStyle","true","className","ellipsis-multiline-2",1,"video-name",3,"internalLink","href","target","ariaLabel","title"],[1,"video-actions"],["placement","bottom-left bottom-right left auto",3,"video","displayOptions","videoRemoved","videoBlocked","videoUnblocked","videoAccountMuted",4,"ngIf"],[1,"date-and-views"],[3,"date",4,"ngIf"],[1,"views"],[4,"ngIf"],[3,"isLive","viewers","views",4,"ngIf"],["ngProjectAs","label-warning",5,["label-warning"]],["ngProjectAs","label-danger",5,["label-danger"]],["type","button","class","nsfw-warning button-unstyle ms-auto ps-1",3,"ngbTooltip",4,"ngIf"],["type","button",1,"nsfw-warning","button-unstyle","ms-auto","ps-1",3,"ngbTooltip"],["iconName","eye-close"],[1,"owner","min-width-0"],["class","owner-container",4,"ngIf"],["actorType","channel",3,"title","size","actor","internalHref"],["actorType","account",3,"title","size","actor","internalHref"],[1,"owner-container"],["inheritParentStyle","true",1,"owner-label","ellipsis",3,"internalLink","href","target","ariaLabel","title"],[3,"host",4,"ngIf"],[3,"host"],[4,"ngTemplateOutlet"],["placement","bottom-left bottom-right left auto",3,"videoRemoved","videoBlocked","videoUnblocked","videoAccountMuted","video","displayOptions"],[3,"date"],[3,"isLive","viewers","views"]];},template:function(n,o){if(n&1){let c=M();s(0,"div",4),S("mouseenter",function(){return u(c),g(o.loadActions());})("focusin",function(){return u(c),g(o.loadActions());}),s(1,"my-video-thumbnail",5),S("watchLaterClick",function(C){return u(c),g(o.onWatchLaterClick(C));}),p(2,No,2,0,"ng-container",6)(3,yo,2,0,"ng-container",7)(4,Po,2,0,"ng-container",7),d(),p(5,bo,1,1,"ng-template",null,0,H),s(7,"div",8),p(8,Wo,3,2,"div",9),s(9,"div",10)(10,"my-link",11),R(11),d(),s(12,"div",12),p(13,zo,1,2,"my-video-actions-dropdown",13),d(),p(14,Bo,1,1,"ng-container"),d(),s(15,"div",14),p(16,Xo,1,1,"my-date-toggle",15),s(17,"span",16),p(18,jo,2,0,"ng-container",17)(19,Qo,1,3,"my-video-views-counter",18),d()()()();}n&2&&(l("ngClass",o.getClasses()),a(),l("ariaLabel",o.getAriaLabel())("blur",o.hasNSFWBlur())("video",o.video())("videoRouterLink",o.videoRouterLink)("videoHref",o.videoHref)("videoTarget",o.videoTarget)("displayWatchLaterPlaylist",o.isWatchLaterPlaylistDisplayed())("inWatchLaterPlaylist",o.inWatchLaterPlaylist),a(),l("ngIf",o.displayOptions().privacyLabel&&o.isUnlistedVideo()),a(),l("ngIf",o.displayOptions().privacyLabel&&o.isPrivateVideo()),a(),l("ngIf",o.displayOptions().privacyLabel&&o.isPasswordProtectedVideo()),a(4),l("ngIf",o.displayOptions().avatar||o.displayOptions().by),a(2),l("internalLink",o.videoRouterLink)("href",o.videoHref)("target",o.videoTarget)("ariaLabel",o.getAriaLabel())("title",o.video().name),a(),b(" ",o.video().name," "),a(2),l("ngIf",o.showActions),a(),k(o.displayAsRow()||!o.displayOptions().avatar&&!o.displayOptions().by?14:-1),a(2),l("ngIf",o.displayOptions().date),a(2),l("ngIf",o.displayOptions().date&&o.displayOptions().views),a(),l("ngIf",o.displayOptions().views));},dependencies:[je,j,x,be,di,ai,li,vi,Ci,Mi,Di,$,Zt,Ve],styles:[`.video-miniature[_ngcontent-%COMP%]{--co-fs-small: .75rem;--co-fs-medium: .875rem;--co-fs-big: 1rem}.video-name-container[_ngcontent-%COMP%]{display:flex;align-items:center;min-width:1px}.video-name[_ngcontent-%COMP%]{font-size:var(--co-fs-big);transition:color .2s;font-weight:700;color:var(--fg);word-break:break-word;word-wrap:break-word;overflow-wrap:break-word}.video-name[_ngcontent-%COMP%]:hover{text-decoration:none}.video-info[_ngcontent-%COMP%]{display:grid}.owner[_ngcontent-%COMP%]{display:flex;position:relative;font-size:var(--co-fs-medium)}.date-and-views[_ngcontent-%COMP%]{font-size:var(--co-fs-small);color:var(--fg-200)}.nsfw-warning[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:18px;height:18px;line-height:18px}.owner-container[_ngcontent-%COMP%]{display:flex;min-width:1px;width:100%}my-actor-host[_ngcontent-%COMP%]{flex-shrink:1;min-width:1px;margin-inline-start:.25rem}.owner-label[_ngcontent-%COMP%]{flex-shrink:1;color:var(--fg-300)}.owner-label[_ngcontent-%COMP%], .owner-label[_ngcontent-%COMP%]:hover, .owner-label[_ngcontent-%COMP%]:focus, .owner-label[_ngcontent-%COMP%]:active{text-decoration:none}.owner-label[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}.owner-label[_ngcontent-%COMP%]:hover{color:var(--fg);opacity:1}.video-actions[_ngcontent-%COMP%]{width:40px}.video-actions[_ngcontent-%COMP%]     .dropdown-root:not(.show){opacity:0}.video-actions[_ngcontent-%COMP%]     .playlist-dropdown.show+my-action-dropdown .dropdown-root{opacity:1}.video-actions[_ngcontent-%COMP%]     .dropdown-root>.dropdown-toggle{--input-y-padding: 0}.video-miniature[_ngcontent-%COMP%]:hover   my-video-thumbnail[_ngcontent-%COMP%]     .actions-overlay, .video-miniature[_ngcontent-%COMP%]:hover   .video-actions[_ngcontent-%COMP%]     .dropdown-root, .video-miniature[_ngcontent-%COMP%]:focus-within   my-video-thumbnail[_ngcontent-%COMP%]     .actions-overlay, .video-miniature[_ngcontent-%COMP%]:focus-within   .video-actions[_ngcontent-%COMP%]     .dropdown-root{opacity:1!important}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row){display:flex;flex-direction:column;padding-bottom:1rem;width:100%}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-name[_ngcontent-%COMP%]{width:calc(100% - 40px)}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-video-thumbnail[_ngcontent-%COMP%]{margin-bottom:.35rem;position:relative;height:0;width:100%;padding-top:56.25%}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-video-thumbnail[_ngcontent-%COMP%]     .video-thumbnail{position:absolute;width:100%;height:100%;top:0}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row).has-avatar   .video-info[_ngcontent-%COMP%]{padding-inline-start:.75rem}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-actor-avatar[_ngcontent-%COMP%]{border:2px solid var(--bg);position:absolute;top:-20px;background:var(--bg);z-index:10}@supports (inset-inline-start: -2px){.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-actor-avatar[_ngcontent-%COMP%]{inset-inline-start:-2px}}@supports not (inset-inline-start: -2px){.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-actor-avatar[_ngcontent-%COMP%]{left:-2px}}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-actor-avatar[actorType=account][_ngcontent-%COMP%]{border-radius:50%}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-actor-avatar[actorType=channel][_ngcontent-%COMP%]{border-radius:5px}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-actor-avatar[_ngcontent-%COMP%] + .owner-container[_ngcontent-%COMP%]{margin-inline-start:calc(.5rem + 34px)}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .date-and-views[_ngcontent-%COMP%]{margin-top:3px}@media screen and (max-width: 800px){.video-miniature[_ngcontent-%COMP%]:not(.display-as-row){width:100%;margin-bottom:25px}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-info[_ngcontent-%COMP%]{width:100%;text-align:left}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-actions[_ngcontent-%COMP%]{top:-3px;width:auto}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-actions[_ngcontent-%COMP%]     .dropdown-root{opacity:1!important}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)     .video-thumbnail{border-radius:0}}.video-miniature.display-as-row[_ngcontent-%COMP%]{--co-fs-small: .875rem;--co-fs-medium: 1rem;--co-fs-big: 1.25rem;--co-row-thumbnail-width: 280px;--co-row-thumbnail-height: 153px;display:flex;flex-direction:row}.video-miniature.display-as-row[_ngcontent-%COMP%]   my-video-thumbnail[_ngcontent-%COMP%]{min-width:var(--co-row-thumbnail-width);max-width:var(--co-row-thumbnail-width);height:var(--co-row-thumbnail-height);margin-inline-end:1rem}.video-miniature.display-as-row[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]{grid-template-rows:auto;height:min-content}.video-miniature.display-as-row[_ngcontent-%COMP%]   .video-name[_ngcontent-%COMP%]{grid-row:1}.video-miniature.display-as-row[_ngcontent-%COMP%]   .date-and-views[_ngcontent-%COMP%]{grid-row:2}.video-miniature.display-as-row[_ngcontent-%COMP%]   .owner[_ngcontent-%COMP%]{grid-row:3;align-items:center;margin-top:.5rem;margin-bottom:.5rem}.video-miniature.display-as-row[_ngcontent-%COMP%]   my-actor-avatar[_ngcontent-%COMP%]{margin-inline-end:.5rem}@media screen and (max-width: 800px){.video-miniature.display-as-row[_ngcontent-%COMP%]{--co-row-thumbnail-width: 201px;--co-row-thumbnail-height: 114px}}@media screen and (max-width: 500px){.video-miniature.display-as-row[_ngcontent-%COMP%]{--co-row-thumbnail-width: 125px;--co-row-thumbnail-height: 71px;--co-fs-small: .875rem;--co-fs-medium: .875rem;--co-fs-big: 1rem}.video-miniature.display-as-row[_ngcontent-%COMP%]   my-actor-avatar[_ngcontent-%COMP%]{display:none}}
/*# sourceMappingURL=video-miniature.component-BIQTDMQK.css.map */`],changeDetection:0}));let e=r;return e;})();export{vi as a,Ci as b,hr as c,Hr as d,Si as e,Ri as f,Mi as g,Ns as h};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-DJO6R22E.js.map