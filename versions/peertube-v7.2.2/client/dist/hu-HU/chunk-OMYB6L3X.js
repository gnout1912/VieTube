import{a as ee,b as ie,c as te,d as _,f as re,g as ae,h as ne}from"./chunk-GL5D7JZI.js";import{a as Z}from"./chunk-XX2DH643.js";import"./chunk-TBYV5OLF.js";import{a as p}from"./chunk-E244FAMK.js";import"./chunk-54JNDI5J.js";import"./chunk-AYTBY3KG.js";import"./chunk-MLUQ7CKS.js";import"./chunk-CWRM6WWY.js";import"./chunk-ZO2H6O7A.js";import"./chunk-4MNDFPOM.js";import"./chunk-GUE2RQOD.js";import"./chunk-FJ2ZROHN.js";import"./chunk-EBEN7JLX.js";import"./chunk-HRQFMPLQ.js";import"./chunk-GAPJZSX5.js";import"./chunk-7EJTRMSK.js";import"./chunk-VM462Q6H.js";import"./chunk-75CL7ZAD.js";import"./chunk-TOPWIQ4B.js";import"./chunk-5GTHDKWY.js";import{a as oe}from"./chunk-RXNERS4P.js";import"./chunk-DEVNJA25.js";import{a as X}from"./chunk-SDLUASD2.js";import"./chunk-IESFBSCZ.js";import"./chunk-ID3GIFOG.js";import"./chunk-UFXFCZP3.js";import"./chunk-V73D6FBB.js";import{b as q,c as K}from"./chunk-BFVCLNOF.js";import"./chunk-3PB3Q4OH.js";import"./chunk-24ZAFI2J.js";import"./chunk-JVRBW57G.js";import"./chunk-ANGOORPW.js";import"./chunk-25AA3I7H.js";import"./chunk-2O3IZ566.js";import"./chunk-YDZGE3V5.js";import"./chunk-UI5MIAKJ.js";import"./chunk-C5UL7A6S.js";import"./chunk-WZVFW7AN.js";import"./chunk-6JJL547V.js";import"./chunk-RT7DTAS6.js";import{B as W,C as B}from"./chunk-WO4VNXA3.js";import"./chunk-PE7TFI7A.js";import{Bb as y,Bf as z,Bg as J,Cb as H,Dc as R,Fa as L,Ha as x,Oc as j,Q as D,Sa as T,Sg as Y,Xb as O,Xf as G,Y as P,Ya as F,Zd as N,aa as t,eb as A,ha as b,ia as I,j as c,kd as k,lg as Q,n as m,nb as C,ob as V,r as w,tb as E,vg as $,xg as v}from"./chunk-F7FAPFPY.js";import{i as n,j as M}from"./chunk-AI7IVZV2.js";function ve(a,o){if(a&1){let se=E();C(0,"my-video-manage-container",2),y("videoUpdated",function(){b(se);let e=H();return I(e.onVideoUpdated());}),V();}}var de=(()=>{let o=class o{route=t(k);serverService=t(v);notifier=t(G);manageController=t(_);isUpdatingVideo=!1;loaded=!1;ngOnInit(){return M(this,null,function*(){let i=this.route.snapshot.data.resolverData,{video:e,userChannels:r,captions:s,chapters:d,videoSource:l,live:u,videoPasswords:f,userQuota:g,privacies:S}=i,h=yield re.createFromAPI(this.serverService.getHTMLConfig(),{video:e,captions:s,chapters:d,live:u,videoSource:l,videoPasswords:f.map(ce=>ce.password)});this.manageController.setStore({videoEdit:h,userQuota:g,userChannels:r,privacies:S}),this.manageController.setConfig({manageType:"update",serverConfig:this.serverService.getHTMLConfig()}),this.loaded=!0;});}ngOnDestroy(){this.manageController.cancelUploadIfNeeded();}onVideoUpdated(){this.notifier.success("Vide\xF3 friss\xEDtve.");}onUnload(i){let{text:e,canDeactivate:r}=this.canDeactivate();if(!r)return i.returnValue=e,e;}canDeactivate(){return{canDeactivate:!this.manageController.hasPendingChanges(),text:"You have unsaved changes. Are you sure you want to leave?"};}};n(o,"\u0275fac",function(e){return new(e||o)();}),n(o,"\u0275cmp",T({type:o,selectors:[["my-video-manage"]],hostBindings:function(e,r){e&1&&y("beforeunload",function(d){return r.onUnload(d);},!1,L);},features:[O([_])],decls:2,vars:1,consts:[[1,"margin-content"],["canUpdate","true","canWatch","true","cancelLink","/my-library/videos",3,"videoUpdated",4,"ngIf"],["canUpdate","true","canWatch","true","cancelLink","/my-library/videos",3,"videoUpdated"]],template:function(e,r){e&1&&(C(0,"div",0),F(1,ve,1,0,"my-video-manage-container",1),V()),e&2&&(x(),A("ngIf",r.loaded));},dependencies:[j,R,W,B,ne],encapsulation:2}));let a=o;return a;})();var U=(()=>{let o=class o{videoService=t(K);liveVideoService=t(p);authService=t(Q);videoCaptionService=t(X);videoChapterService=t(oe);videoPasswordService=t(q);userService=t(Y);serverService=t(v);resolve(i){let e=i.params.uuid;return this.videoService.getVideo({videoId:e}).pipe(D(r=>w(this.buildObservables(r))),m(([r,s,d,l,u,f,g,S,h])=>({video:r,userChannels:d,captions:l,chapters:u,videoSource:s,live:f,videoPasswords:g,userQuota:S,privacies:h})));}buildObservables(i){return[c(i),this.videoService.getSource(i.id),z(this.authService),this.videoCaptionService.listCaptions(i.uuid).pipe(m(e=>e.data)),this.videoChapterService.getChapters({videoId:i.uuid}).pipe(m(({chapters:e})=>e)),i.isLive?this.liveVideoService.getVideoLive(i.id):c(void 0),i.privacy.id===N.PASSWORD_PROTECTED?this.videoPasswordService.getVideoPasswords({videoUUID:i.uuid}):c([]),this.userService.getMyVideoQuotaUsed(),this.serverService.getVideoPrivacies()];}};n(o,"\u0275fac",function(e){return new(e||o)();}),n(o,"\u0275prov",P({token:o,factory:o.Éµfac}));let a=o;return a;})();var Je=[{path:"",component:de,canActivate:[J],canDeactivate:[$],providers:[U,p,ee,ie,te,Z],resolve:{resolverData:U},children:ae}];export{Je as default};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-OMYB6L3X.js.map