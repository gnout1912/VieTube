import{a as wr,b as $r,c as Ur}from"./chunk-XX2DH643.js";import{a as Vr,b as Vt}from"./chunk-TBYV5OLF.js";import{a as Yt}from"./chunk-E244FAMK.js";import{a as Tr}from"./chunk-54JNDI5J.js";import{a as br}from"./chunk-AYTBY3KG.js";import{a as rn}from"./chunk-MLUQ7CKS.js";import{a as Rr,b as hi,c as xr,d as Fr}from"./chunk-CWRM6WWY.js";import{c as mi,d as et}from"./chunk-4MNDFPOM.js";import{a as pi}from"./chunk-GUE2RQOD.js";import{a as Mt}from"./chunk-FJ2ZROHN.js";import{a as ci}from"./chunk-EBEN7JLX.js";import{a as Lr}from"./chunk-GAPJZSX5.js";import{a as an,b as re,c as At,d as gi,e as Ei,f as fi,g as Xi,h as vn,i as yr,j as Dr}from"./chunk-7EJTRMSK.js";import{a as Bi}from"./chunk-VM462Q6H.js";import{a as ui}from"./chunk-75CL7ZAD.js";import{a as Nr}from"./chunk-TOPWIQ4B.js";import{a as Pr}from"./chunk-5GTHDKWY.js";import{a as Gr}from"./chunk-RXNERS4P.js";import{a as _i}from"./chunk-SDLUASD2.js";import{a as Or}from"./chunk-IESFBSCZ.js";import{a as vr}from"./chunk-ID3GIFOG.js";import{B as Ft}from"./chunk-UFXFCZP3.js";import{b as Ir,c as Fe}from"./chunk-BFVCLNOF.js";import{b as di}from"./chunk-3PB3Q4OH.js";import{a as Je}from"./chunk-JVRBW57G.js";import{a as Jn,b as he,c as si}from"./chunk-25AA3I7H.js";import{c as Ct}from"./chunk-2O3IZ566.js";import{a as cr,d as ai}from"./chunk-UI5MIAKJ.js";import{a as on,b as St}from"./chunk-WZVFW7AN.js";import{a as li}from"./chunk-6JJL547V.js";import{A as lr,B as dr,F as tn,s as ei,u as or,w as rr,x as ar,y as sr}from"./chunk-RT7DTAS6.js";import{B as J,C as te,a as qo,c as gt,d as ee,g as Pe,h as ye,j as Zo,m as Yn,n as Ko,p as Qo,q as De,r as qn,s as Jo,t as Re,z as er}from"./chunk-WO4VNXA3.js";import{a as oe}from"./chunk-PE7TFI7A.js";import{$d as xe,$f as ht,Ab as Sn,B as kt,Bb as L,Bc as Rt,Bd as Zn,Ca as Fo,Cb as h,Cc as Ke,Db as kn,Dc as Q,Ea as Un,Eb as Mn,Ef as pr,Eg as ri,Ha as _,Ib as $o,Ic as Xn,J as No,Jb as Uo,K as To,Kb as Ho,Kg as Cr,Mb as rt,Mf as ur,Na as ot,Nb as Dt,Nf as gr,Ob as Ge,Oc as Oe,Of as Er,Pb as R,Pg as Sr,Q as bt,Qb as Y,Qd as Et,Qf as fr,Qg as Mr,Rb as ue,Rd as Kn,S as $i,Sa as j,Sb as ko,Tc as Wn,Tf as ni,Ua as Vo,Ub as zt,Ue as zi,Ug as Ar,Vb as Bt,Wa as Hn,Wb as Xt,X as bo,Xb as en,Xc as jn,Xf as Ue,Y as pt,Ya as I,Yb as zo,Yd as st,Zb as be,Zd as $e,Zf as hr,aa as A,ab as Lo,bf as _r,c as wn,cb as wo,da as yo,de as Qn,ea as Do,eb as g,fc as Wt,gb as Go,gc as zn,ha as F,hc as Hi,ia as V,j as Ze,ja as Ro,jb as K,jc as at,kb as Ui,kd as Xo,kg as ii,la as $n,lb as hn,ld as Wo,lf as ti,lg as oi,mb as Cn,mc as Bo,me as tr,mf as mr,n as Io,nb as c,nc as Bn,ne as ft,ob as l,oc as An,od as jo,oe as Qe,pb as v,pd as ut,pe as nr,qa as xo,qb as B,qd as Yo,qe as ki,r as Gn,rb as X,sa as Jt,sb as yt,sg as nn,ta as Te,tb as q,te as jt,ud as xt,ue as ir,vb as Se,wb as Me,xb as C,xg as ie,yb as Ae,zb as ve}from"./chunk-F7FAPFPY.js";import{a as Z,b as fe,e as Po,g as qe,i as T,j as $}from"./chunk-AI7IVZV2.js";var Yr=Po((Wi,jr)=>{"use strict";(function(t,i){typeof Wi=="object"?jr.exports=i():typeof define=="function"&&define.amd?define([],function(){return t.Channel=i();}):t.Channel=i();})(Wi,function(){"use strict";var t=function(){var i=Math.floor(Math.random()*1000001),o={};function e(p,E,S,P){function N(W){for(var H=0;H<W.length;H++)if(W[H].win===p)return!0;return!1;}var D=!1;if(E==="*"){for(var x in o)if(o.hasOwnProperty(x)&&x!=="*"&&typeof o[x][S]=="object"&&(D=N(o[x][S]),D))break;}else o["*"]&&o["*"][S]&&(D=N(o["*"][S])),!D&&o[E]&&o[E][S]&&(D=N(o[E][S]));if(D)throw"A channel is already bound to the same window which overlaps with origin '"+E+"' and has scope '"+S+"'";typeof o[E]!="object"&&(o[E]={}),typeof o[E][S]!="object"&&(o[E][S]=[]),o[E][S].push({win:p,handler:P});}function n(p,E,S){for(var P=o[E][S],N=0;N<P.length;N++)P[N].win===p&&P.splice(N,1);o[E][S].length===0&&delete o[E][S];}function r(p){return Array.isArray?Array.isArray(p):p.constructor.toString().indexOf("Array")!=-1;}var d={},u=function(p){try{var E=JSON.parse(p.data);if(typeof E!="object"||E===null)throw"malformed";}catch{return;}var S=p.source,P=p.origin,N,D,x;if(typeof E.method=="string"){var W=E.method.split("::");W.length==2?(N=W[0],x=W[1]):x=E.method;}if(typeof E.id<"u"&&(D=E.id),typeof x=="string"){var H=!1;if(o[P]&&o[P][N]){for(var k=0;k<o[P][N].length;k++)if(o[P][N][k].win===S){o[P][N][k].handler(P,x,E),H=!0;break;}}if(!H&&o["*"]&&o["*"][N]){for(var k=0;k<o["*"][N].length;k++)if(o["*"][N][k].win===S){o["*"][N][k].handler(P,x,E);break;}}}else typeof D<"u"&&d[D]&&d[D](P,x,E);};return window.addEventListener?window.addEventListener("message",u,!1):window.attachEvent&&window.attachEvent("onmessage",u),{build:function(p){var E=function(M){if(p.debugOutput&&window.console&&window.console.log){try{typeof M!="string"&&(M=JSON.stringify(M));}catch{}window.console.log("["+N+"] "+M);}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if(typeof p!="object")throw"Channel build invoked without a proper object argument";if(!p.window||!p.window.postMessage)throw"Channel.build() called without a valid window argument";window===p.window&&E("target window is same as present window -- use at your own risk");var S=!1;if(typeof p.origin=="string"){var P;p.origin==="*"?S=!0:(P=p.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))!==null&&(p.origin=P[0].toLowerCase(),S=!0);}if(!S)throw"Channel.build() called with an invalid origin";if(typeof p.scope<"u"){if(typeof p.scope!="string")throw"scope, when specified, must be a string";if(p.scope.split("::").length>1)throw"scope may not contain double colons: '::'";}else p.scope="__default";var N=function(){for(var M="",G="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",y=0;y<5;y++)M+=G.charAt(Math.floor(Math.random()*G.length));return M;}(),D={},x={},W={},H=!1,k=[],_e=[],w=function(M,G,y){var me=!1,Ve=!1;return{origin:G,invoke:function(pe,Ie){if(!W[M])throw"attempting to invoke a callback of a nonexistent transaction: "+M;for(var le=!1,ge=0;ge<y.length;ge++)if(pe===y[ge]){le=!0;break;}if(!le)throw"request supports no such callback '"+pe+"'";ke({id:M,callback:pe,params:Ie});},error:function(pe,Ie){if(Ve=!0,!W[M])throw"error called for nonexistent message: "+M;delete W[M],ke({id:M,error:pe,message:Ie});},complete:function(pe){if(Ve=!0,!W[M])throw"complete called for nonexistent message: "+M;delete W[M],ke({id:M,result:pe});},delayReturn:function(pe){return typeof pe=="boolean"&&(me=pe===!0),me;},completed:function(){return Ve;}};},ne=function(M,G,y){return window.setTimeout(function(){if(x[M]){var me="timeout ("+G+"ms) exceeded on method '"+y+"'";x[M].error&&x[M].error("timeout_error",me),delete x[M],delete d[M];}},G);},Be=function(M,G,y){if(typeof p.gotMessageObserver=="function")try{p.gotMessageObserver(M,y);}catch(U){E("gotMessageObserver() raised an exception: "+U.toString());}if(y.id&&G){W[y.id]={};var me=w(y.id,M,y.callbacks?y.callbacks:[]);if(D[G])try{if(y.callbacks&&r(y.callbacks)&&y.callbacks.length>0)for(var Ve=0;Ve<y.callbacks.length;Ve++){for(var pe=y.callbacks[Ve],Ie=y.params,le=pe.split("/"),ge=0;ge<le.length-1;ge++){var Ot=le[ge];typeof Ie[Ot]!="object"&&(Ie[Ot]={}),Ie=Ie[Ot];}Ie[le[le.length-1]]=function(){var U=pe;return function(dt){return me.invoke(U,dt);};}();}var cn=D[G](me,y.params);!me.delayReturn()&&!me.completed()&&me.complete(cn);}catch(U){var Kt="runtime_error",ze=null;if(typeof U=="string"?ze=U:typeof U=="object"&&(U instanceof Error?(Kt=U.constructor.name,ze=U.message):U&&r(U)&&U.length==2?(Kt=U[0],ze=U[1]):typeof U.error=="string"&&(Kt=U.error,U.message?typeof U.message=="string"?ze=U.message:U=U.message:ze="")),ze===null)try{ze=JSON.stringify(U),typeof ze>"u"&&(ze=U.toString());}catch{ze=U.toString();}me.error(Kt,ze);}else me.error("method_not_found","No method '"+G+"' was (yet) bound by the provider");}else y.id&&y.callback?!x[y.id]||!x[y.id].callbacks||!x[y.id].callbacks[y.callback]?E("ignoring invalid callback, id:"+y.id+" ("+y.callback+")"):x[y.id].callbacks[y.callback](y.params):y.id?x[y.id]?(y.error?x[y.id].error&&x[y.id].error(y.error,y.message):y.result!==void 0?x[y.id].success(y.result):x[y.id].success(),delete x[y.id],delete d[y.id]):E("ignoring invalid response: "+y.id):G&&D[G]&&D[G]({origin:M},y.params);};e(p.window,p.origin,p.scope,Be);var Xe=function(M){return[p.scope,M].join("::");},ke=function(M,G){if(!M)throw"postMessage called with null message";if(!G&&!H)E("queue message: "+JSON.stringify(M)),k.push(M);else{if(typeof p.postMessageObserver=="function")try{p.postMessageObserver(p.origin,M);}catch(y){E("postMessageObserver() raised an exception: "+y.toString());}E("post message: "+JSON.stringify(M)+" with origin "+p.origin),p.window.postMessage(JSON.stringify(M),p.origin);}},We=function(M,G){if(E("ready msg received"),H&&!p.reconnect)throw"received ready message while in ready state.";H=!0,N.length<6&&(G.type==="publish-request"?N+="-R":N+="-L"),E("ready msg accepted."),G.type==="publish-request"&&se.notify({method:"__ready",params:{type:"publish-reply",publish:_e}});for(var y=0;y<G.publish.length;y++)G.publish[y].action==="bind"?tt([G.publish[y].method],se.remote):delete se.remote[G.publish[y].method];for(p.reconnect||se.unbind("__ready",!0);k.length;)ke(k.splice(0,1)[0]);_e=[],typeof p.onReady=="function"&&p.onReady(se);},tt=function(M,G){M=[].concat(M);for(var y,me=0;me<M.length;me++)y=M[me].toString(),G[y]=function(Ve){return function(pe,Ie,le){Ie?se.call({method:Ve,params:pe,success:Ie,error:le}):se.notify({method:Ve,params:pe});};}(y);},nt=function(M,G){tt([G],se.remote);},vt=function(M,G){se.remote[G]&&delete se.remote[G];},se={remote:{},unbind:function(M,G){if(D[M]){if(!delete D[M])throw"can't delete method: "+M;return p.publish&&!G&&(H?se.notify({method:"__unbind",params:M}):_e.push({action:"unbind",method:M})),!0;}return!1;},bind:function(M,G,y){if(!M||typeof M!="string")throw"'method' argument to bind must be string";if(!G||typeof G!="function")throw"callback missing from bind params";if(D[M])throw"method '"+M+"' is already bound!";return D[M]=G,p.publish&&!y&&(H?se.notify({method:"__bind",params:M}):_e.push({action:"bind",method:M})),this;},call:function(M){if(!M)throw"missing arguments to call function";if(!M.method||typeof M.method!="string")throw"'method' argument to call must be string";if(!M.success||typeof M.success!="function")throw"'success' callback missing from call";var G={},y=[],me=[],Ve=function(Ie,le){if(me.indexOf(le)>=0)throw"params cannot be a recursive data structure";if(le&&me.push(le),typeof le=="object"){for(var ge in le)if(le.hasOwnProperty(ge)){var Ot=Ie+(Ie.length?"/":"")+ge;typeof le[ge]=="function"?(G[Ot]=le[ge],y.push(Ot),delete le[ge]):typeof le[ge]=="object"&&Ve(Ot,le[ge]);}}};Ve("",M.params);var pe={id:i,method:Xe(M.method),params:M.params};y.length&&(pe.callbacks=y),M.timeout&&ne(i,M.timeout,Xe(M.method)),x[i]={callbacks:G,error:M.error,success:M.success},d[i]=Be,i++,ke(pe);},notify:function(M){if(!M)throw"missing arguments to notify function";if(!M.method||typeof M.method!="string")throw"'method' argument to notify must be string";ke({method:Xe(M.method),params:M.params});},destroy:function(){n(p.window,p.origin,p.scope),window.removeEventListener?window.removeEventListener("message",Be,!1):window.detachEvent&&window.detachEvent("onmessage",Be),H=!1,D={},W={},x={},p.origin=null,k=[],E("channel destroyed"),N="";}};return se.bind("__ready",We,!0),se.bind("__bind",nt,!0),se.bind("__unbind",vt,!0),p.remote&&tt(p.remote,se.remote),setTimeout(function(){N.length>0&&ke({method:Xe("__ready"),params:{type:"publish-request",publish:_e}},!0);},0),se;}};}();return t;});});var Da=Po((vE,Ii)=>{"use strict";(function(t,i,o,e){"use strict";var n=["","webkit","Moz","MS","ms","o"],r=i.createElement("div"),d="function",u=Math.round,p=Math.abs,E=Date.now;function S(a,s,m){return setTimeout(_e(a,m),s);}function P(a,s,m){return Array.isArray(a)?(N(a,m[s],m),!0):!1;}function N(a,s,m){var f;if(a)if(a.forEach)a.forEach(s,m);else if(a.length!==e)for(f=0;f<a.length;)s.call(m,a[f],f,a),f++;else for(f in a)a.hasOwnProperty(f)&&s.call(m,a[f],f,a);}function D(a,s,m){var f="DEPRECATED METHOD: "+s+`
`+m+` AT 
`;return function(){var O=new Error("get-stack-trace"),b=O&&O.stack?O.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",z=t.console&&(t.console.warn||t.console.log);return z&&z.call(t.console,f,b),a.apply(this,arguments);};}var x;typeof Object.assign!="function"?x=function(s){if(s===e||s===null)throw new TypeError("Cannot convert undefined or null to object");for(var m=Object(s),f=1;f<arguments.length;f++){var O=arguments[f];if(O!==e&&O!==null)for(var b in O)O.hasOwnProperty(b)&&(m[b]=O[b]);}return m;}:x=Object.assign;var W=D(function(s,m,f){for(var O=Object.keys(m),b=0;b<O.length;)(!f||f&&s[O[b]]===e)&&(s[O[b]]=m[O[b]]),b++;return s;},"extend","Use `assign`."),H=D(function(s,m){return W(s,m,!0);},"merge","Use `assign`.");function k(a,s,m){var f=s.prototype,O;O=a.prototype=Object.create(f),O.constructor=a,O._super=f,m&&x(O,m);}function _e(a,s){return function(){return a.apply(s,arguments);};}function w(a,s){return typeof a==d?a.apply(s&&s[0]||e,s):a;}function ne(a,s){return a===e?s:a;}function Be(a,s,m){N(tt(s),function(f){a.addEventListener(f,m,!1);});}function Xe(a,s,m){N(tt(s),function(f){a.removeEventListener(f,m,!1);});}function ke(a,s){for(;a;){if(a==s)return!0;a=a.parentNode;}return!1;}function We(a,s){return a.indexOf(s)>-1;}function tt(a){return a.trim().split(/\s+/g);}function nt(a,s,m){if(a.indexOf&&!m)return a.indexOf(s);for(var f=0;f<a.length;){if(m&&a[f][m]==s||!m&&a[f]===s)return f;f++;}return-1;}function vt(a){return Array.prototype.slice.call(a,0);}function se(a,s,m){for(var f=[],O=[],b=0;b<a.length;){var z=s?a[b][s]:a[b];nt(O,z)<0&&f.push(a[b]),O[b]=z,b++;}return m&&(s?f=f.sort(function(Ne,Le){return Ne[s]>Le[s];}):f=f.sort()),f;}function M(a,s){for(var m,f,O=s[0].toUpperCase()+s.slice(1),b=0;b<n.length;){if(m=n[b],f=m?m+O:s,f in a)return f;b++;}return e;}var G=1;function y(){return G++;}function me(a){var s=a.ownerDocument||a;return s.defaultView||s.parentWindow||t;}var Ve=/mobile|tablet|ip(ad|hone|od)|android/i,pe="ontouchstart"in t,Ie=M(t,"PointerEvent")!==e,le=pe&&Ve.test(navigator.userAgent),ge="touch",Ot="pen",cn="mouse",Kt="kinect",ze=25,U=1,dt=2,Ee=4,we=8,Nn=1,_n=2,mn=4,pn=8,un=16,ct=_n|mn,Ut=pn|un,ro=ct|Ut,ao=["x","y"],Tn=["clientX","clientY"];function je(a,s){var m=this;this.manager=a,this.callback=s,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(f){w(a.options.enable,[a])&&m.handler(f);},this.init();}je.prototype={handler:function(){},init:function(){this.evEl&&Be(this.element,this.evEl,this.domHandler),this.evTarget&&Be(this.target,this.evTarget,this.domHandler),this.evWin&&Be(me(this.element),this.evWin,this.domHandler);},destroy:function(){this.evEl&&Xe(this.element,this.evEl,this.domHandler),this.evTarget&&Xe(this.target,this.evTarget,this.domHandler),this.evWin&&Xe(me(this.element),this.evWin,this.domHandler);}};function ms(a){var s,m=a.options.inputClass;return m?s=m:Ie?s=yi:le?s=Dn:pe?s=Di:s=yn,new s(a,ps);}function ps(a,s,m){var f=m.pointers.length,O=m.changedPointers.length,b=s&U&&f-O===0,z=s&(Ee|we)&&f-O===0;m.isFirst=!!b,m.isFinal=!!z,b&&(a.session={}),m.eventType=s,us(a,m),a.emit("hammer.input",m),a.recognize(m),a.session.prevInput=m;}function us(a,s){var m=a.session,f=s.pointers,O=f.length;m.firstInput||(m.firstInput=so(s)),O>1&&!m.firstMultiple?m.firstMultiple=so(s):O===1&&(m.firstMultiple=!1);var b=m.firstInput,z=m.firstMultiple,Ce=z?z.center:b.center,Ne=s.center=lo(f);s.timeStamp=E(),s.deltaTime=s.timeStamp-b.timeStamp,s.angle=bi(Ce,Ne),s.distance=bn(Ce,Ne),gs(m,s),s.offsetDirection=_o(s.deltaX,s.deltaY);var Le=co(s.deltaTime,s.deltaX,s.deltaY);s.overallVelocityX=Le.x,s.overallVelocityY=Le.y,s.overallVelocity=p(Le.x)>p(Le.y)?Le.x:Le.y,s.scale=z?hs(z.pointers,f):1,s.rotation=z?fs(z.pointers,f):0,s.maxPointers=m.prevInput?s.pointers.length>m.prevInput.maxPointers?s.pointers.length:m.prevInput.maxPointers:s.pointers.length,Es(m,s);var mt=a.element;ke(s.srcEvent.target,mt)&&(mt=s.srcEvent.target),s.target=mt;}function gs(a,s){var m=s.center,f=a.offsetDelta||{},O=a.prevDelta||{},b=a.prevInput||{};(s.eventType===U||b.eventType===Ee)&&(O=a.prevDelta={x:b.deltaX||0,y:b.deltaY||0},f=a.offsetDelta={x:m.x,y:m.y}),s.deltaX=O.x+(m.x-f.x),s.deltaY=O.y+(m.y-f.y);}function Es(a,s){var m=a.lastInterval||s,f=s.timeStamp-m.timeStamp,O,b,z,Ce;if(s.eventType!=we&&(f>ze||m.velocity===e)){var Ne=s.deltaX-m.deltaX,Le=s.deltaY-m.deltaY,mt=co(f,Ne,Le);b=mt.x,z=mt.y,O=p(mt.x)>p(mt.y)?mt.x:mt.y,Ce=_o(Ne,Le),a.lastInterval=s;}else O=m.velocity,b=m.velocityX,z=m.velocityY,Ce=m.direction;s.velocity=O,s.velocityX=b,s.velocityY=z,s.direction=Ce;}function so(a){for(var s=[],m=0;m<a.pointers.length;)s[m]={clientX:u(a.pointers[m].clientX),clientY:u(a.pointers[m].clientY)},m++;return{timeStamp:E(),pointers:s,center:lo(s),deltaX:a.deltaX,deltaY:a.deltaY};}function lo(a){var s=a.length;if(s===1)return{x:u(a[0].clientX),y:u(a[0].clientY)};for(var m=0,f=0,O=0;O<s;)m+=a[O].clientX,f+=a[O].clientY,O++;return{x:u(m/s),y:u(f/s)};}function co(a,s,m){return{x:s/a||0,y:m/a||0};}function _o(a,s){return a===s?Nn:p(a)>=p(s)?a<0?_n:mn:s<0?pn:un;}function bn(a,s,m){m||(m=ao);var f=s[m[0]]-a[m[0]],O=s[m[1]]-a[m[1]];return Math.sqrt(f*f+O*O);}function bi(a,s,m){m||(m=ao);var f=s[m[0]]-a[m[0]],O=s[m[1]]-a[m[1]];return Math.atan2(O,f)*180/Math.PI;}function fs(a,s){return bi(s[1],s[0],Tn)+bi(a[1],a[0],Tn);}function hs(a,s){return bn(s[0],s[1],Tn)/bn(a[0],a[1],Tn);}var Cs={mousedown:U,mousemove:dt,mouseup:Ee},Ss="mousedown",Ms="mousemove mouseup";function yn(){this.evEl=Ss,this.evWin=Ms,this.pressed=!1,je.apply(this,arguments);}k(yn,je,{handler:function(s){var m=Cs[s.type];m&U&&s.button===0&&(this.pressed=!0),m&dt&&s.which!==1&&(m=Ee),this.pressed&&(m&Ee&&(this.pressed=!1),this.callback(this.manager,m,{pointers:[s],changedPointers:[s],pointerType:cn,srcEvent:s}));}});var As={pointerdown:U,pointermove:dt,pointerup:Ee,pointercancel:we,pointerout:we},vs={2:ge,3:Ot,4:cn,5:Kt},mo="pointerdown",po="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(mo="MSPointerDown",po="MSPointerMove MSPointerUp MSPointerCancel");function yi(){this.evEl=mo,this.evWin=po,je.apply(this,arguments),this.store=this.manager.session.pointerEvents=[];}k(yi,je,{handler:function(s){var m=this.store,f=!1,O=s.type.toLowerCase().replace("ms",""),b=As[O],z=vs[s.pointerType]||s.pointerType,Ce=z==ge,Ne=nt(m,s.pointerId,"pointerId");b&U&&(s.button===0||Ce)?Ne<0&&(m.push(s),Ne=m.length-1):b&(Ee|we)&&(f=!0),!(Ne<0)&&(m[Ne]=s,this.callback(this.manager,b,{pointers:m,changedPointers:[s],pointerType:z,srcEvent:s}),f&&m.splice(Ne,1));}});var Os={touchstart:U,touchmove:dt,touchend:Ee,touchcancel:we},Ps="touchstart",Is="touchstart touchmove touchend touchcancel";function uo(){this.evTarget=Ps,this.evWin=Is,this.started=!1,je.apply(this,arguments);}k(uo,je,{handler:function(s){var m=Os[s.type];if(m===U&&(this.started=!0),!!this.started){var f=Ns.call(this,s,m);m&(Ee|we)&&f[0].length-f[1].length===0&&(this.started=!1),this.callback(this.manager,m,{pointers:f[0],changedPointers:f[1],pointerType:ge,srcEvent:s});}}});function Ns(a,s){var m=vt(a.touches),f=vt(a.changedTouches);return s&(Ee|we)&&(m=se(m.concat(f),"identifier",!0)),[m,f];}var Ts={touchstart:U,touchmove:dt,touchend:Ee,touchcancel:we},bs="touchstart touchmove touchend touchcancel";function Dn(){this.evTarget=bs,this.targetIds={},je.apply(this,arguments);}k(Dn,je,{handler:function(s){var m=Ts[s.type],f=ys.call(this,s,m);f&&this.callback(this.manager,m,{pointers:f[0],changedPointers:f[1],pointerType:ge,srcEvent:s});}});function ys(a,s){var m=vt(a.touches),f=this.targetIds;if(s&(U|dt)&&m.length===1)return f[m[0].identifier]=!0,[m,m];var O,b,z=vt(a.changedTouches),Ce=[],Ne=this.target;if(b=m.filter(function(Le){return ke(Le.target,Ne);}),s===U)for(O=0;O<b.length;)f[b[O].identifier]=!0,O++;for(O=0;O<z.length;)f[z[O].identifier]&&Ce.push(z[O]),s&(Ee|we)&&delete f[z[O].identifier],O++;if(Ce.length)return[se(b.concat(Ce),"identifier",!0),Ce];}var Ds=2500,go=25;function Di(){je.apply(this,arguments);var a=_e(this.handler,this);this.touch=new Dn(this.manager,a),this.mouse=new yn(this.manager,a),this.primaryTouch=null,this.lastTouches=[];}k(Di,je,{handler:function(s,m,f){var O=f.pointerType==ge,b=f.pointerType==cn;if(!(b&&f.sourceCapabilities&&f.sourceCapabilities.firesTouchEvents)){if(O)Rs.call(this,m,f);else if(b&&xs.call(this,f))return;this.callback(s,m,f);}},destroy:function(){this.touch.destroy(),this.mouse.destroy();}});function Rs(a,s){a&U?(this.primaryTouch=s.changedPointers[0].identifier,Eo.call(this,s)):a&(Ee|we)&&Eo.call(this,s);}function Eo(a){var s=a.changedPointers[0];if(s.identifier===this.primaryTouch){var m={x:s.clientX,y:s.clientY};this.lastTouches.push(m);var f=this.lastTouches,O=function(){var b=f.indexOf(m);b>-1&&f.splice(b,1);};setTimeout(O,Ds);}}function xs(a){for(var s=a.srcEvent.clientX,m=a.srcEvent.clientY,f=0;f<this.lastTouches.length;f++){var O=this.lastTouches[f],b=Math.abs(s-O.x),z=Math.abs(m-O.y);if(b<=go&&z<=go)return!0;}return!1;}var fo=M(r.style,"touchAction"),ho=fo!==e,Co="compute",So="auto",Ri="manipulation",Ht="none",gn="pan-x",En="pan-y",Rn=Vs();function xi(a,s){this.manager=a,this.set(s);}xi.prototype={set:function(a){a==Co&&(a=this.compute()),ho&&this.manager.element.style&&Rn[a]&&(this.manager.element.style[fo]=a),this.actions=a.toLowerCase().trim();},update:function(){this.set(this.manager.options.touchAction);},compute:function(){var a=[];return N(this.manager.recognizers,function(s){w(s.options.enable,[s])&&(a=a.concat(s.getTouchAction()));}),Fs(a.join(" "));},preventDefaults:function(a){var s=a.srcEvent,m=a.offsetDirection;if(this.manager.session.prevented){s.preventDefault();return;}var f=this.actions,O=We(f,Ht)&&!Rn[Ht],b=We(f,En)&&!Rn[En],z=We(f,gn)&&!Rn[gn];if(O){var Ce=a.pointers.length===1,Ne=a.distance<2,Le=a.deltaTime<250;if(Ce&&Ne&&Le)return;}if(!(z&&b)&&(O||b&&m&ct||z&&m&Ut))return this.preventSrc(s);},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault();}};function Fs(a){if(We(a,Ht))return Ht;var s=We(a,gn),m=We(a,En);return s&&m?Ht:s||m?s?gn:En:We(a,Ri)?Ri:So;}function Vs(){if(!ho)return!1;var a={},s=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(m){a[m]=s?t.CSS.supports("touch-action",m):!0;}),a;}var xn=1,Ye=2,Qt=4,Tt=8,Pt=Tt,fn=16,_t=32;function It(a){this.options=x({},this.defaults,a||{}),this.id=y(),this.manager=null,this.options.enable=ne(this.options.enable,!0),this.state=xn,this.simultaneous={},this.requireFail=[];}It.prototype={defaults:{},set:function(a){return x(this.options,a),this.manager&&this.manager.touchAction.update(),this;},recognizeWith:function(a){if(P(a,"recognizeWith",this))return this;var s=this.simultaneous;return a=Fn(a,this),s[a.id]||(s[a.id]=a,a.recognizeWith(this)),this;},dropRecognizeWith:function(a){return P(a,"dropRecognizeWith",this)?this:(a=Fn(a,this),delete this.simultaneous[a.id],this);},requireFailure:function(a){if(P(a,"requireFailure",this))return this;var s=this.requireFail;return a=Fn(a,this),nt(s,a)===-1&&(s.push(a),a.requireFailure(this)),this;},dropRequireFailure:function(a){if(P(a,"dropRequireFailure",this))return this;a=Fn(a,this);var s=nt(this.requireFail,a);return s>-1&&this.requireFail.splice(s,1),this;},hasRequireFailures:function(){return this.requireFail.length>0;},canRecognizeWith:function(a){return!!this.simultaneous[a.id];},emit:function(a){var s=this,m=this.state;function f(O){s.manager.emit(O,a);}m<Tt&&f(s.options.event+Mo(m)),f(s.options.event),a.additionalEvent&&f(a.additionalEvent),m>=Tt&&f(s.options.event+Mo(m));},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=_t;},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(_t|xn)))return!1;a++;}return!0;},recognize:function(a){var s=x({},a);if(!w(this.options.enable,[this,s])){this.reset(),this.state=_t;return;}this.state&(Pt|fn|_t)&&(this.state=xn),this.state=this.process(s),this.state&(Ye|Qt|Tt|fn)&&this.tryEmit(s);},process:function(a){},getTouchAction:function(){},reset:function(){}};function Mo(a){return a&fn?"cancel":a&Tt?"end":a&Qt?"move":a&Ye?"start":"";}function Ao(a){return a==un?"down":a==pn?"up":a==_n?"left":a==mn?"right":"";}function Fn(a,s){var m=s.manager;return m?m.get(a):a;}function it(){It.apply(this,arguments);}k(it,It,{defaults:{pointers:1},attrTest:function(a){var s=this.options.pointers;return s===0||a.pointers.length===s;},process:function(a){var s=this.state,m=a.eventType,f=s&(Ye|Qt),O=this.attrTest(a);return f&&(m&we||!O)?s|fn:f||O?m&Ee?s|Tt:s&Ye?s|Qt:Ye:_t;}});function Vn(){it.apply(this,arguments),this.pX=null,this.pY=null;}k(Vn,it,{defaults:{event:"pan",threshold:10,pointers:1,direction:ro},getTouchAction:function(){var a=this.options.direction,s=[];return a&ct&&s.push(En),a&Ut&&s.push(gn),s;},directionTest:function(a){var s=this.options,m=!0,f=a.distance,O=a.direction,b=a.deltaX,z=a.deltaY;return O&s.direction||(s.direction&ct?(O=b===0?Nn:b<0?_n:mn,m=b!=this.pX,f=Math.abs(a.deltaX)):(O=z===0?Nn:z<0?pn:un,m=z!=this.pY,f=Math.abs(a.deltaY))),a.direction=O,m&&f>s.threshold&&O&s.direction;},attrTest:function(a){return it.prototype.attrTest.call(this,a)&&(this.state&Ye||!(this.state&Ye)&&this.directionTest(a));},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var s=Ao(a.direction);s&&(a.additionalEvent=this.options.event+s),this._super.emit.call(this,a);}});function Fi(){it.apply(this,arguments);}k(Fi,it,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ht];},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&Ye);},emit:function(a){if(a.scale!==1){var s=a.scale<1?"in":"out";a.additionalEvent=this.options.event+s;}this._super.emit.call(this,a);}});function Vi(){It.apply(this,arguments),this._timer=null,this._input=null;}k(Vi,It,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[So];},process:function(a){var s=this.options,m=a.pointers.length===s.pointers,f=a.distance<s.threshold,O=a.deltaTime>s.time;if(this._input=a,!f||!m||a.eventType&(Ee|we)&&!O)this.reset();else if(a.eventType&U)this.reset(),this._timer=S(function(){this.state=Pt,this.tryEmit();},s.time,this);else if(a.eventType&Ee)return Pt;return _t;},reset:function(){clearTimeout(this._timer);},emit:function(a){this.state===Pt&&(a&&a.eventType&Ee?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=E(),this.manager.emit(this.options.event,this._input)));}});function Li(){it.apply(this,arguments);}k(Li,it,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ht];},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&Ye);}});function wi(){it.apply(this,arguments);}k(wi,it,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ct|Ut,pointers:1},getTouchAction:function(){return Vn.prototype.getTouchAction.call(this);},attrTest:function(a){var s=this.options.direction,m;return s&(ct|Ut)?m=a.overallVelocity:s&ct?m=a.overallVelocityX:s&Ut&&(m=a.overallVelocityY),this._super.attrTest.call(this,a)&&s&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&p(m)>this.options.velocity&&a.eventType&Ee;},emit:function(a){var s=Ao(a.offsetDirection);s&&this.manager.emit(this.options.event+s,a),this.manager.emit(this.options.event,a);}});function Ln(){It.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0;}k(Ln,It,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ri];},process:function(a){var s=this.options,m=a.pointers.length===s.pointers,f=a.distance<s.threshold,O=a.deltaTime<s.time;if(this.reset(),a.eventType&U&&this.count===0)return this.failTimeout();if(f&&O&&m){if(a.eventType!=Ee)return this.failTimeout();var b=this.pTime?a.timeStamp-this.pTime<s.interval:!0,z=!this.pCenter||bn(this.pCenter,a.center)<s.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,!z||!b?this.count=1:this.count+=1,this._input=a;var Ce=this.count%s.taps;if(Ce===0)return this.hasRequireFailures()?(this._timer=S(function(){this.state=Pt,this.tryEmit();},s.interval,this),Ye):Pt;}return _t;},failTimeout:function(){return this._timer=S(function(){this.state=_t;},this.options.interval,this),_t;},reset:function(){clearTimeout(this._timer);},emit:function(){this.state==Pt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input));}});function Nt(a,s){return s=s||{},s.recognizers=ne(s.recognizers,Nt.defaults.preset),new Gi(a,s);}Nt.VERSION="2.0.7",Nt.defaults={domEvents:!1,touchAction:Co,enable:!0,inputTarget:null,inputClass:null,preset:[[Li,{enable:!1}],[Fi,{enable:!1},["rotate"]],[wi,{direction:ct}],[Vn,{direction:ct},["swipe"]],[Ln],[Ln,{event:"doubletap",taps:2},["tap"]],[Vi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ls=1,vo=2;function Gi(a,s){this.options=x({},Nt.defaults,s||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=ms(this),this.touchAction=new xi(this,this.options.touchAction),Oo(this,!0),N(this.options.recognizers,function(m){var f=this.add(new m[0](m[1]));m[2]&&f.recognizeWith(m[2]),m[3]&&f.requireFailure(m[3]);},this);}Gi.prototype={set:function(a){return x(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this;},stop:function(a){this.session.stopped=a?vo:Ls;},recognize:function(a){var s=this.session;if(!s.stopped){this.touchAction.preventDefaults(a);var m,f=this.recognizers,O=s.curRecognizer;(!O||O&&O.state&Pt)&&(O=s.curRecognizer=null);for(var b=0;b<f.length;)m=f[b],s.stopped!==vo&&(!O||m==O||m.canRecognizeWith(O))?m.recognize(a):m.reset(),!O&&m.state&(Ye|Qt|Tt)&&(O=s.curRecognizer=m),b++;}},get:function(a){if(a instanceof It)return a;for(var s=this.recognizers,m=0;m<s.length;m++)if(s[m].options.event==a)return s[m];return null;},add:function(a){if(P(a,"add",this))return this;var s=this.get(a.options.event);return s&&this.remove(s),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a;},remove:function(a){if(P(a,"remove",this))return this;if(a=this.get(a),a){var s=this.recognizers,m=nt(s,a);m!==-1&&(s.splice(m,1),this.touchAction.update());}return this;},on:function(a,s){if(a!==e&&s!==e){var m=this.handlers;return N(tt(a),function(f){m[f]=m[f]||[],m[f].push(s);}),this;}},off:function(a,s){if(a!==e){var m=this.handlers;return N(tt(a),function(f){s?m[f]&&m[f].splice(nt(m[f],s),1):delete m[f];}),this;}},emit:function(a,s){this.options.domEvents&&ws(a,s);var m=this.handlers[a]&&this.handlers[a].slice();if(!(!m||!m.length)){s.type=a,s.preventDefault=function(){s.srcEvent.preventDefault();};for(var f=0;f<m.length;)m[f](s),f++;}},destroy:function(){this.element&&Oo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null;}};function Oo(a,s){var m=a.element;if(m.style){var f;N(a.options.cssProps,function(O,b){f=M(m.style,b),s?(a.oldCssProps[f]=m.style[f],m.style[f]=O):m.style[f]=a.oldCssProps[f]||"";}),s||(a.oldCssProps={});}}function ws(a,s){var m=i.createEvent("Event");m.initEvent(a,!0,!0),m.gesture=s,s.target.dispatchEvent(m);}x(Nt,{INPUT_START:U,INPUT_MOVE:dt,INPUT_END:Ee,INPUT_CANCEL:we,STATE_POSSIBLE:xn,STATE_BEGAN:Ye,STATE_CHANGED:Qt,STATE_ENDED:Tt,STATE_RECOGNIZED:Pt,STATE_CANCELLED:fn,STATE_FAILED:_t,DIRECTION_NONE:Nn,DIRECTION_LEFT:_n,DIRECTION_RIGHT:mn,DIRECTION_UP:pn,DIRECTION_DOWN:un,DIRECTION_HORIZONTAL:ct,DIRECTION_VERTICAL:Ut,DIRECTION_ALL:ro,Manager:Gi,Input:je,TouchAction:xi,TouchInput:Dn,MouseInput:yn,PointerEventInput:yi,TouchMouseInput:Di,SingleTouchInput:uo,Recognizer:It,AttrRecognizer:it,Tap:Ln,Pan:Vn,Swipe:wi,Pinch:Fi,Rotate:Li,Press:Vi,on:Be,off:Xe,each:N,merge:H,extend:W,assign:x,inherit:k,bindFn:_e,prefixed:M});var Gs=typeof t<"u"?t:typeof self<"u"?self:{};Gs.Hammer=Nt,typeof define=="function"&&define.amd?define(function(){return Nt;}):typeof Ii<"u"&&Ii.exports?Ii.exports=Nt:t[o]=Nt;})(window,document,"Hammer");});var Ci=(()=>{let i=class i{config=A(_r);constructor(){this.config.setTranslation({dayNames:["vas\xE1rnap","h\xE9tf\u0151","kedd","szerda","cs\xFCt\xF6rt\xF6k","p\xE9ntek","szombat"],dayNamesShort:["V","H","K","Sze","Cs","P","Szo"],dayNamesMin:["V","H","K","Sz","Cs","P","Sz"],monthNames:["janu\xE1r","febru\xE1r","m\xE1rcius","\xE1prilis","m\xE1jus","j\xFAnius","j\xFAlius","augusztus","szeptember","okt\xF3ber","november","december"],monthNamesShort:["jan.","feb.","m\xE1r.","\xE1pr.","m\xE1j.","j\xFAn.","j\xFAl.","aug.","szept.","okt.","nov.","dec."],today:"Ma",clear:"T\xF6rl\xE9s"});}getTimezone(){let e=new Date().toString().match(/([A-Z]+[+-][0-9]+)/)[1];return`${Intl.DateTimeFormat().resolvedOptions().timeZone} - ${e}`;}getDateFormat(){return"yyyy. mm. dd.";}getVideoPublicationYearRange(){return"1880:"+new Date().getFullYear();}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275prov",pt({token:i,factory:i.ɵfac}));let t=i;return t;})();var Si=class extends hi{getFileUrl(){return $(this,null,function*(){let i={"X-Upload-Content-Length":this.size.toString(),"X-Upload-Content-Type":this.file.type||"application/octet-stream"},o=this.metadata.previewfile;delete this.metadata.previewfile;let e=ni(this.metadata);o!==void 0&&(e.append("previewfile",o,o.name),e.append("thumbnailfile",o,o.name)),yield this.request({method:"POST",body:e,url:this.endpoint,headers:i});let n=this.getValueFromResponse("location");if(!n)throw new Error("Invalid or missing Location header");return this.offset=this.responseStatus===201?0:void 0,Rr(n,this.endpoint);});}};var Mi=(()=>{let i=class i{server=A(ie);notifier=A(Ue);authService=A(oi);getVideoExtensions(){return this.server.getHTMLConfig().video.file.extensions;}checkQuotaAndNotify(e,n,r){let d=new ci();if(n!==-1&&r+e.size>n){let u=d.transform(e.size,0),p=d.transform(r,0),E=d.transform(n,0),S="Ezzel a vide\xF3val t\xFAll\xE9pte a vide\xF3kv\xF3t\xE1j\xE1t (vide\xF3 m\xE9rete: "+u+", felhaszn\xE1lva: "+p+", kv\xF3ta: "+E+")";return this.notifier.error(S),!1;}return!0;}isAudioFile(e){return[".mp3",".flac",".ogg",".wma",".wav"].some(r=>e.endsWith(r));}getNewVideoUploadxOptions(){return this.getUploadxOptions(Fe.BASE_VIDEO_URL+"/upload-resumable",Si);}getReplaceUploadxOptions(e){return this.getUploadxOptions(Fe.BASE_VIDEO_URL+"/"+e+"/source/replace-resumable",hi);}getUploadxOptions(e,n){return{endpoint:e,multiple:!1,maxChunkSize:this.server.getHTMLConfig().client.videos.resumableUpload.maxChunkSize,token:this.authService.getAccessToken(),uploaderClass:n,retryConfig:gr()};}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275prov",pt({token:i,factory:i.ɵfac}));let t=i;return t;})();var Hr=(()=>{let i=class i{authHttp=A(jn);restExtractor=A(ii);editVideo(e,n){let r=Fe.BASE_VIDEO_URL+"/"+e+"/studio/edit",u=ni({tasks:n});return this.authHttp.post(r,u).pipe(kt(p=>this.restExtractor.handleError(p)));}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275prov",pt({token:i,factory:i.ɵfac}));let t=i;return t;})();var kr=qe(ht());var lt=(0,kr.default)("peertube:video-manage"),ae=(()=>{let i=class i{loadingBar=A(cr);videoService=A(Fe);videoCaptionService=A(_i);videoChapterService=A(Gr);liveVideoService=A(Yt);videoPasswordService=A(Ir);notifier=A(Ue);videoUploadService=A(Mi);auth=A(oi);confirmService=A(nn);resumableUploadService=A(xr);formReactiveService=A(he);videoStudio=A(Hr);peertubeRouter=A(ri);videoEdit;userChannels;userQuota;privacies;manageType;serverConfig;uploadingVideo=!1;videoUploaded=!1;videoUploadPercents;uploadError;retryUploadFn;isUpdatingVideo=!1;videoUploadedSubject=new wn();alreadyRefreshedToken=!1;embedVersion=1;uploadServiceSubscription;pendingUpdateObs;updatedSubject=new wn();formErrors=[];saveHook;constructor(){lt("Building video manage controller service"),this.resetUploadState(),this.uploadServiceSubscription=this.resumableUploadService.events.subscribe(e=>this.onUploadVideoOngoing(e));}ngOnDestroy(){lt("Destroying video manage controller service"),this.resumableUploadService.disconnect(),this.uploadServiceSubscription?.unsubscribe();}reset(){this.manageType=void 0,this.serverConfig=void 0,this.videoEdit=void 0,this.userChannels=void 0,this.userQuota=void 0,this.privacies=void 0;}setConfig(e){this.manageType=e.manageType,this.serverConfig=e.serverConfig;}getConfig(){let e=this.videoEdit.getVideoAttributes(),n=new Set(["import-torrent","import-url","upload"]).has(this.manageType);return{manageType:this.manageType,displayTranscriptionInfo:n,hideWaitTranscoding:!n&&(e.isLive||e.state!==xe.TO_TRANSCODE),forbidScheduledPublication:this.getForbidScheduledPublication()};}getForbidScheduledPublication(){return this.manageType==="upload"?!1:this.manageType==="update"&&this.videoEdit.getVideoAttributes().privacy!==$e.PRIVATE;}setStore(e){this.videoEdit=e.videoEdit,this.userChannels=e.userChannels,this.userQuota=e.userQuota,this.privacies=e.privacies;}setVideoEdit(e){this.videoEdit=e;}getStore(){return{videoEdit:this.videoEdit,userChannels:this.userChannels,privacies:this.privacies};}setFormError(e,n,r){let d=this.formReactiveService.grabAllErrors(r);this.formErrors=this.formErrors.filter(u=>u.page!==e),d.length!==0&&this.formErrors.push({page:e,path:n,errors:d});}getFormErrors(){return this.formErrors;}hasFormErrors(){return this.formErrors.some(({errors:e})=>e.length!==0);}getEmbedVersion(){return this.embedVersion;}registerSaveHook(e){this.saveHook=e;}unregisterSaveHook(){this.saveHook=void 0;}runSaveHook(){return this.saveHook?this.saveHook():Promise.resolve();}hasPendingChanges(){return this.videoEdit.hasPendingChanges();}hasStudioTasks(){return this.videoEdit.hasStudioTasks();}hasReplaceFile(){return this.videoEdit.hasReplaceFile();}isUpdating(){return this.isUpdatingVideo;}getUpdatedObs(){return this.updatedSubject.asObservable();}updateVideo(){if(this.isUpdatingVideo===!0)return;this.cancelUploadIfNeeded(),this.loadingBar.useRef().start(),this.isUpdatingVideo=!0;let e=this.videoEdit.getVideoAttributes(),n=!!this.videoEdit.getLive();return this.pendingUpdateObs=this.videoUploadedSubject.pipe($i(()=>this.videoEdit.resetReplaceFile()),bt(()=>n||!this.videoEdit.hasCaptionChanges()?Ze(!0):(lt("Update captions"),this.videoCaptionService.updateCaptions(e.uuid,this.videoEdit.getCaptionsEdit()))),bt(()=>n||!this.videoEdit.hasChaptersChanges()?Ze(!0):(lt("Update chapters"),this.videoChapterService.updateChapters(e.uuid,this.videoEdit.getChaptersEdit()))),bt(()=>!n||!this.videoEdit.hasLiveChanges()?Ze(!0):(lt("Update live"),this.liveVideoService.updateLive(e.uuid,this.videoEdit.toLiveUpdate()))),bt(()=>(lt("Update video"),this.videoService.updateVideo(e.uuid,this.videoEdit.toVideoUpdate()))),bt(()=>this.videoEdit.hasStudioTasks()?(lt("Run studio tasks"),this.videoStudio.editVideo(e.uuid,this.videoEdit.getStudioTasks()).pipe($i(()=>this.videoEdit.resetStudio()))):Ze(!0)),bt(()=>Gn([this.videoService.getVideo({videoId:e.uuid}),this.videoEdit.getVideoAttributes().privacy===$e.PASSWORD_PROTECTED?this.videoPasswordService.getVideoPasswords({videoUUID:e.uuid}):Ze([]),n?this.liveVideoService.getVideoLive(e.uuid):Ze(void 0),n?Ze(void 0):this.videoChapterService.getChapters({videoId:e.uuid}),n?Ze(void 0):this.videoCaptionService.listCaptions(e.uuid)])),bt(([r,d,u,p,E])=>this.videoEdit.loadFromAPI({video:r,videoPasswords:d.map(S=>S.password),live:u,chapters:p?.chapters,captions:E?.data})),To(),No(()=>{lt("Update complete"),this.videoEdit.onSave(),this.loadingBar.useRef().complete(),this.isUpdatingVideo=!1,this.updatedSubject.next(),this.embedVersion++;})),setTimeout(()=>this.replaceFileIfNeeded()),this.pendingUpdateObs;}replaceFileIfNeeded(){if(!this.videoEdit.hasReplaceFile()){lt("No file to replace"),this.videoUploadedSubject.next();return;}lt("Upload file replacement"),this.uploadFileReplacement(this.videoEdit.getReplaceFile());}uploadFileReplacement(e){this.uploadingVideo=!0,this.retryUploadFn=()=>this.uploadFileReplacement(e);let n={filename:e.name};this.resumableUploadService.handleFiles(e,fe(Z({},this.videoUploadService.getReplaceUploadxOptions(this.videoEdit.getVideoAttributes().uuid)),{metadata:n}));}cancelUploadIfNeeded(){this.uploadingVideo&&this.resumableUploadService.control({action:"cancel"}),this.videoUploadedSubject=new wn(),this.pendingUpdateObs=void 0,this.loadingBar.useRef().complete(),this.resetUploadState();}retryUpload(){this.retryUploadFn();}checkAndConfirmVideoFileReplacement(){return $(this,null,function*(){if(!this.videoEdit.hasReplaceFile())return!0;if(this.videoEdit.hasStudioTasks())return this.notifier.error("You cannot replace the video file and also have studio tasks."),!1;let e=this.videoEdit.getReplaceFile();if(!this.checkUserQuota(e))return!1;let n=this.videoEdit.getVideoAttributes(),r=this.serverConfig.autoBlacklist.videos.ofUsers.enabled===!0&&!n.blacklisted,d="";r&&(d=" "+"A vide\xF3ja automatikusan blokkolva lesz, mert a vide\xF3 k\xF6zz\xE9t\xE9tel\xE9hez egy moder\xE1tor k\xE9zi j\xF3v\xE1hagy\xE1s\xE1ra van sz\xFCks\xE9g.");let u="A vide\xF3 \xFAj verzi\xF3j\xE1nak felt\xF6lt\xE9se teljesen t\xF6rli a jelenlegi verzi\xF3t."+d+" "+"<br /><br />Biztos, hogy lecser\xE9li a vide\xF3f\xE1jlj\xE1t?";return(yield this.confirmService.confirm(u,"F\xE1jllecser\xE9l\xE9si figyelmeztet\xE9s"))!==!1;});}checkAndConfirmStudioTasks(){return $(this,null,function*(){if(!this.videoEdit.hasStudioTasks())return!0;let e="Are you sure you want to create studio tasks for \""+this.videoEdit.getVideoAttributes().name+"\"?",n=this.videoEdit.getStudioTasksSummary().map(d=>`<li>${d}</li>`).join(""),r="A jelenlegi vide\xF3 fel\xFCl lesz \xEDrva ezzel a szerkesztett vide\xF3val, <strong>nem fogja tudni helyre\xE1ll\xEDtani</strong>.<br /><br />"+("Eml\xE9keztet\u0151k\xE9ppen, a k\xF6vetkez\u0151 feladatok lesznek v\xE9grehajtva: <ol>"+n+"</ol>");return(yield this.confirmService.confirm(r,e))===!0;});}checkUserQuota(e){let n=this.auth.getUser();return!(!this.videoUploadService.checkQuotaAndNotify(e,n.videoQuota,this.userQuota.videoQuotaUsed)||!this.videoUploadService.checkQuotaAndNotify(e,n.videoQuotaDaily,this.userQuota.videoQuotaUsedDaily));}silentRedirectOnManage(e,n){this.peertubeRouter.silentNavigate(["."],{publishedId:e,uploading:null},n);}silentRedirectOnUploading(e){this.peertubeRouter.silentNavigate(["."],{publishedId:null,uploading:"true"},e);}silentRedirectOnAbortUpload(e){this.peertubeRouter.silentNavigate(["."],{publishedId:null,uploading:null},e);}uploadNewVideo(e){this.resetUploadState(),this.uploadingVideo=!0,this.retryUploadFn=()=>this.uploadNewVideo(e);let n=fe(Z({},this.videoEdit.toVideoCreate(e.privacy)),{filename:e.file.name,previewfile:e.previewfile});this.resumableUploadService.handleFiles(e.file,fe(Z({},this.videoUploadService.getNewVideoUploadxOptions()),{metadata:n}));}resetUploadState(){this.videoUploaded=!1,this.uploadingVideo=!1,this.videoUploadPercents=0,this.uploadError="";}getUploadEventsObs(){return this.resumableUploadService.events;}getUploadPercents(){return this.videoUploadPercents;}getUploadError(){return this.uploadError;}isUploadingFile(){return this.uploadingVideo;}hasUploadedFile(){return this.videoUploaded;}onUploadVideoOngoing(e){switch(lt("Upload state update",e),e.status){case"error":{if(!this.alreadyRefreshedToken&&e.responseStatus===Zn.UNAUTHORIZED_401)return this.alreadyRefreshedToken=!0,this.refreshTokenAndRetryUpload();this.handleUploadError(Er(e));break;}case"cancelled":this.uploadingVideo=!1,this.videoUploadPercents=0,this.uploadError="";break;case"uploading":this.videoUploadPercents=e.progress||0;break;case"paused":this.notifier.info("Felt\xF6lt\xE9s v\xE1rakozik");break;case"complete":this.uploadingVideo=!1,this.videoUploadPercents=100,this.videoUploaded=!0,this.videoUploadedSubject.next();break;}}handleUploadError(e){this.videoUploadPercents=0,this.uploadingVideo=!1,this.uploadError=ur({err:e,name:"vide\xF3"}),this.videoUploadedSubject.error(e);}refreshTokenAndRetryUpload(){this.auth.refreshAccessToken().subscribe(()=>this.retryUploadFn());}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275prov",pt({token:i,factory:i.ɵfac}));let t=i;return t;})();var Qr=qe(ht());var zr={VALIDATORS:[ee.required],MESSAGES:{required:"A vide\xF3felirat nyelv\xE9nek megad\xE1sa k\xF6telez\u0151."}},Br={VALIDATORS:[ee.required],MESSAGES:{required:"A vide\xF3felirat-f\xE1jl megad\xE1sa k\xF6telez\u0151."}},Xr={VALIDATORS:[ee.required],MESSAGES:{required:"A felirattartalom k\xF6telez\u0151."}};var $s=["modal"];function Us(t,i){if(t&1&&(c(0,"div",19),R(1),l()),t&2){let o=h(2);_(),ue(" ",o.formErrors.language," ");}}function Hs(t,i){t&1&&(c(0,"div",20),C(1,3),l());}function ks(t,i){if(t&1){let o=q();B(0,4),c(1,"div",5)(2,"h4",6),C(3,1),l(),c(4,"button",7),L("click",function(){F(o);let n=h();return V(n.hide());}),v(5,"my-global-icon",8),l()(),c(6,"div",9)(7,"label",10),C(8,2),l(),v(9,"my-select-options",11),I(10,Us,2,1,"div",12),c(11,"div",13),v(12,"my-reactive-file",14),l(),I(13,Hs,2,0,"div",15),l(),c(14,"div",16)(15,"input",17),L("click",function(){F(o);let n=h();return V(n.hide());})("key.enter",function(){F(o);let n=h();return V(n.hide());}),l(),c(16,"input",18),L("click",function(){F(o);let n=h();return V(n.addCaption());}),l()(),X();}if(t&2){let o=h();g("formGroup",o.form),_(9),g("items",o.videoCaptionLanguages),_(),g("ngIf",o.formErrors.language),_(2),g("extensions",o.videoCaptionExtensions)("maxFileSize",o.videoCaptionMaxSize)("displayFilename",!0)("buttonTooltip",o.getReactiveFileButtonTooltip()),_(),g("ngIf",o.isReplacingExistingCaption()),_(3),g("disabled",!o.form.valid);}}var Wr=(()=>{let i=class i extends si{formReactiveService=A(he);modalService=A(ei);serverService=A(ie);existingCaptions=Te(void 0);serverConfig=Te(void 0);captionAdded=Jt();modal=ot("modal");videoCaptionLanguages=[];openedModal;get videoCaptionExtensions(){return this.serverConfig().videoCaption.file.extensions;}get videoCaptionMaxSize(){return this.serverConfig().videoCaption.file.size.max;}getReactiveFileButtonTooltip(){return`(extensions: ${this.videoCaptionExtensions.join(", ")})`;}ngOnInit(){this.serverService.getVideoLanguages().subscribe(e=>this.videoCaptionLanguages=e),this.buildForm({language:zr,captionfile:Br});}show(){this.openedModal=this.modalService.open(this.modal(),{centered:!0,keyboard:!1});}hide(){this.openedModal.close(),this.form.reset();}isReplacingExistingCaption(){let e=this.form.value.language;return e&&this.existingCaptions().includes(e);}addCaption(){let e=this.form.value.language,n=this.videoCaptionLanguages.find(r=>r.id===e);this.captionAdded.emit({language:n,captionfile:this.form.value.captionfile,action:"CREATE"}),this.hide();}};T(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=$n(i)))(r||i);};})()),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-caption-add-modal"]],viewQuery:function(n,r){n&1&&rt(r.modal,$s,5),n&2&&Dt();},inputs:{existingCaptions:[1,"existingCaptions"],serverConfig:[1,"serverConfig"]},outputs:{captionAdded:"captionAdded"},features:[Hn],decls:2,vars:0,consts:()=>{let e;e="Felugr\xF3 ablak bez\xE1r\xE1sa";let n;n="A feliratf\xE1jl kiv\xE1laszt\xE1sa";let r;r="M\xE9gse";let d;d="Felirat hozz\xE1ad\xE1sa";let u;u="Felirat hozz\xE1ad\xE1sa";let p;p="Nyelv";let E;return E="Ez lecser\xE9li a megl\xE9v\u0151 feliratot!",[["modal",""],u,p,E,[3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["for","language"],["inputId","language","formControlName","language","clearable","true","filter","true","virtualScroll","true",3,"items"],["class","form-error","role","alert",4,"ngIf"],[1,"caption-file"],["formControlName","captionfile","inputName","captionfile","inputLabel",n,3,"extensions","maxFileSize","displayFilename","buttonTooltip"],["class","warning-replace-caption",4,"ngIf"],[1,"modal-footer","inputs"],["type","button","role","button","value",r,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",d,1,"peertube-button","primary-button",3,"click","disabled"],["role","alert",1,"form-error"],[1,"warning-replace-caption"]];},template:function(n,r){n&1&&I(0,ks,17,9,"ng-template",null,0,at);},dependencies:[J,Pe,ye,te,De,Re,oe,Q,Vt,Ft],styles:[`.caption-file[_ngcontent-%COMP%]{margin-top:20px;width:max-content}.caption-file[_ngcontent-%COMP%]     .root{width:max-content}.warning-replace-caption[_ngcontent-%COMP%]{color:var(--red);margin-top:10px}
/*# sourceMappingURL=video-caption-add-modal.component-4D3RJFIY.css.map */`]}));let t=i;return t;})();var qr=qe(Yr());var Ai=class{eventRegistrations={};bindToChannel(i){for(let o of Object.keys(this.eventRegistrations))i.bind(o,(e,n)=>this.fire(o,n));}registerTypes(i){for(let o of i)this.eventRegistrations[o]={registrations:[]};}fire(i,o){this.eventRegistrations[i].registrations.forEach(e=>e(o));}addListener(i,o){return this.eventRegistrations[i]?(this.eventRegistrations[i].registrations.push(o),!0):(console.warn(`PeerTube: addEventListener(): The event '${i}' is not supported`),!1);}removeListener(i,o){return this.eventRegistrations[i]?(this.eventRegistrations[i].registrations=this.eventRegistrations[i].registrations.filter(e=>e!==o),!0):!1;}};var zs=["pause","play","playbackStatusUpdate","playbackStatusChange","resolutionUpdate","volumeChange"],qt=class{embedElement;scope;eventRegistrar=new Ai();channel;readyPromise;constructor(i,o){this.embedElement=i,this.scope=o,this.eventRegistrar.registerTypes(zs),this.constructChannel(),this.prepareToBeReady();}destroy(){this.embedElement.remove();}addEventListener(i,o){return this.eventRegistrar.addListener(i,o);}removeEventListener(i,o){return this.eventRegistrar.removeListener(i,o);}get ready(){return this.readyPromise;}isPlaying(){return $(this,null,function*(){return this.sendMessage("isPlaying");});}play(){return $(this,null,function*(){yield this.sendMessage("play");});}pause(){return $(this,null,function*(){yield this.sendMessage("pause");});}setVolume(i){return $(this,null,function*(){yield this.sendMessage("setVolume",i);});}getVolume(){return $(this,null,function*(){return this.sendMessage("getVolume");});}setCaption(i){return $(this,null,function*(){yield this.sendMessage("setCaption",i);});}getCaptions(){return $(this,null,function*(){return this.sendMessage("getCaptions");});}getCurrentTime(){return $(this,null,function*(){return this.sendMessage("getCurrentTime");});}seek(i){return $(this,null,function*(){yield this.sendMessage("seek",i);});}setResolution(i){return $(this,null,function*(){yield this.sendMessage("setResolution",i);});}getResolutions(){return $(this,null,function*(){return this.sendMessage("getResolutions");});}getPlaybackRates(){return $(this,null,function*(){return this.sendMessage("getPlaybackRates");});}getPlaybackRate(){return $(this,null,function*(){return this.sendMessage("getPlaybackRate");});}setPlaybackRate(i){return $(this,null,function*(){yield this.sendMessage("setPlaybackRate",i);});}playNextVideo(){return $(this,null,function*(){yield this.sendMessage("playNextVideo");});}playPreviousVideo(){return $(this,null,function*(){yield this.sendMessage("playPreviousVideo");});}getCurrentPosition(){return $(this,null,function*(){return this.sendMessage("getCurrentPosition");});}setVideoPassword(i){return $(this,null,function*(){yield this.sendMessage("setVideoPassword",i);});}getImageDataUrl(){return $(this,null,function*(){return this.sendMessage("getImageDataUrl");});}constructChannel(){this.channel=qr.build({window:this.embedElement.contentWindow,origin:"*",scope:this.scope||"peertube"}),this.eventRegistrar.bindToChannel(this.channel);}prepareToBeReady(){let i,o;this.readyPromise=new Promise((e,n)=>{i=e,o=n;}),this.channel.bind("ready",e=>e?i():o()),this.channel.call({method:"isReady",success:e=>e?i():null});}sendMessage(i,o){return new Promise((e,n)=>{this.channel.call({method:i,params:o,success:r=>e(r),error:r=>n(r)});});}};window.PeerTubePlayer=qt;var Bs=["textarea"],Xs=["embed"],Ws=["modal"],js=()=>[import("./chunk-5UGEIQQZ.js").then(t=>t.EditButtonComponent),import("./chunk-BEQO2ESQ.js").then(t=>t.DeleteButtonComponent)],Ys=t=>({"input-error":t}),qs=t=>({active:t}),Zs=t=>({"opacity-0":t}),Ks=(t,i)=>i.id;function Qs(t,i){if(t&1&&v(0,"my-embed",26,2),t&2){let o=h(2);g("video",o.videoEdit.getVideoAttributes());}}function Js(t,i){if(t&1){let o=q();c(0,"my-button",27),L("click",function(){F(o);let n=h(2);return V(n.addSegmentToEdit());}),l();}}function el(t,i){if(t&1&&(c(0,"div",28),R(1),l()),t&2){let o=h(2);_(),ue(" ",o.formErrors.captionFileContent," ");}}function tl(t,i){if(t&1){let o=q();c(0,"my-button",46),L("click",function(){F(o);let n=h(2).$implicit,r=h(2);return V(r.videoTimeForSegmentStart(n));}),l();}}function nl(t,i){if(t&1){let o=q();c(0,"my-button",47),L("click",function(){F(o);let n=h(2).$implicit,r=h(2);return V(r.videoTimeForSegmentEnd(n));}),l();}}function il(t,i){if(t&1&&(c(0,"div",28),R(1),l()),t&2){let o=h(4);_(),Y(o.segmentEditError);}}function ol(t,i){if(t&1){let o=q();c(0,"div",29)(1,"div",31)(2,"div")(3,"label",32),C(4,4),l(),c(5,"my-timestamp-input",33),Xt("ngModelChange",function(n){F(o);let r=h().$implicit;return Bt(r.startMs,n)||(r.startMs=n),V(n);}),l(),I(6,tl,1,0,"my-button",34),l(),v(7,"my-global-icon",35),c(8,"div")(9,"label",36),C(10,5),l(),c(11,"my-timestamp-input",37),Xt("ngModelChange",function(n){F(o);let r=h().$implicit;return Bt(r.endMs,n)||(r.endMs=n),V(n);}),l(),I(12,nl,1,0,"my-button",38),l()(),c(13,"div",39)(14,"div",40)(15,"label",41),C(16,6),l(),c(17,"textarea",42),Xt("ngModelChange",function(n){F(o);let r=h().$implicit;return Bt(r.text,n)||(r.text=n),V(n);}),l(),I(18,il,2,1,"div",20),l(),c(19,"div",43)(20,"my-button",44),L("click",function(){F(o);let n=h().$implicit,r=h(2);return V(r.onEditSaved(n));}),l(),c(21,"my-button",45),L("click",function(){F(o);let n=h().$implicit,r=h(2);return V(r.onEditCanceled(n));}),l()()()();}if(t&2){let o=h().$implicit,e=h(2);_(5),g("maxTimestamp",(e.videoEdit.getVideoAttributes().duration||0)*1e3),zt("ngModel",o.startMs),g("parser",e.timestampParser)("formatter",e.timestampFormatter),_(),g("ngIf",e.videoEdit.isPublishedVOD()),_(5),g("maxTimestamp",(e.videoEdit.getVideoAttributes().duration||0)*1e3),zt("ngModel",o.endMs),g("parser",e.timestampParser)("formatter",e.timestampFormatter),_(),g("ngIf",e.videoEdit.isPublishedVOD()),_(5),zt("ngModel",o.text),_(),g("ngIf",e.segmentEditError);}}function rl(t,i){if(t&1){let o=q();c(0,"my-edit-button",52),L("click",function(){F(o);let n=h(2).$implicit,r=h(2);return V(r.updateSegment(n));}),l(),c(1,"my-delete-button",53),L("click",function(){F(o);let n=h(2).$implicit,r=h(2);return V(r.deleteSegment(n));}),l();}}function al(t,i){t&1&&v(0,"div",54);}function sl(t,i){if(t&1){let o=q();c(0,"div",30)(1,"div",48),L("keyup.enter",function(n){F(o);let r=h().$implicit,d=h(2);return V(d.onSegmentClick(n,r));})("click",function(n){F(o);let r=h().$implicit,d=h(2);return V(d.onSegmentClick(n,r));}),c(2,"strong",49),R(3),l(),c(4,"span",50),R(5),l()(),c(6,"div",51),I(7,rl,2,0)(8,al,1,0),Lo(9,7,js,null,8),wo(0,-1),l()();}if(t&2){let o=h().$implicit,e=h(2);_(),g("ngClass",be(5,qs,o===e.activeSegment)),_(2),ko("",o.startFormatted," -> ",o.endFormatted,""),_(2),Y(o.text),_(),g("ngClass",be(7,Zs,!!e.segmentToUpdate));}}function ll(t,i){if(t&1&&(c(0,"div",22),I(1,ol,22,12,"div",29)(2,sl,11,9,"div",30),l()),t&2){let o=i.$implicit,e=h(2);_(),K(e.segmentToUpdate===o?1:2);}}function dl(t,i){if(t&1){let o=q();c(0,"div",7)(1,"h4",8),C(2,3),l(),c(3,"button",9),L("click",function(){F(o);let n=h();return V(n.hide());}),v(4,"my-global-icon",10),l()(),c(5,"div",11)(6,"div",12),I(7,Qs,2,1,"my-embed",13),c(8,"div",14)(9,"div",15)(10,"my-peertube-checkbox",16),Xt("ngModelChange",function(n){F(o);let r=h();return Bt(r.rawEdit,n)||(r.rawEdit=n),V(n);}),L("ngModelChange",function(){F(o);let n=h();return V(n.onRawEditSwitch());}),l(),I(11,Js,1,0,"my-button",17),l(),c(12,"div",18)(13,"textarea",19,1),R(15,"          "),l(),I(16,el,2,1,"div",20),l(),c(17,"div",21),hn(18,ll,3,1,"div",22,Ks),l()()()(),c(20,"div",23)(21,"input",24),L("click",function(){F(o);let n=h();return V(n.hide());})("key.enter",function(){F(o);let n=h();return V(n.hide());}),l(),c(22,"input",25),L("click",function(){F(o);let n=h();return V(n.updateCaption());}),l()();}if(t&2){let o=h();_(2),Ae(o.videoCaption.language.label),ve(2),_(5),g("ngIf",o.videoEdit.isPublishedVOD()),_(),g("ngClass",o.videoEdit.isPublishedVOD()?"col-xl-6 col-md-12":""),_(2),zt("ngModel",o.rawEdit),_(),g("ngIf",!o.rawEdit&&!o.segmentToUpdate),_(),g("hidden",!o.rawEdit)("formGroup",o.form),_(),g("ngClass",be(11,Ys,o.formErrors.captionFileContent)),_(3),g("ngIf",o.formErrors.captionFileContent),_(),g("hidden",o.rawEdit),_(),Cn(o.segments),_(4),g("disabled",o.rawEdit&&!o.form.valid);}}var Zr=(()=>{let i=class i extends si{formReactiveService=A(he);videoCaptionService=A(_i);serverService=A(ie);notifier=A(Ue);cd=A(Bn);modalService=A(ei);confirmService=A(nn);textarea=ot("textarea");embed=ot("embed");modal=ot("modal");openedModal;rawEdit=!1;segments=[];segmentToUpdate;segmentEditError="";segmentToUpdateSave;activeSegment;videoCaptionLanguages=[];timestampParser=this.webvttToMS.bind(this);timestampFormatter=Qe;player;videoCaption;serverConfig;videoEdit;captionEdited;ngOnInit(){this.serverService.getVideoLanguages().subscribe(e=>{this.videoCaptionLanguages=e;}),this.buildForm({captionFileContent:Xr});}show(e){this.videoCaption=e.videoCaption,this.serverConfig=e.serverConfig,this.videoEdit=e.videoEdit,this.captionEdited=e.captionEdited,this.rawEdit=!1,this.segments=[],this.segmentToUpdate=void 0,this.openedModal=this.modalService.open(this.modal(),{centered:!0,size:"xl",beforeDismiss:()=>this.confirmService.confirm("Biztosan a v\xE1ltoz\xE1sok ment\xE9se n\xE9lk\xFCl z\xE1rja be ezt az ablakot?","Close modal window")}),this.loadCaptionContent(),setTimeout(()=>this.initEmbed());}hide(){this.videoCaption=void 0,this.serverConfig=void 0,this.videoEdit=void 0,this.captionEdited=void 0,this.openedModal.close(),this.form.reset();}initEmbed(){let e=this.embed();e&&(this.player=new qt(e.getIframe()),this.player.addEventListener("playbackStatusUpdate",({position:n})=>{if(this.activeSegment=void 0,!isNaN(n))for(let r=this.segments.length-1;r>=0;r--){let d=this.segments[r];if(d.startMs/1e3<=n&&this.activeSegment!==d){this.activeSegment=d,this.cd.detectChanges();break;}}}));}loadCaptionContent(){if(this.rawEdit=!1,this.videoCaption.action==="CREATE"||this.videoCaption.action==="UPDATE"){this.videoCaption.captionfile.text().then(r=>this.loadSegments(r));return;}let{fileUrl:e}=this.videoCaption;e&&this.videoCaptionService.getCaptionContent({fileUrl:e}).subscribe(n=>{this.loadSegments(n);});}onRawEditSwitch(){this.rawEdit===!0?(this.segmentToUpdate=void 0,this.form.patchValue({captionFileContent:this.formatSegments()}),this.resetTextarea()):(this.loadSegments(this.form.value.captionFileContent),this.updateSegmentPositions());}onSegmentClick(e,n){e.preventDefault(),this.player&&(this.player.play(),this.player.seek(n.startMs/1e3));}onEditSaved(e){if(this.segmentEditError="",e.startMs>=e.endMs){this.segmentEditError="A szakasz kezdet\xE9nek a v\xE9ge el\u0151tt kell lennie";return;}if(!e.text){this.segmentEditError="A szakasznak sz\xF6veges tartalommal kell rendelkeznie";return;}this.segmentToUpdate=void 0,e.startFormatted=Qe(e.startMs),e.endFormatted=Qe(e.endMs),this.updateSegmentPositions(),this.scrollToSegment(e);}onEditCanceled(e){if(!this.segmentToUpdateSave){this.segments=this.segments.filter(n=>n.id!==e.id);return;}e.startMs=this.segmentToUpdateSave.startMs,e.endMs=this.segmentToUpdateSave.endMs,e.text=this.segmentToUpdateSave.text,this.onEditSaved(e);}updateSegment(e){this.segmentEditError="",this.segmentToUpdateSave=Z({},e),this.segmentToUpdate=e;}addSegmentToEdit(){return $(this,null,function*(){let n=(this.player?yield this.player.getCurrentTime():0)*1e3,r=n+1e3,d={startMs:n,startFormatted:Qe(n),endMs:r,endFormatted:Qe(r),id:"0",text:""};this.segments=[d,...this.segments],this.segmentToUpdate=d,document.querySelector(".segments").scrollTop=0;});}deleteSegment(e){this.segments=this.segments.filter(n=>n!==e),this.updateSegmentPositions();}updateSegmentPositions(){this.segments=Qn(this.segments,"startMs");for(let e=1;e<=this.segments.length;e++)this.segments[e-1].id=`${e}`;}videoTimeForSegmentStart(e){return $(this,null,function*(){e.startMs=(yield this.player.getCurrentTime())*1e3,e.startFormatted=Qe(e.startMs);});}videoTimeForSegmentEnd(e){return $(this,null,function*(){e.endMs=(yield this.player.getCurrentTime())*1e3,e.endFormatted=Qe(e.endMs);});}webvttToMS(e){let[n,r]=e.split(".");return tr(n)*1e3+parseInt(r);}loadSegments(e){try{let n=$r(e).entries;this.segments=n.map(({id:r,from:d,to:u,text:p})=>({id:r,startMs:d,startFormatted:Qe(d),endMs:u,endFormatted:Qe(u),text:p}));}catch(n){console.error(n),this.notifier.error("A feliratok nem dolgozhat\xF3k fel");}}formatSegments(){let e=`WEBVTT
`;for(let n of this.segments)e+=`
${n.id}
`,e+=`${Qe(n.startMs)} --> ${Qe(n.endMs)}
`,e+=`${n.text}
`;return e;}resetTextarea(){let e=this.textarea().nativeElement;e.scrollTop=0,e.selectionStart=0,e.selectionEnd=0;}updateCaption(){if(this.segmentToUpdate){console.log(this.segmentToUpdate),this.notifier.error("A segment is being edited. Save or cancel your edits first.");return;}let e=this.videoCaption.language.id,n=this.videoCaptionLanguages.find(r=>r.id===e);this.rawEdit&&this.loadSegments(this.form.value.captionFileContent),this.captionEdited({language:n,captionfile:new File([this.formatSegments()],`${e}.vtt`,{type:"text/vtt",lastModified:Date.now()}),action:"UPDATE"}),this.openedModal.close();}scrollToSegment(e){setTimeout(()=>{let n=document.querySelector(`.segments > div:nth-child(${parseInt(e.id)+1})`);n&&n.scrollIntoView({behavior:"smooth",block:"center"});});}};T(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=$n(i)))(r||i);};})()),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-caption-edit-modal"]],viewQuery:function(n,r){n&1&&(rt(r.textarea,Bs,5),rt(r.embed,Xs,5),rt(r.modal,Ws,5)),n&2&&Dt(3);},features:[Hn],decls:2,vars:0,consts:()=>{let e;e="Felugr\xF3 ablak bez\xE1r\xE1sa";let n;n="Edit raw";let r;r="\xDAj szakasz hozz\xE1ad\xE1sa";let d;d="M\xE9gse";let u;u="Felirat szerkeszt\xE9se";let p;p="\u201E"+"\uFFFD0\uFFFD"+"\u201D felirat szerkeszt\xE9se";let E;E="A vide\xF3 jelenlegi idej\xE9nek haszn\xE1lata kezdetk\xE9nt";let S;S="A vide\xF3 jelenlegi idej\xE9nek haszn\xE1lata v\xE9gk\xE9nt";let P;P="Ment\xE9s";let N;N="Vissza\xE1ll\xEDt\xE1s";let D;D="Szakasz kezdet\xE9nek id\u0151b\xE9lyege";let x;x="Szakasz v\xE9g\xE9nek id\u0151b\xE9lyege";let W;W="Szakasz v\xE9g\xE9nek id\u0151b\xE9lyege";let H;H="Ugr\xE1s ehhez a szakaszhoz";let k;k="Szakasz szerkeszt\xE9se";let _e;return _e="Szakasz t\xF6rl\xE9se",[["modal",""],["textarea",""],["embed",""],p,D,x,W,[1,"modal-header"],[1,"modal-title"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],[1,"row"],["class","col-md-12 col-xl-6 mb-3","enableAPI","true",3,"video",4,"ngIf"],[3,"ngClass"],[1,"d-flex","justify-content-between","align-items-center","mb-3","ms-2"],["inputName","raw-edition","labelText",n,3,"ngModelChange","ngModel"],["label",r,3,"click",4,"ngIf"],[3,"hidden","formGroup"],["id","captionFileContent","formControlName","captionFileContent","aria-label","Caption raw content",1,"form-control","caption-raw-textarea","fs-7",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"text-start","segments","pe-2","ps-2",3,"hidden"],[1,"pt-1","pb-1","mb-3"],[1,"modal-footer","inputs"],["type","button","role","button","value",d,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","button","value",u,1,"peertube-button","primary-button",3,"click","disabled"],["enableAPI","true",1,"col-md-12","col-xl-6","mb-3",3,"video"],["label",r,3,"click"],["role","alert",1,"form-error"],["role","form"],[1,"d-flex"],[1,"d-flex","flex-wrap","align-items-center"],["for","segmentStart",1,"visually-hidden"],["inputName","segmentStart","enableBorder","true","mask","99:99:99.999",1,"me-1",3,"ngModelChange","maxTimestamp","ngModel","parser","formatter"],["icon","clock-arrow-down","title",E,3,"click",4,"ngIf"],["iconName","move-right",1,"d-inline-block","ms-2","me-2"],["for","segmentEnd",1,"visually-hidden"],["inputName","segmentEnd","enableBorder","true","mask","99:99:99.999",1,"me-1",3,"ngModelChange","maxTimestamp","ngModel","parser","formatter"],["icon","clock-arrow-down","title",S,3,"click",4,"ngIf"],[1,"d-flex","mt-2"],[1,"form-group","w-100"],["for","segment-edit",1,"visually-hidden"],["id","segment-edit","name","segment-edit",1,"form-control","fs-7",3,"ngModelChange","ngModel"],[1,"d-flex","flex-column","ms-3"],["title",P,"icon","tick",3,"click"],["title",N,"icon","undo",1,"mt-3",3,"click"],["icon","clock-arrow-down","title",E,3,"click"],["icon","clock-arrow-down","title",S,3,"click"],["role","button","tabindex","0","title",H,1,"flex-grow-1","segment-text","ps-1","pe-1",3,"keyup.enter","click","ngClass"],[1,"segment-start","me-2","d-block"],[1,"segment-text","fs-7"],[1,"d-flex","flex-column","ms-3",3,"ngClass"],["title",k,3,"click"],["title",_e,1,"mt-1",3,"click"],[2,"height","100%","width","40px"]];},template:function(n,r){n&1&&I(0,dl,23,13,"ng-template",null,0,at);},dependencies:[J,gt,Pe,ye,Yn,te,De,Re,oe,Rt,Q,St,Mt,Ct,rn],styles:[`.caption-raw-textarea[_ngcontent-%COMP%], .segments[_ngcontent-%COMP%]{min-height:50vh;max-height:50vh;overflow:auto}.segments[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:100px}.segment-text[_ngcontent-%COMP%]{white-space:pre-wrap}.segment-text.active[_ngcontent-%COMP%], .segment-text[_ngcontent-%COMP%]:hover{background:var(--bg-secondary-300)}my-timestamp-input[_ngcontent-%COMP%]{width:130px;display:inline-block;vertical-align:bottom}
/*# sourceMappingURL=video-caption-edit-modal.component-RHKVAHIL.css.map */`]}));let t=i;return t;})();var cl=["videoCaptionAddModal"],_l=["videoCaptionEditModal"];function ml(t,i){t&1&&(c(0,"my-alert",13),C(1,3),l());}function pl(t,i){t&1&&(c(0,"my-alert",13),C(1,5),l());}function ul(t,i){t&1&&(c(0,"div",25),C(1,7),l());}function gl(t,i){t&1&&(c(0,"div",25),C(1,8),l());}function El(t,i){t&1&&(c(0,"div",26),C(1,9),l());}function fl(t,i){if(t&1){let o=q();c(0,"my-edit-button",29),L("click",function(){F(o);let n=h(2).$implicit,r=h(2);return V(r.openEditCaptionModal(n));}),l();}}function hl(t,i){t&1&&C(0,6,1);}function Cl(t,i){t&1&&C(0,6,2);}function Sl(t,i){t&1&&C(0,6,3);}function Ml(t,i){if(t&1){let o=q();c(0,"span",24),R(1),l(),I(2,ul,2,0,"div",25)(3,gl,2,0,"div",25)(4,El,2,0,"div",26)(5,fl,1,0,"my-edit-button",27),c(6,"my-button",28),L("click",function(){F(o);let n=h().$implicit,r=h(2);return V(r.deleteCaption(n));}),Se(7,6),I(8,hl,1,0)(9,Cl,1,0)(10,Sl,1,0),Me(),l();}if(t&2){let o,e,n=h().$implicit,r=h(2);_(),Y(r.getCaptionLabel(n)),_(),K((o=n.action)==="CREATE"?2:o==="UPDATE"?3:o==="REMOVE"?4:-1),_(3),K(n.action==="CREATE"||n.action==="UPDATE"?5:-1),_(3),K((e=n.action)==="CREATE"?8:e==="UPDATE"?9:e==="REMOVE"?10:-1);}}function Al(t,i){if(t&1){let o=q();c(0,"a",30),R(1),l(),c(2,"div",31),C(3,10),Wt(4,"ptDate"),l(),c(5,"my-edit-button",32),L("click",function(){F(o);let n=h().$implicit,r=h(2);return V(r.openEditCaptionModal(n));}),l(),c(6,"my-delete-button",33),L("click",function(){F(o);let n=h().$implicit,r=h(2);return V(r.deleteCaption(n));}),l();}if(t&2){let o=h().$implicit,e=h(2);g("href",o.fileUrl,Un),_(),Y(e.getCaptionLabel(o)),_(3),Ae(zn(4,3,o.updatedAt)),ve(3);}}function vl(t,i){if(t&1&&(c(0,"div",22)(1,"div",23),I(2,Ml,11,4)(3,Al,7,5),l()()),t&2){let o=i.$implicit;_(2),K(o.action?2:3);}}function Ol(t,i){t&1&&(c(0,"div",34),C(1,11),l());}function Pl(t,i){if(t&1){let o=q();c(0,"div",14),I(1,pl,2,0,"my-alert",16)(2,vl,4,1,"div",17)(3,Ol,2,0,"div",18),c(4,"div",19)(5,"button",20),L("click",function(){F(o);let n=h();return V(n.openAddCaptionModal());}),v(6,"my-global-icon",21),B(7),C(8,4),X(),l()()();}if(t&2){let o,e=h();_(),g("ngIf",e.displayTranscriptionInfo&&e.isTranscriptionEnabled()&&!e.hasCaptions()),_(),g("ngForOf",e.videoEdit.getCaptionsEdit()),_(),g("ngIf",((o=e.videoEdit.getCaptionsEdit())==null?null:o.length)===0);}}var Kr=(0,Qr.default)("peertube:video-manage"),Jr=(()=>{let i=class i{serverService=A(ie);manageController=A(ae);videoCaptionAddModal=ot("videoCaptionAddModal");videoCaptionEditModal=ot("videoCaptionEditModal");serverConfig;displayTranscriptionInfo;videoEdit;videoLanguages=[];initialVideoCaptions=[];ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig();let{displayTranscriptionInfo:e}=this.manageController.getConfig();this.displayTranscriptionInfo=e;let{videoEdit:n}=this.manageController.getStore();this.videoEdit=n,this.initialVideoCaptions=this.videoEdit.getCaptionsEdit().map(r=>r.language.id);}getCaptionLabel(e){return e.automaticallyGenerated?""+e.language.label+" (automatikus el\u0151\xE1ll\xEDtott)":e.language.label;}getExistingCaptions(){return this.videoEdit.getCaptionsEdit().filter(e=>e.action!=="REMOVE").map(e=>e.language.id);}onCaptionEdited(e){let n=this.videoEdit.getCaptionsEdit(),r=n.find(d=>d.language.id===e.language.id);r?Object.assign(r,e):n.push(Object.assign(e,{action:"CREATE"})),this.sortVideoCaptions(),Kr("Caption edited",e);}deleteCaption(e){if(e.action&&this.initialVideoCaptions.includes(e.language.id)){e.action=void 0;return;}if(e.action==="CREATE"||e.action==="UPDATE"){pr(this.videoEdit.getCaptionsEdit(),e);return;}e.action="REMOVE",Kr("Caption deleted",e);}openAddCaptionModal(){this.videoCaptionAddModal().show();}openEditCaptionModal(e){this.videoCaptionEditModal().show({videoCaption:e,serverConfig:this.serverConfig,videoEdit:this.videoEdit,captionEdited:n=>this.onCaptionEdited(n)});}isTranscriptionEnabled(){return this.serverConfig.videoTranscription.enabled;}hasCaptions(){return this.getExistingCaptions().length!==0;}sortVideoCaptions(){this.videoEdit.getCaptionsEdit().sort((e,n)=>e.language.label<n.language.label?-1:e.language.label===n.language.label?0:1);}isLive(){return this.videoEdit.getVideoAttributes().isLive;}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-captions"]],viewQuery:function(n,r){n&1&&(rt(r.videoCaptionAddModal,cl,5),rt(r.videoCaptionEditModal,_l,5)),n&2&&Dt(2);},decls:10,vars:3,consts:()=>{let e;e="Feliratok";let n;n="Captions are not available on a live.";let r;r="Felirat hozz\xE1ad\xE1sa";let d;d=" Subtitles will be automatically generated from your video. ";let u;u="Szerkeszt\xE9s";let p;p=""+"\uFFFD*8:1\uFFFD"+" Cancel creation "+"[\uFFFD/*8:1\uFFFD|\uFFFD/*9:2\uFFFD|\uFFFD/*10:3\uFFFD]"+""+"\uFFFD*9:2\uFFFD"+" Cancel editing "+"[\uFFFD/*8:1\uFFFD|\uFFFD/*9:2\uFFFD|\uFFFD/*10:3\uFFFD]"+""+"\uFFFD*10:3\uFFFD"+" Cancel deletion "+"[\uFFFD/*8:1\uFFFD|\uFFFD/*9:2\uFFFD|\uFFFD/*10:3\uFFFD]"+"",p=Sn(p);let E;E="Friss\xEDt\xE9skor l\xE9tre lesz hozva";let S;S="Friss\xEDt\xE9skor szerkesztve lesz";let P;P="Friss\xEDt\xE9skor t\xF6r\xF6lve lesz";let N;N="A feliratf\xE1jl megtekint\xE9se";let D;D="Szerkeszt\xE9s";let x;x="Uploaded on "+"\uFFFD0\uFFFD"+"\t\u2714";let W;return W="Egyel\u0151re nincsenek feliratok.",[["videoCaptionAddModal",""],["videoCaptionEditModal",""],e,n,r,d,p,E,S,P,x,W,["iconName","captions"],["type","primary"],[1,"captions"],[3,"captionAdded","existingCaptions","serverConfig"],["type","primary",4,"ngIf"],["class","form-group",4,"ngFor","ngForOf"],["class","no-caption",4,"ngIf"],[1,"mt-3","mb-3"],[1,"peertube-create-button",3,"click"],["iconName","add","aria-hidden","true"],[1,"form-group"],[1,"caption-entry"],[1,"caption-entry-label"],[1,"caption-entry-state","green"],[1,"caption-entry-state","red"],["label",u,1,"me-2"],["icon","undo",3,"click"],["label",u,1,"me-2",3,"click"],["title",N,"target","_blank","rel","noopener noreferrer",1,"caption-entry-label",3,"href"],[1,"caption-entry-state"],["label",D,1,"me-2",3,"click"],["label","",3,"click"],[1,"no-caption"]];},template:function(n,r){if(n&1){let d=q();c(0,"h2"),v(1,"my-global-icon",12),B(2),C(3,2),X(),l(),I(4,ml,2,0,"my-alert",13)(5,Pl,9,3,"div",14),c(6,"my-video-caption-add-modal",15,0),L("captionAdded",function(p){return F(d),V(r.onCaptionEdited(p));}),l(),v(8,"my-video-caption-edit-modal",null,1);}n&2&&(_(4),K(r.isLive()?4:5),_(2),g("existingCaptions",r.getExistingCaptions())("serverConfig",r.serverConfig));},dependencies:[J,te,Q,et,Ke,oe,ui,Wr,pi,Nr,Ct,Je,Zr],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`,`.caption-entry[_ngcontent-%COMP%]{display:flex;min-height:40px;align-items:center;flex-wrap:wrap}.caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%]{color:var(--fg)}.caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%], .caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%]:hover, .caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%]:focus, .caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%]:active{text-decoration:none}.caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}.caption-entry[_ngcontent-%COMP%]   a.caption-entry-label[_ngcontent-%COMP%]:hover{opacity:.8}.caption-entry[_ngcontent-%COMP%]   .caption-entry-label[_ngcontent-%COMP%]{font-weight:700;min-width:100px;margin-inline-end:1.25rem}.caption-entry[_ngcontent-%COMP%]   .caption-entry-state[_ngcontent-%COMP%]{min-width:250px;margin-inline-end:.9375rem}.no-caption[_ngcontent-%COMP%]{text-align:center}
/*# sourceMappingURL=video-captions.component-J6LT7BPS.css.map */`]}));let t=i;return t;})();var ea={VALIDATORS:[ee.minLength(2),ee.maxLength(100)],MESSAGES:{required:"A fejezetc\xEDm megad\xE1sa k\xF6telez\u0151.",minlength:"A fejezetc\xEDmnek 2 karaktern\xE9l hosszabbnak kell lennie.",maxlength:"A fejezetc\xEDmnek 100 karaktern\xE9l r\xF6videbbnek kell lennie."}},ta={VALIDATORS:[Il()],MESSAGES:{}};function Il(){return t=>{let i=t.value;for(let o of i)if(o.title&&i.filter(e=>e.title&&e.timecode===o.timecode).length>1)return{uniqueTimecode:"T\xF6bb fejezetnek azonos az id\u0151k\xF3dja: "+o.timecode+""};return null;};}var ia=qe(ht());var na=t=>({"hide-chapter-label":t}),Nl=t=>({"input-error":t}),Tl=t=>({"opacity-0":t});function bl(t,i){t&1&&(c(0,"my-alert",6),C(1,1),l());}function yl(t,i){if(t&1){let o=q();c(0,"my-delete-button",22),L("click",function(){F(o);let n=h().index,r=h(2);return V(r.deleteChapterControl(n));}),l();}}function Dl(t,i){if(t&1&&(B(0),c(1,"div",14),v(2,"div"),c(3,"label",15),C(4,3),l(),c(5,"label",15),C(6,4),l(),v(7,"div"),c(8,"div",16),R(9),l(),v(10,"my-timestamp-input",17),c(11,"div"),v(12,"input",18),c(13,"div",19)(14,"span",20),R(15,"t"),l(),R(16),l()(),I(17,yl,1,0,"my-delete-button",21),l(),X()),t&2){let o=i.index,e=h(2);_(),g("formGroupName",o),_(2),g("ngClass",be(14,na,o!==0))("for","timecode["+o+"]"),_(2),g("ngClass",be(16,na,o!==0))("for","title["+o+"]"),_(4),Y(o+1),_(),g("inputName","timecode["+o+"]")("maxTimestamp",e.videoEdit.getVideoAttributes().duration||null),_(2),g("ngClass",be(18,Nl,e.formErrors.chapters[o].title))("id","title["+o+"]")("name","title["+o+"]"),_(),g("ngClass",be(20,Tl,!e.formErrors.chapters[o].title)),_(3),ue(" ",e.formErrors.chapters[o].title," "),_(),g("ngIf",!e.isLastChapterControl(o));}}function Rl(t,i){if(t&1&&(c(0,"div",23),R(1),l()),t&2){let o=h(2);_(),ue(" ",o.getChapterArrayErrors()," ");}}function xl(t,i){if(t&1&&v(0,"my-embed",24),t&2){let o=h(2);g("video",o.videoEdit.getVideoAttributes())("version",o.getEmbedVersion());}}function Fl(t,i){if(t&1&&(c(0,"div",7)(1,"div",8)(2,"div",9)(3,"my-alert",6),Se(4,2),v(5,"a",10),Me(),l(),I(6,Dl,18,22,"ng-container",11)(7,Rl,2,1,"div",12),l(),I(8,xl,1,2,"my-embed",13),l()()),t&2){let o=h();g("formGroup",o.form),_(6),g("ngForOf",o.getChaptersFormArray().controls),_(),g("ngIf",o.getChapterArrayErrors()),_(),g("ngIf",o.videoEdit.isPublishedVOD());}}var Vl=(0,ia.default)("peertube:video-manage"),oa=(()=>{let i=class i{formValidatorService=A(Jn);formReactiveService=A(he);manageController=A(ae);form;formErrors={};validationMessages={};videoEdit;updatedSub;ngOnInit(){let{videoEdit:e}=this.manageController.getStore();this.videoEdit=e,this.buildForm();}buildForm(){let{form:e,formErrors:n,validationMessages:r}=this.formReactiveService.buildForm({},{});this.form=e,this.formErrors=n,this.validationMessages=r,this.form.addControl("chapters",new er([],ta.VALIDATORS)),this.addNewChapterControl(),e.get("chapters").valueChanges.subscribe(d=>{let u=d[d.length-1];(u.title||u.timecode)&&this.addNewChapterControl();}),this.patchChapters(),this.form.valueChanges.subscribe(()=>{let d={chapters:this.form.valid?void 0:"Egyes fejezetek \xE9rv\xE9nytelenek"};this.manageController.setFormError("Fejezetek","chapters",d);let u=this.form.value;Vl("Updating form values",u),this.videoEdit.getChaptersEdit().loadFromForm(u);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.patchChapters();});}ngOnDestroy(){this.updatedSub?.unsubscribe();}addNewChapterControl(){let e=this.getChaptersFormArray(),n=e.controls;n.length!==0&&e.controls[n.length-1].get("title").addValidators(ee.required),this.formValidatorService.addControlInFormArray({controlName:"chapters",formArray:e,formErrors:this.formErrors,validationMessages:this.validationMessages,formToBuild:{timecode:null,title:ea},defaultValues:{timecode:0}});}getChaptersFormArray(){return this.form.controls.chapters;}deleteChapterControl(e){this.formValidatorService.removeControlFromFormArray({controlName:"chapters",formArray:this.getChaptersFormArray(),formErrors:this.formErrors,validationMessages:this.validationMessages,index:e});}isLastChapterControl(e){return this.getChaptersFormArray().length-1===e;}getChapterArrayErrors(){return this.getChaptersFormArray().errors?Object.values(this.getChaptersFormArray().errors).join(". "):"";}patchChapters(){let e=this.videoEdit.getChaptersEdit(),n=e.getChaptersForUpdate().length,r=this.getChaptersFormArray().length;for(let d=0;d<=n-r;d++)this.addNewChapterControl();this.form.patchValue(e.toFormPatch());}isLive(){return this.videoEdit.getVideoAttributes().isLive;}getEmbedVersion(){return this.manageController.getEmbedVersion();}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-chapters"]],decls:6,vars:1,consts:()=>{let e;e="Fejezetek";let n;n="Chapters are not available on a live.";let r;r="A fejezetek a vide\xF3 le\xEDr\xE1s\xE1ban is megadhat\xF3k. N\xE9zze meg a form\xE1tumot "+"\uFFFD#5\uFFFD"+"a PeerTube dokument\xE1ci\xF3j\xE1ban"+"\uFFFD/#5\uFFFD"+"";let d;d="Id\u0151k\xF3d";let u;return u="Fejezetn\xE9v",[e,n,r,d,u,["iconName","chapters"],["type","primary"],[3,"formGroup"],[1,"row","mb-5"],["formArrayName","chapters",1,"chapters","col-md-12","col-xl-6"],["href","https://docs.joinpeertube.org/use/create-upload-video#chapters","target","_blank",1,"alert-link"],[4,"ngFor","ngForOf"],["class","form-error","role","alert",4,"ngIf"],["class","col-md-12 col-xl-6",3,"video","version",4,"ngIf"],[1,"chapter",3,"formGroupName"],[3,"ngClass","for"],[1,"position"],["enableBorder","true","formControlName","timecode",1,"d-block",3,"inputName","maxTimestamp"],["type","text","formControlName","title",3,"ngClass","id","name"],["role","alert",1,"form-error",3,"ngClass"],[1,"opacity-0"],[3,"click",4,"ngIf"],[3,"click"],["role","alert",1,"form-error"],[1,"col-md-12","col-xl-6",3,"video","version"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",5),B(2),C(3,0),X(),l(),I(4,bl,2,0,"my-alert",6)(5,Fl,9,4,"div",7)),n&2&&(_(4),K(r.isLive()?4:5));},dependencies:[J,gt,Pe,ye,te,De,Re,qn,Jo,Q,et,Ke,Rt,rn,ui,Mt,Je,oe],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`,`.chapter[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto minmax(150px,350px) 1fr;grid-template-rows:auto auto;column-gap:1rem}.chapter[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]{height:38px;min-width:16px;display:flex;align-items:center}.chapter[_ngcontent-%COMP%]   my-delete-button[_ngcontent-%COMP%]{width:fit-content}.chapter[_ngcontent-%COMP%]   .form-error[_ngcontent-%COMP%]{margin-top:0}
/*# sourceMappingURL=video-chapters.component-TLGFDPQE.css.map */`]}));let t=i;return t;})();var ra={VALIDATORS:[ee.required,ee.minLength(3),ee.maxLength(120)],MESSAGES:{required:"A vide\xF3 nev\xE9nek megad\xE1sa k\xF6telez\u0151.",minlength:"A vide\xF3 nev\xE9nek legal\xE1bb 3 karakter hossz\xFAs\xE1g\xFAnak kell lennie.",maxlength:"A vide\xF3 neve nem lehet hosszabb 120 karaktern\xE9l.",spaces:"A vide\xF3 nev\xE9nek elej\xE9n vagy v\xE9g\xE9n sz\xF3k\xF6z karakterek tal\xE1lhat\xF3ak."}},aa={VALIDATORS:[ee.required],MESSAGES:{required:"A vide\xF3 adatv\xE9delm\xE9nek megad\xE1sa k\xF6telez\u0151."}},ji={VALIDATORS:[ee.minLength(2),ee.maxLength(100)],MESSAGES:{minlength:"A jelsz\xF3nak legal\xE1bb k\xE9t karakteresnek kell lennie.",maxlength:"A jelsz\xF3 legfeljebb 100 karakteres lehet.",required:"A jelsz\xF3 megad\xE1sa k\xF6telez\u0151 a jelsz\xF3val v\xE9dett vide\xF3kn\xE1l."}},sa={VALIDATORS:[],MESSAGES:{}},la={VALIDATORS:[],MESSAGES:{}},da={VALIDATORS:[],MESSAGES:{}};var ca={VALIDATORS:[ee.required],MESSAGES:{required:"A vide\xF3 csatorn\xE1j\xE1nak megad\xE1sa k\xF6telez\u0151."}},_a={VALIDATORS:[ee.minLength(3),ee.maxLength(1e4)],MESSAGES:{minlength:"A vide\xF3 le\xEDr\xE1s\xE1nak legal\xE1bb 3 karakter hossz\xFAs\xE1g\xFAnak kell lennie.",maxlength:"A vide\xF3 le\xEDr\xE1sa nem lehet hosszabb 10000 karaktern\xE9l."}},ma={VALIDATORS:[ee.maxLength(5),Ll()],MESSAGES:{maxlength:"Legfeljebb 5 c\xEDmke haszn\xE1lhat\xF3 egy vide\xF3n.",arrayTagLength:"A c\xEDmk\xE9nek 1 karaktern\xE9l hosszabbnak \xE9s 30 karaktern\xE9l r\xF6videbbnek kell lennie."}},pa={VALIDATORS:[ee.minLength(3),ee.maxLength(1e3)],MESSAGES:{minlength:"A vide\xF3 t\xE1mogat\xE1s\xE1nak legal\xE1bb 3 karakter hossz\xFAs\xE1g\xFAnak kell lennie.",maxlength:"A vide\xF3 t\xE1mogat\xE1sa nem lehet hosszabb 1000 karaktern\xE9l."}},ua={VALIDATORS:[ee.minLength(3),ee.maxLength(250)],MESSAGES:{minlength:"A vide\xF3 t\xE1mogat\xE1s\xE1nak legal\xE1bb 3 karakter hossz\xFAs\xE1g\xFAnak kell lennie.",maxlength:"Video support cannot be more than 250 characters long."}},ga={VALIDATORS:[],MESSAGES:{required:"Egy d\xE1tum megad\xE1sa k\xF6telez\u0151 a vide\xF3 friss\xEDt\xE9s\xE9nek \xFCtemez\xE9s\xE9hez."}},Ea={VALIDATORS:[],MESSAGES:{}};function Ll(t=2,i=30){return o=>o.value.every(n=>n.length>=t&&n.length<=i)?null:{arrayTagLength:!0};}var fa=qe(ht());function Gl(t,i){if(t&1&&(c(0,"div",18)(1,"label",19),C(2,3),l(),c(3,"div",14),C(4,4),l(),v(5,"input",20),l()),t&2){let o=h();_(5),g("disabled",!0)("value",o.videoEdit.getVideoSource().filename);}}function $l(t,i){if(t&1){let o=q();c(0,"button",21),L("click",function(){F(o);let n=h();return V(n.resetField("originallyPublishedAt"));}),C(1,5),l();}}function Ul(t,i){if(t&1&&(c(0,"div",22),R(1),l()),t&2){let o=h();_(),ue(" ",o.formErrors.originallyPublishedAt," ");}}var Hl=(0,fa.default)("peertube:video-manage"),ha=(()=>{let i=class i{formReactiveService=A(he);serverService=A(ie);i18nPrimengCalendarService=A(Ci);manageController=A(ae);form;formErrors={};validationMessages={};videoEdit;calendarDateFormat;myYearRange;serverConfig;updatedSub;constructor(){this.calendarDateFormat=this.i18nPrimengCalendarService.getDateFormat(),this.myYearRange=this.i18nPrimengCalendarService.getVideoPublicationYearRange();}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig();let{videoEdit:e}=this.manageController.getStore();this.videoEdit=e,this.buildForm();}buildForm(){let e=this.videoEdit.toCommonFormPatch(),n={downloadEnabled:null,originallyPublishedAt:Ea},{form:r,formErrors:d,validationMessages:u}=this.formReactiveService.buildForm(n,e);this.form=r,this.formErrors=d,this.validationMessages=u,this.form.valueChanges.subscribe(()=>{this.manageController.setFormError("Customization","customization",this.formErrors);let p=this.form.value;Hl("Updating form values",p),this.videoEdit.loadFromCommonForm(p);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.form.patchValue(this.videoEdit.toCommonFormPatch());});}ngOnDestroy(){this.updatedSub?.unsubscribe();}hasPublicationDate(){return!!this.form.value.originallyPublishedAt;}resetField(e){this.form.patchValue({[e]:null});}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-customization"]],decls:18,vars:11,consts:()=>{let e;e="Let\xF6lt\xE9s enged\xE9lyez\xE9se";let n;n="Customization";let r;r="Eredeti k\xF6zz\xE9t\xE9teli d\xE1tum";let d;d="Ez az a d\xE1tum, amikor a tartalmat eredetileg k\xF6zz\xE9tett\xE9k (p\xE9ld\xE1ul egy film megjelen\xE9si d\xE1tuma)";let u;u="F\xE1jln\xE9v";let p;p=" Name of the uploaded file. ";let E;return E="Vissza\xE1ll\xEDt\xE1s",[n,r,d,u,p,E,["iconName","cog"],[3,"formGroup"],[1,"form-columns"],["class","form-group",4,"ngIf"],[1,"form-group","originally-published-at"],[1,"label-container"],["for","originallyPublishedAt"],["class","reset-button reset-button-small",3,"click",4,"ngIf"],[1,"form-group-description"],["inputId","originallyPublishedAt","formControlName","originallyPublishedAt","baseZIndex","20000",3,"dateFormat","firstDayOfWeek","showTime","hideOnDateTimeSelect","monthNavigator","yearNavigator","yearRange"],["class","form-error","role","alert",4,"ngIf"],["inputName","downloadEnabled","formControlName","downloadEnabled","labelText",e],[1,"form-group"],["for","filename"],["type","text","id","filename",1,"form-control",3,"disabled","value"],[1,"reset-button","reset-button-small",3,"click"],["role","alert",1,"form-error"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",6),B(2),C(3,0),X(),l(),c(4,"div",7)(5,"div",8)(6,"div"),I(7,Gl,6,2,"div",9),c(8,"div",10)(9,"div",11)(10,"label",12),C(11,1),l(),I(12,$l,2,0,"button",13),l(),c(13,"div",14),C(14,2),l(),v(15,"p-calendar",15),I(16,Ul,2,1,"div",16),l(),v(17,"my-peertube-checkbox",17),l()()()),n&2&&(_(4),g("formGroup",r.form),_(3),g("ngIf",r.videoEdit.getVideoSource()),_(5),g("ngIf",r.hasPublicationDate()),_(3),g("dateFormat",r.calendarDateFormat)("firstDayOfWeek",0)("showTime",!0)("hideOnDateTimeSelect",!0)("monthNavigator",!0)("yearNavigator",!0)("yearRange",r.myYearRange),_(),g("ngIf",r.formErrors.originallyPublishedAt));},dependencies:[J,Pe,ye,te,De,Re,Q,et,mi,St,oe],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`]}));let t=i;return t;})();var Ma=qe(ht());var Ca=(()=>{let i=class i{};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-live-documentation-link"]],decls:3,vars:0,consts:()=>{let e;return e="A "+"\uFFFD#2\uFFFD"+"dokument\xE1ci\xF3ban"+"\uFFFD/#2\uFFFD"+" tov\xE1bbi hasznos inform\xE1ci\xF3k tal\xE1lhat\xF3k a PeerTube \xE9l\u0151 k\xF6zvet\xEDt\xE9sekkel kapcsolatban. ",[e,["href","https://docs.joinpeertube.org/use/create-upload-video#publish-a-live","target","_blank","rel","noopener noreferrer",1,"link-primary"]];},template:function(n,r){n&1&&(c(0,"p"),Se(1,0),v(2,"a",1),Me(),l());},encapsulation:2}));let t=i;return t;})();function kl(t,i){t&1&&(c(0,"span",15),C(1,2),l());}function zl(t,i){if(t&1&&(c(0,"span",16),R(1),l()),t&2){let o=h().$implicit,e=h(2);_(),Y(e.getErrorLabel(o));}}function Bl(t,i){if(t&1&&(c(0,"span"),Se(1,3),v(2,"strong"),Wt(3,"ptDate"),Me(),l()),t&2){let o=h().$implicit;_(3),Ae(Hi(3,1,o.endDate,"medium")),ve(1);}}function Xl(t,i){if(t&1&&(c(0,"a",17),C(1,4),l()),t&2){let o=h().$implicit,e=h(2);g("routerLink",e.getVideoUrl(o.replayVideo));}}function Wl(t,i){t&1&&(c(0,"span"),C(1,5),l());}function jl(t,i){if(t&1&&(c(0,"div",10),I(1,kl,2,0,"span",11)(2,zl,2,1,"span",12),c(3,"span"),Se(4,1),v(5,"strong"),Wt(6,"ptDate"),Me(),l(),I(7,Bl,4,4,"span",13)(8,Xl,2,1,"a",14)(9,Wl,2,0,"span",13),l()),t&2){let o=i.$implicit,e=h(2);_(),g("ngIf",!e.getErrorLabel(o)),_(),g("ngIf",e.getErrorLabel(o)),_(4),Ae(Hi(6,6,o.startDate,"medium")),ve(4),_(),g("ngIf",o.endDate),_(),g("ngIf",o.replayVideo),_(),g("ngIf",e.isReplayBeingProcessed(o));}}function Yl(t,i){if(t&1&&(c(0,"div",7)(1,"div",8),C(2,0),l(),I(3,jl,10,9,"div",9),l()),t&2){let o=h();_(3),g("ngForOf",o.latestLiveSessions);}}var Sa=(()=>{let i=class i{liveVideoService=A(Yt);video=Te.required();latestLiveSessions=[];ngOnInit(){this.liveVideoService.listSessions(this.video().id).subscribe(({data:e})=>this.latestLiveSessions=e.reverse());}getVideoUrl(e){return ai.buildWatchUrl(e);}getErrorLabel(e){return e.error?{[Et.BAD_SOCKET_HEALTH]:"A kiszolg\xE1l\xF3 t\xFAl lass\xFA",[Et.BLACKLISTED]:"Az el\u0151 k\xF6zvet\xEDt\xE9s feketelist\xE1ra t\xE9ve",[Et.DURATION_EXCEEDED]:"A legnagyobb id\u0151tartam t\xFAll\xE9pve",[Et.FFMPEG_ERROR]:"Kiszolg\xE1l\xF3hiba",[Et.QUOTA_EXCEEDED]:"A kv\xF3ta t\xFAll\xE9pve",[Et.RUNNER_JOB_CANCEL]:"A futtat\xF3 feladata megszak\xEDtva",[Et.RUNNER_JOB_ERROR]:"Hiba a futtat\xF3 feladat\xE1ban",[Et.UNKNOWN_ERROR]:"Ismeretlen hiba",[Et.INVALID_INPUT_VIDEO_STREAM]:"\xC9rv\xE9nytelen bemeneti vide\xF3folyam"}[e.error]:void 0;}isReplayBeingProcessed(e){return e.endDate?e.saveReplay&&!e.endingProcessed:!1;}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-live-stream-information"]],inputs:{video:[1,"video"]},features:[en([Yt])],decls:1,vars:1,consts:()=>{let e;e="Legut\xF3bbi \xE9l\u0151 ad\xE1sok";let n;n="Started on "+"\uFFFD#5\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#5\uFFFD"+"";let r;r="Siker\xFClt";let d;d="Ended on "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+"";let u;u="Ugr\xE1s a visszaj\xE1tsz\xE1shoz";let p;return p="A visszaj\xE1tsz\xE1s feldolgoz\xE1s alatt \xE1ll...",[e,n,r,d,u,p,["class","journal",4,"ngIf"],[1,"journal"],[1,"label"],["class","journal-session d-flex align-items-center flex-wrap mb-2",4,"ngFor","ngForOf"],[1,"journal-session","d-flex","align-items-center","flex-wrap","mb-2"],["class","pt-badge badge-success me-2",4,"ngIf"],["class","pt-badge badge-danger me-2",4,"ngIf"],[4,"ngIf"],["target","_blank",3,"routerLink",4,"ngIf"],[1,"pt-badge","badge-success","me-2"],[1,"pt-badge","badge-danger","me-2"],["target","_blank",3,"routerLink"]];},template:function(n,r){n&1&&I(0,Yl,4,1,"div",6),n&2&&g("ngIf",r.latestLiveSessions.length!==0);},dependencies:[Oe,Ke,Q,ut,pi],styles:[`@charset "UTF-8";.journal-session[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not(.pt-badge,:last-child):after{margin:3px;content:"\\2022"}
/*# sourceMappingURL=live-stream-information.component-FOI5H2LV.css.map */`]}));let t=i;return t;})();var ql=t=>({disabled:t});function Zl(t,i){if(t&1&&(c(0,"my-alert",18),C(1,1),l()),t&2){let o=h();_(),Ae(o.getVideoName()),ve(1);}}function Kl(t,i){t&1&&(c(0,"my-alert",19),C(1,2),l());}function Ql(t,i){t&1&&(B(0),C(1,9),X());}function Jl(t,i){if(t&1&&(c(0,"div",36),C(1,10),Wt(2,"myTimeDurationFormatter"),l()),t&2){let o=h(3);_(2),Ae(o.getInstanceName())(zn(2,2,o.getMaxLiveDuration())),ve(1);}}function ed(t,i){if(t&1&&(v(0,"my-live-documentation-link"),I(1,Jl,3,4,"div",35)),t&2){let o=h(2);_(),g("ngIf",o.getMaxLiveDuration()>=0);}}function td(t,i){if(t&1&&(c(0,"div",24)(1,"label",37),C(2,11),l(),v(3,"my-input-text",38),l()),t&2){let o=h(2);_(3),g("value",o.getLive().rtmpUrl)("withToggle",!1)("withCopy",!0)("show",!0)("readonly",!0);}}function nd(t,i){if(t&1&&(c(0,"div",24)(1,"label",39),C(2,12),l(),v(3,"my-input-text",40),l()),t&2){let o=h(2);_(3),g("value",o.getLive().rtmpsUrl)("withToggle",!1)("withCopy",!0)("show",!0)("readonly",!0);}}function id(t,i){t&1&&(B(0),C(1,14),X());}function od(t,i){t&1&&(c(0,"div",24)(1,"my-peertube-checkbox",41),I(2,id,2,0,"ng-template",42),B(3,43),c(4,"span"),C(5,13),l(),X(),l()());}function rd(t,i){if(t&1&&(c(0,"div",44)(1,"label",45),C(2,15),l(),v(3,"my-select-options",46),l()),t&2){let o=h(2);_(3),g("items",o.replayPrivacies);}}function ad(t,i){if(t&1&&(c(0,"div",50),R(1),l()),t&2){let o=h(3);_(),ue(" ",o.formErrors.latencyMode," ");}}function sd(t,i){if(t&1&&(c(0,"div",24)(1,"label",47),C(2,16),l(),v(3,"my-select-options",48),I(4,ad,2,1,"div",49),l()),t&2){let o=h(2);_(3),g("items",o.latencyModes),_(),g("ngIf",o.formErrors.latencyMode);}}function ld(t,i){if(t&1&&(c(0,"div",20)(1,"my-alert",21),I(2,Ql,2,0,"ng-container")(3,ed,2,1),l(),c(4,"div",22)(5,"div"),I(6,td,4,5,"div",23)(7,nd,4,5,"div",23),c(8,"div",24)(9,"label",25),C(10,3),l(),v(11,"my-input-text",26),c(12,"div",27),C(13,4),l()(),v(14,"my-live-stream-information",28),l(),c(15,"div")(16,"div",24)(17,"div",29),v(18,"input",30),c(19,"label",31),C(20,5),l(),c(21,"span",27),C(22,6),l()(),c(23,"div",29),v(24,"input",32),c(25,"label",33),C(26,7),l(),c(27,"span",27),C(28,8),l()()(),I(29,od,6,0,"div",23)(30,rd,4,1,"div",34)(31,sd,5,2,"div",23),l()()()),t&2){let o=h();g("formGroup",o.form),_(2),K(o.isStreaming()?2:3),_(2),g("ngClass",be(14,ql,o.isStreaming())),_(2),g("ngIf",o.getLive().rtmpUrl),_(),g("ngIf",o.getLive().rtmpsUrl),_(4),g("value",o.getLive().streamKey)("withCopy",!0)("readonly",!0),_(3),g("video",o.videoEdit.getVideoAttributes()),_(4),g("value",!1),_(6),g("value",!0),_(5),g("ngIf",o.isSaveReplayAllowed()),_(),g("ngIf",o.isSaveReplayEnabled()),_(),g("ngIf",o.isLatencyModeEnabled());}}var dd=(0,Ma.default)("peertube:video-manage"),Aa=(()=>{let i=class i{formReactiveService=A(he);videoService=A(Fe);serverService=A(ie);manageController=A(ae);form;formErrors={};validationMessages={};videoEdit;replayPrivacies=[];latencyModes=[{id:Kn.SMALL_LATENCY,label:"Kis k\xE9sleltet\xE9s",description:"A k\xE9sleltet\xE9s ~15 mp-re cs\xF6kkent\xE9se, kikapcsolva a P2P forgalmat"},{id:Kn.DEFAULT,label:"Alap\xE9rtelmezett",description:"30 mp-es \xE1tlagos k\xE9sleltet\xE9s"},{id:Kn.HIGH_LATENCY,label:"Magas k\xE9sleltet\xE9s",description:"60 mp-es \xE1tlagos k\xE9sleltet\xE9s, n\xF6velve a P2P forgalom ar\xE1ny\xE1t"}];serverConfig;updatedSub;ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig();let{videoEdit:e}=this.manageController.getStore();this.videoEdit=e,this.buildForm(),this.serverService.getVideoPrivacies().subscribe(n=>{this.replayPrivacies=this.videoService.explainedPrivacyLabels(n).videoPrivacies.filter(r=>r.id!==$e.PASSWORD_PROTECTED);});}ngOnDestroy(){this.updatedSub?.unsubscribe();}buildForm(){let e=this.videoEdit.toLiveFormPatch(),n={liveStreamKey:null,permanentLive:null,latencyMode:null,saveReplay:null,replayPrivacy:null},{form:r,formErrors:d,validationMessages:u}=this.formReactiveService.buildForm(n,e);this.form=r,this.formErrors=d,this.validationMessages=u,this.form.valueChanges.subscribe(()=>{this.manageController.setFormError("El\u0151 k\xF6zvet\xEDt\xE9s be\xE1ll\xEDt\xE1sai","live-settings",this.formErrors);let p=this.form.value;dd("Updating form values",p),this.videoEdit.loadFromLiveForm(p);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.form.patchValue(this.videoEdit.toLiveFormPatch());});}isSaveReplayAllowed(){return this.serverConfig.live.allowReplay;}isSaveReplayEnabled(){return this.form.value.saveReplay===!0;}isPermanentLiveEnabled(){return this.form.value.permanentLive===!0;}isLatencyModeEnabled(){return this.serverConfig.live.latencySetting.enabled;}isLive(){return this.videoEdit.getVideoAttributes().isLive;}hasEnded(){return this.videoEdit.getVideoAttributes().state===xe.LIVE_ENDED;}isStreaming(){return this.videoEdit.getVideoAttributes().state===xe.PUBLISHED;}getLive(){return this.videoEdit.getVideoAttributes().live;}getVideoName(){return this.videoEdit.getVideoAttributes().name;}getMaxLiveDuration(){return this.serverConfig.live.maxDuration/1e3;}getInstanceName(){return this.serverConfig.instance.name;}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-live-settings"]],decls:7,vars:1,consts:()=>{let e;e="El\u0151 k\xF6zvet\xEDt\xE9s be\xE1ll\xEDt\xE1sai";let n;n=""+"\uFFFD0\uFFFD"+" is not a live.";let r;r="Your live has ended.";let d;d="\xC9l\u0151 k\xF6zvet\xEDt\xE9s kulcsa";let u;u="\u26A0\uFE0F Soha ne adja ki senkinek az \xE9l\u0151 k\xF6zvet\xEDt\xE9se kulcs\xE1t.";let p;p="Ez egy norm\xE1l \xE9l\u0151 k\xF6zvet\xEDt\xE9s";let E;E="Csak egyszer k\xF6zvet\xEDthet egy norm\xE1l \xE9l\u0151 k\xF6zvet\xEDt\xE9sben. Ha enged\xE9lyezi a visszaj\xE1tsz\xE1st, akkor az \xE9l\u0151 ad\xE1ssal azonos c\xEDmre lesz elmentve.";let S;S="Ez egy \xE1lland\xF3/ism\xE9tl\u0151d\u0151 \xE9l\u0151 k\xF6zvet\xEDt\xE9s";let P;P="T\xF6bbsz\xF6r k\xF6zvet\xEDthet egy \xE1lland\xF3/ism\xE9tl\u0151d\u0151 \xE9l\u0151 k\xF6zvet\xEDt\xE9sben. Ha enged\xE9lyezi a visszaj\xE1tsz\xE1sokat, azok k\xFCl\xF6n vide\xF3kk\xE9nt lesznek elmentve";let N;N="Live configuration is unavailable because you are streaming in this live.";let D;D=" Max live duration configured on "+"\uFFFD0\uFFFD"+" is "+"\uFFFD1\uFFFD"+". If your live reaches this limit, it will be automatically terminated. ";let x;x="\xC9l\u0151 k\xF6zvet\xEDt\xE9s RTMP webc\xEDme";let W;W="\xC9l\u0151 k\xF6zvet\xEDt\xE9s RTMPS webc\xEDme";let H;H="\u26A0\uFE0F A be\xE1ll\xEDt\xE1s enged\xE9lyez\xE9s\xE9vel a vide\xF3kv\xF3ta el\xE9r\xE9sekor az \xE9l\u0151 k\xF6zvet\xEDt\xE9s megszakad";let k;k="Visszaj\xE1tsz\xE1s automatikus k\xF6zz\xE9t\xE9tele, ha az \xE9l\u0151 k\xF6zvet\xEDt\xE9s v\xE9get \xE9r";let _e;_e="Az \xFAj visszaj\xE1tsz\xE1s adatv\xE9delmi be\xE1ll\xEDt\xE1sa";let w;return w="K\xE9sleltet\xE9si m\xF3d",[e,n,r,d,u,p,E,S,P,N,D,x,W,H,k,_e,w,["iconName","live"],["type","danger"],["type","primary"],[3,"formGroup"],["type","primary",1,"d-block","mb-4"],[1,"form-columns","reverse",3,"ngClass"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","liveVideoStreamKey"],["inputId","liveVideoStreamKey",3,"value","withCopy","readonly"],[1,"form-group-description"],[3,"video"],[1,"peertube-radio-container"],["type","radio","formControlName","permanentLive","id","permanentLiveFalse",3,"value"],["for","permanentLiveFalse",1,"radio"],["type","radio","formControlName","permanentLive","id","permanentLiveTrue",3,"value"],["for","permanentLiveTrue",1,"radio"],["class","form-group mx-4",4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"mt-3"],["for","liveVideoRTMPUrl"],["inputId","liveVideoRTMPUrl",3,"value","withToggle","withCopy","show","readonly"],["for","liveVideoRTMPSUrl"],["inputId","liveVideoRTMPSUrl",3,"value","withToggle","withCopy","show","readonly"],["inputName","liveVideoSaveReplay","formControlName","saveReplay"],["ptTemplate","label"],["ngProjectAs","description",5,["description"]],[1,"form-group","mx-4"],["for","replayPrivacy"],["inputId","replayPrivacy","formControlName","replayPrivacy",3,"items"],["for","latencyMode"],["inputId","latencyMode","formControlName","latencyMode","clearable","true",3,"items"],["class","form-error","role","alert",4,"ngIf"],["role","alert",1,"form-error"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",17),B(2),C(3,0),X(),l(),I(4,Zl,2,1,"my-alert",18)(5,Kl,2,0,"my-alert",19)(6,ld,32,16,"div",20)),n&2&&(_(4),K(r.isLive()?r.hasEnded()?5:6:4));},dependencies:[Oe,Rt,Q,J,gt,Qo,Pe,ye,te,De,Re,on,Ft,di,et,St,Ca,Je,Ur,oe,Sa],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`]}));let t=i;return t;})();var Pa=qe(ht());var vi=(()=>{let i=class i{fileDropped=Jt();dragover=!1;onDragOver(e){e.preventDefault(),e.stopPropagation(),this.dragover=!0;}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.dragover=!1;}ondrop(e){e.preventDefault(),e.stopPropagation(),this.dragover=!1;let n=e.dataTransfer.files;n.length>0&&this.fileDropped.emit(n);}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275dir",Vo({type:i,selectors:[["","myDragDrop",""]],hostVars:2,hostBindings:function(n,r){n&1&&L("dragover",function(u){return r.onDragOver(u);})("dragleave",function(u){return r.onDragLeave(u);})("drop",function(u){return r.ondrop(u);}),n&2&&Go("dragover",r.dragover);},outputs:{fileDropped:"fileDropped"}}));let t=i;return t;})();var cd=["embed"];function _d(t,i){if(t&1){let o=q();v(0,"my-embed",7,0),c(2,"div",8)(3,"button",9),L("click",function(){F(o);let n=h();return V(n.selectFrame());}),C(4,1),l(),c(5,"button",10),L("click",function(){F(o);let n=h();return V(n.resetSelectFromVideo());}),C(6,2),l()();}if(t&2){let o=h();g("video",o.videoEdit().getVideoAttributes());}}function md(t,i){if(t&1&&(v(0,"img",18),c(1,"div",19),R(2,"Current thumbnail"),l()),t&2){let o=h(2);g("src",o.imageSrc,Un);}}function pd(t,i){t&1&&(c(0,"div",12),Ro(),c(1,"svg",20),v(2,"path",21)(3,"path",22),l()());}function ud(t,i){if(t&1){let o=q();c(0,"my-button",23),L("click",function(){F(o);let n=h(2);return V(n.selectFromVideo());}),C(1,5),l();}}function gd(t,i){if(t&1){let o=q();c(0,"div",11),I(1,md,3,1)(2,pd,4,0,"div",12),l(),c(3,"div",8)(4,"div",13)(5,"strong"),R(6,"Drag and drop your thumbnail here"),l(),R(7," or click on the button below to modify it: "),l(),c(8,"div",14)(9,"div"),C(10,3),l(),c(11,"div"),C(12,4),l()(),c(13,"div",15)(14,"my-reactive-file",16),L("fileChanged",function(n){F(o);let r=h();return V(r.onFileChanged(n));}),l(),I(15,ud,2,0,"my-button",17),l()();}if(t&2){let o=h();_(),K(o.imageSrc?1:2),_(9),Ae(o.videoImageExtensions)(o.maxVideoImageSizeInBytes),ve(10),_(4),g("extensions",o.videoImageExtensions)("maxFileSize",o.maxVideoImageSize),_(),K(o.canSelectFromVideo()?15:-1);}}var va=(()=>{let i=class i{serverService=A(ie);notifier=A(Ue);environmentInjector=A(yo);embed=ot("embed");videoEdit=Te.required();imageSrc;allowedExtensionsMessage="";serverConfig;bytesPipe;imageFile;selectingFromVideo=!1;player;constructor(){this.bytesPipe=new ci();}get videoImageExtensions(){return this.serverConfig.video.image.extensions;}get maxVideoImageSize(){return this.serverConfig.video.image.size.max;}get maxVideoImageSizeInBytes(){return this.bytesPipe.transform(this.maxVideoImageSize);}canSelectFromVideo(){let e=this.videoEdit();if(!e)return;let n=e.getVideoAttributes();return!n.isLive&&n.state===xe.PUBLISHED;}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig(),this.allowedExtensionsMessage=this.videoImageExtensions.join(", ");}onFileChanged(e){this.imageFile=e,this.propagateChange(this.imageFile),this.updatePreview();}onFileDropped(e){return this.onFileChanged(e[0]);}propagateChange=e=>{};writeValue(e){this.imageFile=e,this.updatePreview();}registerOnChange(e){this.propagateChange=e;}registerOnTouched(){}updatePreview(){this.imageFile&&hr(this.imageFile).then(e=>this.imageSrc=e);}selectFromVideo(){this.selectingFromVideo=!0,Do(this.environmentInjector,()=>{Fo(()=>{try{this.player=new qt(this.embed().getIframe());}catch(e){this.notifier.error("Error creating PeerTube embed: "+e.message),this.selectingFromVideo=!1;return;}});});}resetSelectFromVideo(){this.player&&(this.player.destroy(),this.player=void 0),this.selectingFromVideo=!1;}selectFrame(){return $(this,null,function*(){let e=yield this.player.getImageDataUrl();if(e.length<=6)return;this.imageSrc=e;let n=this.dataURItoBlob(e),r=new File([n],"preview-file-from-frame.jpg",{type:"image/jpeg"});this.imageFile=r,this.propagateChange(this.imageFile),this.resetSelectFromVideo();});}dataURItoBlob(e){let n=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],d=new ArrayBuffer(n.length),u=new Uint8Array(d);for(let p=0;p<n.length;p++)u[p]=n.charCodeAt(p);return new Blob([d],{type:r});}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-thumbnail-manager"]],viewQuery:function(n,r){n&1&&rt(r.embed,cd,5),n&2&&Dt();},inputs:{videoEdit:[1,"videoEdit"]},features:[en([{provide:qo,useExisting:bo(()=>i),multi:!0}])],decls:3,vars:1,consts:()=>{let e;e="Ezen k\xE9pkocka haszn\xE1lata";let n;n="M\xE9gse";let r;r="Felt\xF6lt\xE9s";let d;d="In "+"\uFFFD0\uFFFD"+" formats, "+"\uFFFD1\uFFFD"+" maximum.";let u;u="Recommended size: 1280x720px.";let p;p="Current thumbnail";let E;return E=" Select from video ",[["embed",""],e,n,d,u,E,["myDragDrop","",1,"root",3,"fileDropped"],["enableAPI","true","mute","true","autoplay","true",3,"video"],[1,"mt-3"],["type","button",1,"peertube-button","primary-button","me-2",3,"click"],["type","button",1,"peertube-button","secondary-button",3,"click"],[1,"preview-container"],[1,"no-image"],[1,"muted-1"],[1,"muted-2","fs-7"],[1,"d-flex","flex-wrap","mt-4","justify-content-center","gap-3"],["inputName","uploadNewThumbnail","inputLabel",r,"placement","right","theme","secondary","icon","upload",1,"d-inline-block","me-3",3,"fileChanged","extensions","maxFileSize"],["icon","film","theme","secondary"],["alt",p,3,"src"],[1,"muted-2","fs-8","mt-1"],["width","28","height","20","viewBox","0 0 28 20","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.07133 1.61298L24.1845 4.56992C25.1509 4.72768 25.8511 5.6793 25.6766 6.74787L24.0362 16.7967C23.8617 17.8652 22.8953 18.5448 21.9289 18.387L3.81571 15.4301C2.84933 15.2723 2.14915 14.3207 2.32359 13.2521L3.96404 3.20333C4.13848 2.13476 5.10494 1.45522 6.07133 1.61298Z","stroke","currentColor","stroke-width","2"],["d","M11.5786 6.21294L10.4508 13.1215L16.9362 10.6345L11.5786 6.21294Z","fill","currentColor"],["icon","film","theme","secondary",3,"click"]];},template:function(n,r){n&1&&(c(0,"div",6),L("fileDropped",function(u){return r.onFileDropped(u);}),I(1,_d,7,1)(2,gd,16,6),l()),n&2&&(_(),K(r.selectingFromVideo?1:2));},dependencies:[Oe,Vt,Mt,vi,Ct],styles:[`.root[_ngcontent-%COMP%]{min-height:260px;text-align:center;padding:2rem 1.5rem;border-radius:4px;border:1px dashed var(--secondary-icon-color)}@media screen and (max-width: 500px){.root[_ngcontent-%COMP%]{border:0}}img[_ngcontent-%COMP%]{width:280px;height:153px;border-radius:4px}.no-image[_ngcontent-%COMP%]{color:var(--bg-secondary-450)}.no-image[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100px;height:100px}my-embed[_ngcontent-%COMP%]{max-width:500px;width:500px;max-height:280px;height:280px}.root.dragover[_ngcontent-%COMP%]{background-color:var(--bg-secondary-400);border-color:var(--primary)}.root.dragover[_ngcontent-%COMP%]   .no-image[_ngcontent-%COMP%]{color:var(--primary)}
/*# sourceMappingURL=thumbnail-manager.component-QDOOPKPS.css.map */`]}));let t=i;return t;})();var Oa=qe(ht());var On=class{chaptersFromAPI=[];chapters=[];loadFromAPI(i){this.chapters=i||[],this.chaptersFromAPI=i;}loadFromForm(i){let o=i.chapters||[];this.chapters=o.map(e=>({timecode:e.timecode||0,title:e.title}));}toFormPatch(){return{chapters:this.chapters};}getChaptersForUpdate(){return this.chapters.filter(i=>!!i.title);}hasChanges(){return ir(Qn(this.getChaptersForUpdate(),"timecode"),this.chaptersFromAPI)!==!0;}};var wt=(0,Oa.default)("peertube:video-manage:video-edit"),Yi=(()=>{let i=class i{isNewVideo=!1;common={};captions=[];chapters=new On();live;replaceFile;studioTasks=[];videoImport;metadata={};videoAttributes;saveStore={};checkPluginChanges=!1;serverConfig;constructor(e,n=!1){this.serverConfig=e,this.isNewVideo=n;}static createFromUpload(e,n){let r=new i(e,!0);return r.loadFromPublish(n,!1),r;}static createFromImport(e,n){let r=new i(e,!0);return r.loadFromImport(n),r;}loadFromImport(e){this.loadFromPublish(e,!1),this.videoImport={targetUrl:e.targetUrl,magnetUri:e.magnetUri,torrentfile:e.torrentfile},this.updateAfterChange();}static createFromLive(e,n){let r=new i(e,!0);return r.loadFromLive(n),r;}loadFromLive(e){this.loadFromPublish(e,!0),this.live={latencyMode:e.latencyMode,permanentLive:e.permanentLive,saveReplay:e.saveReplay,replaySettings:e.replaySettings?{privacy:e.replaySettings.privacy}:void 0},this.updateAfterChange();}loadFromPublish(e,n){let r=this.serverConfig.defaults;this.common.name=e.name,this.common.channelId=e.channelId,this.common.support=e.support,this.metadata.isLive=n,this.common.privacy=r.publish.privacy,this.common.downloadEnabled=r.publish.downloadEnabled,this.common.licence=r.publish.licence,this.common.commentsPolicy=r.publish.commentsPolicy,this.common.nsfw=this.serverConfig.instance.isNSFW,this.common.waitTranscoding=!0,this.common.tags=[],this.common.pluginData={},this.metadata.views=0,this.metadata.likes=0,this.updateAfterChange();}static createFromAPI(e,n){return $(this,null,function*(){let r=new i(e);return yield r.loadFromAPI(n),r;});}loadFromAPI(e){return $(this,null,function*(){let{video:n,videoPasswords:r,live:d,chapters:u,captions:p,videoSource:E}=e;wt("Load from API",e),this.loadVideo({video:n,videoPasswords:r,saveInStore:!0}),this.loadLive(d),p!==void 0&&(this.captions=p),u!==void 0&&(this.chapters=new On(),u&&this.chapters.loadFromAPI(u)),E!==void 0&&(this.metadata.videoSource=E),yield this.loadPreview(n),this.updateAfterChange();});}loadVideo(e){let{video:n,saveInStore:r,videoPasswords:d=[]}=e;if(n===void 0)return;let u=()=>fe(Z({},this.common),{name:n.name||"",privacy:n.privacy?.id??null,channelId:n.channel?.id??null,category:n.category?.id??null,licence:n.licence?.id??null,language:n.language?.id??null,description:n.description??"",tags:n.tags??[],nsfw:n.nsfw??null,nsfwSummary:n.nsfwSummary??null,nsfwFlags:n.nsfwFlags??st.NONE,waitTranscoding:n.waitTranscoding??null,support:n.support??"",commentsPolicy:n.commentsPolicy?.id??null,downloadEnabled:n.downloadEnabled??null,pluginData:n.pluginData??{},scheduleUpdate:n.scheduledUpdate?{updateAt:new Date(n.scheduledUpdate.updateAt).toISOString(),privacy:n.scheduledUpdate.privacy}:null,originallyPublishedAt:n.originallyPublishedAt?new Date(n.originallyPublishedAt).toISOString():null,videoPasswords:d??[]});if(this.common=u(),r){let p=u();this.saveStore.common=ki(p,["pluginData","previewfile"]);let E=this.saveStore.pluginDefaults||{};this.saveStore.pluginData=Z(Z({},E),p.pluginData);}this.metadata.id=n.id,this.metadata.uuid=n.uuid,this.metadata.shortUUID=n.shortUUID,this.metadata.state=n.state.id,this.metadata.duration=n.duration,this.metadata.views=n.views,this.metadata.likes=n.likes,this.metadata.aspectRatio=n.aspectRatio,this.metadata.blacklisted=n.blacklisted,this.metadata.isLive=n.isLive;}loadPluginDataDefaults(e){this.saveStore.pluginDefaults=e,this.saveStore?.pluginData&&(this.saveStore.pluginData=Z(Z({},this.saveStore.pluginDefaults),this.saveStore.pluginData));}loadPreview(e){return $(this,null,function*(){if(e?.previewPath)try{let n=yield fetch(fr()+e.previewPath);this.common.previewfile=yield n.blob(),this.saveStore.previewfile={size:this.common.previewfile.size};}catch(n){ti.error("Failed to fetch video preview",n);}});}loadLive(e){if(e===void 0){this.metadata.isLive=!1;return;}let n=()=>({permanentLive:e.permanentLive,latencyMode:e.latencyMode,saveReplay:e.saveReplay,replaySettings:e.replaySettings?{privacy:e.replaySettings.privacy}:void 0});this.metadata.isLive=!0,this.live=n(),this.saveStore.live=n(),this.metadata.live=nr(e,["rtmpUrl","rtmpsUrl","streamKey"]);}loadAfterPublish(e){this.metadata.id=e.video.id,this.metadata.uuid=e.video.uuid,this.metadata.shortUUID=e.video.shortUUID,this.updateAfterChange();}loadFromCommonForm(e){if(e.name!==void 0&&(this.common.name=e.name),e.channelId!==void 0&&(this.common.channelId=e.channelId),e.category!==void 0&&(this.common.category=e.category),e.licence!==void 0&&(this.common.licence=e.licence),e.language!==void 0&&(this.common.language=e.language),e.description!==void 0&&(this.common.description=e.description),e.tags!==void 0&&(this.common.tags=e.tags),e.waitTranscoding!==void 0&&(this.common.waitTranscoding=e.waitTranscoding),e.support!==void 0&&(this.common.support=e.support),e.commentsPolicy!==void 0&&(this.common.commentsPolicy=e.commentsPolicy),e.downloadEnabled!==void 0&&(this.common.downloadEnabled=e.downloadEnabled),e.previewfile!==void 0&&(this.common.previewfile=e.previewfile),e.pluginData!==void 0&&(this.common.pluginData=e.pluginData),e.nsfw!==void 0&&(this.common.nsfw=e.nsfw),this.common.nsfw?(e.nsfwFlagSex!==void 0&&(this.common.nsfwFlags=e.nsfwFlagSex?this.common.nsfwFlags|st.EXPLICIT_SEX:this.common.nsfwFlags&~st.EXPLICIT_SEX),e.nsfwFlagViolent!==void 0&&(this.common.nsfwFlags=e.nsfwFlagViolent?this.common.nsfwFlags|st.VIOLENT:this.common.nsfwFlags&~st.VIOLENT),e.nsfwSummary!==void 0&&(this.common.nsfwSummary=e.nsfwSummary)):(this.common.nsfwSummary=null,this.common.nsfwFlags=st.NONE),e.videoPassword!==void 0&&(this.common.videoPasswords=e.privacy===$e.PASSWORD_PROTECTED&&e.videoPassword?[e.videoPassword]:[]),e.privacy!==void 0)if(e.privacy===i.SPECIAL_SCHEDULED_PRIVACY){let n=new Date(e.schedulePublicationAt);n.setSeconds(0),this.common.privacy=$e.PRIVATE,this.common.scheduleUpdate={updateAt:e.schedulePublicationAt?n.toISOString():void 0,privacy:$e.PUBLIC};}else this.common.privacy=e.privacy,this.common.scheduleUpdate=null;e.originallyPublishedAt!==void 0&&(this.common.originallyPublishedAt=e.originallyPublishedAt?new Date(e.originallyPublishedAt).toISOString():null),this.updateAfterChange();}toCommonFormPatch(){let e={category:this.common.category,licence:this.common.licence,language:this.common.language,description:this.common.description,support:this.common.support,name:this.common.name,tags:this.common.tags,nsfw:this.common.nsfw,nsfwFlagSex:(this.common.nsfwFlags&st.EXPLICIT_SEX)===st.EXPLICIT_SEX,nsfwFlagViolent:(this.common.nsfwFlags&st.VIOLENT)===st.VIOLENT,nsfwSummary:this.common.nsfwSummary,commentsPolicy:this.common.commentsPolicy,waitTranscoding:this.common.waitTranscoding,channelId:this.common.channelId,privacy:this.common.privacy,pluginData:this.common.pluginData,previewfile:this.common.previewfile,videoPassword:this.common.videoPasswords&&this.common.videoPasswords.length!==0?this.common.videoPasswords[0]:null,downloadEnabled:this.common.downloadEnabled,originallyPublishedAt:this.common.originallyPublishedAt?new Date(this.common.originallyPublishedAt):null,schedulePublicationAt:void 0};return this.common.scheduleUpdate&&Object.assign(e,{privacy:i.SPECIAL_SCHEDULED_PRIVACY,schedulePublicationAt:new Date(this.common.scheduleUpdate.updateAt.toString())}),e;}toVideoUpdate(){return fe(Z({},this.toVideoCreateOrUpdate()),{pluginData:this.common.pluginData});}toVideoCreate(e){return fe(Z({},this.toVideoCreateOrUpdate()),{privacy:e});}toVideoCreateOrUpdate(){return{name:this.common.name,category:this.common.category||null,licence:this.common.licence||null,language:this.common.language||null,support:this.common.support||null,description:this.common.description||null,channelId:this.common.channelId,privacy:this.common.privacy,videoPasswords:this.common.privacy===$e.PASSWORD_PROTECTED?this.common.videoPasswords:void 0,tags:this.common.tags,nsfw:this.common.nsfw,nsfwFlags:this.common.nsfwFlags,nsfwSummary:this.common.nsfwSummary||null,waitTranscoding:this.common.waitTranscoding,commentsPolicy:this.common.commentsPolicy,downloadEnabled:this.common.downloadEnabled,thumbnailfile:this.common.previewfile,previewfile:this.common.previewfile,scheduleUpdate:this.common.scheduleUpdate||null,originallyPublishedAt:this.common.originallyPublishedAt||null};}loadFromLiveForm(e){e.permanentLive!==void 0&&(this.live.permanentLive=e.permanentLive),e.latencyMode!==void 0&&(this.live.latencyMode=e.latencyMode),e.saveReplay!==void 0&&(this.live.saveReplay=e.saveReplay),e.replayPrivacy!==void 0&&(this.live.replaySettings=e.replayPrivacy?{privacy:e.replayPrivacy}:void 0),this.updateAfterChange();}toLiveFormPatch(){return{liveStreamKey:this.metadata.live.streamKey,permanentLive:this.live.permanentLive,latencyMode:this.live.latencyMode,saveReplay:this.live.saveReplay,replayPrivacy:this.live.replaySettings?this.live.replaySettings.privacy:$e.PRIVATE};}toLiveUpdate(){return{permanentLive:this.live.permanentLive,saveReplay:this.live.saveReplay,replaySettings:this.live.saveReplay?this.live.replaySettings:void 0,latencyMode:this.live.latencyMode};}toLiveCreate(e){return fe(Z({},this.toVideoCreate(e)),{permanentLive:this.live.permanentLive,latencyMode:this.live.latencyMode,saveReplay:this.live.saveReplay,replaySettings:this.live.replaySettings});}toVideoImportCreate(e){let n=this.toVideoCreate(e);return this.videoImport.targetUrl&&(n.targetUrl=this.videoImport.targetUrl),this.videoImport.magnetUri&&(n.magnetUri=this.videoImport.magnetUri),this.videoImport.torrentfile&&(n.torrentfile=this.videoImport.torrentfile),n;}loadFromReplaceFileForm(e){this.replaceFile=e.replaceFile,this.updateAfterChange();}toReplaceFileFormPatch(){return{replaceFile:this.replaceFile};}resetReplaceFile(){this.replaceFile=void 0;}loadFromStudioForm(e){let n=this.getVideoAttributes().duration;this.studioTasks=[];let r=e.cut;if(jt(r.start)&&r.start!==0||jt(r.end)&&r.end!==n){let d={};jt(r.start)&&r.start!==0&&(d.start=r.start),jt(r.end)&&r.end!==n&&(d.end=r.end),this.studioTasks.push({name:"cut",options:d});}e["add-intro"]?.file&&this.studioTasks.push({name:"add-intro",options:{file:e["add-intro"].file}}),e["add-outro"]?.file&&this.studioTasks.push({name:"add-outro",options:{file:e["add-outro"].file}}),e["add-watermark"]?.file&&this.studioTasks.push({name:"add-watermark",options:{file:e["add-watermark"].file}});}toStudioFormPatch(){let e=this.studioTasks.find(u=>u.name==="cut"),n=this.studioTasks.find(u=>u.name==="add-intro"),r=this.studioTasks.find(u=>u.name==="add-outro"),d=this.studioTasks.find(u=>u.name==="add-watermark");return{cut:{start:e?.options?.start??0,end:e?.options?.end??this.metadata.duration},"add-intro":{file:n?.options?.file??null},"add-outro":{file:r?.options?.file},"add-watermark":{file:d?.options?.file}};}resetStudio(){this.studioTasks=[];}getVideoSource(){return this.metadata.videoSource;}getLive(){return this.metadata.live;}getVideoAttributes(){return this.videoAttributes;}getChaptersEdit(){return this.chapters;}getReplaceFile(){return this.replaceFile;}getCaptionsEdit(){return this.captions;}getStudioTasks(){return this.studioTasks;}getStudioTasksSummary(){return this.getStudioTasks().map(e=>{if(e.name==="add-intro")return"A(z) \u201E"+e.options.file.name+"\u201D a vide\xF3 elej\xE9hez lesz adva";if(e.name==="add-outro")return"A(z) \u201E"+e.options.file.name+"\u201D a vide\xF3 v\xE9g\xE9hez lesz adva";if(e.name==="add-watermark")return"A(z) \u201E"+e.options.file.name+"\u201D v\xEDzjelk\xE9p a vide\xF3hoz lesz adva";if(e.name==="cut"){let{start:n,end:r}=e.options;if(n!==void 0&&r!==void 0)return"A vide\xF3 "+ft(n)+" m\xFAlva indul, \xE9s "+ft(r)+" m\xFAlva \xE9r v\xE9get";if(n!==void 0)return"A vide\xF3 "+ft(n)+" m\xFAlva indul";if(r!==void 0)return"A vide\xF3 "+ft(r)+" m\xFAlva \xE9r v\xE9get";}return"";});}hasCommonChanges(){if(this.isNewVideo||!this.saveStore.common)return!0;let e=!this.areSameObjects(ki(this.common,["previewfile","pluginData"]),this.saveStore.common);return e!==!0&&(this.common.previewfile||this.saveStore.previewfile)&&(e=this.common.previewfile?.size!==this.saveStore.previewfile?.size),wt("Check if has common changes",{changes:e,common:this.common,saveCommon:this.saveStore.common,savePreview:this.saveStore.previewfile}),e;}hasPluginDataChanges(){if(!this.checkPluginChanges)return!1;if(!this.saveStore.pluginData)return!0;let e=this.common.pluginData,n=!this.areSameObjects(e,this.saveStore.pluginData);return wt("Check if has plugin data changes",{changes:n,pluginData:e,savePluginData:this.saveStore.pluginData}),n;}hasCaptionChanges(){let e=this.captions.some(n=>!!n.action);return wt("Check if caption has changes",{captions:this.captions,changes:e}),e;}hasChaptersChanges(){let e=this.chapters.hasChanges();return wt("Check if chapters has changes",{chapters:this.chapters,changes:e}),e;}hasLiveChanges(){if(!this.live)return!1;if(!this.saveStore.live)return!0;let e=!this.areSameObjects(this.live,this.saveStore.live);return wt("Check if live has changes",{live:this.live,saveLive:this.saveStore.live,changes:e}),e;}hasReplaceFile(){let e=!!this.replaceFile;return wt("Check if replace file has changes",{replaceFile:this.replaceFile,changes:e}),e;}hasStudioTasks(){let e=this.studioTasks.length!==0;return wt("Check if studio has changes",{studioTasks:this.studioTasks,changes:e}),e;}hasPendingChanges(){return this.hasCaptionChanges()||this.hasLiveChanges()||this.hasReplaceFile()||this.hasStudioTasks()||this.hasChaptersChanges()||this.hasCommonChanges()||this.hasPluginDataChanges();}isPublishedVOD(){return!this.metadata.isLive&&this.metadata.state===xe.PUBLISHED;}updateAfterChange(){this.videoAttributes={id:this.metadata.id,shortUUID:this.metadata.shortUUID,uuid:this.metadata.uuid,name:this.common.name,state:this.metadata.state,privacy:this.common.privacy,isLive:this.metadata.isLive,aspectRatio:this.metadata.aspectRatio,views:this.metadata.views,likes:this.metadata.likes,duration:this.metadata.duration,blacklisted:this.metadata.blacklisted,live:this.metadata.live};}areSameObjects(e,n){if(typeof e=="string")return e===n||!e&&n===null;if(typeof n=="string")return e===n||!n&&e===null;if(e===void 0)return!jt(n);if(n===void 0)return!jt(e);if(e===n)return!0;if(typeof e!="object"||typeof n!="object"||e===null||n===null)return!1;let r=Object.keys(e),d=Object.keys(n);if(r.length!==d.length)return!1;for(let u of r)if(!d.includes(u)||!this.areSameObjects(e[u],n[u]))return!1;return!0;}onSave(){this.isNewVideo=!1;}enableCheckPluginChanges(){this.checkPluginChanges=!0;}disableCheckPluginChanges(){this.checkPluginChanges=!1;}};T(i,"SPECIAL_SCHEDULED_PRIVACY",-1);let t=i;return t;})();var Ia=t=>({$implicit:t});function Ed(t,i){if(t&1&&(c(0,"div",63),v(1,"my-dynamic-form-field",64),l()),t&2){let o=i.$implicit,e=h();g("hidden",e.isPluginFieldHidden(o)),_(),g("form",e.pluginDataFormGroup)("formErrors",e.formErrors.pluginData)("setting",o.commonOptions);}}function fd(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h();_(),Y(o.formErrors.name);}}function hd(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h();_(),Y(o.formErrors.tags);}}function Cd(t,i){if(t&1&&yt(0,66),t&2){let o=i.$implicit;h();let e=Ge(6);g("ngTemplateOutlet",e)("ngTemplateOutletContext",be(2,Ia,o));}}function Sd(t,i){if(t&1&&yt(0,66),t&2){let o=i.$implicit;h();let e=Ge(6);g("ngTemplateOutlet",e)("ngTemplateOutletContext",be(2,Ia,o));}}function Md(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h();_(),ue(" ",o.formErrors.privacy," ");}}function Ad(t,i){if(t&1&&(c(0,"div",30)(1,"label",67),C(2,19),l(),v(3,"my-input-text",68),l()),t&2){let o=h();_(3),g("withCopy",!0)("formError",o.formErrors.videoPassword);}}function vd(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h(2);_(),ue(" ",o.formErrors.schedulePublicationAt," ");}}function Od(t,i){if(t&1&&(c(0,"div",30)(1,"label",69),C(2,20),l(),v(3,"p-calendar",70),I(4,vd,2,1,"div",33),l()),t&2){let o=h();_(2),Ae(o.calendarTimezone),ve(2),_(),g("dateFormat",o.calendarDateFormat)("firstDayOfWeek",0)("minDate",o.minScheduledDate)("showTime",!0)("hideOnDateTimeSelect",!0),_(),g("ngIf",o.formErrors.schedulePublicationAt);}}function Pd(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h();_(),ue(" ",o.formErrors.licence," ");}}function Id(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h();_(),ue(" ",o.formErrors.category," ");}}function Nd(t,i){if(t&1&&(c(0,"div",65),R(1),l()),t&2){let o=h();_(),ue(" ",o.formErrors.language," ");}}function Td(t,i){t&1&&(B(0),C(1,21),X());}function bd(t,i){t&1&&(B(0),C(1,22),X());}function yd(t,i){t&1&&(c(0,"my-peertube-checkbox",71),I(1,Td,2,0,"ng-template",72)(2,bd,2,0,"ng-template",73),l());}function Dd(t,i){if(t&1){let o=q();c(0,"div")(1,"div",74)(2,"h3",75),C(3,23),l(),c(4,"div",30)(5,"label",76),C(6,24),l(),c(7,"div",35),C(8,25),l(),c(9,"button",77),L("click",function(){F(o);let n=h();return V(n.deleteVideo());}),C(10,26),l()()()();}}var Rd=(0,Pa.default)("peertube:video-manage"),qi=(()=>{let i=class i{formValidatorService=A(Jn);formReactiveService=A(he);videoService=A(Fe);serverService=A(ie);pluginService=A(Sr);instanceService=A(Or);i18nPrimengCalendarService=A(Ci);ngZone=A(xo);hooks=A(Mr);cd=A(Bn);manageController=A(ae);confirmService=A(nn);notifier=A(Ue);router=A(jo);form;formErrors={};validationMessages={};forbidScheduledPublication;hideWaitTranscoding;videoPrivacies=[];videoCategories=[];videoLicences=[];videoLanguages=[];pluginDataFormGroup;schedulePublicationSelected=!1;passwordProtectionSelected=!1;calendarLocale={};minScheduledDate=new Date();calendarTimezone;calendarDateFormat;myYearRange;serverConfig;pluginFields=[];manageType;firstPatchDone=!1;userChannels=[];privacies=[];videoEdit;schedulerInterval;updatedSub;constructor(){this.calendarTimezone=this.i18nPrimengCalendarService.getTimezone(),this.calendarDateFormat=this.i18nPrimengCalendarService.getDateFormat(),this.myYearRange=this.i18nPrimengCalendarService.getVideoPublicationYearRange();}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig();let{videoEdit:e,userChannels:n}=this.manageController.getStore();this.videoEdit=e,this.userChannels=n;let{manageType:r,hideWaitTranscoding:d,forbidScheduledPublication:u}=this.manageController.getConfig();this.manageType=r,this.hideWaitTranscoding=d,this.forbidScheduledPublication=u,this.buildForm(),this.pluginService.ensurePluginsAreLoaded("video-edit").then(()=>this.updatePluginFields()),this.serverService.getVideoCategories().subscribe(E=>this.videoCategories=E),this.serverService.getVideoLicences().subscribe(E=>this.videoLicences=E),this.buildLanguages(),this.buildPrivacies(),this.ngZone.runOutsideAngular(()=>{this.schedulerInterval=setInterval(()=>this.minScheduledDate=new Date(),1e3*60);});let p=E=>{this.form.patchValue(E),this.cd.detectChanges();};this.hooks.runAction("action:video-edit.init","video-edit",{type:this.manageType,updateForm:p}),this.form.valueChanges.subscribe(()=>{let E=this.form.value;this.hooks.runAction("action:video-edit.form.updated","video-edit",{type:this.manageType,formValues:E}),this.manageController.setFormError("Main information",".",this.formErrors),Rd("Updating form values",E),this.videoEdit.loadFromCommonForm(E);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.form.patchValue(this.videoEdit.toCommonFormPatch());}),this.manageController.registerSaveHook(()=>$(this,null,function*(){yield this.formReactiveService.waitPendingCheck(this.form),this.formReactiveService.forceCheck(this.form,this.formErrors,this.validationMessages),this.manageController.setFormError("Main information",".",this.formErrors);}));}ngOnDestroy(){this.schedulerInterval&&clearInterval(this.schedulerInterval),this.updatedSub?.unsubscribe(),this.manageController.unregisterSaveHook(),this.videoEdit.disableCheckPluginChanges();}buildLanguages(){Gn([this.instanceService.getAbout(),this.serverService.getVideoLanguages()]).pipe(Io(([e,n])=>({about:e,languages:n}))).subscribe(({about:e,languages:n})=>{this.videoLanguages=[...n.filter(r=>e.instance.languages.includes(r.id)),n.find(r=>r.id==="zxx"),...n.filter(r=>!e.instance.languages.includes(r.id)&&r.id!=="zxx")];});}buildPrivacies(){let{privacies:e}=this.manageController.getStore();this.videoPrivacies=this.videoService.explainedPrivacyLabels(e).videoPrivacies;let n=this.videoPrivacies.some(r=>r.id===$e.PRIVATE);this.forbidScheduledPublication||!n||this.videoPrivacies.push({id:Yi.SPECIAL_SCHEDULED_PRIVACY,label:"\xDCtemezett",description:"A vide\xF3 elrejt\xE9se egy megadott d\xE1tumig"});}buildForm(){let e=this.videoEdit.toCommonFormPatch(),n={name:ra,privacy:aa,videoPassword:ji,channelId:ca,waitTranscoding:null,category:sa,licence:la,language:da,description:_a,tags:ma,previewfile:null,support:pa,schedulePublicationAt:ga},{form:r,formErrors:d,validationMessages:u}=this.formReactiveService.buildForm(n,e);this.form=r,this.formErrors=d,this.validationMessages=u,this.updateScheduleRelatedControls(e.privacy,!0),this.trackChannelChange(),this.trackPrivacyChange();}getChannelUpdateUrl(){let e=this.form.value.channelId,n=this.userChannels.find(r=>r.id===e);return n?["/my-library/video-channels/update/",n.name]:"";}isPluginFieldHidden(e){return typeof e.commonOptions.hidden!="function"?!1:e.commonOptions.hidden({formValues:this.form.value,videoToUpdate:this.videoEdit,liveVideo:this.videoEdit.getLive()});}getPluginsFields(e){return this.pluginFields.filter(n=>(n.videoFormOptions.tab??"plugin-settings")===e);}updatePluginFields(){return $(this,null,function*(){if(this.pluginFields=this.pluginService.getRegisteredVideoFormFields(this.manageType),this.pluginFields.length===0)return;let{pluginData:e}=this.videoEdit.toCommonFormPatch(),n={},r={},d={},u={};for(let p of this.pluginFields){if(yield this.pluginService.translateSetting(p.pluginInfo.plugin.npmName,p.commonOptions),p.commonOptions.type==="html")continue;let E=P=>$(this,null,function*(){if(!p.commonOptions.error)return null;let N=yield p.commonOptions.error({formValues:this.form.value,value:P.value});return N?.error?{[p.commonOptions.name]:N.text}:null;}),S=p.commonOptions.name;n[S]={ASYNC_VALIDATORS:[E],VALIDATORS:[],MESSAGES:{}},u[S]=e?.[S]??p.commonOptions.default;}this.pluginDataFormGroup=new Zo({}),this.formValidatorService.updateFormGroup(this.pluginDataFormGroup,d,r,n,u),this.videoEdit.loadPluginDataDefaults(u),this.videoEdit.enableCheckPluginChanges(),this.form.addControl("pluginData",this.pluginDataFormGroup),this.formErrors.pluginData=d,this.validationMessages.pluginData=r,this.formReactiveService.markAllAsDirty(this.form.controls),this.cd.detectChanges(),this.form.valueChanges.subscribe(()=>this.formValidatorService.updateTreeValidity(this.pluginDataFormGroup));});}trackPrivacyChange(){this.form.controls.privacy.valueChanges.subscribe(e=>this.updateScheduleRelatedControls(e));}updateScheduleRelatedControls(e,n=!1){this.schedulePublicationSelected=e===Yi.SPECIAL_SCHEDULED_PRIVACY;let r=this.form.get("schedulePublicationAt"),d=this.form.get("waitTranscoding");this.schedulePublicationSelected?(r.setValidators([ee.required]),d.disable(),n||d.setValue(!1)):(r.clearValidators(),d.enable(),n||d.setValue(!0)),r.updateValueAndValidity(),d.updateValueAndValidity(),this.passwordProtectionSelected=e===$e.PASSWORD_PROTECTED;let u=this.form.get("videoPassword");this.passwordProtectionSelected?u.setValidators([ee.required,...ji.VALIDATORS]):u.clearValidators(),u.updateValueAndValidity();}trackChannelChange(){this.form.controls.channelId.valueChanges.subscribe(e=>this.updateSupportFromChannel(e));}updateSupportFromChannel(e){let n=this.userChannels.find(p=>p.id===e);if(!n)return;let r=this.form.value.support,d=this.form.value.channelId,u=this.userChannels.find(p=>p.id===d);if(!n||!u){ti.error("Cannot find new or old channel.");return;}d!==n.id&&(r&&r!==u.support||this.updateSupportField(n.support));}updateSupportField(e){return this.form.patchValue({support:e||""});}canBeDeleted(){return!!this.videoEdit.getVideoAttributes().id;}deleteVideo(){return $(this,null,function*(){let e=this.videoEdit.getVideoAttributes(),n="Are you sure you want to delete your video \""+e.name+"?";(yield this.confirmService.confirm(n,"T\xF6rl\xE9s"))!==!1&&this.videoService.removeVideo(e.id).subscribe({next:()=>{this.notifier.success("\""+e.name+"\" deleted"),this.router.navigate(["/my-library/videos"]);},error:d=>this.notifier.error(d.message)});});}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-main-info"]],decls:90,vars:23,consts:()=>{let e;e="Main information";let n;n="Video title";let r;r="Le\xEDr\xE1s";let d;d=" You can format your description using the "+"\uFFFD#20\uFFFD"+"Markdown Language"+"\uFFFD/#20\uFFFD"+": ";let u;u="For example, to put "+"\uFFFD#24\uFFFD"+"text in bold"+"\uFFFD/#24\uFFFD"+" (**text in bold**) or "+"\uFFFD#25\uFFFD"+"text in italic"+"\uFFFD/#25\uFFFD"+" (*text in italic*)";let p;p="You can also create a link to a specific timecode of the video (e.g. "+"[\uFFFD#28\uFFFD|\uFFFD#29\uFFFD]"+"00:05"+"[\uFFFD/#28\uFFFD|\uFFFD/#29\uFFFD]"+" by simply writing 00:05) or "+"[\uFFFD#28\uFFFD|\uFFFD#29\uFFFD]"+"a classic link"+"[\uFFFD/#28\uFFFD|\uFFFD/#29\uFFFD]"+" ([title of my link](https://example.com))",p=Sn(p);let E;E="C\xEDmk\xE9k";let S;S="Maximum of 5 tags to suggest relevant recommendations.";let P;P="Support button";let N;N=" This is text that helps people watching your video "+"[\uFFFD#44\uFFFD|\uFFFD#46\uFFFD]"+"understand how to support you"+"[\uFFFD/#44\uFFFD|\uFFFD/#46\uFFFD]"+". You can use "+"\uFFFD#45\uFFFD"+"Markdown Language"+"\uFFFD/#45\uFFFD"+", including "+"[\uFFFD#44\uFFFD|\uFFFD#46\uFFFD]"+"links to your fundraising tools"+"[\uFFFD/#44\uFFFD|\uFFFD/#46\uFFFD]"+". ",N=Sn(N);let D;D=" Do you want to use the same text for all your videos? You can define "+"\uFFFD#50\uFFFD"+"a default text and support button"+"\uFFFD/#50\uFFFD"+" in your "+"\uFFFD#51\uFFFD"+"channel settings"+"\uFFFD/#51\uFFFD"+". ";let x;x="Csatorna";let W;W="Thumbnail";let H;H="Adatv\xE9delem";let k;k="Licenc";let _e;_e=""+"\uFFFD#75\uFFFD"+"V\xE1lasszon"+"\uFFFD/#75\uFFFD"+" egy megfelel\u0151 licencet a munk\xE1j\xE1hoz. ";let w;w="Kateg\xF3ria";let ne;ne="Nyelv";let Be;Be="Jelsz\xF3";let Xe;Xe="K\xF6zz\xE9t\xE9tel \xFCtemez\xE9se ( "+"\uFFFD0\uFFFD"+")";let ke;ke="Publish video after transcoding";let We;We="Ez a vide\xF3 lehet, hogy nem j\xE1tszhat\xF3 le az \xE1tk\xF3dol\xE1s folyamata alatt. Ez az oka annak, hogy jobban szeretj\xFCk csak az \xE1tk\xF3dol\xE1s ut\xE1n k\xF6zz\xE9tenni a vide\xF3kat.";let tt;tt="VESZ\xC9LYZ\xD3NA";let nt;nt="Delete your video";let vt;vt="Warning: this is a definitive action!";let se;return se="T\xF6rl\xE9s",[["pluginSettingTemplate",""],e,n,r,d,u,p,E,S,P,N,D,x,W,H,k,_e,w,ne,Be,Xe,ke,We,tt,nt,vt,se,["iconName","film"],[3,"formGroup"],[1,"form-columns"],[1,"form-group"],["for","name"],["type","text","id","name","formControlName","name",1,"form-control"],["class","form-error","role","alert",4,"ngIf"],["for","description"],[1,"form-group-description"],["helpType","markdownText"],[1,"fake-link"],["inputId","description","formControlName","description","withEmoji","true","withShowMoreButton","true",3,"markdownVideo","formError"],["for","label-tags",1,"label-tags"],["inputId","label-tags","formControlName","tags",1,"d-block","w-100"],[1,"form-group","mb-5"],["for","support"],["inputId","support","formControlName","support","markdownType","enhanced","withEmoji","true","withHtml","true",3,"formError"],[1,"form-group-description","mt-3"],["target","_blank","rel","noopener noreferrer",3,"routerLink"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],["for","channel"],["inputId","channel","formControlName","channelId",1,"d-block",3,"items"],["for","previewfile"],["id","previewfile","formControlName","previewfile",3,"videoEdit"],["for","privacy"],["inputId","privacy","formControlName","privacy",3,"items"],["class","form-group",4,"ngIf"],["for","licence"],["href","https://chooser-beta.creativecommons.org/","target","_blank","rel","noopener noreferrer"],["inputId","licence","formControlName","licence","clearable","true",3,"items"],["for","category"],["inputId","category","formControlName","category","clearable","true",3,"items"],["for","language"],["inputId","language","formControlName","language","clearable","true","filter","true","virtualScroll","true",3,"items"],["inputName","waitTranscoding","formControlName","waitTranscoding","helpPlacement","bottom-right",4,"ngIf"],[4,"ngIf"],[3,"hidden"],[3,"form","formErrors","setting"],["role","alert",1,"form-error"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["for","videoPassword"],["formControlName","videoPassword","inputId","videoPassword",3,"withCopy","formError"],["for","schedulePublicationAt"],["id","schedulePublicationAt","formControlName","schedulePublicationAt","baseZIndex","20000",3,"dateFormat","firstDayOfWeek","minDate","showTime","hideOnDateTimeSelect"],["inputName","waitTranscoding","formControlName","waitTranscoding","helpPlacement","bottom-right"],["ptTemplate","label"],["ptTemplate","help"],[1,"danger-zone","mt-5"],[1,"mb-3"],["for","deleteVideo"],[1,"peertube-button","danger-button",3,"click"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",27),B(2),C(3,1),X(),l(),c(4,"div",28),I(5,Ed,2,4,"ng-template",null,0,at),c(7,"div",29)(8,"div")(9,"div",30)(10,"label",31),C(11,2),l(),v(12,"input",32),I(13,fd,2,1,"div",33),l(),c(14,"div",30)(15,"label",34),C(16,3),l(),c(17,"div",35)(18,"div"),Se(19,4),v(20,"my-markdown-hint",36),Me(),l(),c(21,"ul")(22,"li"),Se(23,5),v(24,"strong")(25,"em"),Me(),l(),c(26,"li"),Se(27,6),v(28,"span",37)(29,"span",37),Me(),l()()(),v(30,"my-markdown-textarea",38),l(),c(31,"div",30)(32,"label",39),C(33,7),l(),c(34,"div",35),B(35),C(36,8),X(),l(),v(37,"my-select-tags",40),I(38,hd,2,1,"div",33),l(),c(39,"div",41)(40,"label",42),C(41,9),l(),c(42,"div",35),Se(43,10),v(44,"strong")(45,"my-markdown-hint",36)(46,"strong"),Me(),l(),v(47,"my-markdown-textarea",43),c(48,"div",44),Se(49,11),v(50,"strong")(51,"a",45),Me(),l()(),I(52,Cd,1,4,"ng-container",46)(53,Sd,1,4,"ng-container",46),l(),c(54,"div")(55,"div",30)(56,"label",47),C(57,12),l(),v(58,"my-select-channel",48),l(),c(59,"div",30)(60,"label",49),C(61,13),l(),v(62,"my-thumbnail-manager",50),l(),c(63,"div",30)(64,"label",51),C(65,14),l(),v(66,"my-select-options",52),I(67,Md,2,1,"div",33),l(),I(68,Ad,4,2,"div",53)(69,Od,5,7,"div",53),c(70,"div",30)(71,"label",54),C(72,15),l(),c(73,"div",35),Se(74,16),v(75,"a",55),Me(),l(),v(76,"my-select-options",56),I(77,Pd,2,1,"div",33),l(),c(78,"div",30)(79,"label",57),C(80,17),l(),v(81,"my-select-options",58),I(82,Id,2,1,"div",33),l(),c(83,"div",30)(84,"label",59),C(85,18),l(),v(86,"my-select-options",60),I(87,Nd,2,1,"div",33),l(),I(88,yd,3,0,"my-peertube-checkbox",61),l()(),I(89,Dd,11,0,"div",62),l()),n&2&&(_(4),g("formGroup",r.form),_(9),g("ngIf",r.formErrors.name),_(17),g("markdownVideo",r.videoEdit.getVideoAttributes())("formError",r.formErrors.description),_(8),g("ngIf",r.formErrors.tags),_(9),g("formError",r.formErrors.support),_(4),g("routerLink",r.getChannelUpdateUrl()),_(),g("ngForOf",r.getPluginsFields("main")),_(),g("ngForOf",r.getPluginsFields("plugin-settings")),_(5),g("items",r.userChannels),_(4),g("videoEdit",r.videoEdit),_(4),g("items",r.videoPrivacies),_(),g("ngIf",r.formErrors.privacy),_(),g("ngIf",r.passwordProtectionSelected),_(),g("ngIf",r.schedulePublicationSelected),_(7),g("items",r.videoLicences),_(),g("ngIf",r.formErrors.licence),_(4),g("items",r.videoCategories),_(),g("ngIf",r.formErrors.category),_(4),g("items",r.videoLanguages),_(),g("ngIf",r.formErrors.language),_(),g("ngIf",!r.hideWaitTranscoding),_(),g("ngIf",r.canBeDeleted()));},dependencies:[Oe,Ke,Q,Xn,J,gt,Pe,ye,te,De,Re,Tr,on,br,Pr,Vr,Ft,di,et,mi,St,va,oe,Lr,ut],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`]}));let t=i;return t;})();var Na=qe(ht());var xd=t=>({"input-error":t});function Fd(t,i){t&1&&(B(0),C(1,4),X());}function Vd(t,i){if(t&1&&(c(0,"div",23),R(1),l()),t&2){let o=h();_(),Y(o.formErrors.nsfwSummary);}}function Ld(t,i){t&1&&(B(0),C(1,5),X());}function wd(t,i){t&1&&(B(0),C(1,6),X());}var Gd=(0,Na.default)("peertube:video-manage"),Ta=(()=>{let i=class i{formReactiveService=A(he);serverService=A(ie);manageController=A(ae);form;formErrors={};validationMessages={};commentPolicies=[];serverConfig;updatedSub;ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig(),this.buildForm(),this.serverService.getCommentPolicies().subscribe(e=>this.commentPolicies=e);}ngOnDestroy(){this.updatedSub?.unsubscribe();}buildForm(){let e=this.manageController.getStore().videoEdit,n=e.toCommonFormPatch(),r={commentsPolicy:null,nsfw:null,nsfwFlagViolent:null,nsfwFlagSex:null,nsfwSummary:ua},{form:d,formErrors:u,validationMessages:p}=this.formReactiveService.buildForm(r,n);this.form=d,this.formErrors=u,this.validationMessages=p,this.form.valueChanges.subscribe(()=>{this.manageController.setFormError("Moder\xE1l\xE1s","moderation",this.formErrors);let E=this.form.value;Gd("Updating form values",E),e.loadFromCommonForm(E);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.form.patchValue(e.toCommonFormPatch());}),this.updateNSFWControls(e.toCommonFormPatch().nsfw),this.trackNSFWChange();}trackNSFWChange(){this.form.controls.nsfw.valueChanges.subscribe(e=>this.updateNSFWControls(e));}updateNSFWControls(e){let n=[this.form.controls.nsfwFlagViolent,this.form.controls.nsfwFlagSex,this.form.controls.nsfwSummary];if(!e){for(let r of n)r.disable();return;}for(let r of n)r.enable();}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-moderation"]],decls:26,vars:6,consts:()=>{let e;e="Hozz\xE1sz\xF3l\xE1sok h\xE1zirendje";let n;n="Moder\xE1l\xE1s";let r;r="Megk\xF6veteli a hozz\xE1sz\xF3l\xE1sok j\xF3v\xE1hagy\xE1s\xE1t az "+"\uFFFD#11\uFFFD"+"automatikus c\xEDmk\xE9z\xE9si h\xE1zirend alapj\xE1n"+"\uFFFD/#11\uFFFD"+"";let d;d="Describe what makes your content sensitive";let u;u="Help viewers to identify your sensitive content";let p;p="Your video contains sensitive content";let E;E="Some images may be violent";let S;return S="Content may be perceived as sexually explicit material",[n,r,d,u,p,E,S,["iconName","moderation"],[3,"formGroup"],[1,"form-columns"],[1,"form-group"],["label",e,"inputId","commentsPolicy","formControlName","commentsPolicy",3,"items"],[1,"form-group-description"],["routerLink","/my-account/auto-tag-policies","target","_blank"],["inputName","nsfw","formControlName","nsfw"],["ptTemplate","label"],["ngProjectAs","extra",5,["extra"]],["for","nsfwSummary"],["type","text","id","nsfwSummary","formControlName","nsfwSummary",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"label"],["inputName","nsfwFlagViolent","formControlName","nsfwFlagViolent"],["inputName","nsfwFlagSex","formControlName","nsfwFlagSex"],["role","alert",1,"form-error"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",7),B(2),C(3,0),X(),l(),c(4,"div",8)(5,"div",9)(6,"div")(7,"div",10)(8,"my-select-radio",11)(9,"div",12),Se(10,1),v(11,"a",13),Me(),l()()(),c(12,"my-peertube-checkbox",14),I(13,Fd,2,0,"ng-template",15),B(14,16),c(15,"div",10)(16,"label",17),C(17,2),l(),v(18,"input",18),I(19,Vd,2,1,"div",19),l(),c(20,"div",20),C(21,3),l(),c(22,"my-peertube-checkbox",21),I(23,Ld,2,0,"ng-template",15),l(),c(24,"my-peertube-checkbox",22),I(25,wd,2,0,"ng-template",15),l(),X(),l()()()()),n&2&&(_(4),g("formGroup",r.form),_(4),g("items",r.commentPolicies),_(10),g("ngClass",be(4,xd,r.formErrors.nsfwSummary)),_(),g("ngIf",r.formErrors.nsfwSummary));},dependencies:[Oe,Rt,Q,ut,J,gt,Pe,ye,te,De,Re,on,et,St,oe,vr],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`]}));let t=i;return t;})();var ba=qe(ht());function Oi(t){let{isLive:i,replaceFileEnabled:o,state:e,instanceName:n}=t;return o?zi(e)?"":i?"File replacement is not available on a live.":e===xe.TO_TRANSCODE?"File replacement is not available while the video is being transcoded.":e===xe.TO_EDIT?"File replacement is not available while the video is being edited.":e===xe.TO_IMPORT?"File replacement is not available while the video is being imported.":"File replacement is not available.":"File replacement is not enabled on "+n+".";}function Pi(t){let{isLive:i,studioEnabled:o,state:e,instanceName:n}=t;return o?zi(e)?"":i?"Studio is not available on a live.":e===xe.TO_TRANSCODE?"Studio is not available while the video is being transcoded.":e===xe.TO_EDIT?"Studio is not available while the video is being edited.":e===xe.TO_IMPORT?"Studio is not available while the video is being imported.":"Studio is not available.":"Studio is not enabled on "+n+".";}var $d=["reactiveFileInput"];function Ud(t,i){if(t&1&&(c(0,"my-alert",6),C(1,2),l()),t&2){let o=h();_(),Ae(o.getUnavailability()),ve(1);}}function Hd(t,i){if(t&1&&(c(0,"div",16)(1,"div",17),C(2,4),l(),c(3,"strong",18),R(4),l()()),t&2){let o=h(2);_(4),Y(o.videoEdit.getVideoSource().filename);}}function kd(t,i){if(t&1){let o=q();c(0,"div",8),L("fileDropped",function(n){F(o);let r=h();return V(r.onFileDropped(n));}),I(1,Hd,5,1,"div",9),c(2,"div",10)(3,"div",11)(4,"strong"),R(5,"Drag and drop your new video file here"),l(),R(6," or click on the button below to replace your video: "),l(),c(7,"div",12)(8,"div",13),C(9,3),l()(),c(10,"div",14)(11,"my-reactive-file",15,0),L("fileChanged",function(n){F(o);let r=h();return V(r.onFileChanged(n));}),l()()()();}if(t&2){let o=h();_(),g("ngIf",o.videoEdit.getVideoSource()),_(10),g("extensions",o.getVideoExtensions())("displayFilename",!0)("displayReset",!1);}}var zd=(0,ba.default)("peertube:video-manage"),ya=(()=>{let i=class i{formReactiveService=A(he);videoUploadService=A(Mi);manageController=A(ae);server=A(ie);form;formErrors={};validationMessages={};videoEdit;replaceFileEnabled;instanceName;updatedSub;ngOnInit(){this.videoEdit=this.manageController.getStore().videoEdit;let e=this.server.getHTMLConfig();this.replaceFileEnabled=e.videoFile.update.enabled===!0,this.instanceName=e.instance.name;let n=this.videoEdit.toReplaceFileFormPatch(),r={replaceFile:null},{form:d,formErrors:u,validationMessages:p}=this.formReactiveService.buildForm(r,n);this.form=d,this.formErrors=u,this.validationMessages=p,this.form.valueChanges.subscribe(()=>{this.manageController.setFormError("Replace file","replace-file",this.formErrors);let E=this.form.value;zd("Updating form values",E),this.videoEdit.loadFromReplaceFileForm(E);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.form.patchValue(this.videoEdit.toReplaceFileFormPatch());});}ngOnDestroy(){this.updatedSub?.unsubscribe();}reactiveFile;onFileDropped(e){this.reactiveFile.fileChange({target:{files:e}});}onFileChanged(e){e&&e instanceof File&&(this.form.controls.replaceFile.setValue(e),this.form.controls.replaceFile.markAsDirty(),this.form.markAsDirty(),this.form.updateValueAndValidity());}getVideoExtensions(){return this.videoUploadService.getVideoExtensions();}getUnavailability(){return Oi(fe(Z({},this.videoEdit.getVideoAttributes()),{instanceName:this.instanceName,replaceFileEnabled:this.replaceFileEnabled}));}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-replace-file"]],viewQuery:function(n,r){if(n&1&&$o($d,5),n&2){let d;Uo(d=Ho())&&(r.reactiveFile=d.first);}},decls:6,vars:1,consts:()=>{let e;e="Replace file";let n;n="\n          "+"\uFFFD0\uFFFD"+"\n        ";let r;r="Felt\xF6lt\xE9s";let d;d="\u26A0\uFE0F A vide\xF3 \xFAj verzi\xF3j\xE1nak felt\xF6lt\xE9se teljesen t\xF6rli a jelenlegi verzi\xF3t";let u;return u="Current uploaded file:",[["reactiveFileInput",""],e,n,d,u,["iconName","upload"],["type","primary"],["myDragDrop","",1,"root"],["myDragDrop","",1,"root",3,"fileDropped"],["class","current-filename",4,"ngIf"],[1,"mt-3"],[1,"muted-1"],[1,"muted-2","fs-7"],[1,"form-group-description"],[1,"d-flex","flex-wrap","mt-4","justify-content-center","gap-3"],["inputName","videoFile","inputLabel",r,"placement","right","theme","secondary","icon","upload",1,"d-inline-block","me-3",3,"fileChanged","extensions","displayFilename","displayReset"],[1,"current-filename"],[1,"fs-7"],[1,"fs-5"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",5),B(2),C(3,1),X(),l(),I(4,Ud,2,1,"my-alert",6)(5,kd,13,4,"div",7)),n&2&&(_(4),K(r.getUnavailability()?4:5));},dependencies:[Oe,Q,J,te,Vt,Je,oe,vi],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`,`.current-filename[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem}.root[_ngcontent-%COMP%]{min-height:260px;text-align:center;padding:2rem 1.5rem;border-radius:4px;border:1px dashed var(--secondary-icon-color)}@media screen and (max-width: 500px){.root[_ngcontent-%COMP%]{border:0}}.dragover[_ngcontent-%COMP%]{background-color:var(--bg-secondary-400);border-color:var(--primary)}
/*# sourceMappingURL=video-replace-file.component-H36QQ5YQ.css.map */`]}));let t=i;return t;})();var ln=qe(Da());var In=t=>t&&t.enabled&&t.modifierKey,Ba=(t,i)=>t&&i[t+"Key"],io=(t,i)=>t&&!i[t+"Key"];function Gt(t,i,o){return t===void 0?!0:typeof t=="string"?t.indexOf(i)!==-1:typeof t=="function"?t({chart:o}).indexOf(i)!==-1:!1;}function Zi(t,i){return typeof t=="function"&&(t=t({chart:i})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1};}function Bd(t,i){let o;return function(){return clearTimeout(o),o=setTimeout(t,i),i;};}function Xd({x:t,y:i},o){let e=o.scales,n=Object.keys(e);for(let r=0;r<n.length;r++){let d=e[n[r]];if(i>=d.top&&i<=d.bottom&&t>=d.left&&t<=d.right)return d;}return null;}function Xa(t,i,o){let{mode:e="xy",scaleMode:n,overScaleMode:r}=t||{},d=Xd(i,o),u=Zi(e,o),p=Zi(n,o);if(r){let S=Zi(r,o);for(let P of["x","y"])S[P]&&(p[P]=u[P],u[P]=!1);}if(d&&p[d.axis])return[d];let E=[];return At(o.scales,function(S){u[S.axis]&&E.push(S);}),E;}var Ki=new WeakMap();function ce(t){let i=Ki.get(t);return i||(i={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{},dragging:!1,panning:!1},Ki.set(t,i)),i;}function Wd(t){Ki.delete(t);}function Wa(t,i,o,e){let n=Math.max(0,Math.min(1,(t-i)/o||0)),r=1-n;return{min:e*n,max:e*r};}function ja(t,i){let o=t.isHorizontal()?i.x:i.y;return t.getValueForPixel(o);}function Ya(t,i,o){let e=t.max-t.min,n=e*(i-1),r=ja(t,o);return Wa(r,t.min,e,n);}function jd(t,i,o){let e=ja(t,o);if(e===void 0)return{min:t.min,max:t.max};let n=Math.log10(t.min),r=Math.log10(t.max),d=Math.log10(e),u=r-n,p=u*(i-1),E=Wa(d,n,u,p);return{min:Math.pow(10,n+E.min),max:Math.pow(10,r-E.max)};}function Yd(t,i){return i&&(i[t.id]||i[t.axis])||{};}function Ra(t,i,o,e,n){let r=o[e];if(r==="original"){let d=t.originalScaleLimits[i.id][e];r=an(d.options,d.scale);}return an(r,n);}function qd(t,i,o){let e=t.getValueForPixel(i),n=t.getValueForPixel(o);return{min:Math.min(e,n),max:Math.max(e,n)};}function Zd(t,{min:i,max:o,minLimit:e,maxLimit:n},r){let d=(t-o+i)/2;i-=d,o+=d;let u=r.min.options??r.min.scale,p=r.max.options??r.max.scale,E=t/1e6;return Ei(i,u,E)&&(i=u),Ei(o,p,E)&&(o=p),i<e?(i=e,o=Math.min(e+t,n)):o>n&&(o=n,i=Math.max(n-t,e)),{min:i,max:o};}function Zt(t,{min:i,max:o},e,n=!1){let r=ce(t.chart),{options:d}=t,u=Yd(t,e),{minRange:p=0}=u,E=Ra(r,t,u,"min",-1/0),S=Ra(r,t,u,"max",1/0);if(n==="pan"&&(i<E||o>S))return!0;let P=t.max-t.min,N=n?Math.max(o-i,p):P;if(n&&N===p&&P<=p)return!0;let D=Zd(N,{min:i,max:o,minLimit:E,maxLimit:S},r.originalScaleLimits[t.id]);return d.min=D.min,d.max=D.max,r.updatedScaleLimits[t.id]=D,t.parse(D.min)!==t.min||t.parse(D.max)!==t.max;}function Kd(t,i,o,e){let n=Ya(t,i,o),r={min:t.min+n.min,max:t.max-n.max};return Zt(t,r,e,!0);}function Qd(t,i,o,e){let n=jd(t,i,o);return Zt(t,n,e,!0);}function Jd(t,i,o,e){Zt(t,qd(t,i,o),e,!0);}var xa=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function ec(t){let o=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<o&&(t.max+=1);}function tc(t,i,o,e){let n=Ya(t,i,o);t.min===t.max&&i<1&&ec(t);let r={min:t.min+xa(n.min),max:t.max-xa(n.max)};return Zt(t,r,e,!0);}function nc(t){return t.isHorizontal()?t.width:t.height;}function ic(t,i,o){let n=t.getLabels().length-1,{min:r,max:d}=t,u=Math.max(d-r,1),p=Math.round(nc(t)/Math.max(u,10)),E=Math.round(Math.abs(i/p)),S;return i<-p?(d=Math.min(d+E,n),r=u===1?d:d-u,S=d===n):i>p&&(r=Math.max(0,r-E),d=u===1?r:r+u,S=r===0),Zt(t,{min:r,max:d},o)||S;}var oc={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function qa(t,i,o,e=!1){let{min:n,max:r,options:d}=t,u=d.time&&d.time.round,p=oc[u]||0,E=t.getValueForPixel(t.getPixelForValue(n+p)-i),S=t.getValueForPixel(t.getPixelForValue(r+p)-i);return isNaN(E)||isNaN(S)?!0:Zt(t,{min:E,max:S},o,e?"pan":!1);}function Fa(t,i,o){return qa(t,i,o,!0);}var Qi={category:tc,default:Kd,logarithmic:Qd},Ji={default:Jd},eo={category:ic,default:qa,logarithmic:Fa,timeseries:Fa};function rc(t,i,o){let{id:e,options:{min:n,max:r}}=t;if(!i[e]||!o[e])return!0;let d=o[e];return d.min!==n||d.max!==r;}function Va(t,i){At(t,(o,e)=>{i[e]||delete t[e];});}function dn(t,i){let{scales:o}=t,{originalScaleLimits:e,updatedScaleLimits:n}=i;return At(o,function(r){rc(r,e,n)&&(e[r.id]={min:{scale:r.min,options:r.options.min},max:{scale:r.max,options:r.options.max}});}),Va(e,o),Va(n,o),e;}function La(t,i,o,e){let n=Qi[t.type]||Qi.default;re(n,[t,i,o,e]);}function wa(t,i,o,e){let n=Ji[t.type]||Ji.default;re(n,[t,i,o,e]);}function ac(t){let i=t.chartArea;return{x:(i.left+i.right)/2,y:(i.top+i.bottom)/2};}function oo(t,i,o="none",e="api"){let{x:n=1,y:r=1,focalPoint:d=ac(t)}=typeof i=="number"?{x:i,y:i}:i,u=ce(t),{options:{limits:p,zoom:E}}=u;dn(t,u);let S=n!==1,P=r!==1,N=Xa(E,d,t);At(N||t.scales,function(D){D.isHorizontal()&&S?La(D,n,d,p):!D.isHorizontal()&&P&&La(D,r,d,p);}),t.update(o),re(E.onZoom,[{chart:t,trigger:e}]);}function Za(t,i,o,e="none",n="api"){let r=ce(t),{options:{limits:d,zoom:u}}=r,{mode:p="xy"}=u;dn(t,r);let E=Gt(p,"x",t),S=Gt(p,"y",t);At(t.scales,function(P){P.isHorizontal()&&E?wa(P,i.x,o.x,d):!P.isHorizontal()&&S&&wa(P,i.y,o.y,d);}),t.update(e),re(u.onZoom,[{chart:t,trigger:n}]);}function sc(t,i,o,e="none",n="api"){let r=ce(t);dn(t,r);let d=t.scales[i];Zt(d,o,void 0,!0),t.update(e),re(r.options.zoom?.onZoom,[{chart:t,trigger:n}]);}function lc(t,i="default"){let o=ce(t),e=dn(t,o);At(t.scales,function(n){let r=n.options;e[n.id]?(r.min=e[n.id].min.options,r.max=e[n.id].max.options):(delete r.min,delete r.max),delete o.updatedScaleLimits[n.id];}),t.update(i),re(o.options.zoom.onZoomComplete,[{chart:t}]);}function dc(t,i){let o=t.originalScaleLimits[i];if(!o)return;let{min:e,max:n}=o;return an(n.options,n.scale)-an(e.options,e.scale);}function cc(t){let i=ce(t),o=1,e=1;return At(t.scales,function(n){let r=dc(i,n.id);if(r){let d=Math.round(r/(n.max-n.min)*100)/100;o=Math.min(o,d),e=Math.max(e,d);}}),o<1?o:e;}function Ga(t,i,o,e){let{panDelta:n}=e,r=n[t.id]||0;gi(r)===gi(i)&&(i+=r);let d=eo[t.type]||eo.default;re(d,[t,i,o])?n[t.id]=0:n[t.id]=i;}function Ka(t,i,o,e="none"){let{x:n=0,y:r=0}=typeof i=="number"?{x:i,y:i}:i,d=ce(t),{options:{pan:u,limits:p}}=d,{onPan:E}=u||{};dn(t,d);let S=n!==0,P=r!==0;At(o||t.scales,function(N){N.isHorizontal()&&S?Ga(N,n,p,d):!N.isHorizontal()&&P&&Ga(N,r,p,d);}),t.update(e),re(E,[{chart:t}]);}function Qa(t){let i=ce(t);dn(t,i);let o={};for(let e of Object.keys(t.scales)){let{min:n,max:r}=i.originalScaleLimits[e]||{min:{},max:{}};o[e]={min:n.scale,max:r.scale};}return o;}function _c(t){let i=ce(t),o={};for(let e of Object.keys(t.scales))o[e]=i.updatedScaleLimits[e];return o;}function mc(t){let i=Qa(t);for(let o of Object.keys(t.scales)){let{min:e,max:n}=i[o];if(e!==void 0&&t.scales[o].min!==e||n!==void 0&&t.scales[o].max!==n)return!0;}return!1;}function $a(t){let i=ce(t);return i.panning||i.dragging;}var Ua=(t,i,o)=>Math.min(o,Math.max(i,t));function He(t,i){let{handlers:o}=ce(t),e=o[i];e&&e.target&&(e.target.removeEventListener(i,e),delete o[i]);}function Pn(t,i,o,e){let{handlers:n,options:r}=ce(t),d=n[o];if(d&&d.target===i)return;He(t,o),n[o]=p=>e(t,p,r),n[o].target=i;let u=o==="wheel"?!1:void 0;i.addEventListener(o,n[o],{passive:u});}function pc(t,i){let o=ce(t);o.dragStart&&(o.dragging=!0,o.dragEnd=i,t.update("none"));}function uc(t,i){let o=ce(t);!o.dragStart||i.key!=="Escape"||(He(t,"keydown"),o.dragging=!1,o.dragStart=o.dragEnd=null,t.update("none"));}function to(t,i){if(t.target!==i.canvas){let o=i.canvas.getBoundingClientRect();return{x:t.clientX-o.left,y:t.clientY-o.top};}return vn(t,i);}function Ja(t,i,o){let{onZoomStart:e,onZoomRejected:n}=o;if(e){let r=to(i,t);if(re(e,[{chart:t,event:i,point:r}])===!1)return re(n,[{chart:t,event:i}]),!1;}}function gc(t,i){if(t.legend){let r=vn(i,t);if(Xi(r,t.legend))return;}let o=ce(t),{pan:e,zoom:n={}}=o.options;if(i.button!==0||Ba(In(e),i)||io(In(n.drag),i))return re(n.onZoomRejected,[{chart:t,event:i}]);Ja(t,i,n)!==!1&&(o.dragStart=i,Pn(t,t.canvas.ownerDocument,"mousemove",pc),Pn(t,window.document,"keydown",uc));}function Ec({begin:t,end:i},o){let e=i.x-t.x,n=i.y-t.y,r=Math.abs(e/n);r>o?e=Math.sign(e)*Math.abs(n*o):r<o&&(n=Math.sign(n)*Math.abs(e/o)),i.x=t.x+e,i.y=t.y+n;}function Ha(t,i,o,{min:e,max:n,prop:r}){t[e]=Ua(Math.min(o.begin[r],o.end[r]),i[e],i[n]),t[n]=Ua(Math.max(o.begin[r],o.end[r]),i[e],i[n]);}function fc(t,i,o){let e={begin:to(i.dragStart,t),end:to(i.dragEnd,t)};if(o){let n=t.chartArea.width/t.chartArea.height;Ec(e,n);}return e;}function es(t,i,o,e){let n=Gt(i,"x",t),r=Gt(i,"y",t),{top:d,left:u,right:p,bottom:E,width:S,height:P}=t.chartArea,N={top:d,left:u,right:p,bottom:E},D=fc(t,o,e&&n&&r);n&&Ha(N,t.chartArea,D,{min:"left",max:"right",prop:"x"}),r&&Ha(N,t.chartArea,D,{min:"top",max:"bottom",prop:"y"});let x=N.right-N.left,W=N.bottom-N.top;return fe(Z({},N),{width:x,height:W,zoomX:n&&x?1+(S-x)/S:1,zoomY:r&&W?1+(P-W)/P:1});}function hc(t,i){let o=ce(t);if(!o.dragStart)return;He(t,"mousemove");let{mode:e,onZoomComplete:n,drag:{threshold:r=0,maintainAspectRatio:d}}=o.options.zoom,u=es(t,e,{dragStart:o.dragStart,dragEnd:i},d),p=Gt(e,"x",t)?u.width:0,E=Gt(e,"y",t)?u.height:0,S=Math.sqrt(p*p+E*E);if(o.dragStart=o.dragEnd=null,S<=r){o.dragging=!1,t.update("none");return;}Za(t,{x:u.left,y:u.top},{x:u.right,y:u.bottom},"zoom","drag"),o.dragging=!1,o.filterNextClick=!0,re(n,[{chart:t}]);}function Cc(t,i,o){if(io(In(o.wheel),i)){re(o.onZoomRejected,[{chart:t,event:i}]);return;}if(Ja(t,i,o)!==!1&&(i.cancelable&&i.preventDefault(),i.deltaY!==void 0))return!0;}function Sc(t,i){let{handlers:{onZoomComplete:o},options:{zoom:e}}=ce(t);if(!Cc(t,i,e))return;let n=i.target.getBoundingClientRect(),r=e.wheel.speed,d=i.deltaY>=0?2-1/(1-r):1+r,u={x:d,y:d,focalPoint:{x:i.clientX-n.left,y:i.clientY-n.top}};oo(t,u,"zoom","wheel"),re(o,[{chart:t}]);}function Mc(t,i,o,e){o&&(ce(t).handlers[i]=Bd(()=>re(o,[{chart:t}]),e));}function Ac(t,i){let o=t.canvas,{wheel:e,drag:n,onZoomComplete:r}=i.zoom;e.enabled?(Pn(t,o,"wheel",Sc),Mc(t,"onZoomComplete",r,250)):He(t,"wheel"),n.enabled?(Pn(t,o,"mousedown",gc),Pn(t,o.ownerDocument,"mouseup",hc)):(He(t,"mousedown"),He(t,"mousemove"),He(t,"mouseup"),He(t,"keydown"));}function vc(t){He(t,"mousedown"),He(t,"mousemove"),He(t,"mouseup"),He(t,"wheel"),He(t,"click"),He(t,"keydown");}function Oc(t,i){return function(o,e){let{pan:n,zoom:r={}}=i.options;if(!n||!n.enabled)return!1;let d=e&&e.srcEvent;return d&&!i.panning&&e.pointerType==="mouse"&&(io(In(n),d)||Ba(In(r.drag),d))?(re(n.onPanRejected,[{chart:t,event:e}]),!1):!0;};}function Pc(t,i){let o=Math.abs(t.clientX-i.clientX),e=Math.abs(t.clientY-i.clientY),n=o/e,r,d;return n>.3&&n<1.7?r=d=!0:o>e?r=!0:d=!0,{x:r,y:d};}function ts(t,i,o){if(i.scale){let{center:e,pointers:n}=o,r=1/i.scale*o.scale,d=o.target.getBoundingClientRect(),u=Pc(n[0],n[1]),p=i.options.zoom.mode,E={x:u.x&&Gt(p,"x",t)?r:1,y:u.y&&Gt(p,"y",t)?r:1,focalPoint:{x:e.x-d.left,y:e.y-d.top}};oo(t,E,"zoom","pinch"),i.scale=o.scale;}}function Ic(t,i,o){if(i.options.zoom.pinch.enabled){let e=vn(o,t);re(i.options.zoom.onZoomStart,[{chart:t,event:o,point:e}])===!1?(i.scale=null,re(i.options.zoom.onZoomRejected,[{chart:t,event:o}])):i.scale=1;}}function Nc(t,i,o){i.scale&&(ts(t,i,o),i.scale=null,re(i.options.zoom.onZoomComplete,[{chart:t}]));}function ns(t,i,o){let e=i.delta;e&&(i.panning=!0,Ka(t,{x:o.deltaX-e.x,y:o.deltaY-e.y},i.panScales),i.delta={x:o.deltaX,y:o.deltaY});}function Tc(t,i,o){let{enabled:e,onPanStart:n,onPanRejected:r}=i.options.pan;if(!e)return;let d=o.target.getBoundingClientRect(),u={x:o.center.x-d.left,y:o.center.y-d.top};if(re(n,[{chart:t,event:o,point:u}])===!1)return re(r,[{chart:t,event:o}]);i.panScales=Xa(i.options.pan,u,t),i.delta={x:0,y:0},ns(t,i,o);}function bc(t,i){i.delta=null,i.panning&&(i.panning=!1,i.filterNextClick=!0,re(i.options.pan.onPanComplete,[{chart:t}]));}var no=new WeakMap();function ka(t,i){let o=ce(t),e=t.canvas,{pan:n,zoom:r}=i,d=new ln.default.Manager(e);r&&r.pinch.enabled&&(d.add(new ln.default.Pinch()),d.on("pinchstart",u=>Ic(t,o,u)),d.on("pinch",u=>ts(t,o,u)),d.on("pinchend",u=>Nc(t,o,u))),n&&n.enabled&&(d.add(new ln.default.Pan({threshold:n.threshold,enable:Oc(t,o)})),d.on("panstart",u=>Tc(t,o,u)),d.on("panmove",u=>ns(t,o,u)),d.on("panend",()=>bc(t,o))),no.set(t,d);}function za(t){let i=no.get(t);i&&(i.remove("pinchstart"),i.remove("pinch"),i.remove("pinchend"),i.remove("panstart"),i.remove("pan"),i.remove("panend"),i.destroy(),no.delete(t));}function yc(t,i){let{pan:o,zoom:e}=t,{pan:n,zoom:r}=i;return e?.zoom?.pinch?.enabled!==r?.zoom?.pinch?.enabled||o?.enabled!==n?.enabled||o?.threshold!==n?.threshold;}var Dc="2.2.0";function Ni(t,i,o){let e=o.zoom.drag,{dragStart:n,dragEnd:r}=ce(t);if(e.drawTime!==i||!r)return;let{left:d,top:u,width:p,height:E}=es(t,o.zoom.mode,{dragStart:n,dragEnd:r},e.maintainAspectRatio),S=t.ctx;S.save(),S.beginPath(),S.fillStyle=e.backgroundColor||"rgba(225,225,225,0.3)",S.fillRect(d,u,p,E),e.borderWidth>0&&(S.lineWidth=e.borderWidth,S.strokeStyle=e.borderColor||"rgba(225,225,225)",S.strokeRect(d,u,p,E)),S.restore();}var is={id:"zoom",version:Dc,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,i,o){let e=ce(t);e.options=o,Object.prototype.hasOwnProperty.call(o.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(o.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(o.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),ln.default&&ka(t,o),t.pan=(n,r,d)=>Ka(t,n,r,d),t.zoom=(n,r)=>oo(t,n,r),t.zoomRect=(n,r,d)=>Za(t,n,r,d),t.zoomScale=(n,r,d)=>sc(t,n,r,d),t.resetZoom=n=>lc(t,n),t.getZoomLevel=()=>cc(t),t.getInitialScaleBounds=()=>Qa(t),t.getZoomedScaleBounds=()=>_c(t),t.isZoomedOrPanned=()=>mc(t),t.isZoomingOrPanning=()=>$a(t);},beforeEvent(t,{event:i}){if($a(t))return!1;if(i.type==="click"||i.type==="mouseup"){let o=ce(t);if(o.filterNextClick)return o.filterNextClick=!1,!1;}},beforeUpdate:function(t,i,o){let e=ce(t),n=e.options;e.options=o,yc(n,o)&&(za(t),ka(t,o)),Ac(t,o);},beforeDatasetsDraw(t,i,o){Ni(t,"beforeDatasetsDraw",o);},afterDatasetsDraw(t,i,o){Ni(t,"afterDatasetsDraw",o);},beforeDraw(t,i,o){Ni(t,"beforeDraw",o);},afterDraw(t,i,o){Ni(t,"afterDraw",o);},stop:function(t){vc(t),ln.default&&za(t),Wd(t);},panFunctions:eo,zoomFunctions:Qi,zoomRectFunctions:Ji};var $t=class $t{authHttp=A(jn);restExtractor=A(ii);getOverallStats(i){let{videoId:o,startDate:e,endDate:n}=i,r=new Wn();return e&&(r=r.append("startDate",e.toISOString())),n&&(r=r.append("endDate",n.toISOString())),this.authHttp.get(Fe.BASE_VIDEO_URL+"/"+o+"/stats/overall",{params:r}).pipe(kt(d=>this.restExtractor.handleError(d)));}getTimeserieStats(i){let{videoId:o,metric:e,startDate:n,endDate:r}=i,d=new Wn();return n&&(d=d.append("startDate",n.toISOString())),r&&(d=d.append("endDate",r.toISOString())),this.authHttp.get(Fe.BASE_VIDEO_URL+"/"+o+"/stats/timeseries/"+e,{params:d}).pipe(kt(u=>this.restExtractor.handleError(u)));}getRetentionStats(i){return this.authHttp.get(Fe.BASE_VIDEO_URL+"/"+i+"/stats/retention").pipe(kt(o=>this.restExtractor.handleError(o)));}getUserAgentStats(i){let{videoId:o,startDate:e,endDate:n}=i,r=new Wn();return e&&(r=r.append("startDate",e.toISOString())),n&&(r=r.append("endDate",n.toISOString())),this.authHttp.get(Fe.BASE_VIDEO_URL+"/"+o+"/stats/user-agent",{params:r}).pipe(kt(d=>this.restExtractor.handleError(d)));}};T($t,"BASE_VIDEO_STATS_URL",mr.apiUrl+"/api/v1/videos/"),T($t,"\u0275fac",function(o){return new(o||$t)();}),T($t,"\u0275prov",pt({token:$t,factory:$t.ɵfac,providedIn:"root"}));var Ti=$t;function Rc(t,i){if(t&1&&(c(0,"my-help"),R(1),l()),t&2){let o=h().$implicit;_(),ue(" ",o.help," ");}}function xc(t,i){if(t&1&&(c(0,"div",24),R(1),l()),t&2){let o=h().$implicit;_(),Y(o.moreInfo);}}function Fc(t,i){if(t&1&&(c(0,"div",19)(1,"div",20),R(2),I(3,Rc,2,1,"my-help",21),l(),c(4,"div",22),R(5),l(),I(6,xc,2,1,"div",23),l()),t&2){let o=i.$implicit;_(2),ue(" ",o.label," "),_(),g("ngIf",o.help),_(2),Y(o.value),_(),g("ngIf",o.moreInfo);}}function Vc(t,i){if(t&1&&(c(0,"div",24),R(1),l()),t&2){let o=h().$implicit;_(),Y(o.moreInfo);}}function Lc(t,i){if(t&1&&(c(0,"div",19)(1,"div",20),R(2),l(),c(3,"div",22),R(4),l(),I(5,Vc,2,1,"div",23),l()),t&2){let o=i.$implicit;_(2),Y(o.label),_(2),Y(o.value),_(),g("ngIf",o.moreInfo);}}function wc(t,i){if(t&1&&v(0,"p-chart",33),t&2){let o=h(2).$implicit,e=h();g("height",e.chartHeight)("width",e.chartWidth)("type",e.chartOptions[o.id].type)("options",e.chartOptions[o.id].options)("data",e.chartOptions[o.id].data)("plugins",e.chartPlugins);}}function Gc(t,i){t&1&&(c(0,"span",34),C(1,2),l());}function $c(t,i){if(t&1){let o=q();c(0,"my-button",35),L("click",function(){F(o);let n=h(3);return V(n.resetZoom());}),C(1,3),l();}}function Uc(t,i){if(t&1&&(c(0,"div",28),I(1,wc,1,6,"p-chart",29),l(),c(2,"div",30),I(3,Gc,2,0,"span",31)(4,$c,2,0,"my-button",32),l()),t&2){let o=h().$implicit,e=h();_(),g("ngIf",e.chartOptions[o.id]),_(2),g("ngIf",!e.hasZoom()&&o.zoomEnabled),_(),g("ngIf",e.hasZoom());}}function Hc(t,i){if(t&1&&(B(0,25),c(1,"a",26)(2,"span"),R(3),l()(),I(4,Uc,5,3,"ng-template",27),X()),t&2){let o=i.$implicit;g("ngbNavItem",o.id),_(3),Y(o.label);}}var kc=["countries","regions","clients","devices","operatingSystems"],os=t=>kc.some(i=>i===t);fi.backgroundColor=getComputedStyle(document.body).getPropertyValue("--bg");fi.borderColor=getComputedStyle(document.body).getPropertyValue("--bg-secondary-500");fi.color=getComputedStyle(document.body).getPropertyValue("--fg");var rs=(()=>{let i=class i{localeId=A(Bo);route=A(Xo);notifier=A(Ue);statsService=A(Ti);peertubeRouter=A(ri);numberFormatter=A(Bi);liveService=A(Yt);manageController=A(ae);globalStatsCards=[];overallStatCards=[];chartOptions={};chartHeight="300px";chartWidth=null;availableCharts=[];activeGraphId="viewers";videoEdit;countries=[];regions=[];chartPlugins=[is];currentDateFilter="all";dateFilters=[{id:"all",label:"A vide\xF3 k\xF6zz\xE9t\xE9tele \xF3ta"}];statsStartDate;statsEndDate;chartIngestData={};ngOnInit(){this.videoEdit=this.manageController.getStore().videoEdit,this.availableCharts=[{id:"viewers",label:"N\xE9z\u0151k",zoomEnabled:!0},{id:"aggregateWatchTime",label:"Megtekint\xE9si id\u0151k",zoomEnabled:!0},{id:"countries",label:"Orsz\xE1gok",zoomEnabled:!1},{id:"regions",label:"R\xE9gi\xF3k",zoomEnabled:!1},{id:"clients",label:"Clients",zoomEnabled:!1},{id:"devices",label:"Devices",zoomEnabled:!1},{id:"operatingSystems",label:"Operating systems",zoomEnabled:!1}],this.videoEdit.getVideoAttributes().isLive||this.availableCharts.push({id:"retention",label:"Megtart\xE1s",zoomEnabled:!1});let e=this.route.snapshot.queryParams;(e.startDate||e.endDate)&&this.addAndSelectCustomDateFilter(),this.route.queryParams.subscribe(n=>{this.statsStartDate=n.startDate?new Date(n.startDate):void 0,this.statsEndDate=n.endDate?new Date(n.endDate):void 0,this.loadChart(),this.loadOverallStats();}),this.loadDateFilters();}hasCountries(){return this.countries.length!==0;}hasRegions(){return this.regions.length!==0;}onChartChange(e){this.activeGraphId=e,e==="countries"?this.chartHeight=`${Math.max(this.countries.length*20,300)}px`:e==="regions"?this.chartHeight=`${Math.max(this.regions.length*20,300)}px`:this.chartHeight="300px",this.loadChart();}resetZoom(){this.peertubeRouter.silentNavigate([],{}),this.removeAndResetCustomDateFilter();}hasZoom(){return!!this.statsStartDate&&this.isTimeserieGraph(this.activeGraphId);}getViewersStatsTitle(){return this.statsStartDate&&this.statsEndDate?"N\xE9z\u0151i statisztik\xE1k "+this.toMediumDate(this.statsStartDate)+" \xE9s "+this.toMediumDate(this.statsEndDate)+" k\xF6z\xF6tt":"N\xE9z\u0151i statisztik\xE1k";}onDateFilterChange(){if(this.currentDateFilter==="all")return this.resetZoom();let e=this.currentDateFilter.split("|");if(e.length===2)return this.peertubeRouter.silentNavigate([],{startDate:e[0],endDate:e[1]});}isTimeserieGraph(e){return e==="aggregateWatchTime"||e==="viewers";}loadOverallStats(){let e=this.videoEdit.getVideoAttributes().uuid;this.statsService.getOverallStats({videoId:e,startDate:this.statsStartDate,endDate:this.statsEndDate}).subscribe({next:n=>{this.countries=n.countries.map(r=>({name:this.countryCodeToName(r.isoCode),viewers:r.viewers})),this.regions=n.subdivisions,this.buildOverallStatCard(n);},error:n=>this.notifier.error(n.message)});}loadDateFilters(){return this.videoEdit.getVideoAttributes().isLive?this.loadLiveDateFilters():this.loadVODDateFilters();}loadLiveDateFilters(){this.liveService.listSessions(this.videoEdit.getVideoAttributes().id).subscribe({next:({data:e})=>{let n=e.map(r=>this.buildLiveFilter(r));this.dateFilters=this.dateFilters.concat(n);},error:e=>this.notifier.error(e.message)});}loadVODDateFilters(){this.liveService.findLiveSessionFromVOD(this.videoEdit.getVideoAttributes().id).subscribe({next:e=>{this.dateFilters=this.dateFilters.concat([this.buildLiveFilter(e)]);},error:e=>{e.status!==Zn.NOT_FOUND_404&&this.notifier.error(e.message);}});}buildLiveFilter(e){return{id:e.startDate+"|"+e.endDate,label:"Ekkor \xE9l\u0151 volt: "+this.toMediumDate(new Date(e.startDate))+""};}addAndSelectCustomDateFilter(){this.dateFilters.some(n=>n.id==="custom")||(this.dateFilters=this.dateFilters.concat([{id:"custom",label:"Egy\xE9ni d\xE1tumok"}])),this.currentDateFilter="custom";}removeAndResetCustomDateFilter(){this.dateFilters=this.dateFilters.filter(e=>e.id!=="custom"),this.currentDateFilter="all";}buildOverallStatCard(e){this.globalStatsCards=[{label:"Megtekint\xE9sek",value:this.numberFormatter.transform(this.videoEdit.getVideoAttributes().views),help:"A view means that someone watched the video for several seconds (10 seconds by default)"},{label:"Kedvel\xE9sek",value:this.numberFormatter.transform(this.videoEdit.getVideoAttributes().likes)}],this.overallStatCards=[{label:"\xC1tlagos megtekint\xE9si id\u0151",value:ft({seconds:e.averageWatchTime,format:"locale-string"})},{label:"Teljes megtekint\xE9si id\u0151",value:ft({seconds:e.totalWatchTime,format:"locale-string"})},{label:"N\xE9z\u0151cs\xFAcs",value:this.numberFormatter.transform(e.viewersPeak),moreInfo:e.viewersPeak!==0?"ekkor: "+this.toMediumDate(new Date(e.viewersPeakDate))+"":void 0},{label:"Egyedi n\xE9z\u0151k",value:this.numberFormatter.transform(e.totalViewers)}],e.countries.length!==0&&this.overallStatCards.push({label:"Orsz\xE1gok",value:this.numberFormatter.transform(e.countries.length)}),e.subdivisions.length!==0&&this.overallStatCards.push({label:"R\xE9gi\xF3k",value:this.numberFormatter.transform(e.subdivisions.length)});}loadChart(){let e=this.videoEdit.getVideoAttributes().uuid;({retention:this.statsService.getRetentionStats(e),clients:this.statsService.getUserAgentStats({videoId:e}),devices:this.statsService.getUserAgentStats({videoId:e}),operatingSystems:this.statsService.getUserAgentStats({videoId:e}),aggregateWatchTime:this.statsService.getTimeserieStats({videoId:e,startDate:this.statsStartDate,endDate:this.statsEndDate,metric:"aggregateWatchTime"}),viewers:this.statsService.getTimeserieStats({videoId:e,startDate:this.statsStartDate,endDate:this.statsEndDate,metric:"viewers"}),countries:Ze(this.countries),regions:Ze(this.regions)})[this.activeGraphId].subscribe({next:r=>{this.chartIngestData[this.activeGraphId]=r,this.chartOptions[this.activeGraphId]=this.buildChartOptions(this.activeGraphId);},error:r=>this.notifier.error(r.message)});}buildChartOptions(e){let n={clients:P=>this.buildUserAgentChartOptions(P,"clients"),devices:P=>this.buildUserAgentChartOptions(P,"devices"),operatingSystems:P=>this.buildUserAgentChartOptions(P,"operatingSystems"),retention:P=>this.buildRetentionChartOptions(P),aggregateWatchTime:P=>this.buildTimeserieChartOptions(P),viewers:P=>this.buildTimeserieChartOptions(P),countries:P=>this.buildGeoChartOptions(P),regions:P=>this.buildGeoChartOptions(P)},{type:r,data:d,displayLegend:u,plugins:p,options:E}=n[e](this.chartIngestData[e]),S=this;return{type:r,data:d,options:fe(Z({},E),{responsive:!0,scales:{x:{ticks:{stepSize:os(e)?1:void 0,callback:function(P){return S.formatXTick({graphId:e,value:P,data:S.chartIngestData[e],scale:this});}}},y:{beginAtZero:!0,max:this.activeGraphId==="retention"?100:void 0,ticks:{callback:function(P){return S.formatYTick({graphId:e,value:P,scale:this});}}}},plugins:Z({legend:{display:u},tooltip:{callbacks:{title:P=>this.formatTooltipTitle({graphId:e,items:P}),label:P=>this.formatYTick({graphId:e,value:P.raw})}}},p)})};}buildRetentionChartOptions(e){let n=[],r=[];for(let d of e.data)n.push(ft(d.second)),r.push(Math.round(d.retentionPercent));return{type:"line",displayLegend:!1,plugins:Z({},this.buildDisabledZoomPlugin()),data:{labels:n,datasets:[{data:r,borderColor:this.buildChartColor()}]}};}buildTimeserieChartOptions(e){let n=[],r=[];for(let d of e.data)n.push(d.date),r.push(d.value);return{type:"line",displayLegend:!1,plugins:{zoom:{zoom:{wheel:{enabled:!1},drag:{enabled:!0},pinch:{enabled:!0},mode:"x",onZoomComplete:({chart:d})=>{let{min:u,max:p}=d.scales.x,E=e.data[u].date,S=p===e.data.length-1?(this.statsEndDate||new Date()).toISOString():e.data[p+1].date;this.peertubeRouter.silentNavigate([],{startDate:E,endDate:S}),this.addAndSelectCustomDateFilter();}},limits:{x:{minRange:2}}}},data:{labels:n,datasets:[{data:r,borderColor:this.buildChartColor()}]}};}buildUserAgentChartOptions(e,n){let r=[],d=[];for(let u of e[n]){let p=u.name?.charAt(0).toUpperCase()+u.name?.slice(1);r.push(p),d.push(u.viewers);}return{type:"bar",options:{indexAxis:"y"},displayLegend:!0,plugins:Z({},this.buildDisabledZoomPlugin()),data:{labels:r,datasets:[{label:"N\xE9z\u0151k",backgroundColor:this.buildChartColor(),maxBarThickness:20,data:d}]}};}buildGeoChartOptions(e){let n=[],r=[];for(let d of e)n.push(d.name),r.push(d.viewers);return{type:"bar",options:{indexAxis:"y"},displayLegend:!0,plugins:Z({},this.buildDisabledZoomPlugin()),data:{labels:n,datasets:[{label:"N\xE9z\u0151k",backgroundColor:this.buildChartColor(),maxBarThickness:20,data:r}]}};}buildChartColor(){return getComputedStyle(document.body).getPropertyValue("--border-primary");}formatXTick(e){let{graphId:n,value:r,data:d,scale:u}=e,p=u.getLabelForValue(r);if(!this.isTimeserieGraph(n))return p;let E=new Date(p);return d.groupInterval.match(/ months?$/)?E.toLocaleDateString([],{year:"2-digit",month:"numeric"}):d.groupInterval.match(/ days?$/)?E.toLocaleDateString([],{month:"numeric",day:"numeric"}):d.groupInterval.match(/ hours?$/)?E.toLocaleTimeString([],{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}):E.toLocaleTimeString([],{hour:"numeric",minute:"numeric"});}formatYTick(e){let{graphId:n,value:r,scale:d}=e;return n==="retention"?r+" %":n==="aggregateWatchTime"?ft(+r):os(n)&&d?d.getLabelForValue(r):r.toLocaleString(this.localeId);}formatTooltipTitle(e){let{graphId:n,items:r}=e,d=r[0];return this.isTimeserieGraph(n)?this.toMediumDate(new Date(d.label)):d.label;}countryCodeToName(e){let n=Intl;return n.DisplayNames?new n.DisplayNames([],{type:"region"}).of(e):e;}buildDisabledZoomPlugin(){return{zoom:{zoom:{wheel:{enabled:!1},drag:{enabled:!1},pinch:{enabled:!1}}}};}toMediumDate(e){return new Date(e).toLocaleString(this.localeId,{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"});}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["ng-component"]],features:[en([Bi])],decls:23,vars:9,consts:()=>{let e;e="Statistics";let n;n="A nagy\xEDt\xE1shoz kiv\xE1laszthatja a grafikon egy r\xE9sz\xE9t";let r;return r="Nagy\xEDt\xE1s vissza\xE1ll\xEDt\xE1sa",[["nav","ngbNav"],e,n,r,["iconName","stats"],[1,"stats-embed"],[1,"global-stats"],["class","card stats-card",4,"ngFor","ngForOf"],[3,"video"],[1,"stats-with-date"],[1,"overall-stats"],[1,"date-filter-wrapper"],["for","date-filter",1,"visually-hidden"],["inputId","date-filter",3,"ngModelChange","ngModel","items"],[1,"cards"],[1,"timeseries"],["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem",4,"ngFor","ngForOf"],[3,"ngbNavOutlet"],[1,"card","stats-card"],[1,"label"],[4,"ngIf"],[1,"value"],["class","more-info",4,"ngIf"],[1,"more-info"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"chart-container"],[3,"height","width","type","options","data","plugins",4,"ngIf"],[1,"zoom-container"],["class","description",4,"ngIf"],[3,"click",4,"ngIf"],[3,"height","width","type","options","data","plugins"],[1,"description"],[3,"click"]];},template:function(n,r){if(n&1){let d=q();c(0,"h2"),v(1,"my-global-icon",4),B(2),C(3,1),X(),l(),c(4,"div",5)(5,"div",6),I(6,Fc,7,4,"div",7),l(),v(7,"my-embed",8),l(),c(8,"div",9)(9,"div",10)(10,"h2"),R(11),l(),c(12,"div",11)(13,"label",12),R(14,"Filter viewers stats by date"),l(),c(15,"my-select-options",13),Xt("ngModelChange",function(p){return F(d),Bt(r.currentDateFilter,p)||(r.currentDateFilter=p),V(p);}),L("ngModelChange",function(){return F(d),V(r.onDateFilterChange());}),l()(),c(16,"div",14),I(17,Lc,6,3,"div",7),l()(),c(18,"div",15)(19,"div",16,0),L("activeIdChange",function(p){return F(d),V(r.onChartChange(p));}),I(21,Hc,5,2,"ng-container",17),l(),v(22,"div",18),l()();}if(n&2){let d=Ge(20);_(6),g("ngForOf",r.globalStatsCards),_(),g("video",r.videoEdit.getVideoAttributes()),_(4),Y(r.getViewersStatsTitle()),_(4),zt("ngModel",r.currentDateFilter),g("items",r.dateFilters),_(2),g("ngForOf",r.overallStatCards),_(2),g("activeId",r.activeGraphId),_(2),g("ngForOf",r.availableCharts),_(),g("ngbNavOutlet",d);}},dependencies:[Ke,Q,li,Mt,Ft,J,Pe,Yn,ar,rr,lr,sr,or,Dr,yr,Ct,dr,oe],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`,`.stats-embed[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.overall-stats[_ngcontent-%COMP%], .global-stats[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.overall-stats[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .global-stats[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;width:100%}.overall-stats[_ngcontent-%COMP%]{justify-content:space-between}.overall-stats[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.overall-stats[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]{margin-bottom:10px;min-width:300px}.stats-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:fit-content;min-height:100px;min-width:200px;background-color:var(--bg-secondary-400);margin-bottom:15px;margin-inline-end:.9375rem}.stats-card[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .stats-card[_ngcontent-%COMP%]   .more-info[_ngcontent-%COMP%]{font-size:1rem;font-weight:600}.stats-card[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:24px;font-weight:600}@media screen and (max-width: 500px){.stats-card[_ngcontent-%COMP%]{min-height:fit-content;min-width:fit-content;padding:15px}}my-embed[_ngcontent-%COMP%]{display:block;max-width:500px;width:100%}.stats-with-date[_ngcontent-%COMP%]{margin-top:30px;padding-top:30px;border-top:1px solid var(--bg-secondary-400)}@media screen and (max-width: 800px){my-embed[_ngcontent-%COMP%]{display:none}}.tab-content[_ngcontent-%COMP%]{margin-top:5px}.nav-tabs[_ngcontent-%COMP%]{border-bottom:2px solid #EAEAEA;margin:20px 0 0!important}.nav-tabs.hide-nav[_ngcontent-%COMP%]{display:none!important}.nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]{margin-bottom:-2px;min-height:40px!important;padding:0 30px!important;border:2px solid transparent}.nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]:hover, .nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]:focus, .nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]:active, .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]:hover, .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]:focus, .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]:active{text-decoration:none}.nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}.nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border-bottom:2px solid transparent}.nav-tabs[_ngcontent-%COMP%]   a.nav-link.active[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link.active[_ngcontent-%COMP%]{border-color:#eaeaea;border-bottom-color:transparent}.nav-tabs[_ngcontent-%COMP%]   a.nav-link.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border-bottom-color:var(--border-primary)}.nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]:hover:not(.active), .nav-tabs[_ngcontent-%COMP%]   .unavailable-nav-link[_ngcontent-%COMP%]:hover:not(.active){border-color:transparent}.nav-tabs[_ngcontent-%COMP%]   a.nav-link[_ngcontent-%COMP%]{padding:0 10px!important}.timeseries[_ngcontent-%COMP%]{min-height:500px}.zoom-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.zoom-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-style:italic}
/*# sourceMappingURL=video-stats.component-UK7P5PCG.css.map */`]}));let t=i;return t;})();var as=qe(ht());function zc(t,i){if(t&1&&(c(0,"my-alert",14),R(1),l()),t&2){let o=h();_(),Y(o.getUnavailability());}}function Bc(t,i){if(t&1&&(c(0,"li"),R(1),l()),t&2){let o=i.$implicit;_(),Y(o);}}function Xc(t,i){if(t&1&&(c(0,"div",35)(1,"div",32),C(2,12),l(),c(3,"ol"),I(4,Bc,2,1,"li",36),l()()),t&2){let o=h(2);_(4),g("ngForOf",o.videoEdit.getStudioTasksSummary());}}function Wc(t,i){if(t&1&&(c(0,"div",15)(1,"form",16)(2,"div",17)(3,"h3",18),C(4,1),l(),c(5,"div",19),C(6,2),l(),c(7,"div",20)(8,"label",21),C(9,3),l(),v(10,"my-timestamp-input",22),l(),c(11,"div",20)(12,"label",23),C(13,4),l(),v(14,"my-timestamp-input",24),l()(),c(15,"div",25)(16,"h3",18),C(17,5),l(),c(18,"div",19),C(19,6),l(),c(20,"div",20),v(21,"my-reactive-file",26),l()(),c(22,"div",27)(23,"h3",18),C(24,7),l(),c(25,"div",19),C(26,8),l(),c(27,"div",20),v(28,"my-reactive-file",28),l()(),c(29,"div",29)(30,"h3",18),C(31,9),l(),c(32,"div",19),C(33,10),l(),c(34,"div",20),v(35,"my-reactive-file",30),l()()(),c(36,"div",31)(37,"div",32),C(38,11),l(),v(39,"my-embed",33),l(),I(40,Xc,5,1,"div",34),l()),t&2){let o=h();_(),g("formGroup",o.form),_(9),g("maxTimestamp",o.videoEdit.getVideoAttributes().duration),_(4),g("maxTimestamp",o.videoEdit.getVideoAttributes().duration),_(7),g("extensions",o.videoExtensions)("displayFilename",!0)("displayReset",!0)("buttonTooltip",o.getIntroOutroTooltip()),_(7),g("extensions",o.videoExtensions)("displayFilename",!0)("displayReset",!0)("buttonTooltip",o.getIntroOutroTooltip()),_(7),g("extensions",o.imageExtensions)("displayFilename",!0)("displayReset",!0)("buttonTooltip",o.getWatermarkTooltip()),_(4),g("video",o.videoEdit.getVideoAttributes()),_(),g("ngIf",!o.noEdit());}}var jc=(0,as.default)("peertube:video-manage"),ss=(()=>{let i=class i{formReactiveService=A(he);serverService=A(ie);manageController=A(ae);form;formErrors={};validationMessages={};isRunningEdit=!1;videoEdit;studioEnabled;instanceName;updatedSub;ngOnInit(){this.videoEdit=this.manageController.getStore().videoEdit;let e=this.serverService.getHTMLConfig();this.studioEnabled=e.videoStudio.enabled===!0,this.instanceName=e.instance.name;let{form:n,formErrors:r,validationMessages:d}=this.formReactiveService.buildForm({cut:{start:null,end:null},"add-intro":{file:null},"add-outro":{file:null},"add-watermark":{file:null}},this.videoEdit.toStudioFormPatch());this.form=n,this.formErrors=r,this.validationMessages=d,this.form.valueChanges.subscribe(()=>{this.manageController.setFormError("St\xFAdi\xF3","studio",this.formErrors);let u=this.form.value;jc("Updating form values",u),this.videoEdit.loadFromStudioForm(u);}),this.formReactiveService.markAllAsDirty(this.form.controls),this.updatedSub=this.manageController.getUpdatedObs().subscribe(()=>{this.form.patchValue(this.videoEdit.toStudioFormPatch());});}ngOnDestroy(){this.updatedSub?.unsubscribe();}get videoExtensions(){return this.serverService.getHTMLConfig().video.file.extensions;}get imageExtensions(){return this.serverService.getHTMLConfig().video.image.extensions;}getIntroOutroTooltip(){return"(kiterjeszt\xE9sek: "+this.videoExtensions.join(", ")+")";}getWatermarkTooltip(){return"(kiterjeszt\xE9sek: "+this.imageExtensions.join(", ")+")";}noEdit(){return this.videoEdit.getStudioTasks().length===0;}getUnavailability(){return Pi(fe(Z({},this.videoEdit.getVideoAttributes()),{instanceName:this.instanceName,studioEnabled:this.studioEnabled}));}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-studio"]],decls:6,vars:1,consts:()=>{let e;e="St\xFAdi\xF3";let n;n="V\xE1lassza ki az intr\xF3 videof\xE1jlt";let r;r="V\xE1lassza ki az outro videof\xE1jlt";let d;d="V\xE1lassza ki a v\xEDzjel k\xE9pf\xE1jlt";let u;u="VIDE\xD3 V\xC1G\xC1SA";let p;p="\xDAj kezdeti/befejez\xE9si pont be\xE1ll\xEDt\xE1sa.";let E;E="\xDAj kezdeti pont";let S;S="\xDAj befejez\xE9si pont";let P;P="INTR\xD3 HOZZ\xC1AD\xC1SA";let N;N="F\xE1jl hozz\xE1f\u0171z\xE9se a vide\xF3 elej\xE9hez.";let D;D="OUTRO HOZZ\xC1AD\xC1SA";let x;x="F\xE1jl hozz\xE1f\u0171z\xE9se a vide\xF3 v\xE9g\xE9hez.";let W;W="V\xCDZJEL HOZZ\xC1AD\xC1SA";let H;H="V\xEDzjel k\xE9p hozz\xE1ad\xE1sa a vide\xF3hoz.";let k;k="Original video";let _e;return _e="Edits to apply:",[e,u,p,E,S,P,N,D,x,W,H,k,_e,["iconName","studio"],["type","primary"],[1,"grid-container"],[3,"formGroup"],["formGroupName","cut",1,"section","cut"],[1,"section-label"],[1,"description"],[1,"form-group"],["for","cutStart"],["inputName","cutStart","enableBorder","true","formControlName","start",3,"maxTimestamp"],["for","cutEnd"],["inputName","cutEnd","enableBorder","true","formControlName","end",3,"maxTimestamp"],["formGroupName","add-intro",1,"section"],["formControlName","file","inputName","addIntroFile","inputLabel",n,3,"extensions","displayFilename","displayReset","buttonTooltip"],["formGroupName","add-outro",1,"section"],["formControlName","file","inputName","addOutroFile","inputLabel",r,3,"extensions","displayFilename","displayReset","buttonTooltip"],["formGroupName","add-watermark",1,"section"],["formControlName","file","inputName","addWatermarkFile","inputLabel",d,3,"extensions","displayFilename","displayReset","buttonTooltip"],[1,"embed-container"],[1,"mb-1","fw-bold"],[3,"video"],["class","tasks-container",4,"ngIf"],[1,"tasks-container"],[4,"ngFor","ngForOf"]];},template:function(n,r){n&1&&(c(0,"h2"),v(1,"my-global-icon",13),B(2),C(3,0),X(),l(),I(4,zc,2,1,"my-alert",14)(5,Wc,41,17,"div",15)),n&2&&(_(4),K(r.getUnavailability()?4:5));},dependencies:[J,Ko,Pe,ye,te,De,Re,qn,rn,Vt,Mt,Q,Ke,oe,Je],styles:[`h2[_ngcontent-%COMP%]{font-weight:700;color:var(--fg-350);line-height:1;font-size:calc(1.325rem + .9vw);margin-bottom:calc(1.325rem + .9vw)}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{font-size:2rem}}@media (min-width: 1200px){h2[_ngcontent-%COMP%]{margin-bottom:2rem}}h2[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:inline-block;width:28px;height:28px;line-height:28px;margin-inline-end:.5rem}@media screen and (max-width: 800px){h2[_ngcontent-%COMP%]{text-align:center}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}my-peertube-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}my-timestamp-input[_ngcontent-%COMP%]{width:100px}input[type=text][_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=text][_ngcontent-%COMP%]{width:100%}}p-calendar[_ngcontent-%COMP%]{display:block}p-calendar[_ngcontent-%COMP%]     .p-calendar{width:100%}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:fit-content(66%) 1fr;grid-gap:calc(1.375rem + 1.5vw)}@media (min-width: 1200px){.form-columns[_ngcontent-%COMP%]{grid-gap:2.5rem}}.form-columns.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){order:1}.form-columns.reverse[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){order:-1}@media screen and (max-width: 1000px){.form-columns[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr)}}.dragover[_ngcontent-%COMP%]{border:3px dashed var(--primary)}.plugin-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;column-gap:2.5rem}.plugin-fields[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(odd){width:66%}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--red);font-weight:700;font-size:1rem}
/*# sourceMappingURL=video-manage-page-common-P7TVR4KC.css.map */`,`my-timestamp-input[_ngcontent-%COMP%]{display:block;width:100px}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;grid-template-rows:auto 1fr;column-gap:calc(1.425rem + 2.1vw);row-gap:calc(1.325rem + .9vw)}@media (min-width: 1200px){.grid-container[_ngcontent-%COMP%]{column-gap:3rem}}@media (min-width: 1200px){.grid-container[_ngcontent-%COMP%]{row-gap:2rem}}.grid-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{grid-column:1;grid-row:1/3}.grid-container[_ngcontent-%COMP%]   .embed-container[_ngcontent-%COMP%]{grid-column:2;grid-row:1}.grid-container[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]{grid-column:2;grid-row:2}@media screen and (max-width: 800px){.grid-container[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1fr);grid-template-rows:auto auto 1fr}.grid-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{grid-column:1;grid-row:2}.grid-container[_ngcontent-%COMP%]   .embed-container[_ngcontent-%COMP%]{grid-column:1;grid-row:1}.grid-container[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]{grid-column:1;grid-row:3}}h3[_ngcontent-%COMP%]{font-weight:700;font-size:16px;padding:0 5px;width:fit-content;margin-top:.5rem}.section[_ngcontent-%COMP%]{min-width:600px;margin-bottom:50px;border:1px solid transparent;background:var(--bg-secondary-400);border-radius:5px;width:fit-content;padding-inline-start:.625rem}.section[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .section[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin-inline-start:.3125rem}.section[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--fg-300);margin-top:5px;margin-bottom:15px}@media screen and (max-width: 600px){.section[_ngcontent-%COMP%]{min-width:100%}}my-embed[_ngcontent-%COMP%]{display:block;max-width:500px;width:100%}my-reactive-file[_ngcontent-%COMP%]{display:block;width:fit-content}
/*# sourceMappingURL=video-studio.component-UJIEQNVZ.css.map */`]}));let t=i;return t;})();var zh=[{path:"",component:qi},{path:"main-info",component:qi},{path:"captions",component:Jr},{path:"chapters",component:oa},{path:"customization",component:ha},{path:"live-settings",component:Aa},{path:"moderation",component:Ta},{path:"replace-file",component:ya},{path:"stats",component:rs},{path:"studio",component:ss}];function Yc(t,i){if(t&1&&(c(0,"li"),R(1),l()),t&2){let o=i.$implicit;_(),Y(o);}}function qc(t,i){if(t&1&&(c(0,"div",3)(1,"a",4),C(2,1),l(),c(3,"ul",5),hn(4,Yc,2,1,"li",null,Ui),l()()),t&2){let o=i.$implicit;_(),g("routerLink",o.path),_(),Ae(o.page),ve(2),_(2),Cn(o.errors);}}var ds=(()=>{let i=class i{manageController=A(ae);getAllErrors(){return this.manageController.getFormErrors();}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-manage-errors"]],decls:5,vars:0,consts:()=>{let e;e="There are errors in your video settings.";let n;return n=""+"\uFFFD0\uFFFD"+" page",[e,n,["type","warning"],[1,"mt-3"],[1,"alert-link",3,"routerLink"],[1,"mb-0"]];},template:function(n,r){n&1&&(c(0,"my-alert",2)(1,"div"),C(2,0),l(),hn(3,qc,6,2,"div",3,Ui),l()),n&2&&(_(3),Cn(r.getAllErrors()));},dependencies:[xt,ut,Je],encapsulation:2}));let t=i;return t;})();var Zc=[[["",8,"icon"]],[["",8,"label"]]],Kc=[".icon",".label"],cs=(()=>{let i=class i{help=Te.required();};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-unavailable-menu-entry"]],inputs:{help:[1,"help"]},ngContentSelectors:Kc,decls:10,vars:1,consts:()=>{let e;e="Feature unavailable";let n;return n="UNAVAILABLE",[n,[1,"unavailable"],[1,"badge-help"],[1,"pt-badge","badge-secondary-on-secondary"],["helpTitle",e,"container","body"]];},template:function(n,r){n&1&&(kn(Zc),c(0,"div",1),Mn(1),c(2,"div")(3,"div"),Mn(4,1),l(),c(5,"div",2)(6,"div",3),C(7,0),l(),c(8,"my-help",4),R(9),l()()()()),n&2&&(_(9),ue(" ",r.help()," "));},dependencies:[Oe,xt,J,te,tn,li],styles:[`.unavailable[_ngcontent-%COMP%]{display:flex;align-items:center}.unavailable[_ngcontent-%COMP%]   my-help[_ngcontent-%COMP%]{color:var(--fg-200)}@media only screen and (max-width: 1000px){.unavailable[_ngcontent-%COMP%]{flex-direction:column;text-align:center;align-items:center}.badge-help[_ngcontent-%COMP%]{display:flex;margin-top:.25rem}}
/*# sourceMappingURL=unavailable-menu-entry.component-LS4YTBTR.css.map */`]}));let t=i;return t;})();var Qc=()=>({exact:!0});function Jc(t,i){t&1&&(c(0,"li")(1,"a",26)(2,"div",17),v(3,"my-global-icon",27),l(),c(4,"span"),C(5,8),l()()());}function e_(t,i){t&1&&(c(0,"div",17),v(1,"my-global-icon",35),l());}function t_(t,i){t&1&&(c(0,"span"),C(1,11),l());}function n_(t,i){t&1&&v(0,"span",38);}function i_(t,i){t&1&&v(0,"span",39);}function o_(t,i){if(t&1&&(c(0,"my-unavailable-menu-entry",32),I(1,n_,1,0,"span",36)(2,i_,1,0,"span",37),l()),t&2){h();let o=Ge(16),e=Ge(18),n=h();g("help",n.studioUnavailable()),_(),g("ngTemplateOutlet",o),_(),g("ngTemplateOutlet",e);}}function r_(t,i){t&1&&yt(0);}function a_(t,i){t&1&&yt(0);}function s_(t,i){if(t&1&&(c(0,"a",33),I(1,r_,1,0,"ng-container",40)(2,a_,1,0,"ng-container",40),l()),t&2){h();let o=Ge(16),e=Ge(18);_(),g("ngTemplateOutlet",o),_(),g("ngTemplateOutlet",e);}}function l_(t,i){t&1&&(c(0,"div",17),v(1,"my-global-icon",41),l());}function d_(t,i){t&1&&(c(0,"span"),C(1,12),l());}function c_(t,i){t&1&&v(0,"span",38);}function __(t,i){t&1&&v(0,"span",39);}function m_(t,i){if(t&1&&(c(0,"my-unavailable-menu-entry",32),I(1,c_,1,0,"span",36)(2,__,1,0,"span",37),l()),t&2){h();let o=Ge(23),e=Ge(25),n=h();g("help",n.replaceFileUnavailable()),_(),g("ngTemplateOutlet",o),_(),g("ngTemplateOutlet",e);}}function p_(t,i){t&1&&yt(0);}function u_(t,i){t&1&&yt(0);}function g_(t,i){if(t&1&&(c(0,"a",34),I(1,p_,1,0,"ng-container",40)(2,u_,1,0,"ng-container",40),l()),t&2){h();let o=Ge(23),e=Ge(25);_(),g("ngTemplateOutlet",o),_(),g("ngTemplateOutlet",e);}}function E_(t,i){if(t&1&&(c(0,"li")(1,"a",28)(2,"div",17),v(3,"my-global-icon",29),l(),c(4,"span"),C(5,9),l()()(),c(6,"li")(7,"a",30)(8,"div",17),v(9,"my-global-icon",31),l(),c(10,"span"),C(11,10),l()()(),c(12,"div",20),v(13,"div"),l(),c(14,"li"),I(15,e_,2,0,"ng-template",null,0,at)(17,t_,2,0,"ng-template",null,1,at)(19,o_,3,3,"my-unavailable-menu-entry",32)(20,s_,3,2,"a",33),l(),c(21,"li"),I(22,l_,2,0,"ng-template",null,2,at)(24,d_,2,0,"ng-template",null,3,at)(26,m_,3,3,"my-unavailable-menu-entry",32)(27,g_,3,2,"a",34),l()),t&2){let o=h();_(19),K(o.studioUnavailable()?19:20),_(7),K(o.replaceFileUnavailable()?26:27);}}function f_(t,i){t&1&&(c(0,"div",20),v(1,"div"),l(),c(2,"li")(3,"a",42)(4,"div",17),v(5,"my-global-icon",43),l(),c(6,"span"),C(7,13),l()()());}var _s=(()=>{let i=class i{serverService=A(ie);manageController=A(ae);canWatch=Te.required({transform:An});videoEdit;replaceFileEnabled;studioEnabled;instanceName;ngOnInit(){let e=this.serverService.getHTMLConfig();this.studioEnabled=e.videoStudio.enabled===!0,this.instanceName=e.instance.name,this.replaceFileEnabled=e.videoFile.update.enabled===!0;let{videoEdit:n}=this.manageController.getStore();this.videoEdit=n;}getVideo(){return this.videoEdit.getVideoAttributes();}studioUnavailable(){return Pi(fe(Z({},this.videoEdit.getVideoAttributes()),{instanceName:this.instanceName,studioEnabled:this.studioEnabled}));}replaceFileUnavailable(){return Oi(fe(Z({},this.videoEdit.getVideoAttributes()),{instanceName:this.instanceName,replaceFileEnabled:this.replaceFileEnabled}));}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-manage-menu"]],inputs:{canWatch:[1,"canWatch"]},decls:28,vars:5,consts:()=>{let e;e="MANAGE MY VIDEO";let n;n="Main information";let r;r="Customization";let d;d="Moder\xE1l\xE1s";let u;u="El\u0151 k\xF6zvet\xEDt\xE9s be\xE1ll\xEDt\xE1sai";let p;p="Feliratok";let E;E="Fejezetek";let S;S="St\xFAdi\xF3";let P;P="Replace file";let N;return N="Statistics",[["iconStudio",""],["labelStudio",""],["iconReplaceFile",""],["labelReplaceFile",""],e,n,r,d,u,p,E,S,P,N,[1,"menu"],[1,"ul-unstyle"],["routerLink",".","queryParamsHandling","merge","routerLinkActive","active",3,"routerLinkActiveOptions"],[1,"global-icon-wrapper"],["iconName","film"],[4,"ngIf"],[1,"separator"],["routerLink","customization","queryParamsHandling","merge","routerLinkActive","active"],["iconName","cog"],["routerLink","moderation","queryParamsHandling","merge","routerLinkActive","active"],["iconName","moderation"],[1,"menu-placeholder"],["routerLink","live-settings","queryParamsHandling","merge","routerLinkActive","active"],["iconName","live"],["routerLink","captions","queryParamsHandling","merge","routerLinkActive","active"],["iconName","captions"],["routerLink","chapters","queryParamsHandling","merge","routerLinkActive","active"],["iconName","chapters"],[3,"help"],["routerLink","studio","queryParamsHandling","merge","routerLinkActive","active"],["routerLink","replace-file","queryParamsHandling","merge","routerLinkActive","active"],["iconName","studio"],["class","icon",4,"ngTemplateOutlet"],["class","label",4,"ngTemplateOutlet"],[1,"icon"],[1,"label"],[4,"ngTemplateOutlet"],["iconName","upload"],["routerLink","stats","queryParamsHandling","merge","routerLinkActive","active"],["iconName","stats"]];},template:function(n,r){n&1&&(c(0,"div",14)(1,"h1"),C(2,4),l(),c(3,"ul",15)(4,"li")(5,"a",16)(6,"div",17),v(7,"my-global-icon",18),l(),c(8,"span"),C(9,5),l()()(),I(10,Jc,6,0,"li",19),c(11,"div",20),v(12,"div"),l(),c(13,"li")(14,"a",21)(15,"div",17),v(16,"my-global-icon",22),l(),c(17,"span"),C(18,6),l()()(),c(19,"li")(20,"a",23)(21,"div",17),v(22,"my-global-icon",24),l(),c(23,"span"),C(24,7),l()()(),I(25,E_,28,2)(26,f_,8,0),l()(),v(27,"div",25)),n&2&&(_(5),g("routerLinkActiveOptions",zo(4,Qc)),_(5),g("ngIf",r.getVideo().isLive),_(15),K(r.getVideo().isLive?-1:25),_(),K(r.canWatch()?26:-1));},dependencies:[Oe,Q,Xn,xt,ut,Yo,J,te,tn,oe,cs],styles:[`h1[_ngcontent-%COMP%]{color:var(--fg-200);font-weight:700;margin-bottom:1rem;text-align:center;font-size:.875rem}.menu[_ngcontent-%COMP%], .menu-placeholder[_ngcontent-%COMP%]{position:sticky;top:var(--header-height);width:calc(248px - 2rem);max-height:calc(100vh - var(--header-height));z-index:12600;margin-right:var(--x-margin-content)}.menu[_ngcontent-%COMP%]{padding-top:1.5rem;padding-bottom:1.5rem;background-color:var(--bg-secondary-400);border-radius:14px;overflow:auto}.global-icon-wrapper[_ngcontent-%COMP%]{display:inline-block;border-radius:100%;padding:5px;background-color:var(--bg);line-height:1;width:fit-content;height:fit-content;margin-right:.75rem}.global-icon-wrapper[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{color:var(--primary);display:inline-block;width:22px;height:22px;line-height:22px}li[_ngcontent-%COMP%]{list-style:none}a[_ngcontent-%COMP%], my-unavailable-menu-entry[_ngcontent-%COMP%], .separator[_ngcontent-%COMP%]{padding-left:calc(1.275rem + .3vw)}@media (min-width: 1200px){a[_ngcontent-%COMP%], my-unavailable-menu-entry[_ngcontent-%COMP%], .separator[_ngcontent-%COMP%]{padding-left:1.5rem}}my-unavailable-menu-entry[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}my-unavailable-menu-entry[_ngcontent-%COMP%]   .global-icon-wrapper[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)!important}a[_ngcontent-%COMP%], my-unavailable-menu-entry[_ngcontent-%COMP%]{display:block;padding-top:.5rem;padding-bottom:.5rem}a[_ngcontent-%COMP%]{color:var(--fg-350)}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:active{text-decoration:none}a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}a[_ngcontent-%COMP%]:hover{opacity:1;color:var(--fg-400)}a.active[_ngcontent-%COMP%]{color:var(--fg-400);font-weight:700;background-color:var(--bg-secondary-350)}a.active[_ngcontent-%COMP%]   .global-icon-wrapper[_ngcontent-%COMP%]{background-color:var(--primary)}a.active[_ngcontent-%COMP%]   .global-icon-wrapper[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{color:var(--bg)}.separator[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:1rem;padding-right:calc(1.275rem + .3vw)}@media (min-width: 1200px){.separator[_ngcontent-%COMP%]{padding-right:1.5rem}}.separator[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:2px;width:100%;background-color:var(--bg-secondary-500);border-radius:14px}@media screen and (max-width: 1000px){h1[_ngcontent-%COMP%]{width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}h1[_ngcontent-%COMP%]:not(caption){position:absolute!important}h1[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{overflow:hidden!important}ul[_ngcontent-%COMP%]{display:flex;margin:0 auto;width:fit-content}.menu-placeholder[_ngcontent-%COMP%]{display:none}.menu[_ngcontent-%COMP%]{position:fixed;bottom:0;top:unset;width:calc(100vw - var(--menu-width) - var(--x-margin-content) * 2);padding:.75rem .5rem;border:1px solid var(--bg-secondary-450);border-bottom:0;border-end-end-radius:0;border-end-start-radius:0}a[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;align-items:center}a.active[_ngcontent-%COMP%]{background-color:inherit}a[_ngcontent-%COMP%], .separator[_ngcontent-%COMP%], my-unavailable-menu-entry[_ngcontent-%COMP%]{font-size:12px;line-height:1.2;padding:0 .5rem}.separator[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:100%}.global-icon-wrapper[_ngcontent-%COMP%]{margin:0 0 .25rem}}@media screen and (max-width: 500px){.menu[_ngcontent-%COMP%]{border-radius:0;border-width:1px 0 0;width:100vw;left:0}}
/*# sourceMappingURL=video-manage-menu.component-W64PFW6W.css.map */`]}));let t=i;return t;})();var h_=["*"];function C_(t,i){if(t&1&&(c(0,"my-button",19)(1,"span",20),C(2,1),l()()),t&2){let o=h();g("href",o.getWatchUrl());}}function S_(t,i){t&1&&(B(0),C(1,2),X());}function M_(t,i){t&1&&(B(0),C(1,3),X());}function A_(t,i){t&1&&(B(0),C(1,4),X());}function v_(t,i){if(t&1&&(c(0,"div",21)(1,"div",22),R(2),l(),c(3,"strong",23),R(4),l(),c(5,"span"),R(6),l()()),t&2){let o=h();_(2),Y(o.getStateWarning().title),_(2),Y(o.getStateWarning().manageMain),_(2),Y(o.getStateWarning().manageSecondary);}}function O_(t,i){t&1&&v(0,"my-manage-errors",24);}var VC=(()=>{let i=class i{manageController=A(ae);notifier=A(Ue);headerService=A(Ar);screenService=A(Cr);videoStateMessage=A(wr);canWatch=Te.required({transform:An});canUpdate=Te.required({transform:An});uploadedLabel=Te();cancelLink=Te();videoUpdated=Jt();displayFormErrorsMsg=!1;canRetryUpload=!0;isUpdating=!1;videoEdit;ngOnInit(){this.screenService.isInMobileView()&&this.headerService.setSearchHidden(!0);let{videoEdit:e}=this.manageController.getStore();this.videoEdit=e;}ngOnDestroy(){this.headerService.setSearchHidden(!1);}hasFormErrors(){return this.manageController.hasFormErrors();}getStateWarning(){return this.videoStateMessage.buildWarn(this.videoEdit.getVideoAttributes().state);}hasPendingChanges(){return this.manageController.hasPendingChanges();}hasReplaceFile(){return this.manageController.hasReplaceFile();}hasStudioTasks(){return this.manageController.hasStudioTasks();}onWantToUpdate(){return $(this,null,function*(){if(this.displayFormErrorsMsg=!1,yield this.manageController.runSaveHook(),this.hasFormErrors()){this.displayFormErrorsMsg=!0;return;}if(!this.isUpdating){if(this.isUpdating=!0,!(yield this.manageController.checkAndConfirmVideoFileReplacement())||!(yield this.manageController.checkAndConfirmStudioTasks())){this.isUpdating=!1;return;}this.manageController.updateVideo().subscribe({next:()=>(this.isUpdating=!1,this.videoUpdated.emit()),error:e=>{this.isUpdating=!1,this.notifier.error(e.message);}});}});}getUploadPercents(){return this.manageController.getUploadPercents();}getUploadError(){return this.manageController.getUploadError();}isUploadingFile(){return this.manageController.isUploadingFile();}hasUploadedFile(){return this.manageController.hasUploadedFile();}getWatchUrl(){return ai.buildWatchUrl(this.videoEdit.getVideoAttributes());}getVideo(){return this.videoEdit.getVideoAttributes();}retryUpload(){this.canRetryUpload=!1,this.manageController.cancelUploadIfNeeded(),this.manageController.retryUpload();}};T(i,"\u0275fac",function(n){return new(n||i)();}),T(i,"\u0275cmp",j({type:i,selectors:[["my-video-manage-container"]],inputs:{canWatch:[1,"canWatch"],canUpdate:[1,"canUpdate"],uploadedLabel:[1,"uploadedLabel"],cancelLink:[1,"cancelLink"]},outputs:{videoUpdated:"videoUpdated"},ngContentSelectors:h_,decls:23,vars:14,consts:()=>{let e;e="M\xE9gse";let n;n="Watch the video";let r;r="Save and run studio tasks";let d;d="Save and replace file";let u;return u="Ment\xE9s",[e,n,r,d,u,[1,"root"],[3,"canWatch"],[1,"w-100","min-width-0"],[1,"video-actions-container"],[1,"video-actions","video-header-block"],["icon","arrow-left","theme","secondary",1,"cancel-button",3,"ptRouterLink"],[1,"watch-save"],["icon","external-link","theme","secondary","class","me-3",3,"href",4,"ngIf"],["theme","primary","icon","circle-tick",1,"save-button",3,"click","disabled"],["class","video-state video-header-block mt-2",4,"ngIf"],["class","d-block mt-2",4,"ngIf"],[1,"d-block","mt-2",3,"retry","isUploading","uploadPercents","error","uploaded","enableRetryAfterError","uploadedLabel"],[1,"mt-2"],[1,"mt-3"],["icon","external-link","theme","secondary",1,"me-3",3,"href"],[1,"watch-button-label"],[1,"video-state","video-header-block","mt-2"],[1,"alert-title"],[1,"me-1"],[1,"d-block","mt-2"]];},template:function(n,r){if(n&1&&(kn(),c(0,"div",5)(1,"div"),v(2,"my-video-manage-menu",6),l(),c(3,"div",7)(4,"div",8)(5,"div",9)(6,"my-button",10),C(7,0),l(),c(8,"h2"),R(9),l(),c(10,"div",11),I(11,C_,3,1,"my-button",12),c(12,"my-button",13),L("click",function(){return r.onWantToUpdate();}),I(13,S_,2,0,"ng-container")(14,M_,2,0,"ng-container")(15,A_,2,0,"ng-container"),l()()()(),I(16,v_,7,3,"div",14)(17,O_,1,0,"my-manage-errors",15),c(18,"my-upload-progress",16),L("retry",function(){return r.retryUpload();}),l(),c(19,"div",17),Mn(20),l(),c(21,"div",18),v(22,"router-outlet"),l()()()),n&2){let d;_(2),g("canWatch",r.canWatch()),_(4),g("ptRouterLink",r.cancelLink()),_(3),Y(r.getVideo().name),_(2),g("ngIf",r.canWatch()),_(),g("disabled",!r.canUpdate()||!r.hasPendingChanges()),_(),K(r.hasStudioTasks()?13:r.hasReplaceFile()?14:15),_(3),g("ngIf",(d=r.getStateWarning())==null?null:d.title),_(),g("ngIf",r.displayFormErrorsMsg&&r.hasFormErrors()),_(),g("isUploading",r.isUploadingFile())("uploadPercents",r.getUploadPercents())("error",r.getUploadError())("uploaded",r.hasUploadedFile())("enableRetryAfterError",r.canRetryUpload)("uploadedLabel",r.uploadedLabel());}},dependencies:[Oe,Q,xt,Wo,J,te,Ct,ds,tn,Fr,_s],styles:[`.root[_ngcontent-%COMP%]{display:flex}@media screen and (max-width: 1000px){.root[_ngcontent-%COMP%]{margin-bottom:150px}}.video-header-block[_ngcontent-%COMP%]{border-radius:14px;background-color:var(--bg-secondary-350)}.video-actions-container[_ngcontent-%COMP%]{position:sticky;top:var(--header-height);background-color:var(--bg);z-index:1}.video-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;padding:1.5rem}.video-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{flex-shrink:1;color:var(--fg-350);font-weight:700;margin-bottom:0;line-height:normal;font-size:calc(1.275rem + .3vw);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (min-width: 1200px){.video-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}}.video-actions[_ngcontent-%COMP%]   .watch-save[_ngcontent-%COMP%]{display:flex;gap:1rem}@media screen and (max-width: 1200px){.video-actions[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.video-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{display:none}.video-actions[_ngcontent-%COMP%]   .watch-save[_ngcontent-%COMP%]{justify-content:center}}@media screen and (max-width: 800px){.video-actions[_ngcontent-%COMP%]   .watch-button-label[_ngcontent-%COMP%]{display:none}}@media screen and (max-width: 500px){.video-actions[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem}}.video-state[_ngcontent-%COMP%]{color:var(--fg-300);padding:1rem 1.5rem;font-size:.875rem}
/*# sourceMappingURL=video-manage-container.component-SR7MCP2B.css.map */`]}));let t=i;return t;})();export{Ci as a,Mi as b,Hr as c,ae as d,vi as e,Yi as f,zh as g,VC as h};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-GL5D7JZI.js.map