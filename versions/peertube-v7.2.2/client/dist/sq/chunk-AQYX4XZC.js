import{b as bn}from"./chunk-XHL23EQD.js";import{a as Ln}from"./chunk-5OMW7VPY.js";import{b as vn,c as Yn,d as $n}from"./chunk-CWRM6WWY.js";import{a as Un}from"./chunk-OBNYDDHF.js";import{a as wn,b as Fn}from"./chunk-ANIHUVIX.js";import{a as hn}from"./chunk-OLGL424K.js";import{a as fn,b as Pn,c as Rn,d as In,e as Ue}from"./chunk-I24ROVDK.js";import"./chunk-FWCJKVBG.js";import"./chunk-ZO2H6O7A.js";import{a as it,b as _t,c as rt,i as at,j as st}from"./chunk-5BBSIJ6K.js";import"./chunk-X5AICG5H.js";import"./chunk-4MNDFPOM.js";import{c as Sn}from"./chunk-SS3SQE34.js";import{a as de}from"./chunk-GUE2RQOD.js";import{a as yn}from"./chunk-GLDJGDCD.js";import{c as ot,d as Nn,h as An,i as En}from"./chunk-DUA2DJQ3.js";import"./chunk-FJ2ZROHN.js";import{a as nt}from"./chunk-EBEN7JLX.js";import"./chunk-HRQFMPLQ.js";import{a as gn}from"./chunk-E3CSCYZJ.js";import{a as lt}from"./chunk-APIXYPUO.js";import{a as mn}from"./chunk-5GTHDKWY.js";import{a as rn,b as ln}from"./chunk-HO54TQU6.js";import"./chunk-EFI4VIXO.js";import"./chunk-ID3GIFOG.js";import"./chunk-576ZABFD.js";import"./chunk-UFXFCZP3.js";import"./chunk-V73D6FBB.js";import{a as Mn}from"./chunk-A2KNDDCC.js";import"./chunk-HH4YHD3C.js";import{c as On}from"./chunk-BFVCLNOF.js";import{b as Te}from"./chunk-3PB3Q4OH.js";import"./chunk-24ZAFI2J.js";import{a as sn}from"./chunk-6TRYPH2T.js";import{a as oe}from"./chunk-JVRBW57G.js";import{d as Cn,f as tt,g as cn,h as Tn,j as dn,n as un,o as pn}from"./chunk-BOZAQTZE.js";import"./chunk-ANGOORPW.js";import{b as te,c as ce}from"./chunk-25AA3I7H.js";import{c as _n}from"./chunk-2O3IZ566.js";import"./chunk-YDZGE3V5.js";import{a as on}from"./chunk-724R53DI.js";import"./chunk-S5ARXDTR.js";import{a as nn}from"./chunk-ROB72YBH.js";import"./chunk-EECS7F3M.js";import"./chunk-OPOGZMDG.js";import"./chunk-UI5MIAKJ.js";import"./chunk-C5UL7A6S.js";import{b as et}from"./chunk-WZVFW7AN.js";import{a as an}from"./chunk-6JJL547V.js";import{E as Re,s as Wt}from"./chunk-RT7DTAS6.js";import{B as G,C as ee,c as qe,g as x,h as Q,m as Pe,n as j,q as Z,t as J,u as Gt,v as Xt,w as kt}from"./chunk-WO4VNXA3.js";import{a as ye}from"./chunk-PE7TFI7A.js";import{Ag as Jt,B as De,Bb as N,Bc as He,Bd as ae,Bg as en,C as Rt,Cb as c,Cc as Ke,D as It,Dc as Y,Ea as Ae,Fd as zt,Ha as l,He as Bt,Jd as me,Ld as Ce,Mb as Se,Mf as Je,Na as Ee,Nb as fe,Nf as Kt,Ob as vt,Of as qt,Pb as S,Pg as tn,Q as yt,Qb as b,Ra as ge,Rb as H,Rc as bt,S as Ut,Sa as g,Sg as k,Ub as ue,Vb as pe,Wa as V,Wb as Me,Xc as wt,Xf as w,Y as ht,Ya as m,Yb as Yt,Zb as We,aa as d,eb as C,ef as je,fc as K,ff as Ze,gc as Ct,ha as A,hc as re,i as St,ia as E,j as Ve,jb as q,jc as $t,kg as Qt,la as z,ld as Lt,lg as L,mf as ze,n as ft,nb as r,ob as _,od as Ft,pb as p,pd as xt,qb as R,qf as Ht,r as Be,rb as I,re as Vt,rg as jt,se as Tt,sg as Ie,ta as se,tb as y,vb as B,vg as Zt,wb as W,x as Pt,xb as s,xd as Qe,xg as ne,yb as ie,yd as ct,zb as _e,zd as Dt}from"./chunk-F7FAPFPY.js";import{a as Et,b as gt,i as u,j as Ne}from"./chunk-AI7IVZV2.js";var xn=(()=>{let i=class i{};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-abuses-list"]],decls:1,vars:0,consts:[["viewType","user"]],template:function(e,o){e&1&&p(0,"my-abuse-list-table",0);},dependencies:[fn],encapsulation:2}));let n=i;return n;})();var Gn=(()=>{let i=class i{authService=d(L);scopedTokensService=d(jt);videoService=d(On);notifier=d(w);confirmService=d(Ie);feedUrl;feedToken;baseURL=ze.originServerUrl||window.location.origin;ngOnInit(){this.feedUrl=this.baseURL,this.scopedTokensService.getScopedTokens().subscribe({next:t=>this.regenApplications(t),error:t=>this.notifier.error(t.message)});}renewToken(){return Ne(this,null,function*(){(yield this.confirmService.confirm("Renewing the token will disallow previously configured clients from retrieving the feed until they use the new token. Proceed?","Renew token"))!==!1&&this.scopedTokensService.renewScopedTokens().subscribe({next:e=>{this.regenApplications(e),this.notifier.success("Token renewed. Update your client configuration accordingly.");},error:e=>this.notifier.error(e.message)});});}regenApplications(t){let e=this.authService.getUser(),o=this.videoService.getVideoSubscriptionFeedUrls(e.account.id,t.feedToken);this.feedUrl=this.baseURL+o.find(T=>T.format===Dt.RSS).url,this.feedToken=t.feedToken;}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-applications"]],decls:18,vars:8,consts:()=>{let t;t="Renew token";let e;e="SUBSCRIPTION FEED";let o;o=" Use third-party feed aggregators to retrieve the list of videos from channels you subscribed to. ";let T;T="Feed URL";let O;O="Feed Token";let M;return M="\u26A0\uFE0F Never share your feed token with anyone.",[e,o,T,O,M,[1,"pt-two-cols"],[1,"title-col"],[1,"applications-description"],[1,"content-col"],[1,"form-group"],["for","feed-url"],["inputId","feed-url",3,"value","withToggle","withCopy","show","readonly"],["for","feed-token"],["inputId","feed-token",3,"value","withCopy","readonly"],[1,"form-group-description"],["type","submit","value",t,1,"peertube-button","primary-button","mt-4",3,"click"]];},template:function(e,o){e&1&&(r(0,"div",5)(1,"div",6)(2,"h2"),s(3,0),_(),r(4,"div",7),s(5,1),_()(),r(6,"div",8)(7,"div",9)(8,"label",10),s(9,2),_(),p(10,"my-input-text",11),_(),r(11,"div",9)(12,"label",12),s(13,3),_(),p(14,"my-input-text",13),r(15,"div",14),s(16,4),_()(),r(17,"input",15),N("click",function(){return o.renewToken();}),_()()()),e&2&&(l(10),C("value",o.feedUrl)("withToggle",!1)("withCopy",!0)("show",!0)("readonly",!0),l(4),C("value",o.feedToken)("withCopy",!0)("readonly",!0));},dependencies:[Te],styles:[`.pt-two-cols[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]{max-width:500px}
/*# sourceMappingURL=my-account-applications.component-32P7MX6L.css.map */`]}));let n=i;return n;})();function io(n,i){if(n&1){let a=y();r(0,"div",11)(1,"div",12)(2,"my-advanced-input-filter",13),N("search",function(e){A(a);let o=c();return E(o.onSearch(e));}),_()()();}}function _o(n,i){if(n&1&&(r(0,"tr")(1,"th",14),s(2,0),_(),r(3,"th",15),s(4,1),_(),r(5,"th",16),B(6,2),p(7,"p-sortIcon",17),W(),_()()),n&2){let a=c();l(5),C("ngbTooltip",a.sortTooltip);}}function ro(n,i){if(n&1){let a=y();r(0,"tr")(1,"td",18)(2,"button",19),N("click",function(){let e=A(a).$implicit,o=c();return E(o.unblockAccount(e));}),s(3,3),_()(),r(4,"td")(5,"a",20)(6,"div",21),p(7,"my-actor-avatar",22),r(8,"div"),S(9),r(10,"span",23),S(11),_()()()()(),r(12,"td"),S(13),K(14,"ptDate"),_()();}if(n&2){let a=i.$implicit;l(5),C("href",a.blockedAccount.url,Ae),l(2),C("actor",a.blockedAccount),l(2),H(" ",a.blockedAccount.displayName," "),l(2),b(a.blockedAccount.nameWithHost),l(2),b(re(14,5,a.createdAt,"short"));}}function ao(n,i){n&1&&(R(0),s(1,4),I());}function lo(n,i){n&1&&(R(0),s(1,5),I());}function so(n,i){if(n&1&&(r(0,"tr")(1,"td",24)(2,"div",25),m(3,ao,2,0,"ng-container",26)(4,lo,2,0,"ng-container",26),_()()()),n&2){let a=c();l(3),C("ngIf",a.search),l(),C("ngIf",!a.search);}}var Xn=(()=>{let i=class i extends Pn{mode=ot.Account;getIdentifier(){return"MyAccountBlocklistComponent";}};u(i,"\u0275fac",(()=>{let t;return function(o){return(t||(t=z(i)))(o||i);};})()),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-blocklist"]],features:[V],decls:5,vars:11,consts:()=>{let t;t="Veprim";let e;e="Llogari";let o;o="Heshtuar m\xEB "+"\uFFFD#7\uFFFD"+""+"\uFFFD/#7\uFFFD"+"";let T;T="Hape llogarin\xEB n\xEB sked\xEB t\xEB re";let O;O="Ktheji z\xEBrin";let M;M="S\u2019u gjet llogari me p\xEBrputhje me filtrat e tanish\xEBm.";let P;return P="S\u2019u gjet llogari.",[t,e,o,O,M,P,[3,"onLazyLoad","value","lazy","paginator","totalRecords","rows","rowsPerPageOptions","first","sortField","sortOrder","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"caption"],[1,"ms-auto"],[3,"search"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],[1,"peertube-button","secondary-button",3,"click"],["title",T,"target","_blank","rel","noopener noreferrer",3,"href"],[1,"chip","two-lines"],["actorType","account","size","32",3,"actor"],[1,"muted"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(e,o){e&1&&(r(0,"p-table",6),N("onLazyLoad",function(O){return o.loadLazy(O);}),m(1,io,3,0,"ng-template",7)(2,_o,8,1,"ng-template",8)(3,ro,15,8,"ng-template",9)(4,so,5,2,"ng-template",10),_()),e&2&&C("value",o.blockedAccounts)("lazy",!0)("paginator",o.totalRecords>0)("totalRecords",o.totalRecords)("rows",o.rowsPerPage)("rowsPerPageOptions",o.rowsPerPageOptions)("first",o.pagination.start)("sortField",o.sort.field)("sortOrder",o.sort.order)("showCurrentPageReport",!0)("currentPageReportTemplate",o.getPaginationTemplate());},dependencies:[at,it,je,_t,rt,Ze,lt,Re,sn,st,Y,de],encapsulation:2}));let n=i;return n;})();function Co(n,i){if(n&1){let a=y();r(0,"div",14)(1,"div",15)(2,"button",16),N("click",function(){A(a);let e=c();return E(e.addServersToBlock());})("key.enter",function(){A(a);let e=c();return E(e.addServersToBlock());}),p(3,"my-global-icon",17),R(4),s(5,1),I(),_()(),r(6,"div",18)(7,"my-advanced-input-filter",19),N("search",function(e){A(a);let o=c();return E(o.onSearch(e));}),_()()();}}function co(n,i){if(n&1&&(r(0,"tr")(1,"th",20),s(2,2),_(),r(3,"th",21),s(4,3),_(),r(5,"th",22),B(6,4),p(7,"p-sortIcon",23),W(),_()()),n&2){let a=c();l(5),C("ngbTooltip",a.sortTooltip);}}function To(n,i){if(n&1){let a=y();r(0,"tr")(1,"td",24)(2,"button",25),N("click",function(){let e=A(a).$implicit,o=c();return E(o.unblockServer(e));}),s(3,5),_()(),r(4,"td")(5,"a",26),S(6),p(7,"my-global-icon",27),_()(),r(8,"td"),S(9),K(10,"ptDate"),_()();}if(n&2){let a=i.$implicit;l(5),C("href","https://"+a.blockedServer.host,Ae),l(),H(" ",a.blockedServer.host," "),l(3),b(re(10,3,a.createdAt,"short"));}}function uo(n,i){n&1&&(R(0),s(1,6),I());}function po(n,i){n&1&&(R(0),s(1,7),I());}function Mo(n,i){if(n&1&&(r(0,"tr")(1,"td",28)(2,"div",29),m(3,uo,2,0,"ng-container",30)(4,po,2,0,"ng-container",30),_()()()),n&2){let a=c();l(3),C("ngIf",a.search),l(),C("ngIf",!a.search);}}var kn=(()=>{let i=class i extends Rn{mode=ot.Account;getIdentifier(){return"MyAccountServerBlocklistComponent";}};u(i,"\u0275fac",(()=>{let t;return function(o){return(t||(t=z(i)))(o||i);};})()),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-server-blocklist"]],features:[V],decls:7,vars:12,consts:()=>{let t;t="Heshtoni p\xEBrkat\xEBsi";let e;e="Heshtoni p\xEBrkat\xEBsi";let o;o="Veprim";let T;T="Instanc\xEB";let O;O="Heshtuar m\xEB "+"\uFFFD#7\uFFFD"+""+"\uFFFD/#7\uFFFD"+"";let M;M="Hape instanc\xEBn n\xEB nj\xEB sked\xEB t\xEB re";let P;P="Ktheji z\xEBrin";let U;U="S\u2019u gjet sh\xEBrbyes me p\xEBrputhje me filtrat e tanish\xEBm.";let $;return $="S\u2019u gjet sh\xEBrbyes.",[["batchDomainsModal",""],e,o,T,O,P,U,$,[3,"onLazyLoad","value","paginator","totalRecords","rows","rowsPerPageOptions","first","sortField","sortOrder","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["action",t,3,"domains"],[1,"caption"],[1,"left-buttons"],[1,"peertube-create-button",3,"click","key.enter"],["iconName","add","aria-hidden","true"],[1,"ms-auto"],[3,"search"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],[1,"peertube-button","secondary-button",3,"click"],["title",M,"target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(e,o){if(e&1){let T=y();r(0,"p-table",8),N("onLazyLoad",function(M){return A(T),E(o.loadLazy(M));}),m(1,Co,8,0,"ng-template",9)(2,co,8,1,"ng-template",10)(3,To,11,6,"ng-template",11)(4,Mo,5,2,"ng-template",12),_(),r(5,"my-batch-domains-modal",13,0),N("domains",function(M){return A(T),E(o.onDomainsToBlock(M));}),_();}e&2&&C("value",o.blockedServers)("paginator",o.totalRecords>0)("totalRecords",o.totalRecords)("rows",o.rowsPerPage)("rowsPerPageOptions",o.rowsPerPageOptions)("first",o.pagination.start)("sortField",o.sort.field)("sortOrder",o.sort.order)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",o.getPaginationTemplate());},dependencies:[ye,at,it,je,_t,rt,Ze,lt,Re,st,Y,In,de],styles:[`.moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 1000px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{text-decoration:none;color:var(--fg)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 1000px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}
/*# sourceMappingURL=moderation-RQPVRH5V.css.map */`,`a[_ngcontent-%COMP%]{color:var(--fg)}
/*# sourceMappingURL=server-blocklist.component-5QHBYIKC.css.map */`]}));let n=i;return n;})();var D=class D{authHttp=d(wt);restExtractor=d(Qt);server=d(ne);listUserExports(i){let{userId:a}=i,t=D.BASE_USER_EXPORTS_URL+a+"/exports";return this.authHttp.get(t).pipe(De(e=>this.restExtractor.handleError(e)));}requestNewUserExport(i){let{userId:a,withVideoFiles:t}=i,e=D.BASE_USER_EXPORTS_URL+a+"/exports/request";return this.authHttp.post(e,{withVideoFiles:t}).pipe(De(o=>this.restExtractor.handleError(o)));}deleteUserExport(i){let{userId:a,userExportId:t}=i,e=D.BASE_USER_EXPORTS_URL+a+"/exports/"+t;return this.authHttp.delete(e).pipe(De(o=>this.restExtractor.handleError(o)));}getLatestImport(i){let{userId:a}=i,t=D.BASE_USER_IMPORTS_URL+a+"/imports/latest";return Be([this.authHttp.get(t),this.server.getServerLocale()]).pipe(ft(([e,o])=>(e.state.label=Bt(e.state.label,o),e)),De(e=>e.status===ae.NOT_FOUND_404?Ve(void 0):this.restExtractor.handleError(e)));}};u(D,"BASE_USER_EXPORTS_URL",ze.apiUrl+"/api/v1/users/"),u(D,"BASE_USER_IMPORTS_URL",ze.apiUrl+"/api/v1/users/"),u(D,"\u0275fac",function(a){return new(a||D)();}),u(D,"\u0275prov",ht({token:D,factory:D.ɵfac}));var le=D;function mo(n,i){n&1&&(r(0,"p"),s(1,16),_());}function Oo(n,i){if(n&1&&(r(0,"div",27)(1,"div")(2,"strong"),S(3,"Latest import on:"),_(),S(4),K(5,"ptDate"),_(),r(6,"div")(7,"strong"),S(8,"Latest import state:"),_(),S(9),_()()),n&2){let a=c(2);l(4),H(" ",re(5,2,a.latestImport.createdAt,"medium")," "),l(5),H(" ",a.latestImport.state.label," ");}}function No(n,i){n&1&&(r(0,"my-alert",26),s(1,17),_());}function Ao(n,i){n&1&&(r(0,"my-alert",26),s(1,19),_());}function Eo(n,i){if(n&1){let a=y();r(0,"my-upload-progress",28),N("cancelUpload",function(){A(a);let e=c(2);return E(e.cancelUpload());})("retry",function(){A(a);let e=c(2);return E(e.retryUpload());}),_(),m(1,Ao,2,0,"my-alert",29),r(2,"div",30)(3,"span"),s(4,18),_(),r(5,"input",31),N("change",function(e){A(a);let o=c(2);return E(o.onFileChange(e));}),_()();}if(n&2){let a=c(2);C("isUploading",a.uploadingArchive)("uploadPercents",a.uploadPercents)("error",a.error)("uploaded",a.archiveUploadFinished)("enableRetryAfterError",a.enableRetryAfterError),l(),C("ngIf",a.archiveUploadFinished&&!a.error),l(),C("hidden",a.uploadingArchive||a.archiveUploadFinished);}}function go(n,i){if(n&1&&(r(0,"p"),s(1,1),_(),r(2,"p"),B(3,2),p(4,"strong"),W(),_(),r(5,"p"),s(6,3),_(),r(7,"ul")(8,"li"),s(9,4),_(),r(10,"li"),s(11,5),_(),r(12,"li"),s(13,6),_(),r(14,"li"),s(15,7),_(),r(16,"li"),s(17,8),_(),r(18,"li"),s(19,9),_(),r(20,"li"),s(21,10),_(),r(22,"li"),s(23,11),_(),r(24,"li"),B(25,12),p(26,"strong"),W(),_()(),r(27,"p"),s(28,13),_(),r(29,"ul")(30,"li"),s(31,14),_(),r(32,"li"),s(33,15),_()(),m(34,mo,2,0,"p",24)(35,Oo,10,5,"div",25)(36,No,2,0,"my-alert",26)(37,Eo,6,7)),n&2){let a=c();l(34),C("ngIf",a.isEmailEnabled()),l(),C("ngIf",a.latestImport),l(),q(a.hasPendingImport()?36:37);}}function So(n,i){n&1&&(r(0,"p"),s(1,20),_());}var Dn=(()=>{let i=class i{authService=d(L);server=d(ne);userImportExportService=d(le);resumableUploadService=d(Yn);notifier=d(w);videoQuotaUsed=se(void 0);uploadingArchive=!1;archiveUploadFinished=!1;error;enableRetryAfterError;uploadPercents=0;latestImport;fileToUpload;uploadServiceSubscription;alreadyRefreshedToken=!1;ngOnInit(){this.userImportExportService.getLatestImport({userId:this.authService.getUser().id}).subscribe(t=>this.latestImport=t),this.uploadServiceSubscription=this.resumableUploadService.events.subscribe(t=>this.onUploadOngoing(t));}ngOnDestroy(){this.resumableUploadService.disconnect(),this.uploadServiceSubscription&&this.uploadServiceSubscription.unsubscribe();}canDeactivate(){return{canDeactivate:!this.uploadingArchive,text:"Your archive file is not uploaded yet, are you sure you want to leave this page?"};}isImportEnabled(){return this.server.getHTMLConfig().import.users.enabled;}isEmailEnabled(){return this.server.getHTMLConfig().email.enabled;}onUploadOngoing(t){switch(t.status){case"error":{if(!this.alreadyRefreshedToken&&t.responseStatus===ae.UNAUTHORIZED_401)return this.alreadyRefreshedToken=!0,this.refreshTokenAndRetryUpload();this.handleUploadError(qt(t));break;}case"cancelled":this.uploadingArchive=!1,this.uploadPercents=0,this.enableRetryAfterError=!1,this.error="";break;case"uploading":this.uploadPercents=t.progress;break;case"complete":this.archiveUploadFinished=!0,this.uploadPercents=100,this.uploadingArchive=!1;break;}}onFileChange(t){let e=t.target,o=e.files[0];if(!o)return;let T=this.authService.getUser();if(T.videoQuota!==-1&&this.videoQuotaUsed()+o.size>T.videoQuota){let O=new nt(),M=O.transform(o.size,0),P=O.transform(this.videoQuotaUsed(),0),U=O.transform(T.videoQuota,0);this.notifier.error("Cannot import this file as your video quota would be exceeded (import size: "+M+", used: "+P+", quota: "+U+")"),e.value="";return;}this.fileToUpload=o,this.uploadFile(o);}cancelUpload(){this.resumableUploadService.control({action:"cancel"});}retryUpload(){this.enableRetryAfterError=!1,this.error="",this.uploadFile(this.fileToUpload);}hasPendingImport(){if(!this.latestImport)return!1;let t=this.latestImport.state.id;return t===ct.PENDING||t===ct.PROCESSING;}uploadFile(t){this.resumableUploadService.handleFiles(t,{endpoint:`${le.BASE_USER_IMPORTS_URL}${this.authService.getUser().id}/imports/import-resumable`,multiple:!1,maxChunkSize:this.server.getHTMLConfig().client.videos.resumableUpload.maxChunkSize,token:this.authService.getAccessToken(),uploaderClass:vn,retryConfig:Kt(),metadata:{filename:t.name}}),this.uploadingArchive=!0;}handleUploadError(t){this.uploadPercents=0,this.enableRetryAfterError=!0,this.error=Je({err:t,name:"archive",notifier:this.notifier,sticky:!1}),t.status===ae.UNSUPPORTED_MEDIA_TYPE_415&&this.cancelUpload();}refreshTokenAndRetryUpload(){this.authService.refreshAccessToken().subscribe(()=>this.retryUpload());}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-import"]],inputs:{videoQuotaUsed:[1,"videoQuotaUsed"]},decls:7,vars:1,consts:()=>{let t;t="IMPORT";let e;e="You can import an archive created by another PeerTube website.";let o;o=" This is an "+"\uFFFD#4\uFFFD"+"import"+"\uFFFD/#4\uFFFD"+" tool and not a migration tool. It's the reason why data (like channels or videos) is duplicated and not moved from your previous PeerTube website. ";let T;T="The import process will automatically:";let O;O="Update your account metadata (display name, description, avatar...)";let M;M="Update your user settings (autoplay or P2P policy, notification settings...). It does not update your user email, username or password.";let P;P="Add accounts/servers in your mute list";let U;U="Add likes/dislikes";let $;$="Send a follow request to your subscriptions";let h;h="Create channels if they do not already exist";let X;X="Create playlists if they do not already exist";let he;he="Add watched videos in your video history";let ve;ve=""+"\uFFFD#26\uFFFD"+"If the archive contains video files"+"\uFFFD/#26\uFFFD"+", create videos if they do not already exist";let Ye;Ye="The following data objects are not imported:";let $e;$e="Comments";let be;be="Followers (accounts will need to re-follow your channels)";let we;we="An email will be sent when the import process is complete.";let Le;Le=" You can't re-import an archive because you already have an import that is currently being processed by PeerTube. ";let Fe;Fe="(extension: .zip)";let xe;xe="Select the file to import";let Ge;Ge="Select the archive file to import";let Xe;Xe=" Upload completed. Your archive import will be processed as soon as possible. ";let ke;return ke="User import is not enabled by your administrator.",[t,e,o,T,O,M,P,U,$,h,X,he,ve,Ye,$e,be,we,Le,Ge,Xe,ke,[1,"pt-two-cols"],[1,"title-col"],[1,"content-col"],[4,"ngIf"],["class","mb-3",4,"ngIf"],["type","primary"],[1,"mb-3"],[1,"d-block","mt-3","mb-3",3,"cancelUpload","retry","isUploading","uploadPercents","error","uploaded","enableRetryAfterError"],["type","primary",4,"ngIf"],["ngbTooltip",Fe,1,"button-file","primary-button","form-control",3,"hidden"],["aria-label",xe,"accept",".zip","id","importfile","type","file",3,"change"]];},template:function(e,o){e&1&&(r(0,"div",21)(1,"div",22)(2,"h2"),s(3,0),_()(),r(4,"div",23),m(5,go,38,3)(6,So,2,0,"p"),_()()),e&2&&(l(5),q(o.isImportEnabled()?5:6));},dependencies:[Y,$n,Re,de,oe],styles:[`.button-file[_ngcontent-%COMP%]{width:max-content}my-alert[_ngcontent-%COMP%]{display:block;width:fit-content}
/*# sourceMappingURL=my-account-import.component-TOFRENCJ.css.map */`]}));let n=i;return n;})();var fo=["exportModal"];function Po(n,i){n&1&&(r(0,"p"),s(1,17),_());}function Ro(n,i){if(n&1&&(R(0),S(1),K(2,"bytes"),I()),n&2){let a=c().$implicit;l(),b(Ct(2,1,a.size));}}function Io(n,i){if(n&1&&(R(0),S(1),K(2,"ptDate"),I()),n&2){let a=c().$implicit;l(),b(re(2,1,a.expiresOn,"medium"));}}function yo(n,i){if(n&1&&(r(0,"a",37),s(1,22),_()),n&2){let a=c().$implicit;C("href",a.privateDownloadUrl,Ae);}}function Uo(n,i){if(n&1&&(r(0,"tr")(1,"td"),S(2),K(3,"ptDate"),_(),r(4,"td"),S(5),_(),r(6,"td"),m(7,Ro,3,3,"ng-container",31),_(),r(8,"td"),m(9,Io,3,4,"ng-container",31),_(),r(10,"td"),m(11,yo,2,1,"a",36),_()()),n&2){let a=i.$implicit;l(2),b(re(3,5,a.createdAt,"medium")),l(3),b(a.state.label),l(2),C("ngIf",a.size),l(2),C("ngIf",a.expiresOn),l(2),C("ngIf",a.privateDownloadUrl);}}function ho(n,i){if(n&1&&(r(0,"table")(1,"tr")(2,"th",34),s(3,18),_(),r(4,"th",34),s(5,19),_(),r(6,"th",34),s(7,20),_(),r(8,"th",34),s(9,21),_(),p(10,"th"),_(),m(11,Uo,12,8,"tr",35),_()),n&2){let a=c(2);l(11),C("ngForOf",a.userExports);}}function vo(n,i){if(n&1){let a=y();r(0,"p"),s(1,2),_(),r(2,"ul")(3,"li"),s(4,3),_(),r(5,"li"),s(6,4),_(),r(7,"li"),s(8,5),_(),r(9,"li"),s(10,6),_(),r(11,"li"),s(12,7),_(),r(13,"li"),s(14,8),_(),r(15,"li"),s(16,9),_(),r(17,"li"),s(18,10),_(),r(19,"li"),s(20,11),_()(),r(21,"p"),s(22,12),_(),r(23,"ul")(24,"li"),s(25,13),_(),r(26,"li"),s(27,14),_(),r(28,"li"),s(29,15),_()(),r(30,"p"),s(31,16),_(),m(32,Po,2,0,"p")(33,ho,12,1,"table",31),r(34,"div",32)(35,"input",33),N("click",function(){A(a);let e=c();return E(e.openNewArchiveModal());}),_()();}if(n&2){let a=c();l(32),q(a.isEmailEnabled()?32:-1),l(),C("ngIf",a.userExports&&a.userExports.length!==0),l(2),C("disabled",a.isRequestArchiveDisabled());}}function Yo(n,i){n&1&&(r(0,"p"),s(1,23),_());}function $o(n,i){n&1&&(r(0,"my-alert",50),s(1,26),_());}function bo(n,i){if(n&1&&(r(0,"my-alert",51),S(1),_()),n&2){let a=c(2);l(),b(a.errorInModal);}}function wo(n,i){if(n&1&&(r(0,"div"),B(1,27),p(2,"strong"),K(3,"bytes"),W(),_()),n&2){let a=c(2);l(3),ie(Ct(3,1,a.archiveWeightEstimation)),_e(1);}}function Lo(n,i){if(n&1){let a=y();r(0,"div",38)(1,"h4",39),s(2,24),_(),r(3,"button",40),N("click",function(){let e=A(a).close;return E(e());}),p(4,"my-global-icon",41),_()(),r(5,"div",42),m(6,$o,2,0,"my-alert",43)(7,bo,2,1,"my-alert",44),r(8,"my-peertube-checkbox",45),Me("ngModelChange",function(e){A(a);let o=c();return pe(o.exportWithVideosFiles,e)||(o.exportWithVideosFiles=e),E(e);}),R(9,46),r(10,"div"),s(11,25),_(),m(12,wo,4,3,"div",31),I(),_()(),r(13,"div",47)(14,"input",48),N("click",function(){let e=A(a).close;return E(e());})("key.enter",function(){let e=A(a).close;return E(e());}),_(),r(15,"input",49),N("click",function(){A(a);let e=c();return E(e.requestNewArchive());}),_()();}if(n&2){let a=c();l(6),C("ngIf",a.hasAlreadyACompletedArchive()),l(),C("ngIf",a.errorInModal),l(),ue("ngModel",a.exportWithVideosFiles),l(4),C("ngIf",a.archiveWeightEstimation);}}var zn=(()=>{let i=class i{authService=d(L);server=d(ne);userImportExportService=d(le);modalService=d(Wt);exportModal=Ee("exportModal");videoQuotaUsed=se(void 0);userExports=[];exportWithVideosFiles;errorInModal;archiveWeightEstimation;exportModalOpened;requestingArchive=!1;ngOnInit(){this.archiveWeightEstimation=this.videoQuotaUsed(),this.reloadUserExports();}isExportEnabled(){return this.server.getHTMLConfig().export.users.enabled;}isEmailEnabled(){return this.server.getHTMLConfig().email.enabled;}isRequestArchiveDisabled(){return this.userExports.some(t=>{let e=t.state.id;return e===Qe.PENDING||e===Qe.PROCESSING;});}hasAlreadyACompletedArchive(){return this.userExports.some(t=>t.state.id===Qe.COMPLETED);}openNewArchiveModal(){this.exportWithVideosFiles=!1,this.errorInModal=void 0,this.exportModalOpened=this.modalService.open(this.exportModal(),{centered:!0});}requestNewArchive(){if(this.requestingArchive)return;this.requestingArchive=!0;let t=Ve(!0);this.userExports.length!==0&&(t=St(this.userExports.map(e=>e.id)).pipe(It(e=>this.userImportExportService.deleteUserExport({userId:this.getUserId(),userExportId:e})),Rt())),t.pipe(yt(()=>this.userImportExportService.requestNewUserExport({withVideoFiles:this.exportWithVideosFiles,userId:this.getUserId()}))).subscribe({next:()=>{this.reloadUserExports(),this.exportModalOpened.close(),this.requestingArchive=!1;},error:e=>{if(this.requestingArchive=!1,e.body.code===zt.MAX_USER_VIDEO_QUOTA_EXCEEDED_FOR_USER_EXPORT){this.errorInModal="Video files cannot be included in the export because you have exceeded the maximum video quota allowed by your administrator to export this archive.";return;}this.errorInModal=e.message;}});}reloadUserExports(){this.isExportEnabled()&&this.userImportExportService.listUserExports({userId:this.authService.getUser().id}).subscribe(({data:t})=>this.userExports=t);}getUserId(){return this.authService.getUser().id;}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-export"]],viewQuery:function(e,o){e&1&&Se(o.exportModal,fo,5),e&2&&fe();},inputs:{videoQuotaUsed:[1,"videoQuotaUsed"]},decls:9,vars:1,consts:()=>{let t;t="EXPORT";let e;e="Request a new archive";let o;o="You can request an archive of your account containing:";let T;T="Your account settings with avatar file";let O;O="Your channels with banner and avatar files";let M;M="Your muted accounts and servers";let P;P="Your comments";let U;U="Your likes and dislikes";let $;$="Your subscriptions and followers";let h;h="Your video playlists with thumbnail files";let X;X="Your videos with thumbnail, caption files. Video files can also be included in the archive";let he;he="Your video history";let ve;ve="The exported data will contain multiple directories:";let Ye;Ye="A directory containing an export in ActivityPub format, readable by any compliant software";let $e;$e="A directory containing an export in custom PeerTube JSON format that can be used to re-import your account on another PeerTube instance";let be;be="A directory containing static files (thumbnails, avatars, video files etc.)";let we;we="You can only request one archive at a time.";let Le;Le="An email will be sent when the export archive is available.";let Fe;Fe="Date";let xe;xe="Gjendje";let Ge;Ge="Size";let Xe;Xe="Expires on";let ke;ke="Download your archive";let v;v="User export is not enabled by your administrator.";let dt;dt="Close this modal";let ut;ut="Include video files in archive file";let pt;pt="Anuloje";let Mt;Mt="Request an archive";let mt;mt="Archive settings";let Ot;Ot="Including video files is required if you want to re-import your videos on another PeerTube website";let Nt;Nt=" You already have an active archive. Requesting a new export archive will remove the current one. ";let At;return At="If you include video files, the archive file will weigh "+"\uFFFD#2\uFFFD"+"approximately "+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+"",[["exportModal",""],t,o,T,O,M,P,U,$,h,X,he,ve,Ye,$e,be,we,Le,Fe,xe,Ge,Xe,ke,v,mt,Ot,Nt,At,[1,"pt-two-cols"],[1,"title-col"],[1,"content-col"],[4,"ngIf"],[1,"mt-3"],["type","submit","value",e,1,"peertube-button","primary-button",3,"click","disabled"],["scope","column"],[4,"ngFor","ngForOf"],["class","peertube-button-link secondary-button",3,"href",4,"ngIf"],[1,"peertube-button-link","secondary-button",3,"href"],[1,"modal-header"],[1,"modal-title"],["title",dt,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["type","warning",4,"ngIf"],["type","danger",4,"ngIf"],["inputName","exportWithVideos","labelText",ut,3,"ngModelChange","ngModel"],["ngProjectAs","description",5,["description"]],[1,"modal-footer","inputs"],["type","button","role","button","value",pt,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",Mt,1,"peertube-button","primary-button",3,"click"],["type","warning"],["type","danger"]];},template:function(e,o){e&1&&(r(0,"div",28)(1,"div",29)(2,"h2"),s(3,1),_()(),r(4,"div",30),m(5,vo,36,3)(6,Yo,2,0,"p"),_()(),m(7,Lo,16,4,"ng-template",null,0,$t)),e&2&&(l(5),q(o.isExportEnabled()?5:6));},dependencies:[Y,Ke,ye,et,G,x,Pe,de,nt,oe],styles:[`table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-inline-end:1rem}
/*# sourceMappingURL=my-account-export.component-PGXXX5A6.css.map */`]}));let n=i;return n;})();var Fo=["accountImport"],Vn=(()=>{let i=class i{userService=d(k);accountImport=Ee("accountImport");videoQuotaUsed;ngOnInit(){this.userService.getMyVideoQuotaUsed().subscribe(t=>this.videoQuotaUsed=t.videoQuotaUsed);}canDeactivate(){return this.accountImport()?.canDeactivate()||{canDeactivate:!0};}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-import-export"]],viewQuery:function(e,o){e&1&&Se(o.accountImport,Fo,5),e&2&&fe();},decls:3,vars:2,consts:[["accountImport",""],[1,"d-block","mb-5",3,"videoQuotaUsed"],[3,"videoQuotaUsed"]],template:function(e,o){e&1&&p(0,"my-account-import",1,0)(2,"my-account-export",2),e&2&&(C("videoQuotaUsed",o.videoQuotaUsed),l(2),C("videoQuotaUsed",o.videoQuotaUsed));},dependencies:[Dn,zn],encapsulation:2}));let n=i;return n;})();var xo=["userNotification"];function Go(n,i){n&1&&(R(0),p(1,"my-global-icon",15),r(2,"span"),s(3,4),_(),I());}function Xo(n,i){n&1&&(R(0),p(1,"my-global-icon",16),r(2,"span"),s(3,5),_(),I());}var Bn=(()=>{let i=class i{userNotification=Ee("userNotification");_notificationSortType="createdAt";get notificationSortType(){return this.hasUnreadNotifications()?this._notificationSortType:"createdAt";}set notificationSortType(t){this._notificationSortType=t;}markAllAsRead(){this.userNotification().markAllAsRead();}hasUnreadNotifications(){return this.userNotification().notifications.filter(t=>t.read===!1).length!==0;}onChangeSortColumn(){this.userNotification().changeSortColumn(this.notificationSortType);}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["ng-component"]],viewQuery:function(e,o){e&1&&Se(o.userNotification,xo,5),e&2&&fe();},decls:16,vars:5,consts:()=>{let t;t="Newest first";let e;e="Unread first";let o;o="Notification preferences";let T;T="V\xEBru t\xEB t\xEBrave shenj\xEB si t\xEB lexuara";let O;return O="Krejt t\xEB lexuara",[["userNotification",""],t,e,o,T,O,[1,"header"],[1,"peertube-select-container","me-auto"],["aria-label","Sort by",1,"form-control",3,"ngModelChange","ngModel"],["value","createdAt"],["value","read",3,"disabled"],["routerLink","/my-account/settings","fragment","notifications",1,"peertube-button-link","secondary-button"],["iconName","cog","aria-hidden","true"],[1,"peertube-button","secondary-button",3,"click","disabled"],[4,"ngIf"],["iconName","tick","aria-hidden","true"],["iconName","circle-tick","aria-hidden","true"]];},template:function(e,o){if(e&1){let T=y();r(0,"div",6)(1,"div",7)(2,"select",8),Me("ngModelChange",function(M){return A(T),pe(o.notificationSortType,M)||(o.notificationSortType=M),E(M);}),N("ngModelChange",function(){return A(T),E(o.onChangeSortColumn());}),r(3,"option",9),s(4,1),_(),r(5,"option",10),s(6,2),_()()(),r(7,"a",11),p(8,"my-global-icon",12),r(9,"span"),s(10,3),_()(),r(11,"button",13),N("click",function(){return A(T),E(o.markAllAsRead());}),m(12,Go,4,0,"ng-container",14)(13,Xo,4,0,"ng-container",14),_()(),p(14,"my-user-notifications",null,0);}e&2&&(l(2),ue("ngModel",o.notificationSortType),l(3),C("disabled",!o.hasUnreadNotifications()),l(6),C("disabled",!o.hasUnreadNotifications()),l(),C("ngIf",o.hasUnreadNotifications()),l(),C("ngIf",!o.hasUnreadNotifications()));},dependencies:[xt,ye,G,Xt,kt,Gt,x,Pe,Y,on],styles:[`.header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1.25rem}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:auto}@media screen and (max-width: auto-30px){.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:100%}}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}
/*# sourceMappingURL=my-account-notifications.component-CGAER5NQ.css.map */`]}));let n=i;return n;})();var Wn=(()=>{let i=class i{authService=d(L);notifier=d(w);userService=d(k);confirmService=d(Ie);redirectService=d(Jt);user=se(void 0);deleteMe(){return Ne(this,null,function*(){(yield this.confirmService.confirmWithExpectedInput("Are you sure you want to delete your account?"+"<br /><br />"+("This will delete all your data, including channels, videos, comments and you won't be able to create another user on this instance with \""+this.user().username+"\" username.")+"<br /><br />"+"Content cached by other servers and other third-parties might make longer to be deleted.","Type your username to confirm",this.user().username,"Fshini llogarin\xEB tuaj","Delete my account"))!==!1&&this.userService.deleteMe().subscribe({next:()=>{this.notifier.success("Your account is deleted."),this.authService.logout(),this.redirectService.redirectToHomepage();},error:e=>this.notifier.error(e.message)});});}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-danger-zone"]],inputs:{user:[1,"user"]},decls:5,vars:0,consts:()=>{let t;t="Pasi t\xEB fshini llogarin\xEB tuaj, s\u2019ka kthim prapa. Do t\xEB pyeteni p\xEBr ta ripohuar k\xEBt\xEB veprim.";let e;return e="Fshini llogarin\xEB tuaj",[t,e,[1,"delete-me"],[1,"peertube-button","danger-button",3,"click"]];},template:function(e,o){e&1&&(r(0,"div",2)(1,"p"),s(2,0),_(),r(3,"button",3),N("click",function(){return o.deleteMe();}),s(4,1),_()());},encapsulation:2}));let n=i;return n;})();var ko=n=>({"input-error":n});function Do(n,i){if(n&1&&(r(0,"my-alert",16),S(1),_()),n&2){let a=c();l(),b(a.error);}}function zo(n,i){if(n&1&&(r(0,"my-alert",17),S(1),_()),n&2){let a=c();l(),b(a.success);}}function Vo(n,i){n&1&&(r(0,"div"),s(1,3),_());}function Bo(n,i){if(n&1){let a=y();r(0,"button",20),N("click",function(){A(a);let e=c(2);return E(e.resendVerificationEmail());}),s(1,4),_();}}function Wo(n,i){if(n&1&&(r(0,"div",18)(1,"div"),B(2,2),p(3,"strong"),W(),_(),m(4,Vo,2,0,"div")(5,Bo,2,0,"button",19),_()),n&2){let a=c();l(3),ie(a.user.pendingEmail),_e(2),l(),q(a.verificationEmailSent?4:5);}}function Ho(n,i){if(n&1&&(r(0,"div",21),S(1),_()),n&2){let a=c();l(),H(" ",a.formErrors["new-email"]," ");}}var Hn=(()=>{let i=class i extends ce{formReactiveService=d(te);authService=d(L);userService=d(k);serverService=d(ne);verificationEmailSent=!1;error;success;user;ngOnInit(){this.buildForm({"new-email":Cn,password:bn}),this.user=this.authService.getUser();}changeEmail(){this.error=null,this.success=null;let t=this.form.value.password,e=this.form.value["new-email"];Be([this.serverService.getConfig(),this.userService.changeEmail(t,e)]).pipe(Ut(()=>this.authService.refreshUserInformation())).subscribe({next:([o])=>{this.form.reset(),o.signup.requiresEmailVerification?this.success="Please check your emails to verify your new email.":this.success="Email updated.";},error:o=>{if(o.status===ae.UNAUTHORIZED_401){this.error="You current password is invalid.";return;}this.error=o.message;}});}resendVerificationEmail(){this.userService.askSendVerifyEmail(this.user.pendingEmail).subscribe({next:()=>{this.verificationEmailSent=!0;},error:t=>{this.error=t.message;}});}};u(i,"\u0275fac",(()=>{let t;return function(o){return(t||(t=z(i)))(o||i);};})()),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-change-email"]],features:[V],decls:15,vars:11,consts:()=>{let t;t="Email i ri";let e;e="Fjal\xEBkalimi i tanish\xEBm";let o;o="Ndryshoni email";let T;T="Change your email";let O;O=" Your current email is "+"\uFFFD#9\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#9\uFFFD"+"";let M;M=""+"\uFFFD#3\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#3\uFFFD"+" is awaiting email verification. ";let P;P="Email verification sent!";let U;return U="Resend your verification email",[T,O,M,P,U,["type","danger",4,"ngIf"],["type","success",4,"ngIf"],["class","pending-email",4,"ngIf"],[1,"change-email",3,"ngSubmit","formGroup"],[1,"form-group"],["for","new-email"],[1,"form-group-description"],["type","email","id","new-email","placeholder",t,"formControlName","new-email",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["formControlName","password","inputId","password","placeholder",e,"autocomplete","current-password",3,"formError"],["type","submit","value",o,1,"peertube-button","primary-button",3,"disabled"],["type","danger"],["type","success"],[1,"pending-email"],["type","button",1,"peertube-button-like-link"],["type","button",1,"peertube-button-like-link",3,"click"],["role","alert",1,"form-error"]];},template:function(e,o){e&1&&(m(0,Do,2,1,"my-alert",5)(1,zo,2,1,"my-alert",6)(2,Wo,6,2,"div",7),r(3,"form",8),N("ngSubmit",function(){return o.changeEmail();}),r(4,"div",9)(5,"label",10),s(6,0),_(),r(7,"div",11),B(8,1),p(9,"strong"),W(),_(),p(10,"input",12),m(11,Ho,2,1,"div",13),_(),r(12,"div",9),p(13,"my-input-text",14),_(),p(14,"input",15),_()),e&2&&(C("ngIf",o.error),l(),C("ngIf",o.success),l(),C("ngIf",o.user.pendingEmail),l(),C("formGroup",o.form),l(6),ie(o.user.email),_e(8),l(),C("ngClass",We(9,ko,o.formErrors["new-email"])),l(),C("ngIf",o.formErrors["new-email"]),l(2),C("formError",o.formErrors.password),l(),C("disabled",!o.form.valid));},dependencies:[Y,G,j,qe,x,Q,ee,Z,J,He,Te,oe],styles:[`form[_ngcontent-%COMP%]{max-width:340px}my-input-text[_ngcontent-%COMP%]{display:block;width:100%}input[type=email][_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=email][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=email][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=email][_ngcontent-%COMP%]:focus, input[type=email][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=email][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){input[type=email][_ngcontent-%COMP%]{width:100%}}.pending-email[_ngcontent-%COMP%]{margin-bottom:15px}
/*# sourceMappingURL=my-account-change-email.component-5KTWANJ3.css.map */`]}));let n=i;return n;})();function Ko(n,i){n&1&&(R(0),s(1,0),I());}function qo(n,i){n&1&&(R(0),s(1,1),I());}var Kn=(()=>{let i=class i extends ce{formReactiveService=d(te);userService=d(k);notifier=d(w);user=ge(void 0);ngOnInit(){this.buildForm({"email-public":null}),this.form.patchValue({"email-public":this.user().emailPublic});}updateEmailPublic(){let t={emailPublic:this.form.value["email-public"]};this.userService.updateMyProfile(t).subscribe({next:()=>{t.emailPublic?this.notifier.success("Email is now public"):this.notifier.success("Email is now private"),this.user.update(e=>gt(Et({},e),{emailPublic:t.emailPublic}));},error:e=>this.notifier.error(e.message)});}};u(i,"\u0275fac",(()=>{let t;return function(o){return(t||(t=z(i)))(o||i);};})()),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-email-preferences"]],inputs:{user:[1,"user"]},outputs:{user:"userChange"},features:[V],decls:8,vars:3,consts:()=>{let t;t="Allow email to be publicly displayed";let e;e="Save email settings";let o;o="Necessary to claim podcast RSS feeds.";let T;return T="\u26A0\uFE0F Your email cannot be used in podcast RSS feeds because it has not yet been verified.",[o,T,[3,"ngSubmit","formGroup"],[1,"form-group"],["inputName","email-public","formControlName","email-public","labelText",t],["ngProjectAs","description",5,["description"]],[1,"mb-0"],["type","submit","value",e,1,"peertube-button","primary-button",3,"disabled"]];},template:function(e,o){e&1&&(r(0,"form",2),N("ngSubmit",function(){return o.updateEmailPublic();}),r(1,"div",3)(2,"my-peertube-checkbox",4),R(3,5),r(4,"p",6),m(5,Ko,2,0,"ng-container")(6,qo,2,0,"ng-container"),_(),I(),_()(),p(7,"input",7),_()),e&2&&(C("formGroup",o.form),l(5),q(o.user().emailVerified?5:6),l(2),C("disabled",!o.form.valid));},dependencies:[G,j,x,Q,ee,Z,J,et],encapsulation:2}));let n=i;return n;})();var Qo=()=>["/my-account/two-factor-auth"];function jo(n,i){n&1&&(R(0),r(1,"p"),s(2,0),_(),r(3,"my-button",5),s(4,1),_(),I()),n&2&&(l(3),C("ptRouterLink",Yt(1,Qo)));}function Zo(n,i){if(n&1){let a=y();R(0),r(1,"my-button",6),N("click",function(){A(a);let e=c();return E(e.disableTwoFactor());}),s(2,2),_(),I();}}var qn=(()=>{let i=class i{notifier=d(w);twoFactorService=d(Ue);confirmService=d(Ie);auth=d(L);user=se(void 0);twoFactorEnabled=!1;ngOnInit(){this.twoFactorEnabled=this.user().twoFactorEnabled;}disableTwoFactor(){return Ne(this,null,function*(){let t="Are you sure you want to disable two factor authentication of your account?",{confirmed:e,password:o}=yield this.confirmService.confirmWithPassword({message:t,title:"Disable two factor"});e!==!1&&this.twoFactorService.disableTwoFactor({userId:this.user().id,currentPassword:o}).subscribe({next:()=>{this.twoFactorEnabled=!1,this.auth.refreshUserInformation(),this.notifier.success("Two factor authentication disabled");},error:T=>this.notifier.error(T.message)});});}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-two-factor-button"]],inputs:{user:[1,"user"]},decls:3,vars:2,consts:()=>{let t;t="Two factor authentication adds an additional layer of security to your account by requiring a numeric code from another device (most commonly mobile phones) when you log in.";let e;e="Enable two-factor authentication";let o;return o="Disable two-factor authentication",[t,e,o,[1,"two-factor"],[4,"ngIf"],["theme","primary",3,"ptRouterLink"],["theme","primary",3,"click"]];},template:function(e,o){e&1&&(r(0,"div",3),m(1,jo,5,2,"ng-container",4)(2,Zo,3,0,"ng-container",4),_()),e&2&&(l(),C("ngIf",!o.twoFactorEnabled),l(),C("ngIf",o.twoFactorEnabled));},dependencies:[Y,_n],encapsulation:2}));let n=i;return n;})();function Jo(n,i){if(n&1&&(r(0,"my-alert",8),S(1),_()),n&2){let a=c();l(),b(a.error);}}var Qn=(()=>{let i=class i extends ce{formReactiveService=d(te);notifier=d(w);authService=d(L);userService=d(k);error;user;ngOnInit(){this.buildForm({"current-password":tt,"new-password":Tn,"new-confirmed-password":dn}),this.user=this.authService.getUser();let t=this.form.get("new-confirmed-password");t.valueChanges.pipe(Pt(e=>e!==this.form.value["new-password"])).subscribe(()=>t.setErrors({matchPassword:!0}));}changePassword(){let t=this.form.value["current-password"],e=this.form.value["new-password"];this.userService.changePassword(t,e).subscribe({next:()=>{this.notifier.success("Password updated."),this.form.reset(),this.error=null;},error:o=>{if(o.status===ae.UNAUTHORIZED_401){this.error="You current password is invalid.";return;}this.error=o.message;}});}};u(i,"\u0275fac",(()=>{let t;return function(o){return(t||(t=z(i)))(o||i);};})()),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-change-password"]],features:[V],decls:8,vars:6,consts:()=>{let t;t="Fjal\xEBkalimi i tanish\xEBm";let e;e="Fjal\xEBkalim i ri";let o;o="Ripohoni fjal\xEBkalimin e ri";let T;T="Ndryshoni fjal\xEBkalimin";let O;return O="Ndryshoni fjal\xEBkalimin",[O,["type","danger",4,"ngIf"],[3,"ngSubmit","formGroup"],["for","current-password"],["formControlName","current-password","inputId","current-password","placeholder",t,"autocomplete","current-password",3,"formError"],["formControlName","new-password","inputId","new-password","placeholder",e,"autocomplete","new-password",3,"formError"],["formControlName","new-confirmed-password","inputId","new-confirmed-password","placeholder",o,"autocomplete","new-password",3,"formError"],["type","submit","value",T,1,"mt-3","peertube-button","primary-button",3,"disabled"],["type","danger"]];},template:function(e,o){e&1&&(m(0,Jo,2,1,"my-alert",1),r(1,"form",2),N("ngSubmit",function(){return o.changePassword();}),r(2,"label",3),s(3,0),_(),p(4,"my-input-text",4)(5,"my-input-text",5)(6,"my-input-text",6)(7,"input",7),_()),e&2&&(C("ngIf",o.error),l(),C("formGroup",o.form),l(3),C("formError",o.formErrors["current-password"]),l(),C("formError",o.formErrors["new-password"]),l(),C("formError",o.formErrors["new-confirmed-password"]),l(),C("disabled",!o.form.valid));},dependencies:[Y,G,j,x,Q,ee,Z,J,Te,oe],styles:[`form[_ngcontent-%COMP%]{max-width:340px}my-input-text[_ngcontent-%COMP%]{display:block;width:100%}my-input-text[_ngcontent-%COMP%] + my-input-text[_ngcontent-%COMP%]{margin-top:15px}
/*# sourceMappingURL=my-account-change-password.component-AJJXDO3W.css.map */`]}));let n=i;return n;})();function ei(n,i){n&1&&(r(0,"div"),s(1,2),_());}function ti(n,i){if(n&1){let a=y();r(0,"div")(1,"my-input-switch",8),Me("ngModelChange",function(e){A(a);let o=c(2).$implicit,T=c(4);return pe(T.emailNotifications[o],e)||(T.emailNotifications[o]=e),E(e);}),N("ngModelChange",function(){A(a);let e=c(2).$implicit,o=c(4);return E(o.updateEmailSetting(e,o.emailNotifications[e]));}),_()();}if(n&2){let a=c(2).$implicit,t=c(4);l(),C("label",t.getEmailLabel(a))("inputName","email-notification-"+a),ue("ngModel",t.emailNotifications[a]);}}function ni(n,i){if(n&1){let a=y();r(0,"div",7)(1,"div"),S(2),_(),r(3,"div")(4,"my-input-switch",8),Me("ngModelChange",function(e){A(a);let o=c().$implicit,T=c(4);return pe(T.webNotifications[o],e)||(T.webNotifications[o]=e),E(e);}),N("ngModelChange",function(){A(a);let e=c().$implicit,o=c(4);return E(o.updateWebSetting(e,o.webNotifications[e]));}),_()(),m(5,ti,2,3,"div",3),_();}if(n&2){let a=c().$implicit,t=c(4);l(2),b(t.labelNotifications[a]),l(2),C("label",t.getWebLabel(a))("inputName","web-notification-"+a),ue("ngModel",t.webNotifications[a]),l(),C("ngIf",t.emailEnabled);}}function oi(n,i){if(n&1&&(R(0),m(1,ni,6,5,"div",6),I()),n&2){let a=i.$implicit,t=c(4);l(),C("ngIf",t.hasUserRight(a));}}function ii(n,i){if(n&1&&(R(0),r(1,"div",5)(2,"div"),s(3,0),_(),r(4,"div"),s(5,1),_(),m(6,ei,2,0,"div",3),_(),m(7,oi,2,1,"ng-container",4),I()),n&2){let a=c().$implicit,t=c(2);l(3),ie(a.label),_e(3),l(3),C("ngIf",t.emailEnabled),l(),C("ngForOf",a.keys);}}function _i(n,i){if(n&1&&(R(0),m(1,ii,8,3,"ng-container",3),I()),n&2){let a=i.$implicit,t=c(2);l(),C("ngIf",t.hasNotificationsInGroup(a));}}function ri(n,i){if(n&1&&(r(0,"div"),m(1,_i,2,1,"ng-container",4),_()),n&2){let a=c();l(),C("ngForOf",a.notificationSettingGroups);}}var jn=(()=>{let i=class i{userNotificationService=d(nn);serverService=d(ne);notifier=d(w);user=ge(void 0);notificationSettingGroups=[];emailNotifications={};webNotifications={};labelNotifications={};rightNotifications={};emailEnabled=!1;savePreferences=Ht(this.savePreferencesImpl.bind(this),500);constructor(){this.notificationSettingGroups=[{label:"Social",keys:["newVideoFromSubscription","newFollow","commentMention"]},{label:"Your videos",keys:["newCommentOnMyVideo","blacklistOnMyVideo","myVideoPublished","myVideoImportFinished","myVideoStudioEditionFinished","myVideoTranscriptionGenerated"]},{label:"Moderation",keys:["abuseStateChange","abuseNewMessage","abuseAsModerator","videoAutoBlacklistAsModerator","newUserRegistration"]},{label:"Administrim",keys:["newInstanceFollower","autoInstanceFollowing","newPeerTubeVersion","newPluginVersion"]}],this.rightNotifications={abuseAsModerator:Ce.MANAGE_ABUSES,videoAutoBlacklistAsModerator:Ce.MANAGE_VIDEO_BLACKLIST,newUserRegistration:Ce.MANAGE_USERS,newInstanceFollower:Ce.MANAGE_SERVER_FOLLOW,autoInstanceFollowing:Ce.MANAGE_CONFIGURATION,newPeerTubeVersion:Ce.MANAGE_DEBUG,newPluginVersion:Ce.MANAGE_DEBUG};}ngOnInit(){let t=this.serverService.getHTMLConfig();this.emailEnabled=t.email.enabled,this.labelNotifications={newVideoFromSubscription:"New video or live from your subscriptions",newCommentOnMyVideo:"New comment on your video",abuseAsModerator:"New abuse",videoAutoBlacklistAsModerator:"An automatically blocked video is awaiting review",blacklistOnMyVideo:"One of your video is blocked/unblocked",myVideoPublished:"Video published (after transcoding/scheduled update)",myVideoImportFinished:"Video import finished",newUserRegistration:"A new user registered on "+t.instance.name+"",newFollow:"You or one of your channels has a new follower",commentMention:"Someone mentioned you in video comments",newInstanceFollower:""+t.instance.name+" has a new follower",autoInstanceFollowing:""+t.instance.name+" automatically followed another platform",abuseNewMessage:"An abuse report received a new message",abuseStateChange:"One of your abuse reports has been accepted or rejected by moderators",newPeerTubeVersion:"A new PeerTube version is available",newPluginVersion:"One of your plugin/theme has a new available version",myVideoStudioEditionFinished:"Processing of edits has finished",myVideoTranscriptionGenerated:"The transcription of your video has been generated"},this.loadNotificationSettings();}hasUserRight(t){let e=this.rightNotifications[t];return e?this.user().hasRight(e):!0;}hasNotificationsInGroup(t){return t.keys.some(e=>this.hasUserRight(e));}getWebLabel(t){return`Toggle web notification for "${this.labelNotifications[t]}"`;}getEmailLabel(t){return`Toggle email notification for "${this.labelNotifications[t]}"`;}updateEmailSetting(t,e){this.user.update(o=>(o.notificationSettings[t]=e===!0?o.notificationSettings[t]|me.EMAIL:o.notificationSettings[t]&~me.EMAIL,o)),this.savePreferences();}updateWebSetting(t,e){this.user.update(o=>(o.notificationSettings[t]=e===!0?o.notificationSettings[t]|me.WEB:o.notificationSettings[t]&~me.WEB,o)),this.savePreferences();}savePreferencesImpl(){this.userNotificationService.updateNotificationSettings(this.user().notificationSettings).subscribe({next:()=>{this.notifier.success("Preferences saved",void 0,2e3);},error:t=>this.notifier.error(t.message)});}loadNotificationSettings(){for(let t of Vt(this.user().notificationSettings)){let e=this.user().notificationSettings[t];this.emailNotifications[t]=!!(e&me.EMAIL),this.webNotifications[t]=!!(e&me.WEB);}}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-notification-preferences"]],inputs:{user:[1,"user"]},outputs:{user:"userChange"},decls:1,vars:1,consts:()=>{let t;t="\n          "+"\uFFFD0\uFFFD"+"\n        ";let e;e="Web";let o;return o="Email",[t,e,o,[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"header","notification-row"],["class","small notification-row",4,"ngIf"],[1,"small","notification-row"],[3,"ngModelChange","label","inputName","ngModel"]];},template:function(e,o){e&1&&m(0,ri,2,1,"div",3),e&2&&C("ngIf",o.webNotifications);},dependencies:[Y,Ke,wn,G,x,Pe],styles:[`.notification-row[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid var(--bg-secondary-400)}.notification-row.header[_ngcontent-%COMP%]{font-weight:600;margin-top:10px}.notification-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:10px}.notification-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:350px}@media screen and (max-width: 500px){.notification-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:auto;flex-grow:1}}
/*# sourceMappingURL=my-account-notification-preferences.component-VCYVJAYW.css.map */`]}));let n=i;return n;})();var ai=n=>({"input-error":n});function li(n,i){if(n&1&&(r(0,"my-alert",17),S(1),_()),n&2){let a=c();l(),b(a.error);}}function si(n,i){if(n&1&&(r(0,"div",18),S(1),_()),n&2){let a=c();l(),H(" ",a.formErrors["display-name"]," ");}}function Ci(n,i){if(n&1&&(r(0,"div",18),S(1),_()),n&2){let a=c();l(),H(" ",a.formErrors.description," ");}}var Zn=(()=>{let i=class i extends ce{formReactiveService=d(te);notifier=d(w);userService=d(k);user=ge();error=null;ngOnInit(){this.buildForm({username:null,"display-name":un,description:pn}),this.form.controls.username.disable(),this.form.patchValue({username:this.user().username,"display-name":this.user().account.displayName,description:this.user().account.description});}get instanceHost(){return window.location.host;}updateMyProfile(){let t=this.form.value["display-name"],e=this.form.value.description||null;this.error=null,this.userService.updateMyProfile({displayName:t,description:e}).subscribe({next:()=>{this.user.update(o=>(o.account.displayName=t,o.account.description=e,o)),this.notifier.success("Profile updated.");},error:o=>this.error=o.message});}};u(i,"\u0275fac",(()=>{let t;return function(o){return(t||(t=z(i)))(o||i);};})()),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-profile"]],inputs:{user:[1,"user"]},outputs:{user:"userChange"},features:[V],decls:20,vars:11,consts:()=>{let t;t="Save profile";let e;e="Em\xEBr p\xEBrdoruesi";let o;o=" People can find you using @"+"\uFFFD0\uFFFD"+"@"+"\uFFFD1\uFFFD"+" ";let T;T="Em\xEBr n\xEB ekran";let O;return O="P\xEBrshkrim",[e,o,T,O,["type","danger",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","username"],["type","text","id","username","formControlName","username","readonly","",1,"form-control"],[1,"form-group-description"],["for","display-name"],["type","text","id","display-name","formControlName","display-name",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["for","description"],["helpType","markdownText","supportRelMe","true"],["inputId","description","formControlName","description","markdownType","enhanced","withEmoji","true","withHtml","true",3,"formError"],["type","submit","value",t,1,"mt-3","peertube-button","primary-button",3,"disabled"],["type","danger"],["role","alert",1,"form-error"]];},template:function(e,o){e&1&&(m(0,li,2,1,"my-alert",4),r(1,"form",5),N("ngSubmit",function(){return o.updateMyProfile();}),r(2,"div",6)(3,"label",7),s(4,0),_(),p(5,"input",8),r(6,"div",9),s(7,1),_()(),r(8,"div",6)(9,"label",10),s(10,2),_(),p(11,"input",11),m(12,si,2,1,"div",12),_(),r(13,"div",6)(14,"label",13),s(15,3),_(),p(16,"my-help",14)(17,"my-markdown-textarea",15),m(18,Ci,2,1,"div",12),_(),p(19,"input",16),_()),e&2&&(C("ngIf",o.error),l(),C("formGroup",o.form),l(6),ie(o.user().username)(o.instanceHost),_e(7),l(4),C("ngClass",We(9,ai,o.formErrors["display-name"])),l(),C("ngIf",o.formErrors["display-name"]),l(5),C("formError",o.formErrors.description),l(),C("ngIf",o.formErrors.description),l(),C("disabled",!o.form.valid));},dependencies:[Y,G,j,qe,x,Q,ee,Z,J,He,oe,an,mn],styles:[`input#username[_ngcontent-%COMP%] + .muted[_ngcontent-%COMP%]{margin-top:5px}input[type=text][_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:340px;max-width:340px;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{display:block;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:150px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}
/*# sourceMappingURL=my-account-profile.component-PPX3K667.css.map */`]}));let n=i;return n;})();function ci(n,i){if(n&1){let a=y();r(0,"my-actor-avatar-edit",21),N("avatarChange",function(e){A(a);let o=c();return E(o.onAvatarChange(e));})("avatarDelete",function(){A(a);let e=c();return E(e.onAvatarDelete());}),_();}if(n&2){let a=c();C("avatars",a.user.account.avatars)("displayName",a.user.account.displayName)("username",a.user.username)("subscribers",a.user.account.followersCount);}}function Ti(n,i){n&1&&(r(0,"div",15)(1,"div",11)(2,"h2"),s(3,6),_()(),r(4,"div",12),p(5,"my-account-change-password"),_()());}function di(n,i){if(n&1&&(r(0,"div",15)(1,"div",11)(2,"h2"),s(3,7),_()(),r(4,"div",12),p(5,"my-account-two-factor-button",14),_()()),n&2){let a=c();l(5),C("user",a.user);}}function ui(n,i){if(n&1&&(r(0,"div",15)(1,"div",11)(2,"h2"),s(3,8),_()(),r(4,"div",12),p(5,"my-account-email-preferences",22)(6,"my-account-change-email"),_()()),n&2){let a=c();l(5),C("user",a.user);}}var Jn=(()=>{let i=class i{viewportScroller=d(bt);userService=d(k);authService=d(L);notifier=d(w);user;lastScrollHash;get userInformationLoaded(){return this.authService.userInformationLoaded;}ngOnInit(){this.user=this.authService.getUser();}ngAfterViewChecked(){window.location.hash&&window.location.hash!==this.lastScrollHash&&(this.viewportScroller.scrollToAnchor(window.location.hash.replace("#","")),this.lastScrollHash=window.location.hash);}onAvatarChange(t){this.userService.changeAvatar(t).subscribe({next:e=>{this.notifier.success("Avatar changed."),this.user.updateAccountAvatar(e.avatars),this.user.account=Tt(this.user.account);},error:e=>Je({err:e,name:"avatar",notifier:this.notifier})});}onAvatarDelete(){this.userService.deleteAvatar().subscribe({next:()=>{this.notifier.success("Avatar deleted."),this.user.updateAccountAvatar(),this.user.account=Tt(this.user.account);},error:t=>this.notifier.error(t.message)});}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-settings"]],decls:39,vars:11,consts:()=>{let t;t="Rregullime";let e;e="PROFILE SETTINGS";let o;o="ND\xCBRFAQE";let T;T="RREGULLIME VIDEOSH";let O;O="NJOFTIME";let M;M="ZON\xCB RREZIQESH";let P;P="FJAL\xCBKALIM";let U;U="TWO-FACTOR AUTHENTICATION";let $;return $="EMAIL",[t,e,o,T,O,M,P,U,$,[1,"visually-hidden"],[1,"pt-two-cols","mt-3"],[1,"title-col"],[1,"content-col"],["class","d-block mb-3","actorType","account",3,"avatars","displayName","username","subscribers","avatarChange","avatarDelete",4,"ngIf"],[3,"user"],[1,"pt-two-cols","mt-5"],[3,"user","userInformationLoaded"],["id","video-settings",1,"anchor"],["id","notifications",1,"anchor"],["class","pt-two-cols mt-5",4,"ngIf"],[1,"pt-title-danger"],["actorType","account",1,"d-block","mb-3",3,"avatarChange","avatarDelete","avatars","displayName","username","subscribers"],[1,"d-block","mb-5",3,"user"]];},template:function(e,o){e&1&&(r(0,"h1",9),s(1,0),_(),r(2,"div",10)(3,"div",11)(4,"h2"),s(5,1),_()(),r(6,"div",12),m(7,ci,1,4,"my-actor-avatar-edit",13),p(8,"my-user-quota")(9,"my-account-profile",14),_()(),r(10,"div",15)(11,"div",11)(12,"h2"),s(13,2),_()(),r(14,"div",12),p(15,"my-user-interface-settings",16),_()(),r(16,"div",15)(17,"div",11),p(18,"div",17),r(19,"h2"),s(20,3),_()(),r(21,"div",12),p(22,"my-user-video-settings",16),_()(),r(23,"div",15)(24,"div",11),p(25,"div",18),r(26,"h2"),s(27,4),_()(),r(28,"div",12),p(29,"my-account-notification-preferences",14),_()(),m(30,Ti,6,0,"div",19)(31,di,6,1,"div",19)(32,ui,7,1,"div",19),r(33,"div",15)(34,"div",11)(35,"h2",20),s(36,5),_()(),r(37,"div",12),p(38,"my-account-danger-zone",14),_()()),e&2&&(l(7),C("ngIf",o.user==null?null:o.user.account),l(2),C("user",o.user),l(6),C("user",o.user)("userInformationLoaded",o.userInformationLoaded),l(7),C("user",o.user)("userInformationLoaded",o.userInformationLoaded),l(7),C("user",o.user),l(),C("ngIf",o.user.pluginAuth===null),l(),C("ngIf",o.user.pluginAuth===null),l(),C("ngIf",o.user.pluginAuth===null),l(6),C("user",o.user));},dependencies:[gn,Ln,Zn,rn,ln,jn,Y,Qn,qn,Kn,Hn,Wn],styles:[`.content-col[_ngcontent-%COMP%]{max-width:500px}
/*# sourceMappingURL=my-account-settings.component-GWOIZA5S.css.map */`]}));let n=i;return n;})();function pi(n,i){n&1&&(r(0,"div",9),s(1,0),_());}function Mi(n,i){if(n&1){let a=y();R(0),r(1,"form",12),N("ngSubmit",function(){A(a);let e=c(2);return E(e.requestTwoFactor());}),r(2,"label",13),s(3,1),_(),r(4,"div",14),s(5,2),_(),p(6,"my-input-text",15)(7,"input",16),_(),I();}if(n&2){let a=c(2);l(),C("formGroup",a.formPassword),l(5),C("formError",a.formErrorsPassword["current-password"]),l(),C("disabled",!a.formPassword.valid);}}function mi(n,i){if(n&1){let a=y();R(0),r(1,"p"),s(2,3),_(),p(3,"qrcode",17),r(4,"div"),s(5,4),_(),r(6,"div",18),S(7),_(),r(8,"form",19),N("ngSubmit",function(){A(a);let e=c(2);return E(e.confirmTwoFactor());}),r(9,"label",20),s(10,5),_(),r(11,"div",14),s(12,6),_(),p(13,"my-input-text",21)(14,"input",22),_(),I();}if(n&2){let a=c(2);l(3),C("qrdata",a.twoFactorURI)("width",256),l(4),b(a.twoFactorSecret),l(),C("formGroup",a.formOTP),l(5),C("show",!0)("formError",a.formErrorsOTP["otp-token"]),l(),C("disabled",!a.formOTP.valid);}}function Oi(n,i){if(n&1&&(r(0,"div",10),m(1,Mi,8,3,"ng-container",11)(2,mi,15,7,"ng-container",11),_()),n&2){let a=c();l(),C("ngIf",a.step==="request"),l(),C("ngIf",a.step==="confirm");}}var eo=(()=>{let i=class i{notifier=d(w);twoFactorService=d(Ue);formReactiveService=d(te);auth=d(L);router=d(Ft);twoFactorAlreadyEnabled;step="request";twoFactorSecret;twoFactorURI;inPasswordStep=!0;formPassword;formErrorsPassword;formOTP;formErrorsOTP;user;requestToken;ngOnInit(){this.buildPasswordForm(),this.buildOTPForm(),this.user=this.auth.getUser(),this.twoFactorAlreadyEnabled=this.user.twoFactorEnabled;}requestTwoFactor(){this.twoFactorService.requestTwoFactor({userId:this.user.id,currentPassword:this.formPassword.value["current-password"]}).subscribe({next:({otpRequest:t})=>{this.requestToken=t.requestToken,this.twoFactorURI=t.uri,this.twoFactorSecret=t.secret.replace(/(.{4})/g,"$1 ").trim(),this.step="confirm";},error:t=>this.notifier.error(t.message)});}confirmTwoFactor(){this.twoFactorService.confirmTwoFactorRequest({userId:this.user.id,requestToken:this.requestToken,otpToken:this.formOTP.value["otp-token"]}).subscribe({next:()=>{this.notifier.success("Two factor authentication has been enabled."),this.auth.refreshUserInformation(),this.router.navigateByUrl("/my-account/settings");},error:t=>this.notifier.error(t.message)});}buildPasswordForm(){let{form:t,formErrors:e}=this.formReactiveService.buildForm({"current-password":tt});this.formPassword=t,this.formErrorsPassword=e;}buildOTPForm(){let{form:t,formErrors:e}=this.formReactiveService.buildForm({"otp-token":cn});this.formOTP=t,this.formErrorsOTP=e;}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account-two-factor"]],decls:2,vars:2,consts:()=>{let t;t=" Two factor authentication is already enabled.\n";let e;e="Fjal\xEBkalimi i tanish\xEBm";let o;o="Confirm";let T;T="Your password";let O;O="Confirm your password to enable two factor authentication";let M;M="Confirm";let P;P=" Scan this QR code into a TOTP app on your phone. This app will generate tokens that you will have to enter when logging in. ";let U;U=" If you can't scan the QR code and need to enter it manually, here is the plain-text secret: ";let $;$="Two-factor code";let h;return h="Enter the code generated by your authenticator app to confirm",[t,T,O,P,U,$,h,["class","root already-enabled",4,"ngIf"],["class","root",4,"ngIf"],[1,"root","already-enabled"],[1,"root"],[4,"ngIf"],[3,"ngSubmit","formGroup"],["for","current-password"],[1,"form-group-description"],["formControlName","current-password","inputId","current-password","placeholder",e,"autocomplete","current-password",3,"formError"],["type","submit","value",o,1,"peertube-button","primary-button","mt-3",3,"disabled"],["level","Q",3,"qrdata","width"],[1,"secret-plain-text"],[1,"mt-3",3,"ngSubmit","formGroup"],["for","otp-token"],["formControlName","otp-token","inputId","otp-token","autocomplete","otp-token",3,"show","formError"],["type","submit","value",M,1,"peertube-button","primary-button","mt-3",3,"disabled"]];},template:function(e,o){e&1&&m(0,pi,2,0,"div",7)(1,Oi,3,2,"div",8),e&2&&(C("ngIf",o.twoFactorAlreadyEnabled===!0),l(),C("ngIf",o.twoFactorAlreadyEnabled===!1));},dependencies:[Y,G,j,x,Q,ee,Z,J,Te,Fn],styles:[`.root[_ngcontent-%COMP%]{max-width:600px}.secret-plain-text[_ngcontent-%COMP%]{font-family:monospace;font-size:.9rem}qrcode[_ngcontent-%COMP%]{display:inline-block;margin:auto}
/*# sourceMappingURL=my-account-two-factor.component-QBO7QIZN.css.map */`]}));let n=i;return n;})();var to=(()=>{let i=class i{pluginService=d(tn);menuEntries=[];user;ngOnInit(){this.pluginService.ensurePluginsAreLoaded("my-account").then(()=>this.buildMenu());}buildMenu(){let t=this.pluginService.getAllRegisteredClientRoutesForParent("/my-account")||{};this.menuEntries=[{label:"Rregullime",routerLink:"/my-account/settings"},{label:"Njoftime",routerLink:"/my-account/notifications"},{label:"Import/Export",routerLink:"/my-account/import-export"},{label:"Applications",routerLink:"/my-account/applications"},{label:"Moderation",routerLink:"/my-account/blocklist/accounts",children:[{label:"Llogari t\xEB heshtuara",routerLink:"/my-account/blocklist/accounts"},{label:"Sh\xEBrbyes t\xEB heshtuar",routerLink:"/my-account/blocklist/servers"},{label:"Abuse reports",routerLink:"/my-account/abuses"}]},...Object.values(t).map(e=>({label:e.menuItem?.label,routerLink:"/my-account/p/"+e.route}))];}};u(i,"\u0275fac",function(e){return new(e||i)();}),u(i,"\u0275cmp",g({type:i,selectors:[["my-account"]],decls:8,vars:1,consts:()=>{let t;t="My account";let e;return e="Skip the sub menu",[["myAccountContent",""],e,[1,"root"],[1,"margin-content"],["href","#my-account-content",1,"visually-hidden-focusable","skip-to-content-sub-menu",3,"click"],["h1",t,"h1Icon","cog",3,"menuEntries"],["tabindex","-1","id","my-account-content",1,"margin-content","pb-5","outline-0"]];},template:function(e,o){if(e&1){let T=y();r(0,"div",2)(1,"div",3)(2,"a",4),N("click",function(M){A(T);let P=vt(6);return M.preventDefault(),E(P.focus());}),s(3,1),_(),p(4,"my-horizontal-menu",5),_(),r(5,"div",6,0),p(7,"router-outlet"),_()();}e&2&&(l(4),C("menuEntries",o.menuEntries));},dependencies:[Mn,Lt],encapsulation:2}));let n=i;return n;})();var Fl=[{path:"",component:to,providers:[le,Ue,Nn,An,En,yn,Sn],resolve:{user:Un},canActivateChild:[en],children:[{path:"",redirectTo:"settings",pathMatch:"full"},{path:"settings",component:Jn,data:{meta:{title:"Account settings"}}},{path:"two-factor-auth",component:eo,data:{meta:{title:"Two factor authentication"}}},{path:"video-channels",redirectTo:"/my-library/video-channels",pathMatch:"full"},{path:"video-playlists",redirectTo:"/my-library/video-playlists",pathMatch:"full"},{path:"video-playlists/create",redirectTo:"/my-library/video-playlists/create",pathMatch:"full"},{path:"video-playlists/:videoPlaylistId",redirectTo:"/my-library/video-playlists/:videoPlaylistId",pathMatch:"full"},{path:"video-playlists/update/:videoPlaylistId",redirectTo:"/my-library/video-playlists/update/:videoPlaylistId",pathMatch:"full"},{path:"videos",redirectTo:"/my-library/videos",pathMatch:"full"},{path:"video-imports",redirectTo:"/my-library/video-imports",pathMatch:"full"},{path:"subscriptions",redirectTo:"/my-library/subscriptions",pathMatch:"full"},{path:"ownership",redirectTo:"/my-library/ownership",pathMatch:"full"},{path:"blocklist/accounts",component:Xn,data:{meta:{title:"Llogari t\xEB heshtuara"}}},{path:"blocklist/servers",component:kn,data:{meta:{title:"Sh\xEBrbyes t\xEB heshtuar"}}},{path:"history/videos",redirectTo:"/my-library/history/videos",pathMatch:"full"},{path:"notifications",component:Bn,data:{meta:{title:"Njoftime"}}},{path:"abuses",component:xn,data:{meta:{title:"My abuse reports"}}},{path:"applications",component:Gn,data:{meta:{title:"Applications"}}},{path:"videos/comments",redirectTo:"/my-library/videos/comments"},{path:"import-export",component:Vn,canDeactivate:[Zt],data:{meta:{title:"Import/Export"}}},{path:"watched-words/list",redirectTo:"/my-library/watched-words/list",pathMatch:"full"},{path:"auto-tag-policies",redirectTo:"/my-library/auto-tag-policies",pathMatch:"full"},{path:"p",children:[{path:"**",component:hn,data:{parentRoute:"/my-account",pluginScope:"my-account"}}]}]}];export{Fl as default};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-AQYX4XZC.js.map