import{a as st}from"./chunk-GUGTEC7W.js";import{a as ue}from"./chunk-GAPJZSX5.js";import{a as lt,b as de,c as pe,d as me}from"./chunk-KIBHE7HI.js";import{a as _e}from"./chunk-KCGVGMQ4.js";import{i as rt,j as at}from"./chunk-7EJTRMSK.js";import{a as tt}from"./chunk-VM462Q6H.js";import{a as ot}from"./chunk-75CL7ZAD.js";import{a as it}from"./chunk-TOPWIQ4B.js";import{a as ce}from"./chunk-E3CSCYZJ.js";import{a as nt}from"./chunk-APIXYPUO.js";import{a as se}from"./chunk-5GTHDKWY.js";import{a as et}from"./chunk-6TRYPH2T.js";import{a as re}from"./chunk-JVRBW57G.js";import"./chunk-BOZAQTZE.js";import{b as R}from"./chunk-ANGOORPW.js";import{b as ne,c as Ze}from"./chunk-25AA3I7H.js";import"./chunk-2O3IZ566.js";import"./chunk-YDZGE3V5.js";import{a as Je}from"./chunk-S5ARXDTR.js";import{a as qe}from"./chunk-C5UL7A6S.js";import{b as le}from"./chunk-WZVFW7AN.js";import{a as ae}from"./chunk-6JJL547V.js";import"./chunk-RT7DTAS6.js";import{B as ee,C as te,c as W,g as K,h as Q,n as q,q as J,t as Z}from"./chunk-WO4VNXA3.js";import{a as Qe}from"./chunk-PE7TFI7A.js";import{$f as Et,Ab as P,Ag as We,Bb as A,Bc as j,Bd as Ue,Cb as _,Cc as Ve,Dc as L,Fb as X,Ha as l,Ia as ge,K as Se,Kg as Ke,Lb as xe,Ma as Te,Mf as Ee,Nb as Le,Pa as be,Pb as h,Q as H,Qb as D,Qg as ie,Rb as b,Sa as x,Ua as ye,Wa as k,Xf as I,Ya as p,Yb as Ie,Zb as S,aa as d,c as fe,eb as c,ee as Ge,fc as Fe,fe as Ye,gc as Re,ha as N,ia as f,j as Ce,jb as U,kd as He,la as $,lg as F,mg as ze,n as Ae,nb as s,nc as we,ng as Be,ob as r,od as $e,og as Xe,pb as u,pd as ke,pf as oe,qb as Pe,rb as De,sa as Me,se as he,sg as je,tb as y,ua as Oe,vb as G,wb as Y,xb as C,yb as z,zb as B}from"./chunk-F7FAPFPY.js";import{g as ht,i as v,j as Ne}from"./chunk-AI7IVZV2.js";var w=class extends Ze{videoChannel;get instanceHost(){return window.location.host;}isBulkUpdateVideosDisplayed(){return!1;}};var ct=t=>({"input-error":t});function Nt(t,a){if(t&1&&(s(0,"my-alert",29),h(1),r()),t&2){let o=_();l(),D(o.error);}}function ft(t,a){t&1&&(s(0,"h2"),C(1,4),r());}function At(t,a){t&1&&(s(0,"h2"),C(1,5),r());}function St(t,a){if(t&1){let o=y();s(0,"my-actor-banner-edit",30),A("bannerChange",function(i){N(o);let e=_();return f(e.onBannerChange(i));})("bannerDelete",function(){N(o);let i=_();return f(i.onBannerDelete());}),r();}if(t&2){let o=_();c("previewImage",o.isCreation())("bannerUrl",o.videoChannel==null?null:o.videoChannel.bannerUrl);}}function Mt(t,a){if(t&1){let o=y();s(0,"my-actor-avatar-edit",31),A("avatarChange",function(i){N(o);let e=_();return f(e.onAvatarChange(i));})("avatarDelete",function(){N(o);let i=_();return f(i.onAvatarDelete());}),r();}if(t&2){let o=_();c("displayName",o.videoChannel.displayName)("previewImage",o.isCreation())("avatars",o.videoChannel.avatars)("username",!o.isCreation()&&o.videoChannel.name)("subscribers",!o.isCreation()&&o.videoChannel.followersCount);}}function Ot(t,a){if(t&1&&(s(0,"div",36),h(1),r()),t&2){let o=_(2);l(),b(" ",o.formErrors.name," ");}}function Tt(t,a){if(t&1&&(s(0,"div",16)(1,"label",32),C(2,6),r(),s(3,"div",33),u(4,"input",34),s(5,"div",35),h(6),r()(),p(7,Ot,2,1,"div",19),r()),t&2){let o=_();l(4),c("ngClass",S(3,ct,o.formErrors.name)),l(2),b("@",o.instanceHost,""),l(),c("ngIf",o.formErrors.name);}}function bt(t,a){if(t&1&&(s(0,"div",36),h(1),r()),t&2){let o=_();l(),b(" ",o.formErrors["display-name"]," ");}}function yt(t,a){if(t&1&&(s(0,"div",36),h(1),r()),t&2){let o=_();l(),b(" ",o.formErrors.description," ");}}function Pt(t,a){t&1&&(s(0,"div",16),u(1,"my-peertube-checkbox",37),r());}var _t=(()=>{let a=class a extends w{formReactiveService=d(ne);authService=d(F);notifier=d(I);router=d($e);videoChannelService=d(R);hooks=d(ie);error;videoChannel=new qe({});avatar;banner;ngOnInit(){this.buildForm({name:lt,"display-name":de,description:pe,support:me});}ngAfterViewInit(){this.hooks.runAction("action:video-channel-create.init","video-channel");}formValidated(){this.error=void 0;let n=this.form.value,i={name:n.name,displayName:n["display-name"],description:n.description||null,support:n.support||null};this.videoChannelService.createVideoChannel(i).pipe(H(()=>this.uploadAvatar()),H(()=>this.uploadBanner())).subscribe({next:()=>{this.authService.refreshUserInformation(),this.notifier.success("Il canale video "+i.displayName+" \xE8 stato creato."),this.router.navigate(["/my-library","video-channels"]);},error:e=>{if(e.status===Ue.CONFLICT_409){this.error="Questo nome \xE8 gi\xE0 in uso su questa piattaforma.";return;}this.error=e.message;}});}onAvatarChange(n){this.avatar=n;}onAvatarDelete(){this.avatar=null;}onBannerChange(n){this.banner=n;}onBannerDelete(){this.banner=null;}isCreation(){return!0;}getFormButtonTitle(){return"Crea il tuo canale";}getUsername(){return this.form.value.name;}uploadAvatar(){return this.avatar?this.videoChannelService.changeVideoChannelImage(this.getUsername(),this.avatar,"avatar"):Ce(void 0);}uploadBanner(){return this.banner?this.videoChannelService.changeVideoChannelImage(this.getUsername(),this.banner,"banner"):Ce(void 0);}};v(a,"\u0275fac",(()=>{let n;return function(e){return(n||(n=$(a)))(e||a);};})()),v(a,"\u0275cmp",x({type:a,selectors:[["ng-component"]],features:[k],decls:33,vars:16,consts:()=>{let n;n="Nome visualizzato";let i;i="Descrizione";let e;e="Supporto";let m;m=" This is text that helps people visiting your channel page "+"[\uFFFD#27\uFFFD|\uFFFD#29\uFFFD]"+"understand how to support you"+"[\uFFFD/#27\uFFFD|\uFFFD/#29\uFFFD]"+". You can use "+"\uFFFD#28\uFFFD"+"Markdown Language"+"\uFFFD/#28\uFFFD"+", including "+"[\uFFFD#27\uFFFD|\uFFFD#29\uFFFD]"+"links to your fundraising tools"+"[\uFFFD/#27\uFFFD|\uFFFD/#29\uFFFD]"+". ",m=P(m);let M;M="NUOVO CANALE";let O;O="AGGIORNARE IL CANALE";let T;T="Esempio: il_mio_canale";let E;E="Nome";let V;return V="Sovrascrivi il campo supporto di tutti i video di questo canale",[n,i,e,m,M,O,E,["type","danger",4,"ngIf"],[1,"pt-4"],[3,"ngSubmit","formGroup"],[1,"pt-two-cols"],[1,"title-col"],[1,"content-col"],["class","d-block mb-4",3,"previewImage","bannerUrl","bannerChange","bannerDelete",4,"ngIf"],["class","d-block mb-4","actorType","channel",3,"displayName","previewImage","avatars","username","subscribers","avatarChange","avatarDelete",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","display-name"],["type","text","id","display-name","formControlName","display-name",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","markdown-block"],["for","description"],["helpType","markdownText","supportRelMe","true"],["inputId","description","formControlName","description","markdownType","enhanced","withEmoji","true","withHtml","true",3,"formError"],["for","support"],[1,"form-group-description"],["helpType","markdownText"],["inputId","support","formControlName","support","markdownType","enhanced","withEmoji","true","withHtml","true",3,"formError"],["type","submit",1,"peertube-button","primary-button","mt-4",3,"value","disabled"],["type","danger"],[1,"d-block","mb-4",3,"bannerChange","bannerDelete","previewImage","bannerUrl"],["actorType","channel",1,"d-block","mb-4",3,"avatarChange","avatarDelete","displayName","previewImage","avatars","username","subscribers"],["for","name"],[1,"input-group"],["type","text","id","name","placeholder",T,"formControlName","name",1,"form-control","w-auto","flex-grow-1","d-block",3,"ngClass"],[1,"input-group-text"],["role","alert",1,"form-error"],["inputName","bulkVideosSupportUpdate","formControlName","bulkVideosSupportUpdate","labelText",V]];},template:function(i,e){i&1&&(p(0,Nt,2,1,"my-alert",7),s(1,"div",8)(2,"form",9),A("ngSubmit",function(){return e.formValidated();}),s(3,"div",10)(4,"div",11),p(5,ft,2,0,"h2")(6,At,2,0,"h2"),r(),s(7,"div",12),p(8,St,1,2,"my-actor-banner-edit",13)(9,Mt,1,5,"my-actor-avatar-edit",14)(10,Tt,8,5,"div",15),s(11,"div",16)(12,"label",17),C(13,0),r(),u(14,"input",18),p(15,bt,2,1,"div",19),r(),s(16,"div",20)(17,"label",21),C(18,1),r(),u(19,"my-help",22)(20,"my-markdown-textarea",23),p(21,yt,2,1,"div",19),r(),s(22,"div",20)(23,"label",24),C(24,2),r(),s(25,"div",25),G(26,3),u(27,"strong")(28,"my-markdown-hint",26)(29,"strong"),Y(),r(),u(30,"my-markdown-textarea",27),r(),p(31,Pt,2,0,"div",15),u(32,"input",28),r()()()()),i&2&&(c("ngIf",e.error),l(2),c("formGroup",e.form),l(3),U(e.isCreation()?5:6),l(3),c("ngIf",e.videoChannel),l(),c("ngIf",e.videoChannel),l(),c("ngIf",e.isCreation()),l(4),c("ngClass",S(14,ct,e.formErrors["display-name"])),l(),c("ngIf",e.formErrors["display-name"]),l(5),c("formError",e.formErrors.description),l(),c("ngIf",e.formErrors.description),l(9),c("formError",e.formErrors.support),l(),c("ngIf",e.isBulkUpdateVideosDisplayed()),l(),X("value",e.getFormButtonTitle()),c("disabled",!e.form.valid));},dependencies:[L,ee,q,W,K,Q,te,J,Z,_e,ce,j,ae,se,le,re,ue],styles:[`my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}input[type=text][_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:340px;max-width:340px;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{margin-inline-start:auto}.markdown-block[_ngcontent-%COMP%]{max-width:500px}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:340px}@media screen and (max-width: 310px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}
/*# sourceMappingURL=video-channel-edit.component-IP2KNO7N.css.map */`]}));let t=a;return t;})();var dt=t=>({"input-error":t});function Dt(t,a){if(t&1&&(s(0,"my-alert",29),h(1),r()),t&2){let o=_();l(),D(o.error);}}function xt(t,a){t&1&&(s(0,"h2"),C(1,4),r());}function Lt(t,a){t&1&&(s(0,"h2"),C(1,5),r());}function It(t,a){if(t&1){let o=y();s(0,"my-actor-banner-edit",30),A("bannerChange",function(i){N(o);let e=_();return f(e.onBannerChange(i));})("bannerDelete",function(){N(o);let i=_();return f(i.onBannerDelete());}),r();}if(t&2){let o=_();c("previewImage",o.isCreation())("bannerUrl",o.videoChannel==null?null:o.videoChannel.bannerUrl);}}function Ft(t,a){if(t&1){let o=y();s(0,"my-actor-avatar-edit",31),A("avatarChange",function(i){N(o);let e=_();return f(e.onAvatarChange(i));})("avatarDelete",function(){N(o);let i=_();return f(i.onAvatarDelete());}),r();}if(t&2){let o=_();c("displayName",o.videoChannel.displayName)("previewImage",o.isCreation())("avatars",o.videoChannel.avatars)("username",!o.isCreation()&&o.videoChannel.name)("subscribers",!o.isCreation()&&o.videoChannel.followersCount);}}function Rt(t,a){if(t&1&&(s(0,"div",36),h(1),r()),t&2){let o=_(2);l(),b(" ",o.formErrors.name," ");}}function wt(t,a){if(t&1&&(s(0,"div",16)(1,"label",32),C(2,6),r(),s(3,"div",33),u(4,"input",34),s(5,"div",35),h(6),r()(),p(7,Rt,2,1,"div",19),r()),t&2){let o=_();l(4),c("ngClass",S(3,dt,o.formErrors.name)),l(2),b("@",o.instanceHost,""),l(),c("ngIf",o.formErrors.name);}}function Vt(t,a){if(t&1&&(s(0,"div",36),h(1),r()),t&2){let o=_();l(),b(" ",o.formErrors["display-name"]," ");}}function Ht(t,a){if(t&1&&(s(0,"div",36),h(1),r()),t&2){let o=_();l(),b(" ",o.formErrors.description," ");}}function $t(t,a){t&1&&(s(0,"div",16),u(1,"my-peertube-checkbox",37),r());}var pt=(()=>{let a=class a extends w{formReactiveService=d(ne);authService=d(F);notifier=d(I);route=d(He);videoChannelService=d(R);redirectService=d(We);hooks=d(ie);error;paramsSub;oldSupportField;ngOnInit(){this.buildForm({"display-name":de,description:pe,support:me,bulkVideosSupportUpdate:null}),this.paramsSub=this.route.params.subscribe(n=>{let i=n.videoChannelName;this.videoChannelService.getVideoChannel(i).subscribe({next:e=>{this.videoChannel=e,this.hooks.runAction("action:video-channel-update.video-channel.loaded","video-channel",{videoChannel:this.videoChannel}),this.oldSupportField=e.support,this.form.patchValue({"display-name":e.displayName,description:e.description,support:e.support});},error:e=>{this.error=e.message;}});});}ngAfterViewInit(){this.hooks.runAction("action:video-channel-update.init","video-channel");}ngOnDestroy(){this.paramsSub&&this.paramsSub.unsubscribe();}formValidated(){this.error=void 0;let n=this.form.value,i={displayName:n["display-name"],description:n.description||null,support:n.support||null,bulkVideosSupportUpdate:n.bulkVideosSupportUpdate||!1};this.videoChannelService.updateVideoChannel(this.videoChannel.name,i).subscribe({next:()=>{this.authService.refreshUserInformation(),this.notifier.success("Il canale video "+i.displayName+" \xE8 stato aggiornato."),this.redirectService.redirectToPreviousRoute("/c/"+this.videoChannel.name);},error:e=>{this.error=e.message;}});}onAvatarChange(n){this.videoChannelService.changeVideoChannelImage(this.videoChannel.name,n,"avatar").subscribe({next:i=>{this.notifier.success("Avatar cambiato."),this.videoChannel.updateAvatar(i.avatars),this.videoChannel=he(this.videoChannel);},error:i=>Ee({err:i,name:"avatar",notifier:this.notifier})});}onAvatarDelete(){this.videoChannelService.deleteVideoChannelImage(this.videoChannel.name,"avatar").subscribe({next:()=>{this.notifier.success("Avatar cancellato."),this.videoChannel.resetAvatar(),this.videoChannel=he(this.videoChannel);},error:n=>this.notifier.error(n.message)});}onBannerChange(n){this.videoChannelService.changeVideoChannelImage(this.videoChannel.name,n,"banner").subscribe({next:i=>{this.notifier.success("Il banner \xE8 stato modificato."),this.videoChannel.updateBanner(i.banners);},error:i=>Ee({err:i,name:"banner",notifier:this.notifier})});}onBannerDelete(){this.videoChannelService.deleteVideoChannelImage(this.videoChannel.name,"banner").subscribe({next:()=>{this.notifier.success("Banner cancellato."),this.videoChannel.resetBanner();},error:n=>this.notifier.error(n.message)});}isCreation(){return!1;}getFormButtonTitle(){return"Aggiorna "+this.videoChannel?.name+"";}isBulkUpdateVideosDisplayed(){return this.oldSupportField===void 0?!1:this.oldSupportField!==this.form.value.support;}};v(a,"\u0275fac",(()=>{let n;return function(e){return(n||(n=$(a)))(e||a);};})()),v(a,"\u0275cmp",x({type:a,selectors:[["my-video-channel-update"]],features:[k],decls:33,vars:16,consts:()=>{let n;n="Nome visualizzato";let i;i="Descrizione";let e;e="Supporto";let m;m=" This is text that helps people visiting your channel page "+"[\uFFFD#27\uFFFD|\uFFFD#29\uFFFD]"+"understand how to support you"+"[\uFFFD/#27\uFFFD|\uFFFD/#29\uFFFD]"+". You can use "+"\uFFFD#28\uFFFD"+"Markdown Language"+"\uFFFD/#28\uFFFD"+", including "+"[\uFFFD#27\uFFFD|\uFFFD#29\uFFFD]"+"links to your fundraising tools"+"[\uFFFD/#27\uFFFD|\uFFFD/#29\uFFFD]"+". ",m=P(m);let M;M="NUOVO CANALE";let O;O="AGGIORNARE IL CANALE";let T;T="Esempio: il_mio_canale";let E;E="Nome";let V;return V="Sovrascrivi il campo supporto di tutti i video di questo canale",[n,i,e,m,M,O,E,["type","danger",4,"ngIf"],[1,"pt-4"],[3,"ngSubmit","formGroup"],[1,"pt-two-cols"],[1,"title-col"],[1,"content-col"],["class","d-block mb-4",3,"previewImage","bannerUrl","bannerChange","bannerDelete",4,"ngIf"],["class","d-block mb-4","actorType","channel",3,"displayName","previewImage","avatars","username","subscribers","avatarChange","avatarDelete",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","display-name"],["type","text","id","display-name","formControlName","display-name",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","markdown-block"],["for","description"],["helpType","markdownText","supportRelMe","true"],["inputId","description","formControlName","description","markdownType","enhanced","withEmoji","true","withHtml","true",3,"formError"],["for","support"],[1,"form-group-description"],["helpType","markdownText"],["inputId","support","formControlName","support","markdownType","enhanced","withEmoji","true","withHtml","true",3,"formError"],["type","submit",1,"peertube-button","primary-button","mt-4",3,"value","disabled"],["type","danger"],[1,"d-block","mb-4",3,"bannerChange","bannerDelete","previewImage","bannerUrl"],["actorType","channel",1,"d-block","mb-4",3,"avatarChange","avatarDelete","displayName","previewImage","avatars","username","subscribers"],["for","name"],[1,"input-group"],["type","text","id","name","placeholder",T,"formControlName","name",1,"form-control","w-auto","flex-grow-1","d-block",3,"ngClass"],[1,"input-group-text"],["role","alert",1,"form-error"],["inputName","bulkVideosSupportUpdate","formControlName","bulkVideosSupportUpdate","labelText",V]];},template:function(i,e){i&1&&(p(0,Dt,2,1,"my-alert",7),s(1,"div",8)(2,"form",9),A("ngSubmit",function(){return e.formValidated();}),s(3,"div",10)(4,"div",11),p(5,xt,2,0,"h2")(6,Lt,2,0,"h2"),r(),s(7,"div",12),p(8,It,1,2,"my-actor-banner-edit",13)(9,Ft,1,5,"my-actor-avatar-edit",14)(10,wt,8,5,"div",15),s(11,"div",16)(12,"label",17),C(13,0),r(),u(14,"input",18),p(15,Vt,2,1,"div",19),r(),s(16,"div",20)(17,"label",21),C(18,1),r(),u(19,"my-help",22)(20,"my-markdown-textarea",23),p(21,Ht,2,1,"div",19),r(),s(22,"div",20)(23,"label",24),C(24,2),r(),s(25,"div",25),G(26,3),u(27,"strong")(28,"my-markdown-hint",26)(29,"strong"),Y(),r(),u(30,"my-markdown-textarea",27),r(),p(31,$t,2,0,"div",15),u(32,"input",28),r()()()()),i&2&&(c("ngIf",e.error),l(2),c("formGroup",e.form),l(3),U(e.isCreation()?5:6),l(3),c("ngIf",e.videoChannel),l(),c("ngIf",e.videoChannel),l(),c("ngIf",e.isCreation()),l(4),c("ngClass",S(14,dt,e.formErrors["display-name"])),l(),c("ngIf",e.formErrors["display-name"]),l(5),c("formError",e.formErrors.description),l(),c("ngIf",e.formErrors.description),l(9),c("formError",e.formErrors.support),l(),c("ngIf",e.isBulkUpdateVideosDisplayed()),l(),X("value",e.getFormButtonTitle()),c("disabled",!e.form.valid));},dependencies:[L,ee,q,W,K,Q,te,J,Z,_e,ce,j,ae,se,le,re,ue],styles:[`my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}input[type=text][_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:340px;max-width:340px;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{margin-inline-start:auto}.markdown-block[_ngcontent-%COMP%]{max-width:500px}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;position:relative;height:min-content;width:340px}@media screen and (max-width: 310px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--fg-300);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{line-height:24px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{color:inherit;background-color:transparent;border:1px solid var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.active[_ngcontent-%COMP%], .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{color:inherit;background-color:var(--bg-secondary-500);border-color:var(--bg-secondary-500)}.peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:active, .peertube-select-container[_ngcontent-%COMP%]   select.btn[_ngcontent-%COMP%]:focus-visible, .peertube-select-container[_ngcontent-%COMP%]   select.btn.show[_ngcontent-%COMP%]{color:inherit!important;background-color:var(--bg-secondary-500)!important;border-color:var(--bg-secondary-500)!important}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{color:inherit;background-color:var(--bg-secondary-450)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{color:var(--secondary-icon-color)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) calc(var(--input-x-padding) + 23px) var(--input-y-padding) var(--input-x-padding);position:relative;border:1px solid var(--input-border-color)!important;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--input-fg);background:var(--input-bg);border-radius:var(--input-border-radius)}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100)}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.5}
/*# sourceMappingURL=video-channel-edit.component-IP2KNO7N.css.map */`]}));let t=a;return t;})();var mt=ht(Et());var kt=(0,mt.default)("peertube:main:DeferLoadingDirective"),ut=(()=>{let a=class a{el=d(Oe);viewContainer=d(Te);cd=d(we);template=be(ge);loaded=Me();view;observer;ngAfterViewInit(){if(this.hasIncompatibleBrowser())return this.load();this.observer=new IntersectionObserver(n=>{let i=n[0];!i.isIntersecting||i.target!==this.el.nativeElement||(this.observer.unobserve(this.el.nativeElement),this.load());},{threshold:.1}),this.observer.observe(this.el.nativeElement);}load(){this.isLoaded()||(kt("Loading component"),this.viewContainer.clear(),this.view=this.viewContainer.createEmbeddedView(this.template(),{},0),this.loaded.emit(),this.cd.detectChanges());}isLoaded(){return this.view!=null;}ngOnDestroy(){this.view=null,this.observer&&this.observer.disconnect();}hasIncompatibleBrowser(){return!("IntersectionObserver"in window);}};v(a,"\u0275fac",function(i){return new(i||a)();}),v(a,"\u0275dir",ye({type:a,selectors:[["","myDeferLoading",""]],contentQueries:function(i,e,m){i&1&&xe(m,e.template,ge,5),i&2&&Le();},outputs:{loaded:"loaded"}}));let t=a;return t;})();var Ct=t=>["/c",t],Ut=()=>["/my-library","followers"],Gt=t=>({search:t}),Yt=t=>["/my-library/video-channels/update",t];function zt(t,a){if(t&1&&(s(0,"span",14),h(1),r()),t&2){let o=_();l(),D(o.getTotalTitle());}}function Bt(t,a){t&1&&(s(0,"div",15),C(1,1),r());}function Xt(t,a){if(t&1&&u(0,"p-chart",32),t&2){let o=_(3).index,n=_();c("data",n.videoChannelsChartData[o])("options",n.chartOptions)("ariaLabel",n.getChartAriaLabel(n.videoChannelsChartData[o]));}}function jt(t,a){if(t&1&&p(0,Xt,1,3,"p-chart",31),t&2){let o=_(2).index,n=_();c("ngIf",n.chartOptions&&n.videoChannelsChartData&&n.videoChannelsChartData[o]);}}function Wt(t,a){t&1&&(s(0,"div",29)(1,"div",30),p(2,jt,1,1,"ng-template"),r()());}function Kt(t,a){if(t&1){let o=y();s(0,"div",16),u(1,"my-actor-avatar",17),s(2,"div",18)(3,"a",19)(4,"div",20),h(5),r(),s(6,"div",21),h(7),r()(),s(8,"a",22),C(9,2),r(),s(10,"div",23)(11,"span"),C(12,3),r(),s(13,"span",24),h(14,"\xB7"),r(),s(15,"span"),C(16,4),Fe(17,"myNumberFormatter"),r()(),s(18,"div",25),u(19,"my-edit-button",26),s(20,"my-delete-button",27),A("click",function(){let i=N(o).$implicit,e=_();return f(e.deleteVideoChannel(i));}),r()(),p(21,Wt,3,0,"div",28),r()();}if(t&2){let o=a.$implicit,n=_();l(),c("actor",o)("internalHref",S(17,Ct,o.nameWithHost)),l(2),c("routerLink",S(19,Ct,o.nameWithHost)),l(2),D(o.displayName),l(2),D(o.nameWithHost),l(),c("routerLink",Ie(21,Ut))("queryParams",S(22,Gt,"channel:"+o.name)),l(),z(o.followersCount)(o.followersCount),B(9),l(3),z(o.videosCount)(o.videosCount),B(12),l(5),z(o.totalViews)(Re(17,15,o.totalViews)),B(16),l(2),c("ptRouterLink",S(24,Yt,o.nameWithHost)),l(2),c("ngIf",!n.isInSmallView);}}var gt=(()=>{let a=class a{authService=d(F);notifier=d(I);confirmService=d(je);videoChannelService=d(R);screenService=d(Ke);videoChannels=[];videoChannelsChartData;chartOptions;search;onChannelDataSubject=new fe();pagination={currentPage:1,itemsPerPage:10,totalItems:null};pagesDone=new Set();get isInSmallView(){return this.screenService.isInSmallView();}onSearch(n){this.search=n,Xe(this.pagination),this.videoChannels=[],this.pagesDone.clear(),this.loadMoreVideoChannels();}deleteVideoChannel(n){return Ne(this,null,function*(){(yield this.confirmService.confirmWithExpectedInput("Vuoi veramente eliminare\n          "+n.displayName+"?\n        "+"<br />"+oe("Eliminer\xE0 {count, plural, =1 {1 video} other {{count} video}} caricati in questo canale, e non sarai in grado di creare un altro canale o account con lo stesso nome ("+n.name+")!",{count:n.videosCount}),"Digitare il nome del canale video ("+n.name+") per confermare",n.name,"Cancella"))!==!1&&this.videoChannelService.removeVideoChannel(n).subscribe({next:()=>{this.videoChannels=this.videoChannels.filter(e=>e.id!==n.id),this.notifier.success("Il canale video "+n.displayName+" \xE8 stato cancellato."),Be(this.pagination);},error:e=>this.notifier.error(e.message)});});}onNearOfBottom(){ze(this.pagination)&&(this.pagination.currentPage+=1,this.loadMoreVideoChannels());}loadMoreVideoChannels(){if(!this.pagesDone.has(this.pagination.currentPage))return this.pagesDone.add(this.pagination.currentPage),this.authService.userInformationLoaded.pipe(Se(),Ae(()=>({account:this.authService.getUser().account,withStats:!0,search:this.search,componentPagination:this.pagination,sort:"-updatedAt"})),H(n=>this.videoChannelService.listAccountVideoChannels(n))).subscribe(n=>{this.videoChannels=this.videoChannels.concat(n.data),this.pagination.totalItems=n.total,this.videoChannelsChartData=this.videoChannels.map(i=>({labels:i.viewsPerDay.map(e=>e.date.toLocaleDateString()),datasets:[{label:"Visualizzazioni per giorno",data:i.viewsPerDay.map(e=>e.views),fill:!1,borderColor:"#c6c6c6"}],total:i.viewsPerDay.map(e=>e.views).reduce((e,m)=>e+m,0),startDate:i.viewsPerDay.length!==0?i.viewsPerDay[0].date.toLocaleDateString():""})),this.buildChartOptions(),this.onChannelDataSubject.next(n.data);});}buildChartOptions(){let n=Math.min(...this.videoChannels.map(e=>Ye(e.viewsPerDay,"views").views)),i=Math.max(...this.videoChannels.map(e=>Ge(e.viewsPerDay,"views").views));this.chartOptions={plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,external:function({tooltip:e}){e&&(e.options.displayColors=!1);},callbacks:{label:e=>`${e.formattedValue} views`}}},scales:{x:{display:!1},y:{display:!1,min:Math.max(0,n-3*i/100),max:Math.max(1,i)}},layout:{padding:{left:15,right:15,top:10,bottom:0}},elements:{point:{radius:0}},hover:{mode:"index",intersect:!1}};}getChartAriaLabel(n){return n.startDate?oe(""+n.total+" {value, plural, =1 {visualizzazione} other {visualizzazioni}} dal "+n.startDate+"",{value:n.total}):"";}getTotalTitle(){return oe(""+this.pagination.totalItems+" {total, plural, =1 {canale} other {canali}}",{total:this.pagination.totalItems});}};v(a,"\u0275fac",function(i){return new(i||a)();}),v(a,"\u0275cmp",x({type:a,selectors:[["ng-component"]],decls:11,vars:5,consts:()=>{let n;n="Crea canale video";let i;i="Nessun canale trovato.";let e;e="Pagina del Canale";let m;m="{VAR_PLURAL, plural, =0 {Nessun iscritto} =1 {1 iscritto} other {{INTERPOLATION} iscritti}}",m=P(m,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let M;M=""+m+" ";let O;O="{VAR_PLURAL, plural, =0 {Nessun video} =1 {1 video} other {{INTERPOLATION} video}}",O=P(O,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let T;return T="{VAR_PLURAL, plural, =0 {Nessuna visualizzazione} =1 {1 visualizzazione} other {{INTERPOLATION} visualizzazioni}}",T=P(T,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"}),[n,i,M,O,T,[3,"hideLink"],[1,"video-channels-header","d-flex","justify-content-between","align-items-end","gap-2","flex-wrap"],[3,"search"],["class","total-items",4,"ngIf"],["routerLink","/manage/create",1,"peertube-create-button"],["iconName","add","aria-hidden","true"],["class","no-results",4,"ngIf"],["myInfiniteScroller","",1,"video-channels",3,"nearOfBottom","dataObservable"],["class","video-channel",4,"ngFor","ngForOf"],[1,"total-items"],[1,"no-results"],[1,"video-channel"],["actorType","channel","size","80",3,"actor","internalHref"],[1,"video-channel-info"],["title",e,1,"video-channel-names",3,"routerLink"],[1,"video-channel-display-name"],[1,"video-channel-name"],[1,"video-channel-followers",3,"routerLink","queryParams"],[1,"channel-videos"],[1,"mx-1"],[1,"video-channel-buttons"],["label","",3,"ptRouterLink"],["label","",3,"click"],["class","w-100 d-flex justify-content-end chart-container",4,"ngIf"],[1,"w-100","d-flex","justify-content-end","chart-container"],["myDeferLoading",""],["width","40vw","height","100px","type","line",3,"data","options","ariaLabel",4,"ngIf"],["width","40vw","height","100px","type","line",3,"data","options","ariaLabel"]];},template:function(i,e){i&1&&(u(0,"my-channels-setup-message",5),s(1,"div",6)(2,"my-advanced-input-filter",7),A("search",function(M){return e.onSearch(M);}),r(),p(3,zt,2,1,"span",8),s(4,"a",9),u(5,"my-global-icon",10),Pe(6),C(7,0),De(),r()(),p(8,Bt,2,0,"div",11),s(9,"div",12),A("nearOfBottom",function(){return e.onNearOfBottom();}),p(10,Kt,22,26,"div",13),r()),i&2&&(c("hideLink",!0),l(3),c("ngIf",e.pagination.totalItems),l(5),c("ngIf",e.pagination.totalItems===0),l(),c("dataObservable",e.onChannelDataSubject.asObservable()),l(),c("ngForOf",e.videoChannels));},dependencies:[Qe,L,ke,st,nt,Je,Ve,et,it,ot,ut,at,rt,tt],styles:[`.sub-title[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;top:-3px}input[type=text][_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:300px;max-width:300px;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}input[type=text][readonly][_ngcontent-%COMP%]{color:var(--fg-300)}input[type=text][_ngcontent-%COMP%]:focus, input[type=text][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}input[type=text][disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: 340px){input[type=text][_ngcontent-%COMP%]{width:100%}}my-edit-button[_ngcontent-%COMP%]{margin-inline-end:.625rem}.video-channel[_ngcontent-%COMP%]{display:flex;min-height:130px;padding-bottom:20px;margin-bottom:20px;border-bottom:1px solid var(--input-border-color)}@media screen and (max-width: 800px){.video-channel[_ngcontent-%COMP%]{flex-direction:column;height:auto;align-items:center}}.video-channel[_ngcontent-%COMP%]   my-actor-avatar[_ngcontent-%COMP%]{margin-inline-end:.625rem}.video-channel-info[_ngcontent-%COMP%]{flex-grow:1}.video-channel-names[_ngcontent-%COMP%]{width:fit-content;display:flex;align-items:baseline;color:var(--fg)}.video-channel-names[_ngcontent-%COMP%], .video-channel-names[_ngcontent-%COMP%]:hover, .video-channel-names[_ngcontent-%COMP%]:focus, .video-channel-names[_ngcontent-%COMP%]:active{text-decoration:none}.video-channel-names[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}.video-channel-display-name[_ngcontent-%COMP%]{font-weight:600;font-size:18px}.video-channel-name[_ngcontent-%COMP%]{font-size:14px;color:var(--fg-300);margin-inline-start:.3125rem}.video-channel-followers[_ngcontent-%COMP%]{color:var(--fg);text-decoration:none}.video-channel-buttons[_ngcontent-%COMP%]{margin-top:10px;min-width:190px}.chart-container[_ngcontent-%COMP%]{width:40vw;height:100px}.video-channels-header[_ngcontent-%COMP%]{margin-bottom:30px}@media screen and (max-width: 800px){.video-channel[_ngcontent-%COMP%]{padding-bottom:10px}.video-channel[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-inline-end:0}.video-channel[_ngcontent-%COMP%]   .video-channel-buttons[_ngcontent-%COMP%]{align-self:center}.video-channel-info[_ngcontent-%COMP%]{padding-bottom:10px;text-align:center}.video-channel-names[_ngcontent-%COMP%]{flex-direction:column;align-items:center!important;margin:auto}.video-channel-name[_ngcontent-%COMP%]{margin-inline-start:0!important}}@media screen and (min-width: 800px){.video-channel-buttons[_ngcontent-%COMP%]{float:right}}
/*# sourceMappingURL=my-video-channels.component-QJLBRYUR.css.map */`]}));let t=a;return t;})();var vo=[{path:"",component:gt,data:{meta:{title:"I miei canali video"}}},{path:"create",component:_t,data:{meta:{title:"Crea un nuovo canale video"}}},{path:"update/:videoChannelName",component:pt,data:{meta:{title:"Aggiorna canale video"}}}];export{vo as default};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-H4X75H2D.js.map