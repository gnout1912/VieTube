import{a as q}from"./chunk-6TRYPH2T.js";import{E as G,m as z,o as F,p as V}from"./chunk-RT7DTAS6.js";import{a as X}from"./chunk-PE7TFI7A.js";import{Bb as u,Cb as _,Dc as $,Ha as r,Mb as P,Na as S,Nb as N,Pb as h,Qb as w,Sa as O,Xf as H,Ya as g,Yf as k,Zf as L,aa as T,eb as c,ga as R,ha as m,ia as v,jb as b,nb as a,ob as l,oc as A,pb as p,sa as x,ta as s,tb as y,xb as f,xg as U,yb as I,zb as D}from"./chunk-F7FAPFPY.js";import{i as E}from"./chunk-AI7IVZV2.js";var Q=["avatarfileInput"];function j(t,o){if(t&1){let e=y();a(0,"div",13)(1,"button",15),p(2,"my-global-icon",16),l(),a(3,"div",17)(4,"div",18),p(5,"my-global-icon",19),a(6,"label",20),f(7,1),l(),a(8,"input",21,0),u("change",function(){m(e);let n=_(3);return v(n.onAvatarChange());}),l()(),a(10,"button",22),u("click",function(){m(e);let n=_(3);return v(n.deleteAvatar());})("key.enter",function(){m(e);let n=_(3);return v(n.deleteAvatar());}),p(11,"my-global-icon",23),a(12,"span"),f(13,2),l()()()();}if(t&2){let e=_(3);r(4),c("ngbTooltip",e.avatarFormat),r(4),c("accept",e.avatarExtensions);}}function Y(t,o){if(t&1){let e=y();a(0,"div",14),p(1,"my-global-icon",19),a(2,"label",24),f(3,3),l(),a(4,"input",21,0),u("change",function(){m(e);let n=_(3);return v(n.onAvatarChange());}),l()();}if(t&2){let e=_(3);c("ngbTooltip",e.avatarFormat),r(4),c("accept",e.avatarExtensions);}}function B(t,o){if(t&1&&g(0,j,14,2,"div",13)(1,Y,6,2,"div",14),t&2){let e=_(2);b(e.hasAvatar()?0:1);}}function Z(t,o){if(t&1&&(a(0,"div",25),h(1),l()),t&2){let e=_(2);r(),w(e.displayName());}}function J(t,o){if(t&1&&(a(0,"div",26),h(1),l()),t&2){let e=_(2);r(),w(e.username());}}function K(t,o){if(t&1&&(a(0,"div",27),f(1,4),l()),t&2){let e=_(2);r(),I(e.subscribers()),D(1);}}function W(t,o){if(t&1&&(a(0,"div",6)(1,"div",7),p(2,"my-actor-avatar",8),g(3,B,2,1),l(),a(4,"div",9),g(5,Z,2,1,"div",10)(6,J,2,1,"div",11)(7,K,2,1,"div",12),l()()),t&2){let e=_();r(2),c("actor",e.actor)("actorType",e.actorType())("previewImage",e.preview),r(),b(e.editable()?3:-1),r(2),c("ngIf",e.displayName()),r(),c("ngIf",e.displayUsername()&&e.username()),r(),c("ngIf",e.subscribers());}}var se=(()=>{let o=class o{serverService=T(U);notifier=T(H);avatarfileInput=S("avatarfileInput");actorType=s.required();avatars=s.required();username=s.required();displayName=s(void 0);subscribers=s(void 0);displayUsername=s(!0,{transform:A});editable=s(!0,{transform:A});previewImage=s(!1,{transform:A});avatarChange=x();avatarDelete=x();avatarFormat="";maxAvatarSize=0;avatarExtensions="";preview;actor;ngOnInit(){let i=this.serverService.getHTMLConfig();this.maxAvatarSize=i.avatar.file.size.max,this.avatarExtensions=i.avatar.file.extensions.join(", "),this.avatarFormat="\u6700\u5927: 192*192px, "+k(this.maxAvatarSize)+" \u62C9\u4F38: "+this.avatarExtensions+"";}ngOnChanges(){this.actor={avatars:this.avatars(),name:this.username()};}onAvatarChange(){let i=this.avatarfileInput().nativeElement.files[0];if(i.size>this.maxAvatarSize){this.notifier.error("Error","\u8FD9\u5F20\u56FE\u50CF\u592A\u5927\u4E86\u3002");return;}let n=new FormData();n.append("avatarfile",i),this.avatarChange.emit(n),this.previewImage()&&L(i).then(d=>this.preview=d);}deleteAvatar(){this.preview=void 0,this.avatarDelete.emit();}hasAvatar(){return!!this.preview||this.avatars().length!==0;}};E(o,"\u0275fac",function(n){return new(n||o)();}),E(o,"\u0275cmp",O({type:o,selectors:[["my-actor-avatar-edit"]],viewQuery:function(n,d){n&1&&P(d.avatarfileInput,Q,5),n&2&&N();},inputs:{actorType:[1,"actorType"],avatars:[1,"avatars"],username:[1,"username"],displayName:[1,"displayName"],subscribers:[1,"subscribers"],displayUsername:[1,"displayUsername"],editable:[1,"editable"],previewImage:[1,"previewImage"]},outputs:{avatarChange:"avatarChange",avatarDelete:"avatarDelete"},features:[R],decls:1,vars:1,consts:()=>{let i;i="\u4E0A\u4F20\u65B0\u5934\u50CF";let n;n="\u79FB\u9664\u5934\u50CF";let d;d="\u4E0A\u4F20\u65B0\u5934\u50CF";let M;return M=""+"\uFFFD0\uFFFD"+" \u4F4D\u8BA2\u9605\u8005\n        ",[["avatarfileInput",""],i,n,d,M,["class","actor",4,"ngIf"],[1,"actor"],[1,"position-relative","me-3"],["size","100",3,"actor","actorType","previewImage"],[1,"actor-info"],["class","actor-info-display-name",4,"ngIf"],["class","actor-info-username",4,"ngIf"],["class","actor-info-followers",4,"ngIf"],["ngbDropdown","","placement","right"],["placement","right","container","body",1,"actor-img-edit-button","button-file","primary-button","button-focus-within",3,"ngbTooltip"],["type","button","aria-label","Change your avatar","ngbDropdownToggle","",1,"actor-img-edit-button","button-file","primary-button"],["iconName","edit"],["ngbDropdownMenu",""],[1,"dropdown-item","dropdown-file","button-focus-within",3,"ngbTooltip"],["iconName","upload"],["for","avatarfile"],["type","file","name","avatarfile","id","avatarfile",3,"change","accept"],["type","button",1,"dropdown-item",3,"click","key.enter"],["iconName","delete"],["for","avatarfile",1,"visually-hidden"],[1,"actor-info-display-name"],[1,"actor-info-username"],[1,"actor-info-followers"]];},template:function(n,d){n&1&&g(0,W,8,7,"div",5),n&2&&c("ngIf",d.actor);},dependencies:[$,q,G,X,V,F,z],styles:[`.dropdown-file[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:inline-block}.dropdown-file[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:100%;height:100%;font-size:100px;text-align:end;filter:alpha(opacity=0);opacity:0;outline:none;background:var(--bg);cursor:inherit;display:block}.actor-img-edit-button[_ngcontent-%COMP%]{width:31px;cursor:pointer;display:flex;justify-content:center;align-items:center}.actor-img-edit-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;top:-1px;right:0;display:inline-block;width:19px;height:19px;line-height:19px}.actor-img-edit-button[_ngcontent-%COMP%]:not(.icon-only)   my-global-icon[_ngcontent-%COMP%]{margin-inline-end:0}label[_ngcontent-%COMP%]{font-weight:400;font-size:inherit;color:inherit;margin:0}
/*# sourceMappingURL=actor-image-edit-NRUAYZCV.css.map */`,`.actor[_ngcontent-%COMP%]{display:flex}.actor-info[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.actor-info-display-name[_ngcontent-%COMP%]{font-weight:700;word-break:break-word;word-wrap:break-word;overflow-wrap:break-word;-webkit-hyphens:auto;hyphens:auto;font-size:1.25rem}@media screen and (max-width: 800px){.actor-info-display-name[_ngcontent-%COMP%]{font-size:1.125rem}}.actor-info-username[_ngcontent-%COMP%]{position:relative;font-size:14px;color:var(--fg-300)}.actor-info-followers[_ngcontent-%COMP%]{padding-bottom:.5rem}.actor-img-edit-button[_ngcontent-%COMP%]{padding:8px 20px;position:absolute;bottom:5px;right:5px}.button-focus-within[_ngcontent-%COMP%]:focus-within{box-shadow:0 0 0 .2rem var(--fg-100)}.dropdown-item[_ngcontent-%COMP%]{padding:var(--input-y-padding) 15px}.dropdown-item[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{width:22px;opacity:.7;position:relative;top:-2px;margin-inline-end:.625rem}.dropdown-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400;margin:0}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}
/*# sourceMappingURL=actor-avatar-edit.component-MQAY65X4.css.map */`]}));let t=o;return t;})();export{se as a};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-E3CSCYZJ.js.map