{"version":3,"mappings":"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","names":["require_jschannel","__commonJSMin","exports","module","root","factory","define","amd","Channel","s_curTranId","Math","floor","random","s_boundChans","s_addBoundChan","win","origin","scope","handler","hasWin","arr","i","length","exists","k","hasOwnProperty","push","s_removeBoundChan","splice","s_isArray","obj","Array","isArray","constructor","toString","indexOf","s_transIds","s_onMessage","u","e","m","JSON","parse","data","w","source","o","s","meth","method","ar","split","id","delivered","j","window","addEventListener","attachEvent","build","cfg","debug","E","debugOutput","console","log","stringify","chanId","postMessage","validOrigin","oMatch","match","toLowerCase","text","alpha","charAt","regTbl","outTbl","inTbl","ready","pendingQueue","publishQueue","createTransaction","callbacks","shouldDelayReturn","completed","invoke","cbName","v","valid","callback","params","error","message","complete","result","delayReturn","delay","setTransactionTimeout","ne","transId","timeout","setTimeout","msg","onMessage","Be","gotMessageObserver","trans","path","pathItems","cp","resp","Error","name","success","scopeMethod","Xe","join","ke","force","postMessageObserver","onReady","We","reconnect","type","notify","publish","action","createStubs","remote","unbind","tt","stubList","targetObj","concat","call","onBind","nt","onUnbind","vt","doNotPublish","bind","cb","callbackNames","seen","pruneFunctions","Ve","np","destroy","removeEventListener","detachEvent","require_hammer","document","exportName","undefined","VENDOR_PREFIXES","TEST_ELEMENT","createElement","TYPE_FUNCTION","round","abs","now","Date","setTimeoutContext","fn","context","bindFn","invokeArrayArg","arg","each","iterator","forEach","deprecate","deprecationMessage","stack","replace","warn","apply","arguments","assign","Object","x","target","TypeError","output","index","nextKey","extend","dest","src","merge","keys","inherit","child","base","properties","baseP","prototype","childP","create","_super","boolOrFn","val","args","ifUndefined","val1","val2","addEventListeners","types","splitStr","removeEventListeners","hasParent","node","parent","parentNode","inStr","str","find","trim","inArray","findByKey","toArray","slice","uniqueArray","key","sort","results","values","a","b","prefixed","property","prefix","prop","camelProp","toUpperCase","_uniqueId","uniqueId","getWindowForElement","element","doc","ownerDocument","defaultView","parentWindow","MOBILE_REGEX","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","test","navigator","userAgent","INPUT_TYPE_TOUCH","INPUT_TYPE_PEN","INPUT_TYPE_MOUSE","INPUT_TYPE_KINECT","COMPUTE_INTERVAL","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","PROPS_XY","PROPS_CLIENT_XY","Input","manager","self","options","inputTarget","domHandler","ev","enable","init","evEl","evTarget","evWin","createInputInstance","Type","inputClass","PointerEventInput","TouchInput","TouchMouseInput","MouseInput","inputHandler","eventType","input","pointersLen","pointers","changedPointersLen","changedPointers","isFirst","isFinal","session","computeInputData","emit","recognize","prevInput","pointersLength","firstInput","simpleCloneInputData","firstMultiple","offsetCenter","center","getCenter","timeStamp","deltaTime","angle","getAngle","distance","getDistance","computeDeltaXY","offsetDirection","getDirection","deltaX","deltaY","overallVelocity","getVelocity","overallVelocityX","overallVelocityY","y","scale","getScale","rotation","getRotation","maxPointers","computeIntervalInputData","srcEvent","offset","offsetDelta","prevDelta","last","lastInterval","velocity","velocityX","velocityY","direction","clientX","clientY","p1","p2","props","sqrt","atan2","PI","start","end","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","pressed","button","which","pointerType","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","MSPointerEvent","PointerEvent","store","pointerEvents","removePointer","eventTypeNormalized","isTouch","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","started","touches","normalizeSingleTouches","all","changed","changedTouches","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","targetIds","getTouches","allTouches","identifier","targetTouches","changedTargetTouches","filter","touch","DEDUP_TIMEOUT","DEDUP_DISTANCE","mouse","primaryTouch","lastTouches","inputEvent","inputData","isMouse","sourceCapabilities","firesTouchEvents","recordTouches","isSyntheticEvent","eventData","setLastTouch","lastTouch","lts","removeLastTouch","O","t","dx","dy","PREFIXED_TOUCH_ACTION","style","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MAP","getTouchActionProps","TouchAction","value","set","compute","actions","update","touchAction","recognizers","recognizer","getTouchAction","cleanTouchActions","preventDefaults","prevented","preventDefault","hasNone","hasPanY","hasPanX","isTapPointer","isTapMovement","isTapTouchTime","preventSrc","touchMap","cssSupports","CSS","supports","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","Recognizer","defaults","state","simultaneous","requireFail","recognizeWith","otherRecognizer","getRecognizerByNameIfManager","dropRecognizeWith","requireFailure","dropRequireFailure","hasRequireFailures","canRecognizeWith","event","stateStr","additionalEvent","tryEmit","canEmit","inputDataClone","reset","process","directionStr","get","AttrRecognizer","attrTest","optionPointers","isRecognized","isValid","PanRecognizer","pX","pY","threshold","directionTest","hasMoved","PinchRecognizer","inOut","PressRecognizer","_timer","_input","time","validPointers","validMovement","validTime","clearTimeout","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","count","taps","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","Hammer","preset","Manager","VERSION","domEvents","cssProps","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","STOP","FORCED_STOP","handlers","oldCssProps","toggleCssProps","item","add","stop","stopped","curRecognizer","existing","remove","on","events","off","triggerDomEvent","gestureEvent","createEvent","initEvent","gesture","dispatchEvent","Tap","Pan","Swipe","Pinch","Rotate","Press","freeGlobal","I18nPrimengCalendarService","config","inject","PrimeNGConfig","setTranslation","dayNames","dayNamesShort","dayNamesMin","monthNames","monthNamesShort","today","$localize","clear","getTimezone","gmt","Intl","DateTimeFormat","resolvedOptions","timeZone","getDateFormat","getVideoPublicationYearRange","getFullYear","T","fac","_I18nPrimengCalendarService","UploaderXFormData","UploaderX","getFileUrl","__async","headers","size","file","previewfile","metadata","objectToFormData","append","request","body","url","endpoint","location","getValueFromResponse","responseStatus","resolveUrl","VideoUploadService","server","ServerService","notifier","Notifier","authService","AuthService","getVideoExtensions","getHTMLConfig","video","extensions","checkQuotaAndNotify","videoFile","maxQuota","quotaUsed","bytePipes","BytesPipe","videoSizeBytes","transform","videoQuotaUsedBytes","videoQuotaBytes","isAudioFile","filename","some","endsWith","getNewVideoUploadxOptions","getUploadxOptions","VideoService","BASE_VIDEO_URL","getReplaceUploadxOptions","videoId","uploaderClass","multiple","maxChunkSize","client","videos","resumableUpload","token","getAccessToken","retryConfig","getUploadXRetryConfig","_VideoUploadService","VideoStudioService","authHttp","HttpClient","restExtractor","RestExtractor","editVideo","tasks","post","pipe","catchError","err","handleError","_VideoStudioService","import_debug","qe","ht","debugLogger","VideoManageController","loadingBar","LoadingBarService","videoService","videoCaptionService","VideoCaptionService","videoChapterService","VideoChapterService","liveVideoService","LiveVideoService","videoPasswordService","VideoPasswordService","videoUploadService","auth","confirmService","ConfirmService","resumableUploadService","UploadxService","formReactiveService","FormReactiveService","videoStudio","peertubeRouter","PeerTubeRouterService","videoEdit","userChannels","userQuota","privacies","manageType","serverConfig","uploadingVideo","videoUploaded","videoUploadPercents","uploadError","retryUploadFn","isUpdatingVideo","videoUploadedSubject","Subject","alreadyRefreshedToken","embedVersion","uploadServiceSubscription","pendingUpdateObs","updatedSubject","formErrors","saveHook","resetUploadState","subscribe","onUploadVideoOngoing","ngOnDestroy","disconnect","unsubscribe","setConfig","getConfig","videoAttrs","getVideoAttributes","isPublish","Set","has","displayTranscriptionInfo","hideWaitTranscoding","isLive","VideoState","TO_TRANSCODE","forbidScheduledPublication","getForbidScheduledPublication","privacy","VideoPrivacy","PRIVATE","setStore","setVideoEdit","getStore","setFormError","page","errors","grabAllErrors","getFormErrors","hasFormErrors","getEmbedVersion","registerSaveHook","unregisterSaveHook","runSaveHook","Promise","resolve","hasPendingChanges","hasStudioTasks","hasReplaceFile","isUpdating","getUpdatedObs","asObservable","updateVideo","cancelUploadIfNeeded","useRef","videoAttributes","getLive","tap","resetReplaceFile","switchMap","hasCaptionChanges","of","updateCaptions","uuid","getCaptionsEdit","hasChaptersChanges","updateChapters","getChaptersEdit","hasLiveChanges","updateLive","toLiveUpdate","toVideoUpdate","getStudioTasks","resetStudio","forkJoin","getVideo","PASSWORD_PROTECTED","getVideoPasswords","videoUUID","getVideoLive","getChapters","listCaptions","videoPasswords","live","chaptersRes","captionsRes","loadFromAPI","map","p","password","chapters","captions","first","finalize","onSave","next","replaceFileIfNeeded","uploadFileReplacement","getReplaceFile","handleFiles","__spreadProps","__spreadValues","control","retryUpload","checkAndConfirmVideoFileReplacement","replaceFile","checkUserQuota","willBeBlocked","autoBlacklist","ofUsers","enabled","blacklisted","blockedWarning","confirm","checkAndConfirmStudioTasks","title","listHTML","getStudioTasksSummary","confirmHTML","user","getUser","videoQuota","videoQuotaUsed","videoQuotaDaily","videoQuotaUsedDaily","silentRedirectOnManage","shortUUID","route","silentNavigate","publishedId","uploading","silentRedirectOnUploading","silentRedirectOnAbortUpload","uploadNewVideo","toVideoCreate","getUploadEventsObs","getUploadPercents","getUploadError","isUploadingFile","hasUploadedFile","status","HttpStatusCode","UNAUTHORIZED_401","refreshTokenAndRetryUpload","handleUploadError","buildHTTPErrorResponse","progress","info","genericUploadErrorHandler","refreshAccessToken","_VideoManageController","VIDEO_CAPTION_LANGUAGE_VALIDATOR","VALIDATORS","Validators","required","MESSAGES","VIDEO_CAPTION_FILE_VALIDATOR","VIDEO_CAPTION_FILE_CONTENT_VALIDATOR","elementStart","text","elementEnd","h","advance","textInterpolate1","ctx_r1","language","Hs","i18n","ks","q","elementContainerStart","listener","restoreView","_r1","nextContext","resetView","hide","element","template","VideoCaptionAddModalComponent_ng_template_0_div_10_Template","VideoCaptionAddModalComponent_ng_template_0_div_13_Template","addCaption","X","property","form","videoCaptionLanguages","videoCaptionExtensions","videoCaptionMaxSize","getReactiveFileButtonTooltip","isReplacingExistingCaption","VideoCaptionAddModalComponent","FormReactive","modalService","NgbModal","serverService","existingCaptions","captionAdded","modal","viewChild","openedModal","videoCaption","max","ngOnInit","getVideoLanguages","languages","buildForm","captionfile","show","open","centered","keyboard","close","languageId","includes","languageObject","l","__ngFactoryType__","selectors","viewQuery","rf","ctx","rt","r","$s","n","Dt","inputs","outputs","features","Hn","decls","vars","consts","VideoCaptionAddModalComponent_ng_template_0_Template","templateRefExtractor","dependencies","FormsModule","NgControlStatus","NgControlStatusGroup","ReactiveFormsModule","FormGroupDirective","FormControlName","GlobalIconComponent","NgIf","ReactiveFileComponent","SelectOptionsComponent","styles","_VideoCaptionAddModalComponent","Yr","EventRegistrar","eventRegistrations","bindToChannel","channel","txn","fire","registerTypes","names","registrations","addListener","removeListener","PASSTHROUGH_EVENTS","PeerTubePlayer","embedElement","eventRegistrar","readyPromise","constructChannel","prepareToBeReady","isPlaying","sendMessage","play","pause","setVolume","getVolume","setCaption","getCaptions","getCurrentTime","seek","seconds","setResolution","resolutionId","getResolutions","getPlaybackRates","getPlaybackRate","setPlaybackRate","rate","playNextVideo","playPreviousVideo","getCurrentPosition","setVideoPassword","getImageDataUrl","contentWindow","readyResolve","readyReject","res","rej","isReady","reject","Js","_r3","addSegmentToEdit","el","captionFileContent","tl","_r6","segment_r5","$implicit","videoTimeForSegmentStart","nl","_r7","videoTimeForSegmentEnd","il","textInterpolate","segmentEditError","ol","twoWayListener","$event","_r4","i0","twoWayBindingSet","startMs","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_1_my_button_6_Template","endMs","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_1_my_button_12_Template","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_1_div_18_Template","onEditSaved","onEditCanceled","duration","twoWayProperty","timestampParser","timestampFormatter","isPublishedVOD","rl","_r9","updateSegment","deleteSegment","al","sl","_r8","onSegmentClick","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_2_Defer_7_Template","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_2_DeferPlaceholder_8_Template","defer","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_2_Defer_9_DepsFn","deferOnViewport","pureFunction1","_c4","activeSegment","textInterpolate2","startFormatted","endFormatted","_c5","segmentToUpdate","ll","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_1_Template","VideoCaptionEditModalComponent_ng_template_0_For_19_Conditional_2_Template","conditional","dl","VideoCaptionEditModalComponent_ng_template_0_my_embed_7_Template","rawEdit","onRawEditSwitch","VideoCaptionEditModalComponent_ng_template_0_my_button_11_Template","VideoCaptionEditModalComponent_ng_template_0_div_16_Template","repeaterCreate","VideoCaptionEditModalComponent_ng_template_0_For_19_Template","_forTrack0","updateCaption","i18nExp","label","ve","_c3","repeater","segments","VideoCaptionEditModalComponent","cd","ChangeDetectorRef","textarea","embed","segmentToUpdateSave","webvttToMS","millisecondsToVttTime","player","captionEdited","beforeDismiss","loadCaptionContent","initEmbed","getIframe","position","isNaN","current","detectChanges","then","content","loadSegments","fileUrl","getCaptionContent","patchValue","formatSegments","resetTextarea","updateSegmentPositions","segment","scrollToSegment","querySelector","scrollTop","sortBy","webvttDuration","ms","timeToInt","parseInt","entries","from","to","nativeElement","selectionStart","selectionEnd","File","lastModified","scrollIntoView","behavior","block","Bs","Xs","Ws","VideoCaptionEditModalComponent_ng_template_0_Template","DefaultValueAccessor","NgModel","NgClass","PeertubeCheckboxComponent","EmbedComponent","ButtonComponent","TimestampInputComponent","_VideoCaptionEditModalComponent","cl","_l","ml","pl","ul","gl","El","fl","videoCaption_r5","ctx_r5","openEditCaptionModal","hl","C","Cl","Sl","Ml","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Case_2_Template","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Case_3_Template","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Case_4_Template","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Conditional_5_Template","deleteCaption","i18nStart","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Case_8_Template","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Case_9_Template","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Case_10_Template","i18nEnd","getCaptionLabel","tmp_7_0","tmp_9_0","Al","Wt","sanitizeUrl","pipeBind1","updatedAt","vl","VideoCaptionsComponent_Conditional_5_div_2_Conditional_2_Template","VideoCaptionsComponent_Conditional_5_div_2_Conditional_3_Template","Ol","Pl","VideoCaptionsComponent_Conditional_5_my_alert_1_Template","VideoCaptionsComponent_Conditional_5_div_2_Template","VideoCaptionsComponent_Conditional_5_div_3_Template","_r2","openAddCaptionModal","isTranscriptionEnabled","hasCaptions","tmp_5_0","VideoCaptionsComponent","manageController","videoCaptionAddModal","videoCaptionEditModal","videoLanguages","initialVideoCaptions","c","caption","automaticallyGenerated","getExistingCaptions","onCaptionEdited","captionsEdit","existingCaption","sortVideoCaptions","removeElementFromArray","videoTranscription","v1","v2","Sn","W","VideoCaptionsComponent_Conditional_4_Template","VideoCaptionsComponent_Conditional_5_Template","CalendarModule","NgFor","DeleteButtonComponent","PTDatePipe","EditButtonComponent","AlertComponent","_VideoCaptionsComponent","VIDEO_CHAPTER_TITLE_VALIDATOR","minLength","maxLength","minlength","maxlength","VIDEO_CHAPTERS_ARRAY_VALIDATOR","uniqueTimecodeValidator","array","chapter","timecode","uniqueTimecode","na","Nl","Tl","bl","yl","i_r2","ctx_r2","deleteChapterControl","Dl","VideoChaptersComponent_Conditional_5_ng_container_6_my_delete_button_17_Template","_c0","_c1","_c2","isLastChapterControl","Rl","getChapterArrayErrors","xl","Fl","VideoChaptersComponent_Conditional_5_ng_container_6_Template","VideoChaptersComponent_Conditional_5_div_7_Template","VideoChaptersComponent_Conditional_5_my_embed_8_Template","getChaptersFormArray","controls","VideoChaptersComponent","formValidatorService","FormValidatorService","validationMessages","updatedSub","addControl","FormArray","addNewChapterControl","valueChanges","lastChapter","patchChapters","chapterErrors","formValues","loadFromForm","markAllAsDirty","chaptersFormArray","addValidators","addControlInFormArray","controlName","formArray","formToBuild","defaultValues","removeControlFromFormArray","chaptersEdit","totalChapters","getChaptersForUpdate","totalControls","toFormPatch","i18n_0","d","VideoChaptersComponent_Conditional_4_Template","VideoChaptersComponent_Conditional_5_Template","FormGroupName","FormArrayName","_VideoChaptersComponent","VIDEO_NAME_VALIDATOR","spaces","VIDEO_PRIVACY_VALIDATOR","VIDEO_PASSWORD_VALIDATOR","VIDEO_CATEGORY_VALIDATOR","VIDEO_LICENCE_VALIDATOR","VIDEO_LANGUAGE_VALIDATOR","VIDEO_CHANNEL_VALIDATOR","VIDEO_DESCRIPTION_VALIDATOR","VIDEO_TAGS_ARRAY_VALIDATOR","arrayTagLengthValidator","arrayTagLength","VIDEO_SUPPORT_VALIDATOR","VIDEO_NSFW_SUMMARY_VALIDATOR","VIDEO_SCHEDULE_PUBLICATION_AT_VALIDATOR","VIDEO_ORIGINALLY_PUBLISHED_AT_VALIDATOR","min","every","Gl","ctx_r0","getVideoSource","$l","resetField","Ul","originallyPublishedAt","VideoCustomizationComponent","i18nPrimengCalendarService","calendarDateFormat","myYearRange","toCommonFormPatch","downloadEnabled","loadFromCommonForm","hasPublicationDate","VideoCustomizationComponent_div_7_Template","VideoCustomizationComponent_button_12_Template","VideoCustomizationComponent_div_16_Template","Calendar","_VideoCustomizationComponent","LiveDocumentationLinkComponent","encapsulation","_LiveDocumentationLinkComponent","kl","zl","getErrorLabel","session_r1","Bl","pipeBind2","endDate","Xl","getVideoUrl","replayVideo","Wl","jl","LiveStreamInformationComponent_div_0_div_3_span_1_Template","LiveStreamInformationComponent_div_0_div_3_span_2_Template","LiveStreamInformationComponent_div_0_div_3_span_7_Template","LiveStreamInformationComponent_div_0_div_3_a_8_Template","LiveStreamInformationComponent_div_0_div_3_span_9_Template","startDate","isReplayBeingProcessed","Yl","LiveStreamInformationComponent_div_0_div_3_Template","latestLiveSessions","LiveStreamInformationComponent","listSessions","reverse","Video","buildWatchUrl","LiveVideoError","BAD_SOCKET_HEALTH","BLACKLISTED","DURATION_EXCEEDED","FFMPEG_ERROR","QUOTA_EXCEEDED","RUNNER_JOB_CANCEL","RUNNER_JOB_ERROR","UNKNOWN_ERROR","INVALID_INPUT_VIDEO_STREAM","saveReplay","endingProcessed","ProvidersFeature","LiveStreamInformationComponent_div_0_Template","CommonModule","NgForOf","RouterLink","_LiveStreamInformationComponent","ql","disabled","Zl","getVideoName","Kl","Ql","Jl","getInstanceName","getMaxLiveDuration","ed","VideoLiveSettingsComponent_Conditional_6_Conditional_3_div_1_Template","td","rtmpUrl","nd","rtmpsUrl","od","VideoLiveSettingsComponent_Conditional_6_div_29_ng_template_2_Template","rd","replayPrivacies","ad","latencyMode","sd","VideoLiveSettingsComponent_Conditional_6_div_31_div_4_Template","latencyModes","ld","VideoLiveSettingsComponent_Conditional_6_Conditional_2_Template","VideoLiveSettingsComponent_Conditional_6_Conditional_3_Template","VideoLiveSettingsComponent_Conditional_6_div_6_Template","VideoLiveSettingsComponent_Conditional_6_div_7_Template","VideoLiveSettingsComponent_Conditional_6_div_29_Template","VideoLiveSettingsComponent_Conditional_6_div_30_Template","VideoLiveSettingsComponent_Conditional_6_div_31_Template","isStreaming","streamKey","isSaveReplayAllowed","isSaveReplayEnabled","isLatencyModeEnabled","VideoLiveSettingsComponent","LiveVideoLatencyMode","SMALL_LATENCY","description","DEFAULT","HIGH_LATENCY","getVideoPrivacies","explainedPrivacyLabels","videoPrivacies","toLiveFormPatch","liveStreamKey","permanentLive","replayPrivacy","loadFromLiveForm","allowReplay","isPermanentLiveEnabled","latencySetting","hasEnded","LIVE_ENDED","PUBLISHED","maxDuration","instance","VideoLiveSettingsComponent_Conditional_4_Template","VideoLiveSettingsComponent_Conditional_5_Template","VideoLiveSettingsComponent_Conditional_6_Template","RadioControlValueAccessor","PeerTubeTemplateDirective","InputTextComponent","TimeDurationFormatterPipe","_VideoLiveSettingsComponent","DragDropDirective","fileDropped","dragover","onDragOver","stopPropagation","onDragLeave","ondrop","files","dataTransfer","hostVars","hostBindings","classProp","_DragDropDirective","_d","selectFrame","resetSelectFromVideo","md","imageSrc","pd","Ro","ud","selectFromVideo","gd","ThumbnailManagerComponent_Conditional_2_Conditional_1_Template","ThumbnailManagerComponent_Conditional_2_Conditional_2_Template","onFileChanged","ThumbnailManagerComponent_Conditional_2_Conditional_15_Template","videoImageExtensions","maxVideoImageSizeInBytes","maxVideoImageSize","canSelectFromVideo","ThumbnailManagerComponent","environmentInjector","EnvironmentInjector","allowedExtensionsMessage","bytesPipe","imageFile","selectingFromVideo","image","attrs","propagateChange","updatePreview","onFileDropped","_","writeValue","registerOnChange","registerOnTouched","imageToDataURL","runInInjectionContext","afterNextRender","dataUrl","blob","dataURItoBlob","dataURI","byteString","atob","mimeString","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","Blob","en","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","ThumbnailManagerComponent_Conditional_1_Template","ThumbnailManagerComponent_Conditional_2_Template","_ThumbnailManagerComponent","VideoChaptersEdit","chaptersFromAPI","hasChanges","simpleObjectsDeepEqual","VideoEdit","isNewVideo","common","studioTasks","videoImport","saveStore","checkPluginChanges","createFromUpload","loadFromPublish","createFromImport","loadFromImport","targetUrl","magnetUri","torrentfile","updateAfterChange","createFromLive","loadFromLive","replaySettings","serverDefaults","channelId","support","licence","commentsPolicy","nsfw","isNSFW","waitTranscoding","tags","pluginData","views","likes","createFromAPI","videoSource","loadVideo","saveInStore","loadLive","loadPreview","buildObj","category","nsfwSummary","nsfwFlags","NSFWFlag","NONE","scheduleUpdate","scheduledUpdate","updateAt","toISOString","omit","pluginDefaults","aspectRatio","loadPluginDataDefaults","previewPath","response","fetch","getOriginUrl","logger","pick","loadAfterPublish","nsfwFlagSex","EXPLICIT_SEX","nsfwFlagViolent","VIOLENT","videoPassword","SPECIAL_SCHEDULED_PRIVACY","schedulePublicationAt","setSeconds","PUBLIC","json","toVideoCreateOrUpdate","overriddenPrivacy","thumbnailfile","toLiveCreate","toVideoImportCreate","loadFromReplaceFileForm","toReplaceFileFormPatch","loadFromStudioForm","cut","toStudioFormPatch","addIntro","addOutro","addWatermark","secondsToTime","hasCommonChanges","changes","areSameObjects","saveCommon","savePreview","hasPluginDataChanges","savePluginData","saveLive","keysA","keysB","enableCheckPluginChanges","disableCheckPluginChanges","__publicField","_VideoEdit","Ia","Ed","isPluginFieldHidden","pluginSetting_r1","pluginDataFormGroup","commonOptions","fd","hd","Cd","elementContainer","Ge","pluginSettingTemplate_r4","pluginSetting_r3","Sd","pluginSetting_r5","Md","Ad","vd","Od","VideoMainInfoComponent_div_69_div_4_Template","calendarTimezone","minScheduledDate","Pd","Id","Nd","Td","bd","yd","VideoMainInfoComponent_my_peertube_checkbox_88_ng_template_1_Template","VideoMainInfoComponent_my_peertube_checkbox_88_ng_template_2_Template","Dd","deleteVideo","VideoMainInfoComponent","pluginService","PluginService","instanceService","InstanceService","ngZone","NgZone","hooks","HooksService","router","Router","videoCategories","videoLicences","schedulePublicationSelected","passwordProtectionSelected","calendarLocale","pluginFields","firstPatchDone","schedulerInterval","ensurePluginsAreLoaded","updatePluginFields","getVideoCategories","getVideoLicences","buildLanguages","buildPrivacies","runOutsideAngular","setInterval","updateFormForPlugins","runAction","updateForm","waitPendingCheck","forceCheck","clearInterval","getAbout","about","hasPrivatePrivacy","updateScheduleRelatedControls","trackChannelChange","trackPrivacyChange","getChannelUpdateUrl","pluginField","hidden","videoToUpdate","liveVideo","getPluginsFields","tab","videoFormOptions","getRegisteredVideoFormFields","pluginObj","pluginValidationMessages","pluginFormErrors","setting","translateSetting","pluginInfo","plugin","npmName","validator","ASYNC_VALIDATORS","default","FormGroup","updateFormGroup","updateTreeValidity","newPrivacyId","isInitialPatch","scheduleControl","waitTranscodingControl","setValidators","disable","setValue","clearValidators","updateValueAndValidity","videoPasswordControl","newChannelId","updateSupportFromChannel","newChannel","currentSupport","oldChannelId","oldChannel","updateSupportField","canBeDeleted","removeVideo","navigate","N","D","VideoMainInfoComponent_ng_template_5_Template","VideoMainInfoComponent_div_13_Template","VideoMainInfoComponent_div_38_Template","VideoMainInfoComponent_ng_container_52_Template","VideoMainInfoComponent_ng_container_53_Template","VideoMainInfoComponent_div_67_Template","VideoMainInfoComponent_div_68_Template","VideoMainInfoComponent_div_69_Template","VideoMainInfoComponent_div_77_Template","VideoMainInfoComponent_div_82_Template","VideoMainInfoComponent_div_87_Template","VideoMainInfoComponent_my_peertube_checkbox_88_Template","VideoMainInfoComponent_div_89_Template","NgTemplateOutlet","DynamicFormFieldComponent","SelectTagsComponent","MarkdownTextareaComponent","SelectChannelComponent","MarkdownHintComponent","_VideoMainInfoComponent","xd","Fd","Vd","Ld","wd","VideoModerationComponent","commentPolicies","getCommentPolicies","updateNSFWControls","trackNSFWChange","newNSFW","VideoModerationComponent_ng_template_13_Template","VideoModerationComponent_div_19_Template","VideoModerationComponent_ng_template_23_Template","VideoModerationComponent_ng_template_25_Template","SelectRadioComponent","_VideoModerationComponent","getReplaceFileUnavailability","replaceFileEnabled","instanceName","canVideoFileBeEdited","TO_EDIT","TO_IMPORT","getStudioUnavailability","studioEnabled","$d","Ud","getUnavailability","Hd","kd","VideoReplaceFileComponent_Conditional_5_div_1_Template","VideoReplaceFileComponent","reactiveFile","fileChange","markAsDirty","$o","Uo","Ho","VideoReplaceFileComponent_Conditional_4_Template","VideoReplaceFileComponent_Conditional_5_Template","_VideoReplaceFileComponent","import_hammerjs","Da","getModifierKey","opts","modifierKey","keyPressed","Ba","keyNotPressed","io","directionEnabled","mode","dir","chart","directionsEnabled","debounce","getScaleUnderPoint","scales","scaleIds","top","bottom","left","right","getEnabledScalesByPoint","point","scaleMode","overScaleMode","scaleEnabled","overScaleEnabled","axis","enabledScales","scaleItem","chartStates","WeakMap","getState","originalScaleLimits","updatedScaleLimits","panDelta","dragging","panning","removeState","delete","zoomDelta","range","newRange","minPercent","maxPercent","getValueAtPoint","pixel","isHorizontal","getValueForPixel","linearZoomDelta","zoom","centerValue","logarithmicZoomRange","logMin","log10","logMax","logCenter","logRange","newLogRange","delta","pow","getScaleLimits","limits","getLimit","scaleLimits","fallback","limit","original","valueOrDefault","linearRange","pixel0","pixel1","v0","fixRange","minLimit","maxLimit","originalLimits","origMin","origMax","epsilon","almostEquals","updateRange","scaleOpts","minRange","scaleRange","zoomNumericalScale","zoomLogarithmicScale","zoomRectNumericalScale","integerChange","existCategoryFromMaxZoom","maxIndex","getLabels","zoomCategoryScale","scaleLength","width","height","panCategoryScale","lastLabelIndex","stepDelta","stepSize","applied","OFFSETS","second","minute","hour","day","week","month","quarter","year","panNumericalScale","pan","prevStart","prevEnd","newMin","getPixelForValue","newMax","panNonLinearScale","zoomFunctions","logarithmic","zoomRectFunctions","panFunctions","timeseries","shouldUpdateScaleLimits","previous","removeMissingScales","opt","storeOriginalScaleLimits","doZoom","amount","doZoomRect","ca","chartArea","transition","trigger","focalPoint","zoomOptions","xEnabled","yEnabled","onZoom","zoomRect","p0","zoomScale","scaleId","resetZoom","scaleOptions","onZoomComplete","getOriginalRange","getZoomLevel","origRange","level","panScale","storedDelta","sign","panOptions","onPan","getInitialScaleBounds","scaleBounds","getZoomedScaleBounds","isZoomedOrPanned","originalMin","originalMax","isZoomingOrPanning","clamp","Ua","removeHandler","addHandler","oldHandler","passive","mouseMove","dragStart","dragEnd","keyDown","getPointPosition","canvas","canvasArea","getBoundingClientRect","getRelativePosition","zoomStart","onZoomStart","onZoomRejected","mouseDown","legend","_isPointInArea","drag","applyAspectRatio","begin","ratio","applyMinMaxProps","rect","points","getRelativePoints","pointEvents","maintainAspectRatio","computeDragRect","chartWidth","chartHeight","zoomX","zoomY","mouseUp","distanceX","distanceY","filterNextClick","wheelPreconditions","wheel","cancelable","speed","percentage","addDebouncedHandler","addListeners","wheelOptions","dragOptions","removeListeners","createEnabler","onPanRejected","pinchAxes","pinchX","pinchY","handlePinch","zoomPercent","pinch","startPinch","endPinch","handlePan","panScales","startPan","onPanStart","endPan","onPanComplete","hammers","startHammer","mc","ln","stopHammer","hammerOptionsChanged","oldOptions","newOptions","oldPan","oldZoom","newPan","newZoom","version","draw","caller","drawTime","save","beginPath","fillStyle","backgroundColor","fillRect","borderWidth","lineWidth","strokeStyle","borderColor","strokeRect","restore","_args","beforeEvent","beforeUpdate","previousOptions","beforeDatasetsDraw","afterDatasetsDraw","beforeDraw","afterDraw","VideoStatsService","getOverallStats","HttpParams","getTimeserieStats","metric","getRetentionStats","getUserAgentStats","BASE_VIDEO_STATS_URL","environment","apiUrl","providedIn","_VideoStatsService","card_r2","help","xc","moreInfo","Fc","VideoStatsComponent_div_6_my_help_3_Template","VideoStatsComponent_div_6_div_6_Template","Vc","card_r3","Lc","VideoStatsComponent_div_17_div_5_Template","wc","ctx_r4","chartOptions","availableChart_r4","chartPlugins","Gc","$c","Uc","VideoStatsComponent_ng_container_21_ng_template_4_p_chart_1_Template","VideoStatsComponent_ng_container_21_ng_template_4_span_3_Template","VideoStatsComponent_ng_container_21_ng_template_4_my_button_4_Template","hasZoom","zoomEnabled","Hc","VideoStatsComponent_ng_container_21_ng_template_4_Template","BAR_GRAPHS","isBarGraph","graphId","graph","ChartJSDefaults","getComputedStyle","getPropertyValue","color","VideoStatsComponent","localeId","LOCALE_ID","ActivatedRoute","statsService","numberFormatter","NumberFormatterPipe","liveService","globalStatsCards","overallStatCards","availableCharts","activeGraphId","countries","regions","zoomPlugin","currentDateFilter","dateFilters","statsStartDate","statsEndDate","chartIngestData","snapshotQuery","snapshot","queryParams","addAndSelectCustomDateFilter","loadChart","loadOverallStats","loadDateFilters","hasCountries","hasRegions","onChartChange","newActive","removeAndResetCustomDateFilter","isTimeserieGraph","getViewersStatsTitle","toMediumDate","onDateFilterChange","idParts","countryCodeToName","isoCode","viewers","subdivisions","buildOverallStatCard","loadLiveDateFilters","loadVODDateFilters","newFilters","buildLiveFilter","findLiveSessionFromVOD","NOT_FOUND_404","overallStats","averageWatchTime","format","totalWatchTime","viewersPeak","viewersPeakDate","totalViewers","retention","clients","devices","operatingSystems","aggregateWatchTime","buildChartOptions","dataBuilders","rawData","buildUserAgentChartOptions","buildRetentionChartOptions","buildTimeserieChartOptions","buildGeoChartOptions","displayLegend","plugins","responsive","ticks","formatXTick","beginAtZero","formatYTick","display","tooltip","items","formatTooltipTitle","raw","labels","retentionPercent","buildDisabledZoomPlugin","datasets","buildChartColor","date","indexAxis","maxBarThickness","getLabelForValue","groupInterval","toLocaleDateString","toLocaleTimeString","toLocaleString","code","intl","DisplayNames","VideoStatsComponent_div_6_Template","VideoStatsComponent_div_17_Template","VideoStatsComponent_ng_container_21_Template","nav_r7","HelpComponent","NgbNav","NgbNavItem","NgbNavLink","NgbNavLinkBase","NgbNavContent","ChartModule","UIChart","NgbNavOutlet","_VideoStatsComponent","zc","Bc","task_r2","Xc","VideoStudioEditComponent_Conditional_5_div_40_li_4_Template","Wc","VideoStudioEditComponent_Conditional_5_div_40_Template","videoExtensions","getIntroOutroTooltip","imageExtensions","getWatermarkTooltip","noEdit","VideoStudioEditComponent","isRunningEdit","VideoStudioEditComponent_Conditional_4_Template","VideoStudioEditComponent_Conditional_5_Template","NgNoValidate","_VideoStudioEditComponent","manageRoutes","component","Yc","error_r1","qc","ManageErrorsComponent_For_4_For_5_Template","repeaterTrackByIdentity","errorRoot_r2","ManageErrorsComponent","getAllErrors","template","ManageErrorsComponent_For_4_Template","RouterModule","_ManageErrorsComponent","Zc","Kc","UnavailableMenuEntryComponent","ngContentSelectors","projection","NgbTooltipModule","_UnavailableMenuEntryComponent","Qc","exact","Jc","e_","t_","n_","i_","o_","VideoManageMenuComponent_Conditional_25_Conditional_19_span_1_Template","VideoManageMenuComponent_Conditional_25_Conditional_19_span_2_Template","studioUnavailable","iconStudio_r1","labelStudio_r2","r_","a_","s_","VideoManageMenuComponent_Conditional_25_Conditional_20_ng_container_1_Template","VideoManageMenuComponent_Conditional_25_Conditional_20_ng_container_2_Template","l_","d_","c_","__","m_","VideoManageMenuComponent_Conditional_25_Conditional_26_span_1_Template","VideoManageMenuComponent_Conditional_25_Conditional_26_span_2_Template","replaceFileUnavailable","iconReplaceFile_r4","labelReplaceFile_r5","p_","u_","g_","VideoManageMenuComponent_Conditional_25_Conditional_27_ng_container_1_Template","VideoManageMenuComponent_Conditional_25_Conditional_27_ng_container_2_Template","E_","VideoManageMenuComponent_Conditional_25_ng_template_15_Template","VideoManageMenuComponent_Conditional_25_ng_template_17_Template","VideoManageMenuComponent_Conditional_25_Conditional_19_Template","VideoManageMenuComponent_Conditional_25_Conditional_20_Template","VideoManageMenuComponent_Conditional_25_ng_template_22_Template","VideoManageMenuComponent_Conditional_25_ng_template_24_Template","VideoManageMenuComponent_Conditional_25_Conditional_26_Template","VideoManageMenuComponent_Conditional_25_Conditional_27_Template","f_","VideoManageMenuComponent","canWatch","booleanAttribute","VideoManageMenuComponent_li_10_Template","VideoManageMenuComponent_Conditional_25_Template","VideoManageMenuComponent_Conditional_26_Template","pureFunction0","RouterLinkActive","_VideoManageMenuComponent","h_","C_","getWatchUrl","S_","M_","A_","v_","getStateWarning","manageMain","manageSecondary","O_","VideoManageContainerComponent","headerService","HeaderService","screenService","ScreenService","videoStateMessage","VideoStateMessageService","canUpdate","uploadedLabel","cancelLink","videoUpdated","displayFormErrorsMsg","canRetryUpload","isInMobileView","setSearchHidden","buildWarn","onWantToUpdate","VideoManageContainerComponent_my_button_11_Template","VideoManageContainerComponent_Conditional_13_Template","VideoManageContainerComponent_Conditional_14_Template","VideoManageContainerComponent_Conditional_15_Template","VideoManageContainerComponent_div_16_Template","VideoManageContainerComponent_my_manage_errors_17_Template","tmp_6_0","RouterOutlet","UploadProgressComponent","_VideoManageContainerComponent","Ci","Mi","Hr","ae","vi","Yi","f","zh","g","VC"],"ignoreList":[0,1,40],"sources":["node_modules/jschannel/src/jschannel.js","node_modules/hammerjs/hammer.js","src/app/+videos-publish-manage/shared-manage/common/i18n-primeng-calendar.service.ts","src/app/+videos-publish-manage/shared-manage/common/uploaderx-form-data.ts","src/app/+videos-publish-manage/shared-manage/common/video-upload.service.ts","src/app/+videos-publish-manage/shared-manage/studio/video-studio.service.ts","src/app/+videos-publish-manage/shared-manage/video-manage-controller.service.ts","src/app/+videos-publish-manage/shared-manage/captions/video-captions.component.ts","src/app/shared/form-validators/video-captions-validators.ts","src/app/+videos-publish-manage/shared-manage/captions/video-caption-add-modal.component.html","src/app/+videos-publish-manage/shared-manage/captions/video-caption-add-modal.component.ts","src/standalone/embed-player-api/player.ts","src/standalone/embed-player-api/events.ts","src/app/+videos-publish-manage/shared-manage/captions/video-caption-edit-modal.component.html","src/app/+videos-publish-manage/shared-manage/captions/video-caption-edit-modal.component.ts","src/app/+videos-publish-manage/shared-manage/captions/video-captions.component.html","src/app/shared/form-validators/video-chapter-validators.ts","src/app/+videos-publish-manage/shared-manage/chapters/video-chapters.component.ts","src/app/+videos-publish-manage/shared-manage/chapters/video-chapters.component.html","src/app/shared/form-validators/video-validators.ts","src/app/+videos-publish-manage/shared-manage/customization/video-customization.component.ts","src/app/+videos-publish-manage/shared-manage/customization/video-customization.component.html","src/app/+videos-publish-manage/shared-manage/live-settings/video-live-settings.component.ts","src/app/+videos-publish-manage/shared-manage/live-settings/live-documentation-link.component.ts","src/app/+videos-publish-manage/shared-manage/live-settings/live-documentation-link.component.html","src/app/+videos-publish-manage/shared-manage/live-settings/live-stream-information.component.html","src/app/+videos-publish-manage/shared-manage/live-settings/live-stream-information.component.ts","src/app/+videos-publish-manage/shared-manage/live-settings/video-live-settings.component.html","src/app/+videos-publish-manage/shared-manage/main-info/video-main-info.component.ts","src/app/+videos-publish-manage/+video-publish/shared/drag-drop.directive.ts","src/app/+videos-publish-manage/shared-manage/common/thumbnail-manager.component.html","src/app/+videos-publish-manage/shared-manage/common/thumbnail-manager.component.ts","src/app/+videos-publish-manage/shared-manage/common/video-edit.model.ts","src/app/+videos-publish-manage/shared-manage/common/video-chapters-edit.model.ts","src/app/+videos-publish-manage/shared-manage/main-info/video-main-info.component.html","src/app/+videos-publish-manage/shared-manage/moderation/video-moderation.component.ts","src/app/+videos-publish-manage/shared-manage/moderation/video-moderation.component.html","src/app/+videos-publish-manage/shared-manage/replace-file/video-replace-file.component.ts","src/app/+videos-publish-manage/shared-manage/common/unavailable-features.ts","src/app/+videos-publish-manage/shared-manage/replace-file/video-replace-file.component.html","node_modules/chartjs-plugin-zoom/dist/chartjs-plugin-zoom.esm.js","src/app/+videos-publish-manage/shared-manage/stats/video-stats.service.ts","src/app/+videos-publish-manage/shared-manage/stats/video-stats.component.html","src/app/+videos-publish-manage/shared-manage/stats/video-stats.component.ts","src/app/+videos-publish-manage/shared-manage/studio/video-studio.component.ts","src/app/+videos-publish-manage/shared-manage/studio/video-studio.component.html","src/app/+videos-publish-manage/shared-manage/routes.ts","src/app/+videos-publish-manage/shared-manage/common/manage-errors.component.html","src/app/+videos-publish-manage/shared-manage/common/manage-errors.component.ts","src/app/+videos-publish-manage/shared-manage/unavailable-menu-entry.component.ts","src/app/+videos-publish-manage/shared-manage/unavailable-menu-entry.component.html","src/app/+videos-publish-manage/shared-manage/video-manage-menu.component.html","src/app/+videos-publish-manage/shared-manage/video-manage-menu.component.ts","src/app/+videos-publish-manage/shared-manage/video-manage-container.component.html","src/app/+videos-publish-manage/shared-manage/video-manage-container.component.ts"],"sourcesContent":["/*\n * js_channel is a very lightweight abstraction on top of\n * postMessage which defines message formats and semantics\n * to support interactions more rich than just message passing\n * js_channel supports:\n *  + query/response - traditional rpc\n *  + query/update/response - incremental async return of results\n *    to a query\n *  + notifications - fire and forget\n *  + error handling\n *\n * js_channel is based heavily on json-rpc, but is focused at the\n * problem of inter-iframe RPC.\n *\n * Message types:\n *  There are 5 types of messages that can flow over this channel,\n *  and you may determine what type of message an object is by\n *  examining its parameters:\n *  1. Requests\n *    + integer id\n *    + string method\n *    + (optional) any params\n *  2. Callback Invocations (or just \"Callbacks\")\n *    + integer id\n *    + string callback\n *    + (optional) params\n *  3. Error Responses (or just \"Errors)\n *    + integer id\n *    + string error\n *    + (optional) string message\n *  4. Responses\n *    + integer id\n *    + (optional) any result\n *  5. Notifications\n *    + string method\n *    + (optional) any params\n */\n\n// Universal module definition //\n(function (root, factory) {\n  if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD\n    define([], function () {\n      return root.Channel = factory();\n    });\n  } else {\n    // Global Variables\n    root.Channel = factory();\n  }\n})(this, function () {\n  \"use strict\";\n\n  var Channel = function () {\n    // current transaction id, start out at a random *odd* number between 1 and a million\n    // There is one current transaction counter id per page, and it's shared between\n    // channel instances.  That means of all messages posted from a single javascript\n    // evaluation context, we'll never have two with the same id.\n    var s_curTranId = Math.floor(Math.random() * 1000001);\n\n    // no two bound channels in the same javascript evaluation context may have the same origin, scope, and window.\n    // further if two bound channels have the same window and scope, they may not have *overlapping* origins\n    // (either one or both support '*').  This restriction allows a single onMessage handler to efficiently\n    // route messages based on origin and scope.  The s_boundChans maps origins to scopes, to message\n    // handlers.  Request and Notification messages are routed using this table.\n    // Finally, channels are inserted into this table when built, and removed when destroyed.\n    var s_boundChans = {};\n\n    // add a channel to s_boundChans, throwing if a dup exists\n    function s_addBoundChan(win, origin, scope, handler) {\n      function hasWin(arr) {\n        for (var i = 0; i < arr.length; i++) if (arr[i].win === win) return true;\n        return false;\n      }\n\n      // does she exist?\n      var exists = false;\n      if (origin === '*') {\n        // we must check all other origins, sadly.\n        for (var k in s_boundChans) {\n          if (!s_boundChans.hasOwnProperty(k)) continue;\n          if (k === '*') continue;\n          if (typeof s_boundChans[k][scope] === 'object') {\n            exists = hasWin(s_boundChans[k][scope]);\n            if (exists) break;\n          }\n        }\n      } else {\n        // we must check only '*'\n        if (s_boundChans['*'] && s_boundChans['*'][scope]) {\n          exists = hasWin(s_boundChans['*'][scope]);\n        }\n        if (!exists && s_boundChans[origin] && s_boundChans[origin][scope]) {\n          exists = hasWin(s_boundChans[origin][scope]);\n        }\n      }\n      if (exists) throw \"A channel is already bound to the same window which overlaps with origin '\" + origin + \"' and has scope '\" + scope + \"'\";\n      if (typeof s_boundChans[origin] != 'object') s_boundChans[origin] = {};\n      if (typeof s_boundChans[origin][scope] != 'object') s_boundChans[origin][scope] = [];\n      s_boundChans[origin][scope].push({\n        win: win,\n        handler: handler\n      });\n    }\n    function s_removeBoundChan(win, origin, scope) {\n      var arr = s_boundChans[origin][scope];\n      for (var i = 0; i < arr.length; i++) {\n        if (arr[i].win === win) {\n          arr.splice(i, 1);\n        }\n      }\n      if (s_boundChans[origin][scope].length === 0) {\n        delete s_boundChans[origin][scope];\n      }\n    }\n    function s_isArray(obj) {\n      if (Array.isArray) return Array.isArray(obj);else {\n        return obj.constructor.toString().indexOf(\"Array\") != -1;\n      }\n    }\n\n    // No two outstanding outbound messages may have the same id, period.  Given that, a single table\n    // mapping \"transaction ids\" to message handlers, allows efficient routing of Callback, Error, and\n    // Response messages.  Entries are added to this table when requests are sent, and removed when\n    // responses are received.\n    var s_transIds = {};\n\n    // class singleton onMessage handler\n    // this function is registered once and all incoming messages route through here.  This\n    // arrangement allows certain efficiencies, message data is only parsed once and dispatch\n    // is more efficient, especially for large numbers of simultaneous channels.\n    var s_onMessage = function (e) {\n      try {\n        var m = JSON.parse(e.data);\n        if (typeof m !== 'object' || m === null) throw \"malformed\";\n      } catch (e) {\n        // just ignore any posted messages that do not consist of valid JSON\n        return;\n      }\n      var w = e.source;\n      var o = e.origin;\n      var s, i, meth;\n      if (typeof m.method === 'string') {\n        var ar = m.method.split('::');\n        if (ar.length == 2) {\n          s = ar[0];\n          meth = ar[1];\n        } else {\n          meth = m.method;\n        }\n      }\n      if (typeof m.id !== 'undefined') i = m.id;\n\n      // w is message source window\n      // o is message origin\n      // m is parsed message\n      // s is message scope\n      // i is message id (or undefined)\n      // meth is unscoped method name\n      // ^^ based on these factors we can route the message\n\n      // if it has a method it's either a notification or a request,\n      // route using s_boundChans\n      if (typeof meth === 'string') {\n        var delivered = false;\n        if (s_boundChans[o] && s_boundChans[o][s]) {\n          for (var j = 0; j < s_boundChans[o][s].length; j++) {\n            if (s_boundChans[o][s][j].win === w) {\n              s_boundChans[o][s][j].handler(o, meth, m);\n              delivered = true;\n              break;\n            }\n          }\n        }\n        if (!delivered && s_boundChans['*'] && s_boundChans['*'][s]) {\n          for (var j = 0; j < s_boundChans['*'][s].length; j++) {\n            if (s_boundChans['*'][s][j].win === w) {\n              s_boundChans['*'][s][j].handler(o, meth, m);\n              break;\n            }\n          }\n        }\n      }\n      // otherwise it must have an id (or be poorly formed\n      else if (typeof i != 'undefined') {\n        if (s_transIds[i]) s_transIds[i](o, meth, m);\n      }\n    };\n\n    // Setup postMessage event listeners\n    if (window.addEventListener) window.addEventListener('message', s_onMessage, false);else if (window.attachEvent) window.attachEvent('onmessage', s_onMessage);\n\n    /* a messaging channel is constructed from a window and an origin.\n     * the channel will assert that all messages received over the\n     * channel match the origin\n     *\n     * Arguments to Channel.build(cfg):\n     *\n     *   cfg.window - the remote window with which we'll communicate\n     *   cfg.origin - the expected origin of the remote window, may be '*'\n     *                which matches any origin\n     *   cfg.scope  - the 'scope' of messages.  a scope string that is\n     *                prepended to message names.  local and remote endpoints\n     *                of a single channel must agree upon scope. Scope may\n     *                not contain double colons ('::').\n     *   cfg.debugOutput - A boolean value.  If true and window.console.log is\n     *                a function, then debug strings will be emitted to that\n     *                function.\n     *   cfg.postMessageObserver - A function that will be passed two arguments,\n     *                an origin and a message.  It will be passed these immediately\n     *                before messages are posted.\n     *   cfg.gotMessageObserver - A function that will be passed two arguments,\n     *                an origin and a message.  It will be passed these arguments\n     *                immediately after they pass scope and origin checks, but before\n     *                they are processed.\n     *   cfg.onReady - A function that will be invoked when a channel becomes \"ready\",\n     *                this occurs once both sides of the channel have been\n     *                instantiated and an application level handshake is exchanged.\n     *                the onReady function will be passed a single argument which is\n     *                the channel object that was returned from build().\n     *   cfg.reconnect - A boolean value - if true, the channel allows reconnection\n     *                useful when the page in a child frame is reloaded and wants\n     *                to re-establish connection with parent window using the same\n     *                origin, scope and bindings.\n     *   cfg.publish - A boolean value. If true, bind will automatically publish\n     *                the method on the remote side. The method will be published under\n     *                channelObject.remote, but it will not be available before the onReady\n     *                callback is called on the other side.\n     *   cfg.remote - An array of method names for which stubs should be generated without\n     *                waiting for remote end to publish them. A string (for a single method name)\n     *                is also accepted. This allows methods under channelObject.remote to be called\n     *                also before onReady callback is called; the invocations will be queued until\n     *                the channel is ready. If the methods do not exist on remote side, the\n     *                error callback will be called.\n     */\n    return {\n      build: function (cfg) {\n        var debug = function (m) {\n          if (cfg.debugOutput && window.console && window.console.log) {\n            // try to stringify, if it doesn't work we'll let javascript's built in toString do its magic\n            try {\n              if (typeof m !== 'string') {\n                m = JSON.stringify(m);\n              }\n            } catch (e) {}\n            window.console.log(\"[\" + chanId + \"] \" + m);\n          }\n        };\n\n        /* browser capabilities check */\n        if (!window.postMessage) throw \"jschannel cannot run this browser, no postMessage\";\n        if (!window.JSON || !window.JSON.stringify || !window.JSON.parse) {\n          throw \"jschannel cannot run this browser, no JSON parsing/serialization\";\n        }\n\n        /* basic argument validation */\n        if (typeof cfg != 'object') throw \"Channel build invoked without a proper object argument\";\n        if (!cfg.window || !cfg.window.postMessage) throw \"Channel.build() called without a valid window argument\";\n\n        /* we'd have to do a little more work to be able to run multiple channels that intercommunicate the same\n         * window...  Not sure if we care to support that */\n        if (window === cfg.window) debug(\"target window is same as present window -- use at your own risk\");\n\n        // let's require that the client specify an origin.  if we just assume '*' we'll be\n        // propagating unsafe practices.  that would be lame.\n        var validOrigin = false;\n        if (typeof cfg.origin === 'string') {\n          var oMatch;\n          if (cfg.origin === \"*\") validOrigin = true;\n          // allow valid domains under http and https.  Also, trim paths off otherwise valid origins.\n          else if (null !== (oMatch = cfg.origin.match(/^https?:\\/\\/(?:[-a-zA-Z0-9_\\.])+(?::\\d+)?/))) {\n            cfg.origin = oMatch[0].toLowerCase();\n            validOrigin = true;\n          }\n        }\n        if (!validOrigin) throw \"Channel.build() called with an invalid origin\";\n        if (typeof cfg.scope !== 'undefined') {\n          if (typeof cfg.scope !== 'string') throw 'scope, when specified, must be a string';\n          if (cfg.scope.split('::').length > 1) throw \"scope may not contain double colons: '::'\";\n        } else {\n          cfg.scope = \"__default\";\n        }\n\n        /* private variables */\n        // generate a random and psuedo unique id for this channel\n        var chanId = function () {\n          var text = \"\";\n          var alpha = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n          for (var i = 0; i < 5; i++) text += alpha.charAt(Math.floor(Math.random() * alpha.length));\n          return text;\n        }();\n\n        // registrations: mapping method names to call objects\n        var regTbl = {};\n        // current oustanding sent requests\n        var outTbl = {};\n        // current oustanding received requests\n        var inTbl = {};\n        // are we ready yet?  when false we will block outbound messages.\n        var ready = false;\n        var pendingQueue = [];\n        var publishQueue = [];\n        var createTransaction = function (id, origin, callbacks) {\n          var shouldDelayReturn = false;\n          var completed = false;\n          return {\n            origin: origin,\n            invoke: function (cbName, v) {\n              // verify in table\n              if (!inTbl[id]) throw \"attempting to invoke a callback of a nonexistent transaction: \" + id;\n              // verify that the callback name is valid\n              var valid = false;\n              for (var i = 0; i < callbacks.length; i++) if (cbName === callbacks[i]) {\n                valid = true;\n                break;\n              }\n              if (!valid) throw \"request supports no such callback '\" + cbName + \"'\";\n\n              // send callback invocation\n              postMessage({\n                id: id,\n                callback: cbName,\n                params: v\n              });\n            },\n            error: function (error, message) {\n              completed = true;\n              // verify in table\n              if (!inTbl[id]) throw \"error called for nonexistent message: \" + id;\n\n              // remove transaction from table\n              delete inTbl[id];\n\n              // send error\n              postMessage({\n                id: id,\n                error: error,\n                message: message\n              });\n            },\n            complete: function (v) {\n              completed = true;\n              // verify in table\n              if (!inTbl[id]) throw \"complete called for nonexistent message: \" + id;\n              // remove transaction from table\n              delete inTbl[id];\n              // send complete\n              postMessage({\n                id: id,\n                result: v\n              });\n            },\n            delayReturn: function (delay) {\n              if (typeof delay === 'boolean') {\n                shouldDelayReturn = delay === true;\n              }\n              return shouldDelayReturn;\n            },\n            completed: function () {\n              return completed;\n            }\n          };\n        };\n        var setTransactionTimeout = function (transId, timeout, method) {\n          return window.setTimeout(function () {\n            if (outTbl[transId]) {\n              // XXX: what if client code raises an exception here?\n              var msg = \"timeout (\" + timeout + \"ms) exceeded on method '\" + method + \"'\";\n              if (outTbl[transId].error) {\n                outTbl[transId].error(\"timeout_error\", msg);\n              }\n              delete outTbl[transId];\n              delete s_transIds[transId];\n            }\n          }, timeout);\n        };\n        var onMessage = function (origin, method, m) {\n          // if an observer was specified at allocation time, invoke it\n          if (typeof cfg.gotMessageObserver === 'function') {\n            // pass observer a clone of the object so that our\n            // manipulations are not visible (i.e. method unscoping).\n            // This is not particularly efficient, but then we expect\n            // that message observers are primarily for debugging anyway.\n            try {\n              cfg.gotMessageObserver(origin, m);\n            } catch (e) {\n              debug(\"gotMessageObserver() raised an exception: \" + e.toString());\n            }\n          }\n\n          // now, what type of message is this?\n          if (m.id && method) {\n            inTbl[m.id] = {};\n            var trans = createTransaction(m.id, origin, m.callbacks ? m.callbacks : []);\n            // a request!  do we have a registered handler for this request?\n            if (regTbl[method]) {\n              try {\n                // callback handling.  we'll magically create functions inside the parameter list for each\n                // callback\n                if (m.callbacks && s_isArray(m.callbacks) && m.callbacks.length > 0) {\n                  for (var i = 0; i < m.callbacks.length; i++) {\n                    var path = m.callbacks[i];\n                    var obj = m.params;\n                    var pathItems = path.split('/');\n                    for (var j = 0; j < pathItems.length - 1; j++) {\n                      var cp = pathItems[j];\n                      if (typeof obj[cp] !== 'object') obj[cp] = {};\n                      obj = obj[cp];\n                    }\n                    obj[pathItems[pathItems.length - 1]] = function () {\n                      var cbName = path;\n                      return function (params) {\n                        return trans.invoke(cbName, params);\n                      };\n                    }();\n                  }\n                }\n                var resp = regTbl[method](trans, m.params);\n                if (!trans.delayReturn() && !trans.completed()) trans.complete(resp);\n              } catch (e) {\n                // automagic handling of exceptions:\n                var error = \"runtime_error\";\n                var message = null;\n                // * if it's a string then it gets an error code of 'runtime_error' and string is the message\n                if (typeof e === 'string') {\n                  message = e;\n                } else if (typeof e === 'object') {\n                  // if it's an Error instance we use the constructor name to set the error property\n                  // and we just copy the error message\n                  if (e instanceof Error) {\n                    error = e.constructor.name;\n                    message = e.message;\n                  }\n                  // Otherwise, it's either an array or an object\n                  // * if it's an array of length two, then  array[0] is the code, array[1] is the error message\n                  else if (e && s_isArray(e) && e.length == 2) {\n                    error = e[0];\n                    message = e[1];\n                  }\n                  // * if it's an object then we'll look form error and message parameters\n                  else if (typeof e.error === 'string') {\n                    error = e.error;\n                    if (!e.message) message = \"\";else if (typeof e.message === 'string') message = e.message;else e = e.message; // let the stringify/toString message give us a reasonable verbose error string\n                  }\n                }\n\n                // message is *still* null, let's try harder\n                if (message === null) {\n                  try {\n                    message = JSON.stringify(e);\n                    /* On MSIE8, this can result in 'out of memory', which\n                     * leaves message undefined. */\n                    if (typeof message == 'undefined') message = e.toString();\n                  } catch (e2) {\n                    message = e.toString();\n                  }\n                }\n                trans.error(error, message);\n              }\n            } else {\n              // if no method found, send error\n              trans.error(\"method_not_found\", \"No method '\" + method + \"' was (yet) bound by the provider\");\n            }\n          } else if (m.id && m.callback) {\n            if (!outTbl[m.id] || !outTbl[m.id].callbacks || !outTbl[m.id].callbacks[m.callback]) {\n              debug(\"ignoring invalid callback, id:\" + m.id + \" (\" + m.callback + \")\");\n            } else {\n              // XXX: what if client code raises an exception here?\n              outTbl[m.id].callbacks[m.callback](m.params);\n            }\n          } else if (m.id) {\n            if (!outTbl[m.id]) {\n              debug(\"ignoring invalid response: \" + m.id);\n            } else {\n              // XXX: what if client code raises an exception here?\n              if (m.error) {\n                // We might not have an error callback\n                if (outTbl[m.id].error) {\n                  outTbl[m.id].error(m.error, m.message);\n                }\n              } else {\n                // But we always have a success callback\n                if (m.result !== undefined) {\n                  outTbl[m.id].success(m.result);\n                } else {\n                  outTbl[m.id].success();\n                }\n              }\n              delete outTbl[m.id];\n              delete s_transIds[m.id];\n            }\n          } else if (method) {\n            // tis a notification.\n            if (regTbl[method]) {\n              // yep, there's a handler for that.\n              // transaction has only origin for notifications.\n              regTbl[method]({\n                origin: origin\n              }, m.params);\n              // if the client throws, we'll just let it bubble out\n              // what can we do?  Also, here we'll ignore return values\n            }\n          }\n        };\n\n        // now register our bound channel for msg routing\n        s_addBoundChan(cfg.window, cfg.origin, cfg.scope, onMessage);\n\n        // scope method names based on cfg.scope specified when the Channel was instantiated\n        var scopeMethod = function (m) {\n          return [cfg.scope, m].join(\"::\");\n        };\n\n        // a small wrapper around postmessage whose primary function is to handle the\n        // case that clients start sending messages before the other end is \"ready\"\n        var postMessage = function (msg, force) {\n          if (!msg) throw \"postMessage called with null message\";\n\n          // delay posting if we're not ready yet.\n          if (!force && !ready) {\n            debug(\"queue message: \" + JSON.stringify(msg));\n            pendingQueue.push(msg);\n          } else {\n            if (typeof cfg.postMessageObserver === 'function') {\n              try {\n                cfg.postMessageObserver(cfg.origin, msg);\n              } catch (e) {\n                debug(\"postMessageObserver() raised an exception: \" + e.toString());\n              }\n            }\n            debug(\"post message: \" + JSON.stringify(msg) + \" with origin \" + cfg.origin);\n            cfg.window.postMessage(JSON.stringify(msg), cfg.origin);\n          }\n        };\n        var onReady = function (trans, params) {\n          debug('ready msg received');\n          if (ready && !cfg.reconnect) {\n            throw \"received ready message while in ready state.\";\n          }\n          ready = true;\n\n          // only append suffix to chanId once:\n          if (chanId.length < 6) {\n            if (params.type === 'publish-request') {\n              chanId += '-R';\n            } else {\n              chanId += '-L';\n            }\n          }\n          debug('ready msg accepted.');\n          if (params.type === 'publish-request') {\n            obj.notify({\n              method: '__ready',\n              params: {\n                type: 'publish-reply',\n                publish: publishQueue\n              }\n            });\n          }\n          for (var i = 0; i < params.publish.length; i++) {\n            if (params.publish[i].action === \"bind\") {\n              createStubs([params.publish[i].method], obj.remote);\n            } else {\n              // unbind\n              delete obj.remote[params.publish[i].method];\n            }\n          }\n\n          //unbind ready handler unless we allow reconnecting:\n          if (!cfg.reconnect) {\n            obj.unbind('__ready', true); // now this handler isn't needed any more.\n          }\n\n          // flush queue\n          while (pendingQueue.length) {\n            postMessage(pendingQueue.splice(0, 1)[0]);\n          }\n          publishQueue = [];\n          // invoke onReady observer if provided\n          if (typeof cfg.onReady === 'function') cfg.onReady(obj);\n        };\n        var createStubs = function (stubList, targetObj) {\n          stubList = [].concat(stubList); // Coerce into array, allows string to be used for single-item array\n          var method;\n          for (var i = 0; i < stubList.length; i++) {\n            method = stubList[i].toString();\n            targetObj[method] = function (m) {\n              return function (params, success, error) {\n                if (success) {\n                  obj.call({\n                    method: m,\n                    params: params,\n                    success: success,\n                    error: error\n                  });\n                } else {\n                  obj.notify({\n                    method: m,\n                    params: params\n                  });\n                }\n              };\n            }(method);\n          }\n        };\n\n        // Dynamic publish from remote\n        var onBind = function (trans, method) {\n          createStubs([method], obj.remote);\n        };\n\n        // Dynamic unpublish from remote\n        var onUnbind = function (trans, method) {\n          if (obj.remote[method]) {\n            delete obj.remote[method];\n          }\n        };\n        var obj = {\n          remote: {},\n          // tries to unbind a bound message handler.  returns false if not possible\n          unbind: function (method, doNotPublish) {\n            if (regTbl[method]) {\n              if (!delete regTbl[method]) throw \"can't delete method: \" + method;\n              if (cfg.publish && !doNotPublish) {\n                if (ready) {\n                  obj.notify({\n                    method: '__unbind',\n                    params: method\n                  });\n                } else {\n                  publishQueue.push({\n                    action: 'unbind',\n                    method: method\n                  });\n                }\n              }\n              return true;\n            }\n            return false;\n          },\n          bind: function (method, cb, doNotPublish) {\n            if (!method || typeof method !== 'string') throw \"'method' argument to bind must be string\";\n            if (!cb || typeof cb !== 'function') throw \"callback missing from bind params\";\n            if (regTbl[method]) throw \"method '\" + method + \"' is already bound!\";\n            regTbl[method] = cb;\n            if (cfg.publish && !doNotPublish) {\n              if (ready) {\n                obj.notify({\n                  method: '__bind',\n                  params: method\n                });\n              } else {\n                publishQueue.push({\n                  action: 'bind',\n                  method: method\n                });\n              }\n            }\n            return this;\n          },\n          call: function (m) {\n            if (!m) throw 'missing arguments to call function';\n            if (!m.method || typeof m.method !== 'string') throw \"'method' argument to call must be string\";\n            if (!m.success || typeof m.success !== 'function') throw \"'success' callback missing from call\";\n\n            // now it's time to support the 'callback' feature of jschannel.  We'll traverse the argument\n            // object and pick out all of the functions that were passed as arguments.\n            var callbacks = {};\n            var callbackNames = [];\n            var seen = [];\n            var pruneFunctions = function (path, obj) {\n              if (seen.indexOf(obj) >= 0) {\n                throw \"params cannot be a recursive data structure\";\n              }\n              if (obj) {\n                seen.push(obj);\n              }\n              if (typeof obj === 'object') {\n                for (var k in obj) {\n                  if (!obj.hasOwnProperty(k)) continue;\n                  var np = path + (path.length ? '/' : '') + k;\n                  if (typeof obj[k] === 'function') {\n                    callbacks[np] = obj[k];\n                    callbackNames.push(np);\n                    delete obj[k];\n                  } else if (typeof obj[k] === 'object') {\n                    pruneFunctions(np, obj[k]);\n                  }\n                }\n              }\n            };\n            pruneFunctions(\"\", m.params);\n\n            // build a 'request' message and send it\n            var msg = {\n              id: s_curTranId,\n              method: scopeMethod(m.method),\n              params: m.params\n            };\n            if (callbackNames.length) msg.callbacks = callbackNames;\n            if (m.timeout)\n              // XXX: This function returns a timeout ID, but we don't do anything with it.\n              // We might want to keep track of it so we can cancel it using clearTimeout()\n              // when the transaction completes.\n              setTransactionTimeout(s_curTranId, m.timeout, scopeMethod(m.method));\n\n            // insert into the transaction table\n            outTbl[s_curTranId] = {\n              callbacks: callbacks,\n              error: m.error,\n              success: m.success\n            };\n            s_transIds[s_curTranId] = onMessage;\n\n            // increment current id\n            s_curTranId++;\n            postMessage(msg);\n          },\n          notify: function (m) {\n            if (!m) throw 'missing arguments to notify function';\n            if (!m.method || typeof m.method !== 'string') throw \"'method' argument to notify must be string\";\n\n            // no need to go into any transaction table\n            postMessage({\n              method: scopeMethod(m.method),\n              params: m.params\n            });\n          },\n          destroy: function () {\n            s_removeBoundChan(cfg.window, cfg.origin, cfg.scope);\n            if (window.removeEventListener) window.removeEventListener('message', onMessage, false);else if (window.detachEvent) window.detachEvent('onmessage', onMessage);\n            ready = false;\n            regTbl = {};\n            inTbl = {};\n            outTbl = {};\n            cfg.origin = null;\n            pendingQueue = [];\n            debug(\"channel destroyed\");\n            chanId = \"\";\n          }\n        };\n        obj.bind('__ready', onReady, true);\n        obj.bind('__bind', onBind, true);\n        obj.bind('__unbind', onUnbind, true);\n        if (cfg.remote) {\n          createStubs(cfg.remote, obj.remote);\n        }\n        setTimeout(function () {\n          if (chanId.length > 0) {\n            // The channel might already have been destroyed\n            postMessage({\n              method: scopeMethod('__ready'),\n              params: {\n                type: \"publish-request\",\n                publish: publishQueue\n              }\n            }, true);\n          }\n        }, 0);\n        return obj;\n      }\n    };\n  }();\n  return Channel;\n});","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function (window, document, exportName, undefined) {\n  'use strict';\n\n  var VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\n  var TEST_ELEMENT = document.createElement('div');\n  var TYPE_FUNCTION = 'function';\n  var round = Math.round;\n  var abs = Math.abs;\n  var now = Date.now;\n\n  /**\n   * set a timeout with a given scope\n   * @param {Function} fn\n   * @param {Number} timeout\n   * @param {Object} context\n   * @returns {number}\n   */\n  function setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n  }\n\n  /**\n   * if the argument is an array, we want to execute the fn on each entry\n   * if it aint an array we don't want to do a thing.\n   * this is used by all the methods that accept a single and array argument.\n   * @param {*|Array} arg\n   * @param {String} fn\n   * @param {Object} [context]\n   * @returns {Boolean}\n   */\n  function invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n      each(arg, context[fn], context);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * walk objects and arrays\n   * @param {Object} obj\n   * @param {Function} iterator\n   * @param {Object} context\n   */\n  function each(obj, iterator, context) {\n    var i;\n    if (!obj) {\n      return;\n    }\n    if (obj.forEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n      i = 0;\n      while (i < obj.length) {\n        iterator.call(context, obj[i], i, obj);\n        i++;\n      }\n    } else {\n      for (i in obj) {\n        obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n      }\n    }\n  }\n\n  /**\n   * wrap a method with a deprecation warning and stack trace\n   * @param {Function} method\n   * @param {String} name\n   * @param {String} message\n   * @returns {Function} A new function wrapping the supplied method.\n   */\n  function deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function () {\n      var e = new Error('get-stack-trace');\n      var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '').replace(/^\\s+at\\s+/gm, '').replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n      var log = window.console && (window.console.warn || window.console.log);\n      if (log) {\n        log.call(window.console, deprecationMessage, stack);\n      }\n      return method.apply(this, arguments);\n    };\n  }\n\n  /**\n   * extend object.\n   * means that properties in dest will be overwritten by the ones in src.\n   * @param {Object} target\n   * @param {...Object} objects_to_assign\n   * @returns {Object} target\n   */\n  var assign;\n  if (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n      if (target === undefined || target === null) {\n        throw new TypeError('Cannot convert undefined or null to object');\n      }\n      var output = Object(target);\n      for (var index = 1; index < arguments.length; index++) {\n        var source = arguments[index];\n        if (source !== undefined && source !== null) {\n          for (var nextKey in source) {\n            if (source.hasOwnProperty(nextKey)) {\n              output[nextKey] = source[nextKey];\n            }\n          }\n        }\n      }\n      return output;\n    };\n  } else {\n    assign = Object.assign;\n  }\n\n  /**\n   * extend object.\n   * means that properties in dest will be overwritten by the ones in src.\n   * @param {Object} dest\n   * @param {Object} src\n   * @param {Boolean} [merge=false]\n   * @returns {Object} dest\n   */\n  var extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n      if (!merge || merge && dest[keys[i]] === undefined) {\n        dest[keys[i]] = src[keys[i]];\n      }\n      i++;\n    }\n    return dest;\n  }, 'extend', 'Use `assign`.');\n\n  /**\n   * merge the values from src in the dest.\n   * means that properties that exist in dest will not be overwritten by src\n   * @param {Object} dest\n   * @param {Object} src\n   * @returns {Object} dest\n   */\n  var merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n  }, 'merge', 'Use `assign`.');\n\n  /**\n   * simple class inheritance\n   * @param {Function} child\n   * @param {Function} base\n   * @param {Object} [properties]\n   */\n  function inherit(child, base, properties) {\n    var baseP = base.prototype,\n      childP;\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n    if (properties) {\n      assign(childP, properties);\n    }\n  }\n\n  /**\n   * simple function bind\n   * @param {Function} fn\n   * @param {Object} context\n   * @returns {Function}\n   */\n  function bindFn(fn, context) {\n    return function boundFn() {\n      return fn.apply(context, arguments);\n    };\n  }\n\n  /**\n   * let a boolean value also be a function that must return a boolean\n   * this first item in args will be used as the context\n   * @param {Boolean|Function} val\n   * @param {Array} [args]\n   * @returns {Boolean}\n   */\n  function boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n      return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n  }\n\n  /**\n   * use the val2 when val1 is undefined\n   * @param {*} val1\n   * @param {*} val2\n   * @returns {*}\n   */\n  function ifUndefined(val1, val2) {\n    return val1 === undefined ? val2 : val1;\n  }\n\n  /**\n   * addEventListener with multiple events at once\n   * @param {EventTarget} target\n   * @param {String} types\n   * @param {Function} handler\n   */\n  function addEventListeners(target, types, handler) {\n    each(splitStr(types), function (type) {\n      target.addEventListener(type, handler, false);\n    });\n  }\n\n  /**\n   * removeEventListener with multiple events at once\n   * @param {EventTarget} target\n   * @param {String} types\n   * @param {Function} handler\n   */\n  function removeEventListeners(target, types, handler) {\n    each(splitStr(types), function (type) {\n      target.removeEventListener(type, handler, false);\n    });\n  }\n\n  /**\n   * find if a node is in the given parent\n   * @method hasParent\n   * @param {HTMLElement} node\n   * @param {HTMLElement} parent\n   * @return {Boolean} found\n   */\n  function hasParent(node, parent) {\n    while (node) {\n      if (node == parent) {\n        return true;\n      }\n      node = node.parentNode;\n    }\n    return false;\n  }\n\n  /**\n   * small indexOf wrapper\n   * @param {String} str\n   * @param {String} find\n   * @returns {Boolean} found\n   */\n  function inStr(str, find) {\n    return str.indexOf(find) > -1;\n  }\n\n  /**\n   * split string on whitespace\n   * @param {String} str\n   * @returns {Array} words\n   */\n  function splitStr(str) {\n    return str.trim().split(/\\s+/g);\n  }\n\n  /**\n   * find if a array contains the object using indexOf or a simple polyFill\n   * @param {Array} src\n   * @param {String} find\n   * @param {String} [findByKey]\n   * @return {Boolean|Number} false when not found, or the index\n   */\n  function inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n      return src.indexOf(find);\n    } else {\n      var i = 0;\n      while (i < src.length) {\n        if (findByKey && src[i][findByKey] == find || !findByKey && src[i] === find) {\n          return i;\n        }\n        i++;\n      }\n      return -1;\n    }\n  }\n\n  /**\n   * convert array-like objects to real arrays\n   * @param {Object} obj\n   * @returns {Array}\n   */\n  function toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n  }\n\n  /**\n   * unique array with objects based on a key (like 'id') or just by the array's value\n   * @param {Array} src [{id:1},{id:2},{id:1}]\n   * @param {String} [key]\n   * @param {Boolean} [sort=False]\n   * @returns {Array} [{id:1},{id:2}]\n   */\n  function uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n    while (i < src.length) {\n      var val = key ? src[i][key] : src[i];\n      if (inArray(values, val) < 0) {\n        results.push(src[i]);\n      }\n      values[i] = val;\n      i++;\n    }\n    if (sort) {\n      if (!key) {\n        results = results.sort();\n      } else {\n        results = results.sort(function sortUniqueArray(a, b) {\n          return a[key] > b[key];\n        });\n      }\n    }\n    return results;\n  }\n\n  /**\n   * get the prefixed property\n   * @param {Object} obj\n   * @param {String} property\n   * @returns {String|Undefined} prefixed\n   */\n  function prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n      prefix = VENDOR_PREFIXES[i];\n      prop = prefix ? prefix + camelProp : property;\n      if (prop in obj) {\n        return prop;\n      }\n      i++;\n    }\n    return undefined;\n  }\n\n  /**\n   * get a unique id\n   * @returns {number} uniqueId\n   */\n  var _uniqueId = 1;\n  function uniqueId() {\n    return _uniqueId++;\n  }\n\n  /**\n   * get the window object of an element\n   * @param {HTMLElement} element\n   * @returns {DocumentView|Window}\n   */\n  function getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return doc.defaultView || doc.parentWindow || window;\n  }\n  var MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n  var SUPPORT_TOUCH = 'ontouchstart' in window;\n  var SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\n  var SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n  var INPUT_TYPE_TOUCH = 'touch';\n  var INPUT_TYPE_PEN = 'pen';\n  var INPUT_TYPE_MOUSE = 'mouse';\n  var INPUT_TYPE_KINECT = 'kinect';\n  var COMPUTE_INTERVAL = 25;\n  var INPUT_START = 1;\n  var INPUT_MOVE = 2;\n  var INPUT_END = 4;\n  var INPUT_CANCEL = 8;\n  var DIRECTION_NONE = 1;\n  var DIRECTION_LEFT = 2;\n  var DIRECTION_RIGHT = 4;\n  var DIRECTION_UP = 8;\n  var DIRECTION_DOWN = 16;\n  var DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\n  var DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\n  var DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n  var PROPS_XY = ['x', 'y'];\n  var PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n  /**\n   * create new input type manager\n   * @param {Manager} manager\n   * @param {Function} callback\n   * @returns {Input}\n   * @constructor\n   */\n  function Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function (ev) {\n      if (boolOrFn(manager.options.enable, [manager])) {\n        self.handler(ev);\n      }\n    };\n    this.init();\n  }\n  Input.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function () {},\n    /**\n     * bind the events\n     */\n    init: function () {\n      this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n      this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n      this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n    /**\n     * unbind the events\n     */\n    destroy: function () {\n      this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n      this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n      this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n  };\n\n  /**\n   * create new input type manager\n   * called by the Manager constructor\n   * @param {Hammer} manager\n   * @returns {Input}\n   */\n  function createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n    if (inputClass) {\n      Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n      Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n      Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n      Type = MouseInput;\n    } else {\n      Type = TouchMouseInput;\n    }\n    return new Type(manager, inputHandler);\n  }\n\n  /**\n   * handle input events\n   * @param {Manager} manager\n   * @param {String} eventType\n   * @param {Object} input\n   */\n  function inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = eventType & INPUT_START && pointersLen - changedPointersLen === 0;\n    var isFinal = eventType & (INPUT_END | INPUT_CANCEL) && pointersLen - changedPointersLen === 0;\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n    if (isFirst) {\n      manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n    manager.recognize(input);\n    manager.session.prevInput = input;\n  }\n\n  /**\n   * extend the data with some usable properties like scale, rotate, velocity etc\n   * @param {Object} manager\n   * @param {Object} input\n   */\n  function computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n      session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n      session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n      session.firstMultiple = false;\n    }\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = abs(overallVelocity.x) > abs(overallVelocity.y) ? overallVelocity.x : overallVelocity.y;\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n    input.maxPointers = !session.prevInput ? input.pointers.length : input.pointers.length > session.prevInput.maxPointers ? input.pointers.length : session.prevInput.maxPointers;\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n      target = input.srcEvent.target;\n    }\n    input.target = target;\n  }\n  function computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n      prevDelta = session.prevDelta = {\n        x: prevInput.deltaX || 0,\n        y: prevInput.deltaY || 0\n      };\n      offset = session.offsetDelta = {\n        x: center.x,\n        y: center.y\n      };\n    }\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n  }\n\n  /**\n   * velocity is calculated every x ms\n   * @param {Object} session\n   * @param {Object} input\n   */\n  function computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n      deltaTime = input.timeStamp - last.timeStamp,\n      velocity,\n      velocityX,\n      velocityY,\n      direction;\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n      var deltaX = input.deltaX - last.deltaX;\n      var deltaY = input.deltaY - last.deltaY;\n      var v = getVelocity(deltaTime, deltaX, deltaY);\n      velocityX = v.x;\n      velocityY = v.y;\n      velocity = abs(v.x) > abs(v.y) ? v.x : v.y;\n      direction = getDirection(deltaX, deltaY);\n      session.lastInterval = input;\n    } else {\n      // use latest velocity info if it doesn't overtake a minimum period\n      velocity = last.velocity;\n      velocityX = last.velocityX;\n      velocityY = last.velocityY;\n      direction = last.direction;\n    }\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n  }\n\n  /**\n   * create a simple clone from the input used for storage of firstInput and firstMultiple\n   * @param {Object} input\n   * @returns {Object} clonedInputData\n   */\n  function simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n      pointers[i] = {\n        clientX: round(input.pointers[i].clientX),\n        clientY: round(input.pointers[i].clientY)\n      };\n      i++;\n    }\n    return {\n      timeStamp: now(),\n      pointers: pointers,\n      center: getCenter(pointers),\n      deltaX: input.deltaX,\n      deltaY: input.deltaY\n    };\n  }\n\n  /**\n   * get the center of all the pointers\n   * @param {Array} pointers\n   * @return {Object} center contains `x` and `y` properties\n   */\n  function getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n      return {\n        x: round(pointers[0].clientX),\n        y: round(pointers[0].clientY)\n      };\n    }\n    var x = 0,\n      y = 0,\n      i = 0;\n    while (i < pointersLength) {\n      x += pointers[i].clientX;\n      y += pointers[i].clientY;\n      i++;\n    }\n    return {\n      x: round(x / pointersLength),\n      y: round(y / pointersLength)\n    };\n  }\n\n  /**\n   * calculate the velocity between two points. unit is in px per ms.\n   * @param {Number} deltaTime\n   * @param {Number} x\n   * @param {Number} y\n   * @return {Object} velocity `x` and `y`\n   */\n  function getVelocity(deltaTime, x, y) {\n    return {\n      x: x / deltaTime || 0,\n      y: y / deltaTime || 0\n    };\n  }\n\n  /**\n   * get the direction between two points\n   * @param {Number} x\n   * @param {Number} y\n   * @return {Number} direction\n   */\n  function getDirection(x, y) {\n    if (x === y) {\n      return DIRECTION_NONE;\n    }\n    if (abs(x) >= abs(y)) {\n      return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n  }\n\n  /**\n   * calculate the absolute distance between two points\n   * @param {Object} p1 {x, y}\n   * @param {Object} p2 {x, y}\n   * @param {Array} [props] containing x and y keys\n   * @return {Number} distance\n   */\n  function getDistance(p1, p2, props) {\n    if (!props) {\n      props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n      y = p2[props[1]] - p1[props[1]];\n    return Math.sqrt(x * x + y * y);\n  }\n\n  /**\n   * calculate the angle between two coordinates\n   * @param {Object} p1\n   * @param {Object} p2\n   * @param {Array} [props] containing x and y keys\n   * @return {Number} angle\n   */\n  function getAngle(p1, p2, props) {\n    if (!props) {\n      props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n      y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n  }\n\n  /**\n   * calculate the rotation degrees between two pointersets\n   * @param {Array} start array of pointers\n   * @param {Array} end array of pointers\n   * @return {Number} rotation\n   */\n  function getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n  }\n\n  /**\n   * calculate the scale factor between two pointersets\n   * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n   * @param {Array} start array of pointers\n   * @param {Array} end array of pointers\n   * @return {Number} scale\n   */\n  function getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n  }\n  var MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n  };\n  var MOUSE_ELEMENT_EVENTS = 'mousedown';\n  var MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n  /**\n   * Mouse events input\n   * @constructor\n   * @extends Input\n   */\n  function MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n  }\n  inherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n      var eventType = MOUSE_INPUT_MAP[ev.type];\n\n      // on start we want to have the left mouse button down\n      if (eventType & INPUT_START && ev.button === 0) {\n        this.pressed = true;\n      }\n      if (eventType & INPUT_MOVE && ev.which !== 1) {\n        eventType = INPUT_END;\n      }\n\n      // mouse must be down\n      if (!this.pressed) {\n        return;\n      }\n      if (eventType & INPUT_END) {\n        this.pressed = false;\n      }\n      this.callback(this.manager, eventType, {\n        pointers: [ev],\n        changedPointers: [ev],\n        pointerType: INPUT_TYPE_MOUSE,\n        srcEvent: ev\n      });\n    }\n  });\n  var POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n  };\n\n  // in IE10 the pointer types is defined as an enum\n  var IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n  };\n  var POINTER_ELEMENT_EVENTS = 'pointerdown';\n  var POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n  // IE10 has prefixed support, and case-sensitive\n  if (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n  }\n\n  /**\n   * Pointer events input\n   * @constructor\n   * @extends Input\n   */\n  function PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n    Input.apply(this, arguments);\n    this.store = this.manager.session.pointerEvents = [];\n  }\n  inherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n      var store = this.store;\n      var removePointer = false;\n      var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n      var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n      var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n      var isTouch = pointerType == INPUT_TYPE_TOUCH;\n\n      // get index of the event in the store\n      var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n      // start and mouse must be down\n      if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n        if (storeIndex < 0) {\n          store.push(ev);\n          storeIndex = store.length - 1;\n        }\n      } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        removePointer = true;\n      }\n\n      // it not found, so the pointer hasn't been down (so it's probably a hover)\n      if (storeIndex < 0) {\n        return;\n      }\n\n      // update the event in the store\n      store[storeIndex] = ev;\n      this.callback(this.manager, eventType, {\n        pointers: store,\n        changedPointers: [ev],\n        pointerType: pointerType,\n        srcEvent: ev\n      });\n      if (removePointer) {\n        // remove from the store\n        store.splice(storeIndex, 1);\n      }\n    }\n  });\n  var SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n  };\n  var SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\n  var SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n  /**\n   * Touch events input\n   * @constructor\n   * @extends Input\n   */\n  function SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n    Input.apply(this, arguments);\n  }\n  inherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n      var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n      // should we handle the touch events?\n      if (type === INPUT_START) {\n        this.started = true;\n      }\n      if (!this.started) {\n        return;\n      }\n      var touches = normalizeSingleTouches.call(this, ev, type);\n\n      // when done, reset the started state\n      if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n        this.started = false;\n      }\n      this.callback(this.manager, type, {\n        pointers: touches[0],\n        changedPointers: touches[1],\n        pointerType: INPUT_TYPE_TOUCH,\n        srcEvent: ev\n      });\n    }\n  });\n\n  /**\n   * @this {TouchInput}\n   * @param {Object} ev\n   * @param {Number} type flag\n   * @returns {undefined|Array} [all, changed]\n   */\n  function normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n      all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n    return [all, changed];\n  }\n  var TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n  };\n  var TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n  /**\n   * Multi-user touch events input\n   * @constructor\n   * @extends Input\n   */\n  function TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n    Input.apply(this, arguments);\n  }\n  inherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n      var type = TOUCH_INPUT_MAP[ev.type];\n      var touches = getTouches.call(this, ev, type);\n      if (!touches) {\n        return;\n      }\n      this.callback(this.manager, type, {\n        pointers: touches[0],\n        changedPointers: touches[1],\n        pointerType: INPUT_TYPE_TOUCH,\n        srcEvent: ev\n      });\n    }\n  });\n\n  /**\n   * @this {TouchInput}\n   * @param {Object} ev\n   * @param {Number} type flag\n   * @returns {undefined|Array} [all, changed]\n   */\n  function getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n      targetIds[allTouches[0].identifier] = true;\n      return [allTouches, allTouches];\n    }\n    var i,\n      targetTouches,\n      changedTouches = toArray(ev.changedTouches),\n      changedTargetTouches = [],\n      target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function (touch) {\n      return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n      i = 0;\n      while (i < targetTouches.length) {\n        targetIds[targetTouches[i].identifier] = true;\n        i++;\n      }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n      if (targetIds[changedTouches[i].identifier]) {\n        changedTargetTouches.push(changedTouches[i]);\n      }\n\n      // cleanup removed touches\n      if (type & (INPUT_END | INPUT_CANCEL)) {\n        delete targetIds[changedTouches[i].identifier];\n      }\n      i++;\n    }\n    if (!changedTargetTouches.length) {\n      return;\n    }\n    return [\n    // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n    uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true), changedTargetTouches];\n  }\n\n  /**\n   * Combined touch and mouse input\n   *\n   * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n   * This because touch devices also emit mouse events while doing a touch.\n   *\n   * @constructor\n   * @extends Input\n   */\n\n  var DEDUP_TIMEOUT = 2500;\n  var DEDUP_DISTANCE = 25;\n  function TouchMouseInput() {\n    Input.apply(this, arguments);\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n    this.primaryTouch = null;\n    this.lastTouches = [];\n  }\n  inherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n      var isTouch = inputData.pointerType == INPUT_TYPE_TOUCH,\n        isMouse = inputData.pointerType == INPUT_TYPE_MOUSE;\n      if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n        return;\n      }\n\n      // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n      if (isTouch) {\n        recordTouches.call(this, inputEvent, inputData);\n      } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n        return;\n      }\n      this.callback(manager, inputEvent, inputData);\n    },\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n      this.touch.destroy();\n      this.mouse.destroy();\n    }\n  });\n  function recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n      this.primaryTouch = eventData.changedPointers[0].identifier;\n      setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n      setLastTouch.call(this, eventData);\n    }\n  }\n  function setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n    if (touch.identifier === this.primaryTouch) {\n      var lastTouch = {\n        x: touch.clientX,\n        y: touch.clientY\n      };\n      this.lastTouches.push(lastTouch);\n      var lts = this.lastTouches;\n      var removeLastTouch = function () {\n        var i = lts.indexOf(lastTouch);\n        if (i > -1) {\n          lts.splice(i, 1);\n        }\n      };\n      setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n  }\n  function isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX,\n      y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n      var t = this.lastTouches[i];\n      var dx = Math.abs(x - t.x),\n        dy = Math.abs(y - t.y);\n      if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n        return true;\n      }\n    }\n    return false;\n  }\n  var PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\n  var NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n  // magical touchAction value\n  var TOUCH_ACTION_COMPUTE = 'compute';\n  var TOUCH_ACTION_AUTO = 'auto';\n  var TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\n  var TOUCH_ACTION_NONE = 'none';\n  var TOUCH_ACTION_PAN_X = 'pan-x';\n  var TOUCH_ACTION_PAN_Y = 'pan-y';\n  var TOUCH_ACTION_MAP = getTouchActionProps();\n\n  /**\n   * Touch Action\n   * sets the touchAction property or uses the js alternative\n   * @param {Manager} manager\n   * @param {String} value\n   * @constructor\n   */\n  function TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n  }\n  TouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function (value) {\n      // find out the touch-action by the event handlers\n      if (value == TOUCH_ACTION_COMPUTE) {\n        value = this.compute();\n      }\n      if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n        this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n      }\n      this.actions = value.toLowerCase().trim();\n    },\n    /**\n     * just re-set the touchAction value\n     */\n    update: function () {\n      this.set(this.manager.options.touchAction);\n    },\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function () {\n      var actions = [];\n      each(this.manager.recognizers, function (recognizer) {\n        if (boolOrFn(recognizer.options.enable, [recognizer])) {\n          actions = actions.concat(recognizer.getTouchAction());\n        }\n      });\n      return cleanTouchActions(actions.join(' '));\n    },\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function (input) {\n      var srcEvent = input.srcEvent;\n      var direction = input.offsetDirection;\n\n      // if the touch action did prevented once this session\n      if (this.manager.session.prevented) {\n        srcEvent.preventDefault();\n        return;\n      }\n      var actions = this.actions;\n      var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n      var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n      var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n      if (hasNone) {\n        //do not prevent defaults if this is a tap gesture\n\n        var isTapPointer = input.pointers.length === 1;\n        var isTapMovement = input.distance < 2;\n        var isTapTouchTime = input.deltaTime < 250;\n        if (isTapPointer && isTapMovement && isTapTouchTime) {\n          return;\n        }\n      }\n      if (hasPanX && hasPanY) {\n        // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n        return;\n      }\n      if (hasNone || hasPanY && direction & DIRECTION_HORIZONTAL || hasPanX && direction & DIRECTION_VERTICAL) {\n        return this.preventSrc(srcEvent);\n      }\n    },\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function (srcEvent) {\n      this.manager.session.prevented = true;\n      srcEvent.preventDefault();\n    }\n  };\n\n  /**\n   * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n   * @param {String} actions\n   * @returns {*}\n   */\n  function cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n      return TOUCH_ACTION_NONE;\n    }\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n      return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n      return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n      return TOUCH_ACTION_MANIPULATION;\n    }\n    return TOUCH_ACTION_AUTO;\n  }\n  function getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n      return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function (val) {\n      // If css.supports is not supported but there is native touch-action assume it supports\n      // all values. This is the case for IE 10 and 11.\n      touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n  }\n\n  /**\n   * Recognizer flow explained; *\n   * All recognizers have the initial state of POSSIBLE when a input session starts.\n   * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n   * Example session for mouse-input: mousedown -> mousemove -> mouseup\n   *\n   * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n   * which determines with state it should be.\n   *\n   * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n   * POSSIBLE to give it another change on the next cycle.\n   *\n   *               Possible\n   *                  |\n   *            +-----+---------------+\n   *            |                     |\n   *      +-----+-----+               |\n   *      |           |               |\n   *   Failed      Cancelled          |\n   *                          +-------+------+\n   *                          |              |\n   *                      Recognized       Began\n   *                                         |\n   *                                      Changed\n   *                                         |\n   *                                  Ended/Recognized\n   */\n  var STATE_POSSIBLE = 1;\n  var STATE_BEGAN = 2;\n  var STATE_CHANGED = 4;\n  var STATE_ENDED = 8;\n  var STATE_RECOGNIZED = STATE_ENDED;\n  var STATE_CANCELLED = 16;\n  var STATE_FAILED = 32;\n\n  /**\n   * Recognizer\n   * Every recognizer needs to extend from this class.\n   * @constructor\n   * @param {Object} options\n   */\n  function Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n    this.id = uniqueId();\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n    this.state = STATE_POSSIBLE;\n    this.simultaneous = {};\n    this.requireFail = [];\n  }\n  Recognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function (options) {\n      assign(this.options, options);\n\n      // also update the touchAction, in case something changed about the directions/enabled state\n      this.manager && this.manager.touchAction.update();\n      return this;\n    },\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function (otherRecognizer) {\n      if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n        return this;\n      }\n      var simultaneous = this.simultaneous;\n      otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n      if (!simultaneous[otherRecognizer.id]) {\n        simultaneous[otherRecognizer.id] = otherRecognizer;\n        otherRecognizer.recognizeWith(this);\n      }\n      return this;\n    },\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function (otherRecognizer) {\n      if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n        return this;\n      }\n      otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n      delete this.simultaneous[otherRecognizer.id];\n      return this;\n    },\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function (otherRecognizer) {\n      if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n        return this;\n      }\n      var requireFail = this.requireFail;\n      otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n      if (inArray(requireFail, otherRecognizer) === -1) {\n        requireFail.push(otherRecognizer);\n        otherRecognizer.requireFailure(this);\n      }\n      return this;\n    },\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function (otherRecognizer) {\n      if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n        return this;\n      }\n      otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n      var index = inArray(this.requireFail, otherRecognizer);\n      if (index > -1) {\n        this.requireFail.splice(index, 1);\n      }\n      return this;\n    },\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function () {\n      return this.requireFail.length > 0;\n    },\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function (otherRecognizer) {\n      return !!this.simultaneous[otherRecognizer.id];\n    },\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function (input) {\n      var self = this;\n      var state = this.state;\n      function emit(event) {\n        self.manager.emit(event, input);\n      }\n\n      // 'panstart' and 'panmove'\n      if (state < STATE_ENDED) {\n        emit(self.options.event + stateStr(state));\n      }\n      emit(self.options.event); // simple 'eventName' events\n\n      if (input.additionalEvent) {\n        // additional event(panleft, panright, pinchin, pinchout...)\n        emit(input.additionalEvent);\n      }\n\n      // panend and pancancel\n      if (state >= STATE_ENDED) {\n        emit(self.options.event + stateStr(state));\n      }\n    },\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function (input) {\n      if (this.canEmit()) {\n        return this.emit(input);\n      }\n      // it's failing anyway\n      this.state = STATE_FAILED;\n    },\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function () {\n      var i = 0;\n      while (i < this.requireFail.length) {\n        if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n          return false;\n        }\n        i++;\n      }\n      return true;\n    },\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function (inputData) {\n      // make a new copy of the inputData\n      // so we can change the inputData without messing up the other recognizers\n      var inputDataClone = assign({}, inputData);\n\n      // is is enabled and allow recognizing?\n      if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n        this.reset();\n        this.state = STATE_FAILED;\n        return;\n      }\n\n      // reset when we've reached the end\n      if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n        this.state = STATE_POSSIBLE;\n      }\n      this.state = this.process(inputDataClone);\n\n      // the recognizer has recognized a gesture\n      // so trigger an event\n      if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n        this.tryEmit(inputDataClone);\n      }\n    },\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function (inputData) {},\n    // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function () {},\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function () {}\n  };\n\n  /**\n   * get a usable string, used as event postfix\n   * @param {Const} state\n   * @returns {String} state\n   */\n  function stateStr(state) {\n    if (state & STATE_CANCELLED) {\n      return 'cancel';\n    } else if (state & STATE_ENDED) {\n      return 'end';\n    } else if (state & STATE_CHANGED) {\n      return 'move';\n    } else if (state & STATE_BEGAN) {\n      return 'start';\n    }\n    return '';\n  }\n\n  /**\n   * direction cons to string\n   * @param {Const} direction\n   * @returns {String}\n   */\n  function directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n      return 'down';\n    } else if (direction == DIRECTION_UP) {\n      return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n      return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n      return 'right';\n    }\n    return '';\n  }\n\n  /**\n   * get a recognizer by name if it is bound to a manager\n   * @param {Recognizer|String} otherRecognizer\n   * @param {Recognizer} recognizer\n   * @returns {Recognizer}\n   */\n  function getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n      return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n  }\n\n  /**\n   * This recognizer is just used as a base for the simple attribute recognizers.\n   * @constructor\n   * @extends Recognizer\n   */\n  function AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n  }\n  inherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n      /**\n       * @type {Number}\n       * @default 1\n       */\n      pointers: 1\n    },\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function (input) {\n      var optionPointers = this.options.pointers;\n      return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function (input) {\n      var state = this.state;\n      var eventType = input.eventType;\n      var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n      var isValid = this.attrTest(input);\n\n      // on cancel input and we've recognized before, return STATE_CANCELLED\n      if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n        return state | STATE_CANCELLED;\n      } else if (isRecognized || isValid) {\n        if (eventType & INPUT_END) {\n          return state | STATE_ENDED;\n        } else if (!(state & STATE_BEGAN)) {\n          return STATE_BEGAN;\n        }\n        return state | STATE_CHANGED;\n      }\n      return STATE_FAILED;\n    }\n  });\n\n  /**\n   * Pan\n   * Recognized when the pointer is down and moved in the allowed direction.\n   * @constructor\n   * @extends AttrRecognizer\n   */\n  function PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n    this.pX = null;\n    this.pY = null;\n  }\n  inherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n      event: 'pan',\n      threshold: 10,\n      pointers: 1,\n      direction: DIRECTION_ALL\n    },\n    getTouchAction: function () {\n      var direction = this.options.direction;\n      var actions = [];\n      if (direction & DIRECTION_HORIZONTAL) {\n        actions.push(TOUCH_ACTION_PAN_Y);\n      }\n      if (direction & DIRECTION_VERTICAL) {\n        actions.push(TOUCH_ACTION_PAN_X);\n      }\n      return actions;\n    },\n    directionTest: function (input) {\n      var options = this.options;\n      var hasMoved = true;\n      var distance = input.distance;\n      var direction = input.direction;\n      var x = input.deltaX;\n      var y = input.deltaY;\n\n      // lock to axis?\n      if (!(direction & options.direction)) {\n        if (options.direction & DIRECTION_HORIZONTAL) {\n          direction = x === 0 ? DIRECTION_NONE : x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n          hasMoved = x != this.pX;\n          distance = Math.abs(input.deltaX);\n        } else {\n          direction = y === 0 ? DIRECTION_NONE : y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n          hasMoved = y != this.pY;\n          distance = Math.abs(input.deltaY);\n        }\n      }\n      input.direction = direction;\n      return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n    attrTest: function (input) {\n      return AttrRecognizer.prototype.attrTest.call(this, input) && (this.state & STATE_BEGAN || !(this.state & STATE_BEGAN) && this.directionTest(input));\n    },\n    emit: function (input) {\n      this.pX = input.deltaX;\n      this.pY = input.deltaY;\n      var direction = directionStr(input.direction);\n      if (direction) {\n        input.additionalEvent = this.options.event + direction;\n      }\n      this._super.emit.call(this, input);\n    }\n  });\n\n  /**\n   * Pinch\n   * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n   * @constructor\n   * @extends AttrRecognizer\n   */\n  function PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n  }\n  inherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n      event: 'pinch',\n      threshold: 0,\n      pointers: 2\n    },\n    getTouchAction: function () {\n      return [TOUCH_ACTION_NONE];\n    },\n    attrTest: function (input) {\n      return this._super.attrTest.call(this, input) && (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n    emit: function (input) {\n      if (input.scale !== 1) {\n        var inOut = input.scale < 1 ? 'in' : 'out';\n        input.additionalEvent = this.options.event + inOut;\n      }\n      this._super.emit.call(this, input);\n    }\n  });\n\n  /**\n   * Press\n   * Recognized when the pointer is down for x ms without any movement.\n   * @constructor\n   * @extends Recognizer\n   */\n  function PressRecognizer() {\n    Recognizer.apply(this, arguments);\n    this._timer = null;\n    this._input = null;\n  }\n  inherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n      event: 'press',\n      pointers: 1,\n      time: 251,\n      // minimal time of the pointer to be pressed\n      threshold: 9 // a minimal movement is ok, but keep it low\n    },\n    getTouchAction: function () {\n      return [TOUCH_ACTION_AUTO];\n    },\n    process: function (input) {\n      var options = this.options;\n      var validPointers = input.pointers.length === options.pointers;\n      var validMovement = input.distance < options.threshold;\n      var validTime = input.deltaTime > options.time;\n      this._input = input;\n\n      // we only allow little movement\n      // and we've reached an end event, so a tap is possible\n      if (!validMovement || !validPointers || input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime) {\n        this.reset();\n      } else if (input.eventType & INPUT_START) {\n        this.reset();\n        this._timer = setTimeoutContext(function () {\n          this.state = STATE_RECOGNIZED;\n          this.tryEmit();\n        }, options.time, this);\n      } else if (input.eventType & INPUT_END) {\n        return STATE_RECOGNIZED;\n      }\n      return STATE_FAILED;\n    },\n    reset: function () {\n      clearTimeout(this._timer);\n    },\n    emit: function (input) {\n      if (this.state !== STATE_RECOGNIZED) {\n        return;\n      }\n      if (input && input.eventType & INPUT_END) {\n        this.manager.emit(this.options.event + 'up', input);\n      } else {\n        this._input.timeStamp = now();\n        this.manager.emit(this.options.event, this._input);\n      }\n    }\n  });\n\n  /**\n   * Rotate\n   * Recognized when two or more pointer are moving in a circular motion.\n   * @constructor\n   * @extends AttrRecognizer\n   */\n  function RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n  }\n  inherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n      event: 'rotate',\n      threshold: 0,\n      pointers: 2\n    },\n    getTouchAction: function () {\n      return [TOUCH_ACTION_NONE];\n    },\n    attrTest: function (input) {\n      return this._super.attrTest.call(this, input) && (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n  });\n\n  /**\n   * Swipe\n   * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n   * @constructor\n   * @extends AttrRecognizer\n   */\n  function SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n  }\n  inherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n      event: 'swipe',\n      threshold: 10,\n      velocity: 0.3,\n      direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n      pointers: 1\n    },\n    getTouchAction: function () {\n      return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n    attrTest: function (input) {\n      var direction = this.options.direction;\n      var velocity;\n      if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n        velocity = input.overallVelocity;\n      } else if (direction & DIRECTION_HORIZONTAL) {\n        velocity = input.overallVelocityX;\n      } else if (direction & DIRECTION_VERTICAL) {\n        velocity = input.overallVelocityY;\n      }\n      return this._super.attrTest.call(this, input) && direction & input.offsetDirection && input.distance > this.options.threshold && input.maxPointers == this.options.pointers && abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n    emit: function (input) {\n      var direction = directionStr(input.offsetDirection);\n      if (direction) {\n        this.manager.emit(this.options.event + direction, input);\n      }\n      this.manager.emit(this.options.event, input);\n    }\n  });\n\n  /**\n   * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n   * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n   * a single tap.\n   *\n   * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n   * multi-taps being recognized.\n   * @constructor\n   * @extends Recognizer\n   */\n  function TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n  }\n  inherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n      event: 'tap',\n      pointers: 1,\n      taps: 1,\n      interval: 300,\n      // max time between the multi-tap taps\n      time: 250,\n      // max time of the pointer to be down (like finger on the screen)\n      threshold: 9,\n      // a minimal movement is ok, but keep it low\n      posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n    getTouchAction: function () {\n      return [TOUCH_ACTION_MANIPULATION];\n    },\n    process: function (input) {\n      var options = this.options;\n      var validPointers = input.pointers.length === options.pointers;\n      var validMovement = input.distance < options.threshold;\n      var validTouchTime = input.deltaTime < options.time;\n      this.reset();\n      if (input.eventType & INPUT_START && this.count === 0) {\n        return this.failTimeout();\n      }\n\n      // we only allow little movement\n      // and we've reached an end event, so a tap is possible\n      if (validMovement && validTouchTime && validPointers) {\n        if (input.eventType != INPUT_END) {\n          return this.failTimeout();\n        }\n        var validInterval = this.pTime ? input.timeStamp - this.pTime < options.interval : true;\n        var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n        this.pTime = input.timeStamp;\n        this.pCenter = input.center;\n        if (!validMultiTap || !validInterval) {\n          this.count = 1;\n        } else {\n          this.count += 1;\n        }\n        this._input = input;\n\n        // if tap count matches we have recognized it,\n        // else it has began recognizing...\n        var tapCount = this.count % options.taps;\n        if (tapCount === 0) {\n          // no failing requirements, immediately trigger the tap event\n          // or wait as long as the multitap interval to trigger\n          if (!this.hasRequireFailures()) {\n            return STATE_RECOGNIZED;\n          } else {\n            this._timer = setTimeoutContext(function () {\n              this.state = STATE_RECOGNIZED;\n              this.tryEmit();\n            }, options.interval, this);\n            return STATE_BEGAN;\n          }\n        }\n      }\n      return STATE_FAILED;\n    },\n    failTimeout: function () {\n      this._timer = setTimeoutContext(function () {\n        this.state = STATE_FAILED;\n      }, this.options.interval, this);\n      return STATE_FAILED;\n    },\n    reset: function () {\n      clearTimeout(this._timer);\n    },\n    emit: function () {\n      if (this.state == STATE_RECOGNIZED) {\n        this._input.tapCount = this.count;\n        this.manager.emit(this.options.event, this._input);\n      }\n    }\n  });\n\n  /**\n   * Simple way to create a manager with a default set of recognizers.\n   * @param {HTMLElement} element\n   * @param {Object} [options]\n   * @constructor\n   */\n  function Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n  }\n\n  /**\n   * @const {string}\n   */\n  Hammer.VERSION = '2.0.7';\n\n  /**\n   * default settings\n   * @namespace\n   */\n  Hammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n    // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n    [RotateRecognizer, {\n      enable: false\n    }], [PinchRecognizer, {\n      enable: false\n    }, ['rotate']], [SwipeRecognizer, {\n      direction: DIRECTION_HORIZONTAL\n    }], [PanRecognizer, {\n      direction: DIRECTION_HORIZONTAL\n    }, ['swipe']], [TapRecognizer], [TapRecognizer, {\n      event: 'doubletap',\n      taps: 2\n    }, ['tap']], [PressRecognizer]],\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n      /**\n       * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n       * @type {String}\n       * @default 'none'\n       */\n      userSelect: 'none',\n      /**\n       * Disable the Windows Phone grippers when pressing an element.\n       * @type {String}\n       * @default 'none'\n       */\n      touchSelect: 'none',\n      /**\n       * Disables the default callout shown when you touch and hold a touch target.\n       * On iOS, when you touch and hold a touch target such as a link, Safari displays\n       * a callout containing information about the link. This property allows you to disable that callout.\n       * @type {String}\n       * @default 'none'\n       */\n      touchCallout: 'none',\n      /**\n       * Specifies whether zooming is enabled. Used by IE10>\n       * @type {String}\n       * @default 'none'\n       */\n      contentZooming: 'none',\n      /**\n       * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n       * @type {String}\n       * @default 'none'\n       */\n      userDrag: 'none',\n      /**\n       * Overrides the highlight color shown when the user taps a link or a JavaScript\n       * clickable element in iOS. This property obeys the alpha value, if specified.\n       * @type {String}\n       * @default 'rgba(0,0,0,0)'\n       */\n      tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n  };\n  var STOP = 1;\n  var FORCED_STOP = 2;\n\n  /**\n   * Manager\n   * @param {HTMLElement} element\n   * @param {Object} [options]\n   * @constructor\n   */\n  function Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n    this.options.inputTarget = this.options.inputTarget || element;\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n    toggleCssProps(this, true);\n    each(this.options.recognizers, function (item) {\n      var recognizer = this.add(new item[0](item[1]));\n      item[2] && recognizer.recognizeWith(item[2]);\n      item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n  }\n  Manager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function (options) {\n      assign(this.options, options);\n\n      // Options that need a little more setup\n      if (options.touchAction) {\n        this.touchAction.update();\n      }\n      if (options.inputTarget) {\n        // Clean up existing event listeners and reinitialize\n        this.input.destroy();\n        this.input.target = options.inputTarget;\n        this.input.init();\n      }\n      return this;\n    },\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function (force) {\n      this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function (inputData) {\n      var session = this.session;\n      if (session.stopped) {\n        return;\n      }\n\n      // run the touch-action polyfill\n      this.touchAction.preventDefaults(inputData);\n      var recognizer;\n      var recognizers = this.recognizers;\n\n      // this holds the recognizer that is being recognized.\n      // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n      // if no recognizer is detecting a thing, it is set to `null`\n      var curRecognizer = session.curRecognizer;\n\n      // reset when the last recognizer is recognized\n      // or when we're in a new session\n      if (!curRecognizer || curRecognizer && curRecognizer.state & STATE_RECOGNIZED) {\n        curRecognizer = session.curRecognizer = null;\n      }\n      var i = 0;\n      while (i < recognizers.length) {\n        recognizer = recognizers[i];\n\n        // find out if we are allowed try to recognize the input for this one.\n        // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n        // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n        //      that is being recognized.\n        // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n        //      this can be setup with the `recognizeWith()` method on the recognizer.\n        if (session.stopped !== FORCED_STOP && (\n        // 1\n        !curRecognizer || recognizer == curRecognizer ||\n        // 2\n        recognizer.canRecognizeWith(curRecognizer))) {\n          // 3\n          recognizer.recognize(inputData);\n        } else {\n          recognizer.reset();\n        }\n\n        // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n        // current active recognizer. but only if we don't already have an active recognizer\n        if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n          curRecognizer = session.curRecognizer = recognizer;\n        }\n        i++;\n      }\n    },\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function (recognizer) {\n      if (recognizer instanceof Recognizer) {\n        return recognizer;\n      }\n      var recognizers = this.recognizers;\n      for (var i = 0; i < recognizers.length; i++) {\n        if (recognizers[i].options.event == recognizer) {\n          return recognizers[i];\n        }\n      }\n      return null;\n    },\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function (recognizer) {\n      if (invokeArrayArg(recognizer, 'add', this)) {\n        return this;\n      }\n\n      // remove existing\n      var existing = this.get(recognizer.options.event);\n      if (existing) {\n        this.remove(existing);\n      }\n      this.recognizers.push(recognizer);\n      recognizer.manager = this;\n      this.touchAction.update();\n      return recognizer;\n    },\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function (recognizer) {\n      if (invokeArrayArg(recognizer, 'remove', this)) {\n        return this;\n      }\n      recognizer = this.get(recognizer);\n\n      // let's make sure this recognizer exists\n      if (recognizer) {\n        var recognizers = this.recognizers;\n        var index = inArray(recognizers, recognizer);\n        if (index !== -1) {\n          recognizers.splice(index, 1);\n          this.touchAction.update();\n        }\n      }\n      return this;\n    },\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function (events, handler) {\n      if (events === undefined) {\n        return;\n      }\n      if (handler === undefined) {\n        return;\n      }\n      var handlers = this.handlers;\n      each(splitStr(events), function (event) {\n        handlers[event] = handlers[event] || [];\n        handlers[event].push(handler);\n      });\n      return this;\n    },\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function (events, handler) {\n      if (events === undefined) {\n        return;\n      }\n      var handlers = this.handlers;\n      each(splitStr(events), function (event) {\n        if (!handler) {\n          delete handlers[event];\n        } else {\n          handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n        }\n      });\n      return this;\n    },\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function (event, data) {\n      // we also want to trigger dom events\n      if (this.options.domEvents) {\n        triggerDomEvent(event, data);\n      }\n\n      // no handlers, so skip it all\n      var handlers = this.handlers[event] && this.handlers[event].slice();\n      if (!handlers || !handlers.length) {\n        return;\n      }\n      data.type = event;\n      data.preventDefault = function () {\n        data.srcEvent.preventDefault();\n      };\n      var i = 0;\n      while (i < handlers.length) {\n        handlers[i](data);\n        i++;\n      }\n    },\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function () {\n      this.element && toggleCssProps(this, false);\n      this.handlers = {};\n      this.session = {};\n      this.input.destroy();\n      this.element = null;\n    }\n  };\n\n  /**\n   * add/remove the css properties as defined in manager.options.cssProps\n   * @param {Manager} manager\n   * @param {Boolean} add\n   */\n  function toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n      return;\n    }\n    var prop;\n    each(manager.options.cssProps, function (value, name) {\n      prop = prefixed(element.style, name);\n      if (add) {\n        manager.oldCssProps[prop] = element.style[prop];\n        element.style[prop] = value;\n      } else {\n        element.style[prop] = manager.oldCssProps[prop] || '';\n      }\n    });\n    if (!add) {\n      manager.oldCssProps = {};\n    }\n  }\n\n  /**\n   * trigger dom event\n   * @param {String} event\n   * @param {Object} data\n   */\n  function triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n  }\n  assign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n  });\n\n  // this prevents errors when Hammer is loaded in the presence of an AMD\n  //  style loader but by script tag, not by the loader.\n  var freeGlobal = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}; // jshint ignore:line\n  freeGlobal.Hammer = Hammer;\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return Hammer;\n    });\n  } else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n  } else {\n    window[exportName] = Hammer;\n  }\n})(window, document, 'Hammer');","import { Injectable, inject } from '@angular/core'\nimport { PrimeNGConfig } from 'primeng/api'\n\n@Injectable()\nexport class I18nPrimengCalendarService {\n  private config = inject(PrimeNGConfig)\n\n  constructor () {\n    this.config.setTranslation({\n      dayNames: [\n        $localize`Sunday`,\n        $localize`Monday`,\n        $localize`Tuesday`,\n        $localize`Wednesday`,\n        $localize`Thursday`,\n        $localize`Friday`,\n        $localize`Saturday`\n      ],\n\n      dayNamesShort: [\n        $localize`:Sunday short name|Day name short:Sun`,\n        $localize`:Monday short name|Day name short:Mon`,\n        $localize`:Tuesday short name|Day name short:Tue`,\n        $localize`:Wednesday short name|Day name short:Wed`,\n        $localize`:Thursday short name|Day name short:Thu`,\n        $localize`:Friday short name|Day name short:Fri`,\n        $localize`:Saturday short name|Day name short:Sat`\n      ],\n\n      dayNamesMin: [\n        $localize`:Sunday min name|Day name min:Su`,\n        $localize`:Monday min name|Day name min:Mo`,\n        $localize`:Tuesday min name|Day name min:Tu`,\n        $localize`:Wednesday min name|Day name min:We`,\n        $localize`:Thursday min name|Day name min:Th`,\n        $localize`:Friday min name|Day name min:Fr`,\n        $localize`:Saturday min name|Day name min:Sa`\n      ],\n\n      monthNames: [\n        $localize`January`,\n        $localize`February`,\n        $localize`March`,\n        $localize`April`,\n        $localize`May`,\n        $localize`June`,\n        $localize`July`,\n        $localize`August`,\n        $localize`September`,\n        $localize`October`,\n        $localize`November`,\n        $localize`December`\n      ],\n\n      monthNamesShort: [\n        $localize`:January short name|Month name short:Jan`,\n        $localize`:February short name|Month name short:Feb`,\n        $localize`:March short name|Month name short:Mar`,\n        $localize`:April short name|Month name short:Apr`,\n        $localize`:May short name|Month name short:May`,\n        $localize`:June short name|Month name short:Jun`,\n        $localize`:July short name|Month name short:Jul`,\n        $localize`:August short name|Month name short:Aug`,\n        $localize`:September short name|Month name short:Sep`,\n        $localize`:October short name|Month name short:Oct`,\n        $localize`:November short name|Month name short:Nov`,\n        $localize`:December short name|Month name short:Dec`\n      ],\n\n      today: $localize`Today`,\n\n      clear: $localize`Clear`\n    })\n  }\n\n  getTimezone () {\n    const gmt = new Date().toString().match(/([A-Z]+[+-][0-9]+)/)[1]\n    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\n    return `${timezone} - ${gmt}`\n  }\n\n  getDateFormat () {\n    return $localize`:Date format in this locale.:yy-mm-dd`\n  }\n\n  getVideoPublicationYearRange () {\n    return '1880:' + (new Date()).getFullYear()\n  }\n}\n","import { objectToFormData } from '@app/helpers'\nimport { resolveUrl, UploaderX } from 'ngx-uploadx'\n\n/**\n * multipart/form-data uploader extending the UploaderX implementation of Google Resumable\n * for use with multer\n *\n * @see https://github.com/kukhariev/ngx-uploadx/blob/637e258fe366b8095203f387a6101a230ee4f8e6/src/uploadx/lib/uploaderx.ts\n * @example\n *\n *   options: UploadxOptions = {\n *     uploaderClass: UploaderXFormData\n *   };\n */\nexport class UploaderXFormData extends UploaderX {\n\n  async getFileUrl (): Promise<string> {\n    const headers = {\n      'X-Upload-Content-Length': this.size.toString(),\n      'X-Upload-Content-Type': this.file.type || 'application/octet-stream'\n    }\n\n    const previewfile = this.metadata.previewfile as any as File\n    delete this.metadata.previewfile\n\n    const data = objectToFormData(this.metadata)\n    if (previewfile !== undefined) {\n      data.append('previewfile', previewfile, previewfile.name)\n      data.append('thumbnailfile', previewfile, previewfile.name)\n    }\n\n    await this.request({\n      method: 'POST',\n      body: data,\n      url: this.endpoint,\n      headers\n    })\n\n    const location = this.getValueFromResponse('location')\n    if (!location) {\n      throw new Error('Invalid or missing Location header')\n    }\n\n    this.offset = this.responseStatus === 201 ? 0 : undefined\n\n    return resolveUrl(location, this.endpoint)\n  }\n}\n","import { UploaderX, UploadxOptions } from 'ngx-uploadx'\nimport { Injectable, inject } from '@angular/core'\nimport { AuthService, Notifier, ServerService } from '@app/core'\nimport { UploaderXFormData } from './uploaderx-form-data'\nimport { getUploadXRetryConfig } from '@app/helpers'\nimport { BytesPipe } from '@app/shared/shared-main/common/bytes.pipe'\nimport { VideoService } from '@app/shared/shared-main/video/video.service'\n\n@Injectable()\nexport class VideoUploadService {\n  private server = inject(ServerService)\n  private notifier = inject(Notifier)\n  private authService = inject(AuthService)\n\n  getVideoExtensions () {\n    return this.server.getHTMLConfig().video.file.extensions\n  }\n\n  checkQuotaAndNotify (videoFile: File, maxQuota: number, quotaUsed: number) {\n    const bytePipes = new BytesPipe()\n\n    // Check global user quota\n    if (maxQuota !== -1 && (quotaUsed + videoFile.size) > maxQuota) {\n      const videoSizeBytes = bytePipes.transform(videoFile.size, 0)\n      const videoQuotaUsedBytes = bytePipes.transform(quotaUsed, 0)\n      const videoQuotaBytes = bytePipes.transform(maxQuota, 0)\n\n      const msg =\n        // eslint-disable-next-line max-len\n        $localize`Your video quota is exceeded with this video (video size: ${videoSizeBytes}, used: ${videoQuotaUsedBytes}, quota: ${videoQuotaBytes})`\n      this.notifier.error(msg)\n\n      return false\n    }\n\n    return true\n  }\n\n  isAudioFile (filename: string) {\n    const extensions = [ '.mp3', '.flac', '.ogg', '.wma', '.wav' ]\n\n    return extensions.some(e => filename.endsWith(e))\n  }\n\n  // ---------------------------------------------------------------------------\n\n  getNewVideoUploadxOptions (): UploadxOptions {\n    return this.getUploadxOptions(\n      VideoService.BASE_VIDEO_URL + '/upload-resumable',\n      UploaderXFormData\n    )\n  }\n\n  getReplaceUploadxOptions (videoId: string): UploadxOptions {\n    return this.getUploadxOptions(\n      VideoService.BASE_VIDEO_URL + '/' + videoId + '/source/replace-resumable',\n      UploaderX\n    )\n  }\n\n  private getUploadxOptions (endpoint: string, uploaderClass: typeof UploaderXFormData) {\n    return {\n      endpoint,\n      multiple: false,\n\n      maxChunkSize: this.server.getHTMLConfig().client.videos.resumableUpload.maxChunkSize,\n\n      token: this.authService.getAccessToken(),\n\n      uploaderClass,\n\n      retryConfig: getUploadXRetryConfig()\n    }\n  }\n}\n","import { catchError } from 'rxjs'\nimport { HttpClient } from '@angular/common/http'\nimport { Injectable, inject } from '@angular/core'\nimport { RestExtractor } from '@app/core'\nimport { objectToFormData } from '@app/helpers'\nimport { VideoStudioCreateEdition, VideoStudioTask } from '@peertube/peertube-models'\nimport { VideoService } from '@app/shared/shared-main/video/video.service'\n\n@Injectable()\nexport class VideoStudioService {\n  private authHttp = inject(HttpClient)\n  private restExtractor = inject(RestExtractor)\n\n  editVideo (videoId: number | string, tasks: VideoStudioTask[]) {\n    const url = VideoService.BASE_VIDEO_URL + '/' + videoId + '/studio/edit'\n    const body: VideoStudioCreateEdition = {\n      tasks\n    }\n\n    const data = objectToFormData(body)\n\n    return this.authHttp.post(url, data)\n      .pipe(catchError(err => this.restExtractor.handleError(err)))\n  }\n}\n","import { HttpErrorResponse } from '@angular/common/http'\nimport { inject, Injectable, OnDestroy } from '@angular/core'\nimport { ActivatedRoute } from '@angular/router'\nimport { AuthService, ConfirmService, Notifier, PeerTubeRouterService } from '@app/core'\nimport { buildHTTPErrorResponse, genericUploadErrorHandler } from '@app/helpers'\nimport { FormReactiveErrors, FormReactiveService } from '@app/shared/shared-forms/form-reactive.service'\nimport { VideoCaptionService } from '@app/shared/shared-main/video-caption/video-caption.service'\nimport { VideoChapterService } from '@app/shared/shared-main/video/video-chapter.service'\nimport { VideoPasswordService } from '@app/shared/shared-main/video/video-password.service'\nimport { VideoService } from '@app/shared/shared-main/video/video.service'\nimport { LiveVideoService } from '@app/shared/shared-video-live/live-video.service'\nimport { LoadingBarService } from '@ngx-loading-bar/core'\nimport {\n  HTMLServerConfig,\n  HttpStatusCode,\n  UserVideoQuota,\n  VideoConstant,\n  VideoPassword,\n  VideoPrivacy,\n  VideoPrivacyType,\n  VideoState\n} from '@peertube/peertube-models'\nimport debug from 'debug'\nimport { UploadState, UploadxService } from 'ngx-uploadx'\nimport { finalize, first, forkJoin, Observable, of, Subject, Subscription, switchMap, tap } from 'rxjs'\nimport { SelectChannelItem } from '../../../types'\nimport { VideoEdit } from './common/video-edit.model'\nimport { VideoManageType } from './common/video-manage.type'\nimport { VideoUploadService } from './common/video-upload.service'\nimport { VideoStudioService } from './studio/video-studio.service'\n\nconst debugLogger = debug('peertube:video-manage')\n\n@Injectable()\nexport class VideoManageController implements OnDestroy {\n  private loadingBar = inject(LoadingBarService)\n  private videoService = inject(VideoService)\n  private videoCaptionService = inject(VideoCaptionService)\n  private videoChapterService = inject(VideoChapterService)\n  private liveVideoService = inject(LiveVideoService)\n  private videoPasswordService = inject(VideoPasswordService)\n  private notifier = inject(Notifier)\n  private videoUploadService = inject(VideoUploadService)\n  private auth = inject(AuthService)\n  private confirmService = inject(ConfirmService)\n  private resumableUploadService = inject(UploadxService)\n  private formReactiveService = inject(FormReactiveService)\n  private videoStudio = inject(VideoStudioService)\n  private peertubeRouter = inject(PeerTubeRouterService)\n\n  private videoEdit: VideoEdit\n  private userChannels: SelectChannelItem[]\n  private userQuota: UserVideoQuota\n  private privacies: VideoConstant<VideoPrivacyType>[]\n\n  private manageType: VideoManageType\n  private serverConfig: HTMLServerConfig\n\n  private uploadingVideo = false\n  private videoUploaded = false\n  private videoUploadPercents: number\n  private uploadError: string\n  private retryUploadFn: () => any\n\n  private isUpdatingVideo = false\n  private videoUploadedSubject = new Subject<void>()\n  private alreadyRefreshedToken = false\n\n  private embedVersion = 1\n\n  private uploadServiceSubscription: Subscription\n  private pendingUpdateObs: Observable<any>\n  private updatedSubject = new Subject<void>()\n\n  private formErrors: { page: string, path: string, errors: string[] }[] = []\n  private saveHook: () => Promise<any>\n\n  constructor () {\n    debugLogger('Building video manage controller service')\n\n    this.resetUploadState()\n\n    this.uploadServiceSubscription = this.resumableUploadService.events\n      .subscribe(state => this.onUploadVideoOngoing(state))\n  }\n\n  ngOnDestroy () {\n    debugLogger('Destroying video manage controller service')\n\n    this.resumableUploadService.disconnect()\n    this.uploadServiceSubscription?.unsubscribe()\n  }\n\n  reset () {\n    this.manageType = undefined\n    this.serverConfig = undefined\n    this.videoEdit = undefined\n    this.userChannels = undefined\n    this.userQuota = undefined\n    this.privacies = undefined\n  }\n\n  // ---------------------------------------------------------------------------\n\n  setConfig (config: {\n    manageType: VideoManageType\n    serverConfig: HTMLServerConfig\n  }) {\n    this.manageType = config.manageType\n    this.serverConfig = config.serverConfig\n  }\n\n  getConfig () {\n    const videoAttrs = this.videoEdit.getVideoAttributes()\n    const isPublish = new Set<VideoManageType>([ 'import-torrent', 'import-url', 'upload' ]).has(this.manageType)\n\n    return {\n      manageType: this.manageType,\n      displayTranscriptionInfo: isPublish,\n\n      hideWaitTranscoding: !isPublish && (videoAttrs.isLive || videoAttrs.state !== VideoState.TO_TRANSCODE),\n\n      forbidScheduledPublication: this.getForbidScheduledPublication()\n    }\n  }\n\n  private getForbidScheduledPublication () {\n    if (this.manageType === 'upload') return false\n\n    return this.manageType === 'update' && this.videoEdit.getVideoAttributes().privacy !== VideoPrivacy.PRIVATE\n  }\n\n  // ---------------------------------------------------------------------------\n\n  setStore (store: {\n    videoEdit: VideoEdit\n    userChannels: SelectChannelItem[]\n    userQuota: UserVideoQuota\n    privacies: VideoConstant<VideoPrivacyType>[]\n  }) {\n    this.videoEdit = store.videoEdit\n    this.userChannels = store.userChannels\n    this.userQuota = store.userQuota\n    this.privacies = store.privacies\n  }\n\n  setVideoEdit (videoEdit: VideoEdit) {\n    this.videoEdit = videoEdit\n  }\n\n  getStore () {\n    return {\n      videoEdit: this.videoEdit,\n      userChannels: this.userChannels,\n      privacies: this.privacies\n    }\n  }\n\n  setFormError (page: string, path: string, formErrors: FormReactiveErrors) {\n    const errors = this.formReactiveService.grabAllErrors(formErrors)\n    this.formErrors = this.formErrors.filter(e => e.page !== page)\n\n    if (errors.length === 0) return\n\n    this.formErrors.push({ page, path, errors })\n  }\n\n  getFormErrors () {\n    return this.formErrors\n  }\n\n  hasFormErrors () {\n    return this.formErrors.some(({ errors }) => errors.length !== 0)\n  }\n\n  getEmbedVersion () {\n    return this.embedVersion\n  }\n\n  // ---------------------------------------------------------------------------\n\n  registerSaveHook (fn: () => Promise<any>) {\n    this.saveHook = fn\n  }\n\n  unregisterSaveHook () {\n    this.saveHook = undefined\n  }\n\n  runSaveHook () {\n    if (!this.saveHook) return Promise.resolve()\n\n    return this.saveHook()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  hasPendingChanges () {\n    return this.videoEdit.hasPendingChanges()\n  }\n\n  hasStudioTasks () {\n    return this.videoEdit.hasStudioTasks()\n  }\n\n  hasReplaceFile () {\n    return this.videoEdit.hasReplaceFile()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  isUpdating () {\n    return this.isUpdatingVideo\n  }\n\n  getUpdatedObs () {\n    return this.updatedSubject.asObservable()\n  }\n\n  updateVideo () {\n    if (this.isUpdatingVideo === true) return\n\n    this.cancelUploadIfNeeded()\n\n    this.loadingBar.useRef().start()\n    this.isUpdatingVideo = true\n\n    const videoAttributes = this.videoEdit.getVideoAttributes()\n\n    const isLive = !!this.videoEdit.getLive()\n\n    this.pendingUpdateObs = this.videoUploadedSubject.pipe(\n      tap(() => this.videoEdit.resetReplaceFile()),\n      switchMap(() => {\n        if (isLive || !this.videoEdit.hasCaptionChanges()) return of(true)\n\n        debugLogger('Update captions')\n\n        return this.videoCaptionService.updateCaptions(videoAttributes.uuid, this.videoEdit.getCaptionsEdit())\n      }),\n      switchMap(() => {\n        if (isLive || !this.videoEdit.hasChaptersChanges()) return of(true)\n\n        debugLogger('Update chapters')\n\n        return this.videoChapterService.updateChapters(videoAttributes.uuid, this.videoEdit.getChaptersEdit())\n      }),\n      switchMap(() => {\n        if (!isLive || !this.videoEdit.hasLiveChanges()) return of(true)\n\n        debugLogger('Update live')\n\n        return this.liveVideoService.updateLive(videoAttributes.uuid, this.videoEdit.toLiveUpdate())\n      }),\n      switchMap(() => {\n        debugLogger('Update video')\n\n        return this.videoService.updateVideo(videoAttributes.uuid, this.videoEdit.toVideoUpdate())\n      }),\n      switchMap(() => {\n        if (!this.videoEdit.hasStudioTasks()) return of(true)\n\n        debugLogger('Run studio tasks')\n\n        return this.videoStudio.editVideo(videoAttributes.uuid, this.videoEdit.getStudioTasks())\n          .pipe(tap(() => this.videoEdit.resetStudio()))\n      }),\n      switchMap(() => {\n        return forkJoin([\n          this.videoService.getVideo({ videoId: videoAttributes.uuid }),\n\n          this.videoEdit.getVideoAttributes().privacy === VideoPrivacy.PASSWORD_PROTECTED\n            ? this.videoPasswordService.getVideoPasswords({ videoUUID: videoAttributes.uuid })\n            : of([] as VideoPassword[]),\n\n          isLive\n            ? this.liveVideoService.getVideoLive(videoAttributes.uuid)\n            : of(undefined),\n\n          !isLive\n            ? this.videoChapterService.getChapters({ videoId: videoAttributes.uuid })\n            : of(undefined),\n\n          !isLive\n            ? this.videoCaptionService.listCaptions(videoAttributes.uuid)\n            : of(undefined)\n        ])\n      }),\n      switchMap(([ video, videoPasswords, live, chaptersRes, captionsRes ]) => {\n        return this.videoEdit.loadFromAPI({\n          video,\n          videoPasswords: videoPasswords.map(p => p.password),\n          live,\n          chapters: chaptersRes?.chapters,\n          captions: captionsRes?.data\n        })\n      }),\n      first(), // To complete\n      finalize(() => {\n        debugLogger('Update complete')\n\n        this.videoEdit.onSave()\n        this.loadingBar.useRef().complete()\n        this.isUpdatingVideo = false\n        this.updatedSubject.next()\n        this.embedVersion++\n      })\n    )\n\n    setTimeout(() => this.replaceFileIfNeeded())\n\n    return this.pendingUpdateObs\n  }\n\n  private replaceFileIfNeeded () {\n    if (!this.videoEdit.hasReplaceFile()) {\n      debugLogger('No file to replace')\n      this.videoUploadedSubject.next()\n      return\n    }\n\n    debugLogger('Upload file replacement')\n    this.uploadFileReplacement(this.videoEdit.getReplaceFile())\n  }\n\n  private uploadFileReplacement (file: File) {\n    this.uploadingVideo = true\n    this.retryUploadFn = () => this.uploadFileReplacement(file)\n\n    const metadata = { filename: file.name }\n\n    this.resumableUploadService.handleFiles(file, {\n      ...this.videoUploadService.getReplaceUploadxOptions(this.videoEdit.getVideoAttributes().uuid),\n\n      metadata\n    })\n  }\n\n  cancelUploadIfNeeded () {\n    if (this.uploadingVideo) {\n      this.resumableUploadService.control({ action: 'cancel' })\n    }\n\n    this.videoUploadedSubject = new Subject<void>()\n\n    this.pendingUpdateObs = undefined\n    this.loadingBar.useRef().complete()\n\n    this.resetUploadState()\n  }\n\n  retryUpload () {\n    this.retryUploadFn()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  async checkAndConfirmVideoFileReplacement () {\n    if (!this.videoEdit.hasReplaceFile()) return true\n\n    if (this.videoEdit.hasStudioTasks()) {\n      this.notifier.error($localize`You cannot replace the video file and also have studio tasks.`)\n      return false\n    }\n\n    const replaceFile = this.videoEdit.getReplaceFile()\n\n    if (!this.checkUserQuota(replaceFile)) return false\n\n    const videoAttributes = this.videoEdit.getVideoAttributes()\n    const willBeBlocked = this.serverConfig.autoBlacklist.videos.ofUsers.enabled === true && !videoAttributes.blacklisted\n\n    let blockedWarning = ''\n    if (willBeBlocked) {\n      blockedWarning = ' ' +\n        $localize`Your video will also be automatically blocked since video publication requires manual validation by moderators.`\n    }\n\n    const message = $localize`Uploading a new version of your video will completely erase the current version.` +\n      blockedWarning +\n      ' ' +\n      $localize`<br /><br />Do you still want to replace your video file?`\n\n    const res = await this.confirmService.confirm(message, $localize`Replace file warning`)\n    if (res === false) return false\n\n    return true\n  }\n\n  async checkAndConfirmStudioTasks () {\n    if (!this.videoEdit.hasStudioTasks()) return true\n\n    const title = $localize`Are you sure you want to create studio tasks for \"${this.videoEdit.getVideoAttributes().name}\"?`\n    const listHTML = this.videoEdit.getStudioTasksSummary().map(t => `<li>${t}</li>`).join('')\n\n    const confirmHTML =\n      // eslint-disable-next-line max-len\n      $localize`The current video will be overwritten by this edited video and <strong>you won't be able to recover it</strong>.<br /><br />` +\n      $localize`As a reminder, the following tasks will be executed: <ol>${listHTML}</ol>`\n\n    if (await this.confirmService.confirm(confirmHTML, title) !== true) return false\n\n    return true\n  }\n\n  checkUserQuota (file: File) {\n    const user = this.auth.getUser()\n\n    if (!this.videoUploadService.checkQuotaAndNotify(file, user.videoQuota, this.userQuota.videoQuotaUsed)) return false\n    if (!this.videoUploadService.checkQuotaAndNotify(file, user.videoQuotaDaily, this.userQuota.videoQuotaUsedDaily)) return false\n\n    return true\n  }\n\n  // ---------------------------------------------------------------------------\n\n  silentRedirectOnManage (shortUUID: string, route: ActivatedRoute) {\n    this.peertubeRouter.silentNavigate([ '.' ], { publishedId: shortUUID, uploading: null }, route)\n  }\n\n  silentRedirectOnUploading (route: ActivatedRoute) {\n    this.peertubeRouter.silentNavigate([ '.' ], { publishedId: null, uploading: 'true' }, route)\n  }\n\n  silentRedirectOnAbortUpload (route: ActivatedRoute) {\n    this.peertubeRouter.silentNavigate([ '.' ], { publishedId: null, uploading: null }, route)\n  }\n\n  // ---------------------------------------------------------------------------\n\n  uploadNewVideo (options: {\n    file: File\n    privacy: VideoPrivacyType\n    previewfile?: File\n  }) {\n    this.resetUploadState()\n\n    this.uploadingVideo = true\n    this.retryUploadFn = () => this.uploadNewVideo(options)\n\n    const metadata = {\n      ...this.videoEdit.toVideoCreate(options.privacy),\n\n      filename: options.file.name,\n      previewfile: options.previewfile\n    }\n\n    this.resumableUploadService.handleFiles(options.file, {\n      ...this.videoUploadService.getNewVideoUploadxOptions(),\n\n      metadata\n    })\n  }\n\n  private resetUploadState () {\n    this.videoUploaded = false\n    this.uploadingVideo = false\n    this.videoUploadPercents = 0\n    this.uploadError = ''\n  }\n\n  getUploadEventsObs () {\n    return this.resumableUploadService.events\n  }\n\n  getUploadPercents () {\n    return this.videoUploadPercents\n  }\n\n  getUploadError () {\n    return this.uploadError\n  }\n\n  isUploadingFile () {\n    return this.uploadingVideo\n  }\n\n  hasUploadedFile () {\n    return this.videoUploaded\n  }\n\n  // ---------------------------------------------------------------------------\n\n  private onUploadVideoOngoing (state: UploadState) {\n    debugLogger('Upload state update', state)\n\n    switch (state.status) {\n      case 'error': {\n        if (!this.alreadyRefreshedToken && state.responseStatus === HttpStatusCode.UNAUTHORIZED_401) {\n          this.alreadyRefreshedToken = true\n\n          return this.refreshTokenAndRetryUpload()\n        }\n\n        this.handleUploadError(buildHTTPErrorResponse(state))\n        break\n      }\n\n      case 'cancelled':\n        this.uploadingVideo = false\n        this.videoUploadPercents = 0\n        this.uploadError = ''\n        break\n\n      case 'uploading':\n        this.videoUploadPercents = state.progress || 0\n        break\n\n      case 'paused':\n        this.notifier.info($localize`Upload on hold`)\n        break\n\n      case 'complete':\n        this.uploadingVideo = false\n        this.videoUploadPercents = 100\n        this.videoUploaded = true\n        this.videoUploadedSubject.next()\n        break\n    }\n  }\n\n  private handleUploadError (err: HttpErrorResponse) {\n    this.videoUploadPercents = 0\n    this.uploadingVideo = false\n\n    this.uploadError = genericUploadErrorHandler({ err, name: $localize`video` })\n\n    this.videoUploadedSubject.error(err)\n  }\n\n  private refreshTokenAndRetryUpload () {\n    this.auth.refreshAccessToken()\n      .subscribe(() => this.retryUploadFn())\n  }\n}\n","import { NgFor, NgIf } from '@angular/common'\nimport { Component, OnInit, inject, viewChild } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { ServerService } from '@app/core'\nimport { removeElementFromArray } from '@app/helpers'\nimport { AlertComponent } from '@app/shared/shared-main/common/alert.component'\nimport { PTDatePipe } from '@app/shared/shared-main/common/date.pipe'\nimport { VideoCaptionEdit, VideoCaptionWithPathEdit } from '@app/+videos-publish-manage/shared-manage/common/video-caption-edit.model'\nimport { HTMLServerConfig, VideoConstant } from '@peertube/peertube-models'\nimport debug from 'debug'\nimport { CalendarModule } from 'primeng/calendar'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { ButtonComponent } from '../../../shared/shared-main/buttons/button.component'\nimport { DeleteButtonComponent } from '../../../shared/shared-main/buttons/delete-button.component'\nimport { EditButtonComponent } from '../../../shared/shared-main/buttons/edit-button.component'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoManageController } from '../video-manage-controller.service'\nimport { VideoCaptionAddModalComponent } from './video-caption-add-modal.component'\nimport { VideoCaptionEditModalComponent } from './video-caption-edit-modal.component'\n\nconst debugLogger = debug('peertube:video-manage')\n\n@Component({\n  selector: 'my-video-captions',\n  styleUrls: [\n    '../common/video-manage-page-common.scss',\n    './video-captions.component.scss'\n  ],\n  templateUrl: './video-captions.component.html',\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    NgIf,\n    CalendarModule,\n    NgFor,\n    GlobalIconComponent,\n    DeleteButtonComponent,\n    VideoCaptionAddModalComponent,\n    PTDatePipe,\n    EditButtonComponent,\n    ButtonComponent,\n    AlertComponent,\n    VideoCaptionEditModalComponent\n  ]\n})\nexport class VideoCaptionsComponent implements OnInit {\n  private serverService = inject(ServerService)\n  private manageController = inject(VideoManageController)\n\n  readonly videoCaptionAddModal = viewChild<VideoCaptionAddModalComponent>('videoCaptionAddModal')\n  readonly videoCaptionEditModal = viewChild<VideoCaptionEditModalComponent>('videoCaptionEditModal')\n\n  serverConfig: HTMLServerConfig\n\n  displayTranscriptionInfo: boolean\n  videoEdit: VideoEdit\n\n  videoLanguages: VideoConstant<string>[] = []\n\n  private initialVideoCaptions: string[] = []\n\n  ngOnInit () {\n    this.serverConfig = this.serverService.getHTMLConfig()\n\n    const { displayTranscriptionInfo } = this.manageController.getConfig()\n    this.displayTranscriptionInfo = displayTranscriptionInfo\n\n    const { videoEdit } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n\n    this.initialVideoCaptions = this.videoEdit.getCaptionsEdit().map(c => c.language.id)\n  }\n\n  // ---------------------------------------------------------------------------\n\n  getCaptionLabel (caption: VideoCaptionWithPathEdit) {\n    if (caption.automaticallyGenerated) {\n      return $localize`${caption.language.label} (auto-generated)`\n    }\n\n    return caption.language.label\n  }\n\n  getExistingCaptions () {\n    return this.videoEdit\n      .getCaptionsEdit()\n      .filter(c => c.action !== 'REMOVE')\n      .map(c => c.language.id)\n  }\n\n  onCaptionEdited (caption: VideoCaptionEdit) {\n    const captionsEdit = this.videoEdit.getCaptionsEdit()\n\n    const existingCaption = captionsEdit\n      .find(c => c.language.id === caption.language.id)\n\n    // Replace existing caption\n    if (existingCaption) {\n      Object.assign(existingCaption, caption)\n    } else {\n      captionsEdit.push(\n        Object.assign(caption, { action: 'CREATE' as 'CREATE' })\n      )\n    }\n\n    this.sortVideoCaptions()\n\n    debugLogger('Caption edited', caption)\n  }\n\n  deleteCaption (caption: VideoCaptionEdit) {\n    // Caption recovers his former state\n    if (caption.action && this.initialVideoCaptions.includes(caption.language.id)) {\n      caption.action = undefined\n      return\n    }\n\n    // This caption is not on the server, just remove it from our array\n    if (caption.action === 'CREATE' || caption.action === 'UPDATE') {\n      removeElementFromArray(this.videoEdit.getCaptionsEdit(), caption)\n      return\n    }\n\n    caption.action = 'REMOVE' as 'REMOVE'\n\n    debugLogger('Caption deleted', caption)\n  }\n\n  openAddCaptionModal () {\n    this.videoCaptionAddModal().show()\n  }\n\n  openEditCaptionModal (videoCaption: VideoCaptionWithPathEdit) {\n    this.videoCaptionEditModal().show({\n      videoCaption,\n      serverConfig: this.serverConfig,\n      videoEdit: this.videoEdit,\n      captionEdited: caption => this.onCaptionEdited(caption)\n    })\n  }\n\n  isTranscriptionEnabled () {\n    return this.serverConfig.videoTranscription.enabled\n  }\n\n  hasCaptions () {\n    return this.getExistingCaptions().length !== 0\n  }\n\n  private sortVideoCaptions () {\n    this.videoEdit.getCaptionsEdit().sort((v1, v2) => {\n      if (v1.language.label < v2.language.label) return -1\n      if (v1.language.label === v2.language.label) return 0\n\n      return 1\n    })\n  }\n\n  isLive () {\n    return this.videoEdit.getVideoAttributes().isLive\n  }\n}\n","import { Validators } from '@angular/forms'\nimport { BuildFormValidator } from './form-validator.model'\n\nexport const VIDEO_CAPTION_LANGUAGE_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.required ],\n  MESSAGES: {\n    required: $localize`Video caption language is required.`\n  }\n}\n\nexport const VIDEO_CAPTION_FILE_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.required ],\n  MESSAGES: {\n    required: $localize`Video caption file is required.`\n  }\n}\n\nexport const VIDEO_CAPTION_FILE_CONTENT_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.required ],\n  MESSAGES: {\n    required: $localize`Caption content is required.`\n  }\n}\n","<ng-template #modal>\n  <ng-container [formGroup]=\"form\">\n\n    <div class=\"modal-header\">\n      <h4 i18n class=\"modal-title\">Add caption</h4>\n\n      <button class=\"border-0 p-0\" title=\"Close this modal\" i18n-title (click)=\"hide()\">\n        <my-global-icon iconName=\"cross\"></my-global-icon>\n      </button>\n    </div>\n\n    <div class=\"modal-body\">\n      <label i18n for=\"language\">Language</label>\n\n      <my-select-options\n        inputId=\"language\" [items]=\"videoCaptionLanguages\" formControlName=\"language\"\n        clearable=\"true\" filter=\"true\" virtualScroll=\"true\"\n      ></my-select-options>\n\n      <div *ngIf=\"formErrors.language\" class=\"form-error\" role=\"alert\">\n        {{ formErrors.language }}\n      </div>\n\n      <div class=\"caption-file\">\n        <my-reactive-file\n          formControlName=\"captionfile\" inputName=\"captionfile\" i18n-inputLabel inputLabel=\"Select the caption file\"\n          [extensions]=\"videoCaptionExtensions\" [maxFileSize]=\"videoCaptionMaxSize\" [displayFilename]=\"true\"\n          [buttonTooltip]=\"getReactiveFileButtonTooltip()\"\n        ></my-reactive-file>\n      </div>\n\n      <div *ngIf=\"isReplacingExistingCaption()\" class=\"warning-replace-caption\" i18n>\n        This will replace an existing caption!\n      </div>\n    </div>\n\n    <div class=\"modal-footer inputs\">\n      <input\n        type=\"button\" role=\"button\" i18n-value value=\"Cancel\" class=\"peertube-button secondary-button\"\n        (click)=\"hide()\" (key.enter)=\"hide()\"\n      >\n\n      <input\n        type=\"submit\" i18n-value value=\"Add this caption\" class=\"peertube-button primary-button\"\n        [disabled]=\"!form.valid\" (click)=\"addCaption()\"\n      >\n    </div>\n  </ng-container>\n</ng-template>\n","import { NgIf } from '@angular/common'\nimport { Component, ElementRef, OnInit, inject, input, output, viewChild } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { ServerService } from '@app/core'\nimport { VIDEO_CAPTION_FILE_VALIDATOR, VIDEO_CAPTION_LANGUAGE_VALIDATOR } from '@app/shared/form-validators/video-captions-validators'\nimport { FormReactive } from '@app/shared/shared-forms/form-reactive'\nimport { FormReactiveService } from '@app/shared/shared-forms/form-reactive.service'\nimport { SelectOptionsComponent } from '@app/shared/shared-forms/select/select-options.component'\nimport { VideoCaptionEdit } from '@app/+videos-publish-manage/shared-manage/common/video-caption-edit.model'\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap'\nimport { HTMLServerConfig, VideoConstant } from '@peertube/peertube-models'\nimport { ReactiveFileComponent } from '../../../shared/shared-forms/reactive-file.component'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\n\n@Component({\n  selector: 'my-video-caption-add-modal',\n  styleUrls: [ './video-caption-add-modal.component.scss' ],\n  templateUrl: './video-caption-add-modal.component.html',\n  imports: [ FormsModule, ReactiveFormsModule, GlobalIconComponent, NgIf, ReactiveFileComponent, SelectOptionsComponent ]\n})\nexport class VideoCaptionAddModalComponent extends FormReactive implements OnInit {\n  protected formReactiveService = inject(FormReactiveService)\n  private modalService = inject(NgbModal)\n  private serverService = inject(ServerService)\n\n  readonly existingCaptions = input<string[]>(undefined)\n  readonly serverConfig = input<HTMLServerConfig>(undefined)\n\n  readonly captionAdded = output<VideoCaptionEdit>()\n\n  readonly modal = viewChild<ElementRef>('modal')\n\n  videoCaptionLanguages: VideoConstant<string>[] = []\n\n  private openedModal: NgbModalRef\n\n  get videoCaptionExtensions () {\n    return this.serverConfig().videoCaption.file.extensions\n  }\n\n  get videoCaptionMaxSize () {\n    return this.serverConfig().videoCaption.file.size.max\n  }\n\n  getReactiveFileButtonTooltip () {\n    return `(extensions: ${this.videoCaptionExtensions.join(', ')})`\n  }\n\n  ngOnInit () {\n    this.serverService.getVideoLanguages()\n      .subscribe(languages => this.videoCaptionLanguages = languages)\n\n    this.buildForm({\n      language: VIDEO_CAPTION_LANGUAGE_VALIDATOR,\n      captionfile: VIDEO_CAPTION_FILE_VALIDATOR\n    })\n  }\n\n  show () {\n    this.openedModal = this.modalService.open(this.modal(), { centered: true, keyboard: false })\n  }\n\n  hide () {\n    this.openedModal.close()\n    this.form.reset()\n  }\n\n  isReplacingExistingCaption () {\n    const languageId = this.form.value['language']\n\n    return languageId && this.existingCaptions().includes(languageId)\n  }\n\n  addCaption () {\n    const languageId = this.form.value['language']\n    const languageObject = this.videoCaptionLanguages.find(l => l.id === languageId)\n\n    this.captionAdded.emit({\n      language: languageObject,\n      captionfile: this.form.value['captionfile'],\n      action: 'CREATE'\n    })\n\n    this.hide()\n  }\n}\n","import * as Channel from 'jschannel'\nimport { EventHandler, PeerTubeResolution, PeerTubeTextTrack, PlayerEventType } from './definitions'\nimport { EventRegistrar } from './events'\n\nconst PASSTHROUGH_EVENTS = [\n  'pause',\n  'play',\n  'playbackStatusUpdate',\n  'playbackStatusChange',\n  'resolutionUpdate',\n  'volumeChange'\n]\n\n/**\n * Allows for programmatic control of a PeerTube embed running in an <iframe>\n * within a web page.\n */\nexport class PeerTubePlayer {\n\n  private readonly eventRegistrar: EventRegistrar = new EventRegistrar()\n  private channel: Channel.MessagingChannel\n  private readyPromise: Promise<void>\n\n  /**\n   * Construct a new PeerTubePlayer for the given PeerTube embed iframe.\n   * Optionally provide a `scope` to ensure that messages are not crossed\n   * between multiple PeerTube embeds. The string passed here must match the\n   * `scope=` query parameter on the embed URL.\n   *\n   * @param embedElement\n   * @param scope\n   */\n  constructor (\n    private readonly embedElement: HTMLIFrameElement,\n    private readonly scope?: string\n  ) {\n    this.eventRegistrar.registerTypes(PASSTHROUGH_EVENTS)\n\n    this.constructChannel()\n    this.prepareToBeReady()\n  }\n\n  /**\n   * Destroy the player object and remove the associated player from the DOM.\n   */\n  destroy () {\n    this.embedElement.remove()\n  }\n\n  /**\n   * Listen to an event emitted by this player.\n   *\n   * @param event One of the supported event types\n   * @param handler A handler which will be passed an event object (or undefined if no event object is included)\n   */\n  addEventListener (event: PlayerEventType, handler: EventHandler<any>): boolean {\n    return this.eventRegistrar.addListener(event, handler)\n  }\n\n  /**\n   * Remove an event listener previously added with addEventListener().\n   *\n   * @param event The name of the event previously listened to\n   * @param handler\n   */\n  removeEventListener (event: PlayerEventType, handler: EventHandler<any>): boolean {\n    return this.eventRegistrar.removeListener(event, handler)\n  }\n\n  /**\n   * Promise resolves when the player is ready.\n   */\n  get ready (): Promise<void> {\n    return this.readyPromise\n  }\n\n  /**\n   * Check if the player is playing the media\n   */\n  async isPlaying () {\n    return this.sendMessage<undefined, boolean>('isPlaying')\n  }\n\n  /**\n   * Tell the embed to start/resume playback\n   */\n  async play () {\n    await this.sendMessage('play')\n  }\n\n  /**\n   * Tell the embed to pause playback.\n   */\n  async pause () {\n    await this.sendMessage('pause')\n  }\n\n  /**\n   * Tell the embed to change the audio volume\n   *\n   * @param value A number from 0 to 1\n   */\n  async setVolume (value: number) {\n    await this.sendMessage('setVolume', value)\n  }\n\n  /**\n   * Get the current volume level in the embed.\n   *\n   * @param value A number from 0 to 1\n   */\n  async getVolume (): Promise<number> {\n    return this.sendMessage<undefined, number>('getVolume')\n  }\n\n  /**\n   * Tell the embed to change the current caption\n   *\n   * @param value Caption id\n   */\n  async setCaption (value: string) {\n    await this.sendMessage('setCaption', value)\n  }\n\n  /**\n   * Get video captions\n   */\n  async getCaptions (): Promise<PeerTubeTextTrack[]> {\n    return this.sendMessage<undefined, PeerTubeTextTrack[]>('getCaptions')\n  }\n\n  /**\n   * Get player current time in seconds.\n   *\n   */\n  async getCurrentTime () {\n    return this.sendMessage<undefined, number>('getCurrentTime')\n  }\n\n  /**\n   * Tell the embed to seek to a specific position (in seconds)\n   *\n   * @param seconds\n   */\n  async seek (seconds: number) {\n    await this.sendMessage('seek', seconds)\n  }\n\n  /**\n   * Tell the embed to switch resolutions to the resolution identified\n   * by the given ID.\n   *\n   * @param resolutionId The ID of the resolution as found with getResolutions()\n   */\n  async setResolution (resolutionId: any) {\n    await this.sendMessage('setResolution', resolutionId)\n  }\n\n  /**\n   * Retrieve a list of the available resolutions. This may change later, listen to the\n   * `resolutionUpdate` event with `addEventListener` in order to be updated as the available\n   * resolutions change.\n   */\n  async getResolutions (): Promise<PeerTubeResolution[]> {\n    return this.sendMessage<undefined, PeerTubeResolution[]>('getResolutions')\n  }\n\n  /**\n   * Retrieve a list of available playback rates.\n   */\n  async getPlaybackRates (): Promise<number[]> {\n    return this.sendMessage<undefined, number[]>('getPlaybackRates')\n  }\n\n  /**\n   * Get the current playback rate. Defaults to 1 (1x playback rate).\n   */\n  async getPlaybackRate (): Promise<number> {\n    return this.sendMessage<undefined, number>('getPlaybackRate')\n  }\n\n  /**\n   * Set the playback rate. Should be one of the options returned by getPlaybackRates().\n   * Passing 0.5 means half speed, 1 means normal, 2 means 2x speed, etc.\n   *\n   * @param rate\n   */\n  async setPlaybackRate (rate: number) {\n    await this.sendMessage('setPlaybackRate', rate)\n  }\n\n  /**\n   * Play next video in playlist\n   */\n  async playNextVideo () {\n    await this.sendMessage('playNextVideo')\n  }\n\n  /**\n   * Play previous video in playlist\n   */\n  async playPreviousVideo () {\n    await this.sendMessage('playPreviousVideo')\n  }\n\n  /**\n   * Get video position currently played (starts from 1)\n   */\n  async getCurrentPosition () {\n    return this.sendMessage<undefined, number>('getCurrentPosition')\n  }\n\n  /**\n   * Set video password to so the user doesn't have to manually fill it\n   *\n   * @param password\n   */\n  async setVideoPassword (password: string): Promise<void> {\n    await this.sendMessage('setVideoPassword', password)\n  }\n\n  /**\n   * Get video frame image as data url\n   */\n  async getImageDataUrl (): Promise<string> {\n    return this.sendMessage('getImageDataUrl')\n  }\n\n  private constructChannel () {\n    this.channel = Channel.build({\n      window: this.embedElement.contentWindow,\n      origin: '*',\n      scope: this.scope || 'peertube'\n    })\n    this.eventRegistrar.bindToChannel(this.channel)\n  }\n\n  private prepareToBeReady () {\n    let readyResolve: () => void\n    let readyReject: () => void\n\n    this.readyPromise = new Promise<void>((res, rej) => {\n      readyResolve = res\n      readyReject = rej\n    })\n\n    this.channel.bind('ready', success => success ? readyResolve() : readyReject())\n    this.channel.call({\n      method: 'isReady',\n      success: isReady => isReady ? readyResolve() : null\n    })\n  }\n\n  private sendMessage<TIn, TOut> (method: string, params?: TIn): Promise<TOut> {\n    return new Promise<TOut>((resolve, reject) => {\n      this.channel.call({\n        method,\n        params,\n        success: result => resolve(result),\n        error: error => reject(error)\n      })\n    })\n  }\n}\n\n// put it on the window as well as the export\n(window as any)['PeerTubePlayer'] = PeerTubePlayer\n","import { EventHandler } from './definitions'\n\ninterface PlayerEventRegistrar {\n  registrations: EventHandler<any>[]\n}\n\ninterface PlayerEventRegistrationMap {\n  [ name: string ]: PlayerEventRegistrar\n}\n\nexport class EventRegistrar {\n\n  private eventRegistrations: PlayerEventRegistrationMap = {}\n\n  public bindToChannel (channel: Channel.MessagingChannel) {\n    for (const name of Object.keys(this.eventRegistrations)) {\n      channel.bind(name, (txn, params) => this.fire(name, params))\n    }\n  }\n\n  public registerTypes (names: string[]) {\n    for (const name of names) {\n      this.eventRegistrations[name] = { registrations: [] }\n    }\n  }\n\n  public fire<T> (name: string, event: T) {\n    this.eventRegistrations[name].registrations.forEach(x => x(event))\n  }\n\n  public addListener<T> (name: string, handler: EventHandler<T>) {\n    if (!this.eventRegistrations[name]) {\n      console.warn(`PeerTube: addEventListener(): The event '${name}' is not supported`)\n      return false\n    }\n\n    this.eventRegistrations[name].registrations.push(handler)\n    return true\n  }\n\n  public removeListener<T> (name: string, handler: EventHandler<T>) {\n    if (!this.eventRegistrations[name]) return false\n\n    this.eventRegistrations[name].registrations = this.eventRegistrations[name].registrations.filter(x => x !== handler)\n\n    return true\n  }\n}\n","<ng-template #modal>\n  <div class=\"modal-header\">\n    <h4 i18n class=\"modal-title\">Edit caption \"{{ videoCaption.language.label }}\"</h4>\n\n    <button class=\"border-0 p-0\" title=\"Close this modal\" i18n-title (click)=\"hide()\">\n      <my-global-icon iconName=\"cross\"></my-global-icon>\n    </button>\n  </div>\n\n  <div class=\"modal-body\">\n\n    <div class=\"row\">\n\n      <my-embed *ngIf=\"videoEdit.isPublishedVOD()\" #embed class=\"col-md-12 col-xl-6 mb-3\" [video]=\"videoEdit.getVideoAttributes()\" enableAPI=\"true\"></my-embed>\n\n      <div [ngClass]=\"videoEdit.isPublishedVOD() ? 'col-xl-6 col-md-12' : ''\">\n\n        <div class=\"d-flex justify-content-between align-items-center mb-3 ms-2\">\n          <my-peertube-checkbox\n            inputName=\"raw-edition\"\n            [(ngModel)]=\"rawEdit\" (ngModelChange)=\"onRawEditSwitch()\"\n            i18n-labelText labelText=\"Edit raw\"\n          ></my-peertube-checkbox>\n\n          <my-button *ngIf=\"!rawEdit && !segmentToUpdate\" i18n-label label=\"Add a new segment\" (click)=\"addSegmentToEdit()\">\n          </my-button>\n        </div>\n\n        <div [hidden]=\"!rawEdit\" [formGroup]=\"form\">\n          <textarea\n            id=\"captionFileContent\"\n            formControlName=\"captionFileContent\"\n            i18n-label aria-label=\"Caption raw content\"\n            class=\"form-control caption-raw-textarea fs-7\"\n            [ngClass]=\"{ 'input-error': formErrors['captionFileContent'] }\"\n            #textarea\n          >\n          </textarea>\n\n          <div *ngIf=\"formErrors.captionFileContent\" class=\"form-error\" role=\"alert\">\n            {{ formErrors.captionFileContent }}\n          </div>\n        </div>\n\n        <div class=\"text-start segments pe-2 ps-2\" [hidden]=\"rawEdit\">\n          @for (segment of segments; track segment.id) {\n            <div class=\"pt-1 pb-1 mb-3\">\n              @if (segmentToUpdate === segment) {\n                <div role=\"form\">\n                  <div class=\"d-flex flex-wrap align-items-center\">\n                    <div>\n                      <label class=\"visually-hidden\" i18n for=\"segmentStart\">Segment start timestamp</label>\n\n                      <my-timestamp-input\n                        class=\"me-1\" inputName=\"segmentStart\" enableBorder=\"true\"\n                        [maxTimestamp]=\"(videoEdit.getVideoAttributes().duration || 0) * 1000\" mask=\"99:99:99.999\"\n                        [(ngModel)]=\"segment.startMs\" [parser]=\"timestampParser\" [formatter]=\"timestampFormatter\"\n                      ></my-timestamp-input>\n\n                      <my-button\n                        *ngIf=\"videoEdit.isPublishedVOD()\" icon=\"clock-arrow-down\"\n                        i18n-title title=\"Use video current time as start time\" (click)=\"videoTimeForSegmentStart(segment)\"\n                      >\n                      </my-button>\n                    </div>\n\n                    <my-global-icon class=\"d-inline-block ms-2 me-2\" iconName=\"move-right\"></my-global-icon>\n\n                    <div>\n                      <label class=\"visually-hidden\" i18n for=\"segmentEnd\">Segment end timestamp</label>\n\n                      <my-timestamp-input\n                        class=\"me-1\" inputName=\"segmentEnd\" enableBorder=\"true\"\n                        [maxTimestamp]=\"(videoEdit.getVideoAttributes().duration || 0) * 1000\" mask=\"99:99:99.999\"\n                        [(ngModel)]=\"segment.endMs\" [parser]=\"timestampParser\" [formatter]=\"timestampFormatter\"\n                      ></my-timestamp-input>\n\n                      <my-button\n                        *ngIf=\"videoEdit.isPublishedVOD()\" icon=\"clock-arrow-down\"\n                        i18n-title title=\"Use video current time as end time\" (click)=\"videoTimeForSegmentEnd(segment)\"\n                      >\n                      </my-button>\n                    </div>\n                  </div>\n\n                  <div class=\"d-flex mt-2\">\n                    <div class=\"form-group w-100\">\n                      <label class=\"visually-hidden\" i18n for=\"segment-edit\">Segment end timestamp</label>\n\n                      <textarea  id=\"segment-edit\" name=\"segment-edit\" class=\"form-control fs-7\" [(ngModel)]=\"segment.text\"></textarea>\n\n                      <div *ngIf=\"segmentEditError\" class=\"form-error\" role=\"alert\">{{ segmentEditError }}</div>\n                    </div>\n\n                    <div class=\"d-flex flex-column ms-3\">\n                      <my-button i18n-title title=\"Save\" icon=\"tick\" (click)=\"onEditSaved(segment)\"></my-button>\n                      <my-button class=\"mt-3\" i18n-title title=\"Revert\" icon=\"undo\" (click)=\"onEditCanceled(segment)\"></my-button>\n                    </div>\n                  </div>\n                </div>\n              } @else {\n                <div class=\"d-flex\">\n                  <div\n                    class=\"flex-grow-1 segment-text ps-1 pe-1\" role=\"button\" tabindex=\"0\" i18n-title title=\"Jump to this segment\"\n                    (keyup.enter)=\"onSegmentClick($event, segment)\" (click)=\"onSegmentClick($event, segment)\"\n                    [ngClass]=\"{ active: segment === activeSegment }\"\n                  >\n                    <strong class=\"segment-start me-2 d-block\">{{ segment.startFormatted }} -> {{ segment.endFormatted }}</strong>\n                    <span class=\"segment-text fs-7\">{{ segment.text }}</span>\n                  </div>\n\n                  <div class=\"d-flex flex-column ms-3\" [ngClass]=\"{ 'opacity-0': !!segmentToUpdate }\">\n                      @defer (on viewport) {\n                        <my-edit-button i18n-title title=\"Edit this segment\" (click)=\"updateSegment(segment)\"></my-edit-button>\n                        <my-delete-button class=\"mt-1\" i18n-title title=\"Delete this segment\" (click)=\"deleteSegment(segment)\"></my-delete-button>\n                      } @placeholder {\n                        <div style=\"height: 100%; width: 40px\"></div>\n                      }\n                    </div>\n                </div>\n              }\n            </div>\n          }\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"modal-footer inputs\">\n    <input\n      type=\"button\" role=\"button\" i18n-value value=\"Cancel\" class=\"peertube-button secondary-button\"\n      (click)=\"hide()\" (key.enter)=\"hide()\"\n    >\n\n    <input\n      type=\"button\" i18n-value value=\"Edit this caption\" class=\"peertube-button primary-button\"\n      [disabled]=\"rawEdit && !form.valid\" (click)=\"updateCaption()\"\n    >\n  </div>\n</ng-template>\n","import { NgClass, NgIf } from '@angular/common'\nimport { ChangeDetectorRef, Component, ElementRef, OnInit, inject, viewChild } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { VideoCaptionEdit, VideoCaptionWithPathEdit } from '@app/+videos-publish-manage/shared-manage/common/video-caption-edit.model'\nimport { VIDEO_CAPTION_FILE_CONTENT_VALIDATOR } from '@app/shared/form-validators/video-captions-validators'\nimport { FormReactive } from '@app/shared/shared-forms/form-reactive'\nimport { FormReactiveService } from '@app/shared/shared-forms/form-reactive.service'\nimport { PeertubeCheckboxComponent } from '@app/shared/shared-forms/peertube-checkbox.component'\nimport { TimestampInputComponent } from '@app/shared/shared-forms/timestamp-input.component'\nimport { VideoCaptionService } from '@app/shared/shared-main/video-caption/video-caption.service'\nimport { EmbedComponent } from '@app/shared/shared-main/video/embed.component'\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap'\nimport { millisecondsToVttTime, sortBy, timeToInt } from '@peertube/peertube-core-utils'\nimport { HTMLServerConfig, VideoConstant } from '@peertube/peertube-models'\nimport { parse } from '@plussub/srt-vtt-parser'\nimport { PeerTubePlayer } from '../../../../standalone/embed-player-api/player'\nimport { ConfirmService, Notifier, ServerService } from '../../../core'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { ButtonComponent } from '../../../shared/shared-main/buttons/button.component'\nimport { DeleteButtonComponent } from '../../../shared/shared-main/buttons/delete-button.component'\nimport { EditButtonComponent } from '../../../shared/shared-main/buttons/edit-button.component'\nimport { VideoEdit } from '../common/video-edit.model'\n\ntype Segment = {\n  id: string\n\n  startMs: number\n  startFormatted: string\n\n  endMs: number\n  endFormatted: string\n\n  text: string\n}\n\n@Component({\n  selector: 'my-video-caption-edit-modal',\n  styleUrls: [ './video-caption-edit-modal.component.scss' ],\n  templateUrl: './video-caption-edit-modal.component.html',\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    GlobalIconComponent,\n    NgClass,\n    NgIf,\n    PeertubeCheckboxComponent,\n    EmbedComponent,\n    EditButtonComponent,\n    ButtonComponent,\n    TimestampInputComponent,\n    DeleteButtonComponent\n  ]\n})\nexport class VideoCaptionEditModalComponent extends FormReactive implements OnInit {\n  protected formReactiveService = inject(FormReactiveService)\n  private videoCaptionService = inject(VideoCaptionService)\n  private serverService = inject(ServerService)\n  private notifier = inject(Notifier)\n  private cd = inject(ChangeDetectorRef)\n  private modalService = inject(NgbModal)\n  private confirmService = inject(ConfirmService)\n\n  readonly textarea = viewChild<ElementRef>('textarea')\n  readonly embed = viewChild<EmbedComponent>('embed')\n  readonly modal = viewChild<ElementRef>('modal')\n\n  private openedModal: NgbModalRef\n\n  rawEdit = false\n  segments: Segment[] = []\n\n  segmentToUpdate: Segment\n  segmentEditError = ''\n  private segmentToUpdateSave: Segment\n\n  activeSegment: Segment\n\n  videoCaptionLanguages: VideoConstant<string>[] = []\n\n  timestampParser = this.webvttToMS.bind(this)\n  timestampFormatter = millisecondsToVttTime\n\n  private player: PeerTubePlayer\n\n  // Show options\n  videoCaption: VideoCaptionWithPathEdit\n  serverConfig: HTMLServerConfig\n  videoEdit: VideoEdit\n  captionEdited: (caption: VideoCaptionEdit) => any\n\n  ngOnInit () {\n    this.serverService.getVideoLanguages().subscribe(languages => {\n      this.videoCaptionLanguages = languages\n    })\n\n    this.buildForm({ captionFileContent: VIDEO_CAPTION_FILE_CONTENT_VALIDATOR })\n  }\n\n  show (options: {\n    videoCaption: VideoCaptionWithPathEdit\n    serverConfig: HTMLServerConfig\n    videoEdit: VideoEdit\n    captionEdited: (caption: VideoCaptionEdit) => any\n  }) {\n    this.videoCaption = options.videoCaption\n    this.serverConfig = options.serverConfig\n    this.videoEdit = options.videoEdit\n    this.captionEdited = options.captionEdited\n\n    this.rawEdit = false\n    this.segments = []\n    this.segmentToUpdate = undefined\n\n    this.openedModal = this.modalService.open(this.modal(), {\n      centered: true,\n      size: 'xl',\n\n      beforeDismiss: () => {\n        return this.confirmService.confirm(\n          $localize`Are you sure you want to close this modal without saving your changes?`,\n          $localize`Close modal window`\n        )\n      }\n    })\n\n    this.loadCaptionContent()\n\n    setTimeout(() => this.initEmbed())\n  }\n\n  hide () {\n    this.videoCaption = undefined\n    this.serverConfig = undefined\n    this.videoEdit = undefined\n    this.captionEdited = undefined\n\n    this.openedModal.close()\n    this.form.reset()\n  }\n\n  initEmbed () {\n    const embed = this.embed()\n    if (embed) {\n      this.player = new PeerTubePlayer(embed.getIframe())\n\n      this.player.addEventListener('playbackStatusUpdate', ({ position }) => {\n        this.activeSegment = undefined\n\n        if (isNaN(position)) return\n\n        for (let i = this.segments.length - 1; i >= 0; i--) {\n          const current = this.segments[i]\n\n          if (current.startMs / 1000 <= position && this.activeSegment !== current) {\n            this.activeSegment = current\n            this.cd.detectChanges()\n            break\n          }\n        }\n      })\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n\n  loadCaptionContent () {\n    this.rawEdit = false\n\n    if (this.videoCaption.action === 'CREATE' || this.videoCaption.action === 'UPDATE') {\n      const file = this.videoCaption.captionfile as File\n\n      file.text().then(content => this.loadSegments(content))\n      return\n    }\n\n    const { fileUrl } = this.videoCaption\n    if (!fileUrl) return\n\n    this.videoCaptionService.getCaptionContent({ fileUrl })\n      .subscribe(content => {\n        this.loadSegments(content)\n      })\n  }\n\n  onRawEditSwitch () {\n    if (this.rawEdit === true) {\n      this.segmentToUpdate = undefined\n      this.form.patchValue({ captionFileContent: this.formatSegments() })\n      this.resetTextarea()\n    } else {\n      this.loadSegments(this.form.value['captionFileContent'])\n      this.updateSegmentPositions()\n    }\n  }\n\n  onSegmentClick (event: Event, segment: Segment) {\n    event.preventDefault()\n\n    if (!this.player) return\n\n    this.player.play()\n    this.player.seek(segment.startMs / 1000)\n  }\n\n  onEditSaved (segment: Segment) {\n    this.segmentEditError = ''\n\n    if (segment.startMs >= segment.endMs) {\n      this.segmentEditError = $localize`Start segment must be before end segment time`\n      return\n    }\n\n    if (!segment.text) {\n      this.segmentEditError = $localize`Segment must have a text content`\n      return\n    }\n\n    this.segmentToUpdate = undefined\n\n    segment.startFormatted = millisecondsToVttTime(segment.startMs)\n    segment.endFormatted = millisecondsToVttTime(segment.endMs)\n\n    this.updateSegmentPositions()\n    this.scrollToSegment(segment)\n  }\n\n  onEditCanceled (segment: Segment) {\n    if (!this.segmentToUpdateSave) {\n      this.segments = this.segments.filter(s => s.id !== segment.id)\n      return\n    }\n\n    segment.startMs = this.segmentToUpdateSave.startMs\n    segment.endMs = this.segmentToUpdateSave.endMs\n    segment.text = this.segmentToUpdateSave.text\n\n    this.onEditSaved(segment)\n  }\n\n  updateSegment (segment: Segment) {\n    this.segmentEditError = ''\n\n    this.segmentToUpdateSave = { ...segment }\n    this.segmentToUpdate = segment\n  }\n\n  async addSegmentToEdit () {\n    const currentTime = this.player\n      ? await this.player.getCurrentTime()\n      : 0\n\n    const startMs = currentTime * 1000\n    const endMs = startMs + 1000\n\n    const segment = {\n      startMs,\n      startFormatted: millisecondsToVttTime(startMs),\n      endMs,\n      endFormatted: millisecondsToVttTime(endMs),\n      id: '0',\n      text: ''\n    }\n\n    this.segments = [ segment, ...this.segments ]\n    this.segmentToUpdate = segment\n\n    document.querySelector<HTMLElement>('.segments').scrollTop = 0\n  }\n\n  deleteSegment (segment: Segment) {\n    this.segments = this.segments.filter(s => s !== segment)\n    this.updateSegmentPositions()\n  }\n\n  private updateSegmentPositions () {\n    this.segments = sortBy(this.segments, 'startMs')\n\n    for (let i = 1; i <= this.segments.length; i++) {\n      this.segments[i - 1].id = `${i}`\n    }\n  }\n\n  async videoTimeForSegmentStart (segment: Segment) {\n    segment.startMs = await this.player.getCurrentTime() * 1000\n    segment.startFormatted = millisecondsToVttTime(segment.startMs)\n  }\n\n  async videoTimeForSegmentEnd (segment: Segment) {\n    segment.endMs = await this.player.getCurrentTime() * 1000\n    segment.endFormatted = millisecondsToVttTime(segment.endMs)\n  }\n\n  private webvttToMS (webvttDuration: string) {\n    const [ time, ms ] = webvttDuration.split('.')\n\n    return timeToInt(time) * 1000 + parseInt(ms)\n  }\n\n  private loadSegments (content: string) {\n    try {\n      const entries = parse(content).entries\n\n      this.segments = entries.map(({ id, from, to, text }) => {\n        return {\n          id,\n\n          startMs: from,\n          startFormatted: millisecondsToVttTime(from),\n\n          endMs: to,\n          endFormatted: millisecondsToVttTime(to),\n\n          text\n        }\n      })\n    } catch (err) {\n      console.error(err)\n      this.notifier.error($localize`Cannot parse subtitles`)\n    }\n  }\n\n  private formatSegments () {\n    let content = `WEBVTT\\n`\n\n    for (const segment of this.segments) {\n      content += `\\n${segment.id}\\n`\n      content += `${millisecondsToVttTime(segment.startMs)} --> ${millisecondsToVttTime(segment.endMs)}\\n`\n      content += `${segment.text}\\n`\n    }\n\n    return content\n  }\n\n  private resetTextarea () {\n    const el = this.textarea().nativeElement\n\n    el.scrollTop = 0\n    el.selectionStart = 0\n    el.selectionEnd = 0\n  }\n\n  updateCaption () {\n    if (this.segmentToUpdate) {\n      console.log(this.segmentToUpdate)\n      this.notifier.error($localize`A segment is being edited. Save or cancel your edits first.`)\n      return\n    }\n\n    const languageId = this.videoCaption.language.id\n    const languageObject = this.videoCaptionLanguages.find(l => l.id === languageId)\n\n    if (this.rawEdit) {\n      this.loadSegments(this.form.value['captionFileContent'])\n    }\n\n    this.captionEdited({\n      language: languageObject,\n      captionfile: new File([ this.formatSegments() ], `${languageId}.vtt`, {\n        type: 'text/vtt',\n        lastModified: Date.now()\n      }),\n      action: 'UPDATE'\n    })\n\n    this.openedModal.close()\n  }\n\n  private scrollToSegment (segment: Segment) {\n    setTimeout(() => {\n      const element = document.querySelector<HTMLElement>(`.segments > div:nth-child(${parseInt(segment.id) + 1})`)\n      if (!element) return\n\n      element.scrollIntoView({ behavior: 'smooth', block: 'center' })\n    })\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"captions\"></my-global-icon>\n\n  <ng-container i18n>Captions</ng-container>\n</h2>\n\n@if (isLive()) {\n  <my-alert type=\"primary\" i18n>Captions are not available on a live.</my-alert>\n} @else {\n  <div class=\"captions\">\n    <my-alert type=\"primary\" *ngIf=\"displayTranscriptionInfo && isTranscriptionEnabled() && !hasCaptions()\" i18n>\n      Subtitles will be automatically generated from your video.\n    </my-alert>\n\n    <div class=\"form-group\" *ngFor=\"let videoCaption of videoEdit.getCaptionsEdit()\">\n\n      <div class=\"caption-entry\">\n\n        @if (videoCaption.action) {\n          <span class=\"caption-entry-label\">{{ getCaptionLabel(videoCaption) }}</span>\n\n          @switch (videoCaption.action) {\n            @case ('CREATE') {\n              <div i18n class=\"caption-entry-state green\">Will be created on update</div>\n            } @case ('UPDATE') {\n              <div i18n class=\"caption-entry-state green\">Will be edited on update</div>\n            } @case ('REMOVE') {\n              <div i18n class=\"caption-entry-state red\">Will be deleted on update</div>\n            }\n          }\n\n          @if (videoCaption.action === 'CREATE' || videoCaption.action === 'UPDATE') {\n            <my-edit-button class=\"me-2\" i18n-label label=\"Edit\" (click)=\"openEditCaptionModal(videoCaption)\"></my-edit-button>\n          }\n\n          <my-button i18n (click)=\"deleteCaption(videoCaption)\" icon=\"undo\">\n            @switch (videoCaption.action) {\n              @case ('CREATE') {\n                Cancel creation\n              } @case ('UPDATE') {\n                Cancel editing\n              } @case ('REMOVE') {\n                Cancel deletion\n              }\n            }\n          </my-button>\n        } @else {\n          <a\n            i18n-title title=\"See the subtitle file\" class=\"caption-entry-label\" target=\"_blank\" rel=\"noopener noreferrer\"\n            [href]=\"videoCaption.fileUrl\"\n          >{{ getCaptionLabel(videoCaption) }}</a>\n\n          <div i18n class=\"caption-entry-state\">Uploaded on {{ videoCaption.updatedAt | ptDate }}\t&#10004;</div>\n\n          <my-edit-button i18n-label label=\"Edit\" class=\"me-2\" (click)=\"openEditCaptionModal(videoCaption)\"></my-edit-button>\n          <my-delete-button label (click)=\"deleteCaption(videoCaption)\"></my-delete-button>\n        }\n      </div>\n    </div>\n\n    <div i18n class=\"no-caption\" *ngIf=\"videoEdit.getCaptionsEdit()?.length === 0\">\n      No captions for now.\n    </div>\n\n    <div class=\"mt-3 mb-3\">\n      <button (click)=\"openAddCaptionModal()\" class=\"peertube-create-button\">\n        <my-global-icon iconName=\"add\" aria-hidden=\"true\"></my-global-icon>\n        <ng-container i18n>Add a caption</ng-container>\n      </button>\n    </div>\n\n  </div>\n}\n\n<my-video-caption-add-modal\n  #videoCaptionAddModal [existingCaptions]=\"getExistingCaptions()\" [serverConfig]=\"serverConfig\" (captionAdded)=\"onCaptionEdited($event)\"\n></my-video-caption-add-modal>\n\n<my-video-caption-edit-modal #videoCaptionEditModal></my-video-caption-edit-modal>\n","import { AbstractControl, ValidationErrors, ValidatorFn, Validators } from '@angular/forms'\nimport { BuildFormValidator } from './form-validator.model'\n\nexport const VIDEO_CHAPTER_TITLE_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.minLength(2), Validators.maxLength(100) ], // Required is set dynamically\n  MESSAGES: {\n    required: $localize`A chapter title is required.`,\n    minlength: $localize`A chapter title should be more than 2 characters long.`,\n    maxlength: $localize`A chapter title should be less than 100 characters long.`\n  }\n}\n\nexport const VIDEO_CHAPTERS_ARRAY_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ uniqueTimecodeValidator() ],\n  MESSAGES: {}\n}\n\nfunction uniqueTimecodeValidator (): ValidatorFn {\n  return (control: AbstractControl): ValidationErrors => {\n    const array = control.value as { timecode: number, title: string }[]\n\n    for (const chapter of array) {\n      if (!chapter.title) continue\n\n      if (array.filter(c => c.title && c.timecode === chapter.timecode).length > 1) {\n        return { uniqueTimecode: $localize`Multiple chapters have the same timecode ${chapter.timecode}` }\n      }\n    }\n\n    return null\n  }\n}\n","import { NgClass, NgFor, NgIf } from '@angular/common'\nimport { Component, OnDestroy, OnInit, inject } from '@angular/core'\nimport { FormArray, FormControl, FormGroup, FormsModule, ReactiveFormsModule, Validators } from '@angular/forms'\nimport { VIDEO_CHAPTERS_ARRAY_VALIDATOR, VIDEO_CHAPTER_TITLE_VALIDATOR } from '@app/shared/form-validators/video-chapter-validators'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport { FormValidatorService } from '@app/shared/shared-forms/form-validator.service'\nimport { AlertComponent } from '@app/shared/shared-main/common/alert.component'\nimport debug from 'debug'\nimport { CalendarModule } from 'primeng/calendar'\nimport { Subscription } from 'rxjs'\nimport { TimestampInputComponent } from '../../../shared/shared-forms/timestamp-input.component'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { DeleteButtonComponent } from '../../../shared/shared-main/buttons/delete-button.component'\nimport { EmbedComponent } from '../../../shared/shared-main/video/embed.component'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoManageController } from '../video-manage-controller.service'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype ChapterForm = {\n  timecode: FormControl<number>\n  title: FormControl<string>\n}\n\ntype Form = {\n  chapters: FormArray<FormGroup<ChapterForm>>\n}\n\n@Component({\n  selector: 'my-video-chapters',\n  styleUrls: [\n    '../common/video-manage-page-common.scss',\n    './video-chapters.component.scss'\n  ],\n  templateUrl: './video-chapters.component.html',\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    NgIf,\n    CalendarModule,\n    NgFor,\n    NgClass,\n    TimestampInputComponent,\n    DeleteButtonComponent,\n    EmbedComponent,\n    AlertComponent,\n    GlobalIconComponent\n  ]\n})\nexport class VideoChaptersComponent implements OnInit, OnDestroy {\n  private formValidatorService = inject(FormValidatorService)\n  private formReactiveService = inject(FormReactiveService)\n  private manageController = inject(VideoManageController)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors & { chapters?: { title: string }[] } = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  videoEdit: VideoEdit\n\n  private updatedSub: Subscription\n\n  ngOnInit () {\n    const { videoEdit } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n\n    this.buildForm()\n  }\n\n  private buildForm () {\n    const { form, formErrors, validationMessages } = this.formReactiveService.buildForm<Form>({}, {})\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.form.addControl('chapters', new FormArray([], VIDEO_CHAPTERS_ARRAY_VALIDATOR.VALIDATORS))\n    this.addNewChapterControl()\n\n    form.get('chapters').valueChanges.subscribe(chapters => {\n      const lastChapter = chapters[chapters.length - 1]\n\n      if (lastChapter.title || lastChapter.timecode) {\n        this.addNewChapterControl()\n      }\n    })\n\n    this.patchChapters()\n\n    this.form.valueChanges.subscribe(() => {\n      const chapterErrors = {\n        chapters: !this.form.valid\n          ? $localize`Some chapters are invalid`\n          : undefined\n      }\n\n      this.manageController.setFormError($localize`Chapters`, 'chapters', chapterErrors)\n\n      const formValues = this.form.value\n      debugLogger('Updating form values', formValues)\n\n      this.videoEdit.getChaptersEdit().loadFromForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.patchChapters()\n    })\n  }\n\n  ngOnDestroy () {\n    this.updatedSub?.unsubscribe()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  addNewChapterControl () {\n    const chaptersFormArray = this.getChaptersFormArray()\n    const controls = chaptersFormArray.controls\n\n    if (controls.length !== 0) {\n      const lastControl = chaptersFormArray.controls[controls.length - 1]\n      lastControl.get('title').addValidators(Validators.required)\n    }\n\n    this.formValidatorService.addControlInFormArray({\n      controlName: 'chapters',\n      formArray: chaptersFormArray,\n      formErrors: this.formErrors,\n      validationMessages: this.validationMessages,\n      formToBuild: {\n        timecode: null,\n        title: VIDEO_CHAPTER_TITLE_VALIDATOR\n      },\n      defaultValues: {\n        timecode: 0\n      }\n    })\n  }\n\n  getChaptersFormArray () {\n    return this.form.controls.chapters\n  }\n\n  deleteChapterControl (index: number) {\n    this.formValidatorService.removeControlFromFormArray({\n      controlName: 'chapters',\n      formArray: this.getChaptersFormArray(),\n      formErrors: this.formErrors,\n      validationMessages: this.validationMessages,\n      index\n    })\n  }\n\n  isLastChapterControl (index: number) {\n    return this.getChaptersFormArray().length - 1 === index\n  }\n\n  getChapterArrayErrors () {\n    if (!this.getChaptersFormArray().errors) return ''\n\n    return Object.values(this.getChaptersFormArray().errors).join('. ')\n  }\n\n  private patchChapters () {\n    const chaptersEdit = this.videoEdit.getChaptersEdit()\n\n    const totalChapters = chaptersEdit.getChaptersForUpdate().length\n    const totalControls = this.getChaptersFormArray().length\n\n    // Add missing controls. We use <= because we need the \"empty control\" to add another chapter\n    for (let i = 0; i <= totalChapters - totalControls; i++) {\n      this.addNewChapterControl()\n    }\n\n    this.form.patchValue(chaptersEdit.toFormPatch())\n  }\n\n  isLive () {\n    return this.videoEdit.getVideoAttributes().isLive\n  }\n\n  getEmbedVersion () {\n    return this.manageController.getEmbedVersion()\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"chapters\"></my-global-icon>\n\n  <ng-container i18n>Chapters</ng-container>\n</h2>\n\n@if (isLive()) {\n  <my-alert type=\"primary\" i18n>Chapters are not available on a live.</my-alert>\n} @else {\n  <div [formGroup]=\"form\">\n    <div class=\"row mb-5\">\n      <div class=\"chapters col-md-12 col-xl-6\" formArrayName=\"chapters\">\n        <my-alert type=\"primary\" i18n>\n          Chapters can also be set in the video description.\n\n          Check the format <a href=\"https://docs.joinpeertube.org/use/create-upload-video#chapters\" target=\"_blank\" class=\"alert-link\">in the PeerTube documentation</a>\n        </my-alert>\n\n        <ng-container *ngFor=\"let chapterControl of getChaptersFormArray().controls; let i = index\">\n          <div class=\"chapter\" [formGroupName]=\"i\">\n            <!-- Row 1 -->\n            <div></div>\n\n            <label i18n [ngClass]=\"{ 'hide-chapter-label': i !== 0 }\" [for]=\"'timecode[' + i + ']'\">Timecode</label>\n\n            <label i18n [ngClass]=\"{ 'hide-chapter-label': i !== 0 }\" [for]=\"'title[' + i + ']'\">Chapter name</label>\n\n            <div></div>\n\n            <!-- Row 2 -->\n            <div class=\"position\">{{ i + 1 }}</div>\n\n            <my-timestamp-input\n              class=\"d-block\" enableBorder=\"true\" [inputName]=\"'timecode[' + i + ']'\"\n              [maxTimestamp]=\"videoEdit.getVideoAttributes().duration || null\" formControlName=\"timecode\"\n            ></my-timestamp-input>\n\n            <div>\n              <input\n                [ngClass]=\"{ 'input-error': formErrors.chapters[i].title }\"\n                type=\"text\" [id]=\"'title[' + i + ']'\" [name]=\"'title[' + i + ']'\" formControlName=\"title\"\n              />\n\n              <div [ngClass]=\"{ 'opacity-0': !formErrors.chapters[i].title }\" class=\"form-error\" role=\"alert\">\n                <span class=\"opacity-0\">t</span> <!-- Ensure we have reserve a correct height -->\n                {{ formErrors.chapters[i].title }}\n              </div>\n            </div>\n\n            <my-delete-button *ngIf=\"!isLastChapterControl(i)\" (click)=\"deleteChapterControl(i)\"></my-delete-button>\n          </div>\n        </ng-container>\n\n        <div *ngIf=\"getChapterArrayErrors()\" class=\"form-error\" role=\"alert\">\n          {{ getChapterArrayErrors() }}\n        </div>\n      </div>\n\n      <my-embed *ngIf=\"videoEdit.isPublishedVOD()\" class=\"col-md-12 col-xl-6\" [video]=\"videoEdit.getVideoAttributes()\" [version]=\"getEmbedVersion()\"></my-embed>\n    </div>\n  </div>\n}\n","import { AbstractControl, ValidationErrors, ValidatorFn, Validators, FormControl } from '@angular/forms'\nimport { BuildFormValidator } from './form-validator.model'\n\nexport const trimValidator: ValidatorFn = (control: FormControl) => {\n  if (control.value.startsWith(' ') || control.value.endsWith(' ')) {\n    return { spaces: true }\n  }\n\n  return null\n}\n\nexport const VIDEO_NAME_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.required, Validators.minLength(3), Validators.maxLength(120) ],\n  MESSAGES: {\n    required: $localize`Video name is required.`,\n    minlength: $localize`Video name must be at least 3 characters long.`,\n    maxlength: $localize`Video name cannot be more than 120 characters long.`,\n    spaces: $localize`Video name has leading or trailing whitespace.`\n  }\n}\n\nexport const VIDEO_PRIVACY_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.required ],\n  MESSAGES: {\n    required: $localize`Video privacy is required.`\n  }\n}\n\nexport const VIDEO_PASSWORD_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.minLength(2), Validators.maxLength(100) ], // Required is set dynamically\n  MESSAGES: {\n    minlength: $localize`A password should be at least 2 characters long.`,\n    maxlength: $localize`A password should be shorter than 100 characters long.`,\n    required: $localize`A password is required for password protected video.`\n  }\n}\n\nexport const VIDEO_CATEGORY_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [],\n  MESSAGES: {}\n}\n\nexport const VIDEO_LICENCE_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [],\n  MESSAGES: {}\n}\n\nexport const VIDEO_LANGUAGE_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [],\n  MESSAGES: {}\n}\n\nexport const VIDEO_IMAGE_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [],\n  MESSAGES: {}\n}\n\nexport const VIDEO_CHANNEL_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.required ],\n  MESSAGES: {\n    required: $localize`Video channel is required.`\n  }\n}\n\nexport const VIDEO_DESCRIPTION_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.minLength(3), Validators.maxLength(10000) ],\n  MESSAGES: {\n    minlength: $localize`Video description must be at least 3 characters long.`,\n    maxlength: $localize`Video description cannot be more than 10000 characters long.`\n  }\n}\n\nexport const VIDEO_TAGS_ARRAY_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.maxLength(5), arrayTagLengthValidator() ],\n  MESSAGES: {\n    maxlength: $localize`A maximum of 5 tags can be used on a video.`,\n    arrayTagLength: $localize`A tag should be more than 1 and less than 30 characters long.`\n  }\n}\n\nexport const VIDEO_SUPPORT_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.minLength(3), Validators.maxLength(1000) ],\n  MESSAGES: {\n    minlength: $localize`Video support must be at least 3 characters long.`,\n    maxlength: $localize`Video support cannot be more than 1000 characters long.`\n  }\n}\n\nexport const VIDEO_NSFW_SUMMARY_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [ Validators.minLength(3), Validators.maxLength(250) ],\n  MESSAGES: {\n    minlength: $localize`Video support must be at least 3 characters long.`,\n    maxlength: $localize`Video support cannot be more than 250 characters long.`\n  }\n}\n\nexport const VIDEO_SCHEDULE_PUBLICATION_AT_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [], // Required is set dynamically\n  MESSAGES: {\n    required: $localize`A date is required to schedule video update.`\n  }\n}\n\nexport const VIDEO_ORIGINALLY_PUBLISHED_AT_VALIDATOR: BuildFormValidator = {\n  VALIDATORS: [],\n  MESSAGES: {}\n}\n\nfunction arrayTagLengthValidator (min = 2, max = 30): ValidatorFn {\n  return (control: AbstractControl): ValidationErrors => {\n    const array = control.value as string[]\n\n    if (array.every(e => e.length >= min && e.length <= max)) {\n      return null\n    }\n\n    return { arrayTagLength: true }\n  }\n}\n","import { NgIf } from '@angular/common'\nimport { Component, OnDestroy, OnInit, inject } from '@angular/core'\nimport { FormControl, FormGroup, FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { ServerService } from '@app/core'\nimport { BuildFormArgument } from '@app/shared/form-validators/form-validator.model'\nimport { VIDEO_ORIGINALLY_PUBLISHED_AT_VALIDATOR } from '@app/shared/form-validators/video-validators'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport { HTMLServerConfig } from '@peertube/peertube-models'\nimport debug from 'debug'\nimport { CalendarModule } from 'primeng/calendar'\nimport { Subscription } from 'rxjs'\nimport { PeertubeCheckboxComponent } from '../../../shared/shared-forms/peertube-checkbox.component'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { I18nPrimengCalendarService } from '../common/i18n-primeng-calendar.service'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoManageController } from '../video-manage-controller.service'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype Form = {\n  downloadEnabled: FormControl<boolean>\n  originallyPublishedAt: FormControl<Date>\n}\n\n@Component({\n  selector: 'my-video-customization',\n  styleUrls: [\n    '../common/video-manage-page-common.scss'\n  ],\n  templateUrl: './video-customization.component.html',\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    NgIf,\n    CalendarModule,\n    PeertubeCheckboxComponent,\n    GlobalIconComponent\n  ]\n})\nexport class VideoCustomizationComponent implements OnInit, OnDestroy {\n  private formReactiveService = inject(FormReactiveService)\n  private serverService = inject(ServerService)\n  private i18nPrimengCalendarService = inject(I18nPrimengCalendarService)\n  private manageController = inject(VideoManageController)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  videoEdit: VideoEdit\n\n  calendarDateFormat: string\n  myYearRange: string\n\n  serverConfig: HTMLServerConfig\n\n  private updatedSub: Subscription\n\n  constructor () {\n    this.calendarDateFormat = this.i18nPrimengCalendarService.getDateFormat()\n    this.myYearRange = this.i18nPrimengCalendarService.getVideoPublicationYearRange()\n  }\n\n  ngOnInit () {\n    this.serverConfig = this.serverService.getHTMLConfig()\n\n    const { videoEdit } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n\n    this.buildForm()\n  }\n\n  private buildForm () {\n    const defaultValues = this.videoEdit.toCommonFormPatch()\n    const obj: BuildFormArgument = {\n      downloadEnabled: null,\n      originallyPublishedAt: VIDEO_ORIGINALLY_PUBLISHED_AT_VALIDATOR\n    }\n\n    const {\n      form,\n      formErrors,\n      validationMessages\n    } = this.formReactiveService.buildForm<Form>(obj, defaultValues)\n\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.form.valueChanges.subscribe(() => {\n      this.manageController.setFormError($localize`Customization`, 'customization', this.formErrors)\n\n      const formValues = this.form.value\n      debugLogger('Updating form values', formValues)\n\n      this.videoEdit.loadFromCommonForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.form.patchValue(this.videoEdit.toCommonFormPatch())\n    })\n  }\n\n  ngOnDestroy () {\n    this.updatedSub?.unsubscribe()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  hasPublicationDate () {\n    return !!this.form.value.originallyPublishedAt\n  }\n\n  resetField (name: string) {\n    this.form.patchValue({ [name]: null })\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"cog\"></my-global-icon>\n\n  <ng-container i18n>Customization</ng-container>\n</h2>\n\n<div [formGroup]=\"form\">\n  <div class=\"form-columns\">\n    <div>\n      <div *ngIf=\"videoEdit.getVideoSource()\" class=\"form-group\">\n        <label i18n for=\"filename\">Filename</label>\n\n        <div class=\"form-group-description\" i18n>\n          Name of the uploaded file.\n        </div>\n\n        <input type=\"text\" [disabled]=\"true\" id=\"filename\" class=\"form-control\" [value]=\"videoEdit.getVideoSource().filename\" />\n      </div>\n\n      <div class=\"form-group originally-published-at\">\n        <div class=\"label-container\">\n          <label i18n for=\"originallyPublishedAt\">Original publication date</label>\n\n          <button i18n class=\"reset-button reset-button-small\" (click)=\"resetField('originallyPublishedAt')\" *ngIf=\"hasPublicationDate()\">\n            Reset\n          </button>\n        </div>\n\n        <div class=\"form-group-description\" i18n>\n          This is the date when the content was originally published (e.g. the release date for a film)\n        </div>\n\n        <p-calendar\n          inputId=\"originallyPublishedAt\" formControlName=\"originallyPublishedAt\" [dateFormat]=\"calendarDateFormat\" [firstDayOfWeek]=\"0\"\n          [showTime]=\"true\" [hideOnDateTimeSelect]=\"true\" [monthNavigator]=\"true\" [yearNavigator]=\"true\" [yearRange]=\"myYearRange\"\n          baseZIndex=\"20000\"\n        >\n        </p-calendar>\n\n        <div *ngIf=\"formErrors.originallyPublishedAt\" class=\"form-error\" role=\"alert\">\n          {{ formErrors.originallyPublishedAt }}\n        </div>\n      </div>\n\n      <my-peertube-checkbox\n        inputName=\"downloadEnabled\" formControlName=\"downloadEnabled\"\n        i18n-labelText labelText=\"Enable download\"\n      ></my-peertube-checkbox>\n    </div>\n  </div>\n</div>\n","import { CommonModule } from '@angular/common'\nimport { Component, OnDestroy, OnInit, inject } from '@angular/core'\nimport { FormControl, FormGroup, FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { ServerService } from '@app/core'\nimport { BuildFormArgument } from '@app/shared/form-validators/form-validator.model'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport { AlertComponent } from '@app/shared/shared-main/common/alert.component'\nimport { VideoService } from '@app/shared/shared-main/video/video.service'\nimport {\n  HTMLServerConfig,\n  LiveVideoLatencyMode,\n  LiveVideoLatencyModeType,\n  VideoConstant,\n  VideoPrivacy,\n  VideoPrivacyType,\n  VideoState\n} from '@peertube/peertube-models'\nimport debug from 'debug'\nimport { CalendarModule } from 'primeng/calendar'\nimport { Subscription } from 'rxjs'\nimport { SelectOptionsItem } from 'src/types/select-options-item.model'\nimport { InputTextComponent } from '../../../shared/shared-forms/input-text.component'\nimport { PeertubeCheckboxComponent } from '../../../shared/shared-forms/peertube-checkbox.component'\nimport { SelectOptionsComponent } from '../../../shared/shared-forms/select/select-options.component'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { PeerTubeTemplateDirective } from '../../../shared/shared-main/common/peertube-template.directive'\nimport { TimeDurationFormatterPipe } from '../../../shared/shared-main/date/time-duration-formatter.pipe'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoManageController } from '../video-manage-controller.service'\nimport { LiveDocumentationLinkComponent } from './live-documentation-link.component'\nimport { LiveStreamInformationComponent } from './live-stream-information.component'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype Form = {\n  liveStreamKey: FormControl<string>\n  permanentLive: FormControl<boolean>\n  latencyMode: FormControl<LiveVideoLatencyModeType>\n  saveReplay: FormControl<boolean>\n  replayPrivacy: FormControl<VideoPrivacyType>\n}\n\n@Component({\n  selector: 'my-video-live-settings',\n  styleUrls: [\n    '../common/video-manage-page-common.scss'\n  ],\n  templateUrl: './video-live-settings.component.html',\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    PeerTubeTemplateDirective,\n    SelectOptionsComponent,\n    InputTextComponent,\n    CalendarModule,\n    PeertubeCheckboxComponent,\n    LiveDocumentationLinkComponent,\n    AlertComponent,\n    TimeDurationFormatterPipe,\n    GlobalIconComponent,\n    LiveStreamInformationComponent\n  ]\n})\nexport class VideoLiveSettingsComponent implements OnInit, OnDestroy {\n  private formReactiveService = inject(FormReactiveService)\n  private videoService = inject(VideoService)\n  private serverService = inject(ServerService)\n  private manageController = inject(VideoManageController)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  videoEdit: VideoEdit\n\n  replayPrivacies: VideoConstant<VideoPrivacyType>[] = []\n\n  latencyModes: SelectOptionsItem[] = [\n    {\n      id: LiveVideoLatencyMode.SMALL_LATENCY,\n      label: $localize`Small latency`,\n      description: $localize`Reduce latency to ~15s disabling P2P`\n    },\n    {\n      id: LiveVideoLatencyMode.DEFAULT,\n      label: $localize`Default`,\n      description: $localize`Average latency of 30s`\n    },\n    {\n      id: LiveVideoLatencyMode.HIGH_LATENCY,\n      label: $localize`High latency`,\n      description: $localize`Average latency of 60s increasing P2P ratio`\n    }\n  ]\n\n  serverConfig: HTMLServerConfig\n\n  private updatedSub: Subscription\n\n  ngOnInit () {\n    this.serverConfig = this.serverService.getHTMLConfig()\n\n    const { videoEdit } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n\n    this.buildForm()\n\n    this.serverService.getVideoPrivacies()\n      .subscribe(privacies => {\n        this.replayPrivacies = this.videoService.explainedPrivacyLabels(privacies)\n          .videoPrivacies\n          .filter(privacy => privacy.id !== VideoPrivacy.PASSWORD_PROTECTED)\n      })\n  }\n\n  ngOnDestroy () {\n    this.updatedSub?.unsubscribe()\n  }\n\n  private buildForm () {\n    const defaultValues = this.videoEdit.toLiveFormPatch()\n\n    const obj: BuildFormArgument = {\n      liveStreamKey: null,\n      permanentLive: null,\n      latencyMode: null,\n      saveReplay: null,\n      replayPrivacy: null\n    }\n\n    const {\n      form,\n      formErrors,\n      validationMessages\n    } = this.formReactiveService.buildForm<Form>(obj, defaultValues)\n\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.form.valueChanges.subscribe(() => {\n      this.manageController.setFormError($localize`Live settings`, 'live-settings', this.formErrors)\n\n      const formValues = this.form.value\n      debugLogger('Updating form values', formValues)\n\n      this.videoEdit.loadFromLiveForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.form.patchValue(this.videoEdit.toLiveFormPatch())\n    })\n  }\n\n  isSaveReplayAllowed () {\n    return this.serverConfig.live.allowReplay\n  }\n\n  isSaveReplayEnabled () {\n    return this.form.value.saveReplay === true\n  }\n\n  isPermanentLiveEnabled () {\n    return this.form.value.permanentLive === true\n  }\n\n  isLatencyModeEnabled () {\n    return this.serverConfig.live.latencySetting.enabled\n  }\n\n  isLive () {\n    return this.videoEdit.getVideoAttributes().isLive\n  }\n\n  hasEnded () {\n    return this.videoEdit.getVideoAttributes().state === VideoState.LIVE_ENDED\n  }\n\n  isStreaming () {\n    return this.videoEdit.getVideoAttributes().state === VideoState.PUBLISHED\n  }\n\n  getLive () {\n    return this.videoEdit.getVideoAttributes().live\n  }\n\n  getVideoName () {\n    return this.videoEdit.getVideoAttributes().name\n  }\n\n  getMaxLiveDuration () {\n    return this.serverConfig.live.maxDuration / 1000\n  }\n\n  getInstanceName () {\n    return this.serverConfig.instance.name\n  }\n}\n","import { Component } from '@angular/core'\n\n@Component({\n  selector: 'my-live-documentation-link',\n  templateUrl: './live-documentation-link.component.html',\n  styleUrls: [],\n  standalone: true\n})\nexport class LiveDocumentationLinkComponent {\n\n}\n","<p i18n>\n  See <a class=\"link-primary\" href=\"https://docs.joinpeertube.org/use/create-upload-video#publish-a-live\" target=\"_blank\" rel=\"noopener noreferrer\">the documentation</a>\n  to learn how to use the PeerTube live streaming feature.\n</p>\n","<div class=\"journal\" *ngIf=\"latestLiveSessions.length !== 0\">\n  <div class=\"label\" i18n>Latest live sessions</div>\n\n  <div class=\"journal-session d-flex align-items-center flex-wrap mb-2\" *ngFor=\"let session of latestLiveSessions\">\n    <span i18n class=\"pt-badge badge-success me-2\" *ngIf=\"!getErrorLabel(session)\">Success</span>\n    <span class=\"pt-badge badge-danger me-2\" *ngIf=\"getErrorLabel(session)\">{{ getErrorLabel(session) }}</span>\n\n    <span i18n>Started on <strong>{{ session.startDate | ptDate:'medium' }}</strong></span>\n    <span i18n *ngIf=\"session.endDate\">Ended on <strong>{{ session.endDate | ptDate:'medium' }}</strong></span>\n\n    <a i18n *ngIf=\"session.replayVideo\" [routerLink]=\"getVideoUrl(session.replayVideo)\" target=\"_blank\">Go to replay</a>\n    <span i18n *ngIf=\"isReplayBeingProcessed(session)\">Replay is being processed...</span>\n  </div>\n</div>\n","import { CommonModule } from '@angular/common'\nimport { Component, inject, input, OnInit } from '@angular/core'\nimport { RouterLink } from '@angular/router'\nimport { Video } from '@app/shared/shared-main/video/video.model'\nimport { LiveVideoError, LiveVideoErrorType, LiveVideoSession } from '@peertube/peertube-models'\nimport { PTDatePipe } from '../../../shared/shared-main/common/date.pipe'\nimport { LiveVideoService } from '../../../shared/shared-video-live/live-video.service'\n\n@Component({\n  selector: 'my-live-stream-information',\n  templateUrl: './live-stream-information.component.html',\n  styleUrls: [ './live-stream-information.component.scss' ],\n  imports: [\n    CommonModule,\n    RouterLink,\n    PTDatePipe\n  ],\n  providers: [ LiveVideoService ]\n})\nexport class LiveStreamInformationComponent implements OnInit {\n  private liveVideoService = inject(LiveVideoService)\n\n  video = input.required<Pick<Video, 'id' | 'shortUUID'>>()\n  latestLiveSessions: LiveVideoSession[] = []\n\n  ngOnInit () {\n    this.liveVideoService.listSessions(this.video().id)\n      .subscribe(({ data }) => this.latestLiveSessions = data.reverse())\n  }\n\n  getVideoUrl (video: { shortUUID: string }) {\n    return Video.buildWatchUrl(video)\n  }\n\n  getErrorLabel (session: LiveVideoSession) {\n    if (!session.error) return undefined\n\n    const errors: { [id in LiveVideoErrorType]: string } = {\n      [LiveVideoError.BAD_SOCKET_HEALTH]: $localize`Server too slow`,\n      [LiveVideoError.BLACKLISTED]: $localize`Live blacklisted`,\n      [LiveVideoError.DURATION_EXCEEDED]: $localize`Max duration exceeded`,\n      [LiveVideoError.FFMPEG_ERROR]: $localize`Server error`,\n      [LiveVideoError.QUOTA_EXCEEDED]: $localize`Quota exceeded`,\n      [LiveVideoError.RUNNER_JOB_CANCEL]: $localize`Runner job cancelled`,\n      [LiveVideoError.RUNNER_JOB_ERROR]: $localize`Error in runner job`,\n      [LiveVideoError.UNKNOWN_ERROR]: $localize`Unknown error`,\n      [LiveVideoError.INVALID_INPUT_VIDEO_STREAM]: $localize`Invalid input video stream`\n    }\n\n    return errors[session.error]\n  }\n\n  isReplayBeingProcessed (session: LiveVideoSession) {\n    // Running live\n    if (!session.endDate) return false\n\n    return session.saveReplay && !session.endingProcessed\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"live\"></my-global-icon>\n\n  <ng-container i18n>Live settings</ng-container>\n</h2>\n\n@if (!isLive()) {\n  <my-alert type=\"danger\" i18n>{{ getVideoName() }} is not a live.</my-alert>\n} @else if (hasEnded()) {\n  <my-alert type=\"primary\" i18n>Your live has ended.</my-alert>\n} @else {\n  <div [formGroup]=\"form\">\n\n    <my-alert class=\"d-block mb-4\" type=\"primary\">\n      @if (isStreaming()) {\n        <ng-container i18n>Live configuration is unavailable because you are streaming in this live.</ng-container>\n      } @else {\n        <my-live-documentation-link></my-live-documentation-link>\n\n        <div class=\"mt-3\" i18n *ngIf=\"getMaxLiveDuration() >= 0\">\n          Max live duration configured on {{ getInstanceName() }} is {{ getMaxLiveDuration() | myTimeDurationFormatter }}.\n          If your live reaches this limit, it will be automatically terminated.\n        </div>\n      }\n    </my-alert>\n\n    <div class=\"form-columns reverse\" [ngClass]=\"{ disabled: isStreaming() }\">\n      <div>\n        <div *ngIf=\"getLive().rtmpUrl\" class=\"form-group\">\n          <label for=\"liveVideoRTMPUrl\" i18n>Live RTMP Url</label>\n          <my-input-text inputId=\"liveVideoRTMPUrl\" [value]=\"getLive().rtmpUrl\" [withToggle]=\"false\" [withCopy]=\"true\" [show]=\"true\" [readonly]=\"true\"></my-input-text>\n        </div>\n\n        <div *ngIf=\"getLive().rtmpsUrl\" class=\"form-group\">\n          <label for=\"liveVideoRTMPSUrl\" i18n>Live RTMPS Url</label>\n          <my-input-text inputId=\"liveVideoRTMPSUrl\" [value]=\"getLive().rtmpsUrl\" [withToggle]=\"false\" [withCopy]=\"true\" [show]=\"true\" [readonly]=\"true\"></my-input-text>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"liveVideoStreamKey\" i18n>Live stream key</label>\n          <my-input-text inputId=\"liveVideoStreamKey\" [value]=\"getLive().streamKey\" [withCopy]=\"true\" [readonly]=\"true\"></my-input-text>\n\n          <div class=\"form-group-description\" i18n> Never share your stream key with anyone.</div>\n        </div>\n\n        <my-live-stream-information [video]=\"videoEdit.getVideoAttributes()\"></my-live-stream-information>\n      </div>\n\n      <div>\n        <div class=\"form-group\">\n          <div class=\"peertube-radio-container\">\n            <input type=\"radio\" formControlName=\"permanentLive\" id=\"permanentLiveFalse\" [value]=\"false\">\n            <label i18n for=\"permanentLiveFalse\" class=\"radio\">This is a normal live</label>\n\n            <span class=\"form-group-description\" i18n>\n              You can stream only once in a normal live. If you enable replay, it will be saved under the same URL as your live\n            </span>\n          </div>\n\n          <div class=\"peertube-radio-container\">\n            <input type=\"radio\" formControlName=\"permanentLive\" id=\"permanentLiveTrue\" [value]=\"true\">\n            <label i18n for=\"permanentLiveTrue\" class=\"radio\">This is a permanent/recurring live</label>\n\n            <span class=\"form-group-description\" i18n>\n              You can stream multiple times in a permanent/recurring live. If you enable replays, they will be saved as separate videos\n            </span>\n          </div>\n        </div>\n\n        <div class=\"form-group\" *ngIf=\"isSaveReplayAllowed()\">\n          <my-peertube-checkbox inputName=\"liveVideoSaveReplay\" formControlName=\"saveReplay\">\n            <ng-template ptTemplate=\"label\">\n              <ng-container i18n>Automatically publish a replay when your live ends</ng-container>\n            </ng-template>\n\n            <ng-container ngProjectAs=\"description\">\n              <span i18n> If you enable this option, your live will be terminated if you exceed your video quota</span>\n            </ng-container>\n          </my-peertube-checkbox>\n        </div>\n\n        <div class=\"form-group mx-4\" *ngIf=\"isSaveReplayEnabled()\">\n          <label i18n for=\"replayPrivacy\">Privacy of the new replay</label>\n          <my-select-options inputId=\"replayPrivacy\" [items]=\"replayPrivacies\" formControlName=\"replayPrivacy\"></my-select-options>\n        </div>\n\n        <div class=\"form-group\" *ngIf=\"isLatencyModeEnabled()\">\n          <label i18n for=\"latencyMode\">Latency mode</label>\n          <my-select-options inputId=\"latencyMode\" [items]=\"latencyModes\" formControlName=\"latencyMode\" clearable=\"true\"></my-select-options>\n\n          <div *ngIf=\"formErrors.latencyMode\" class=\"form-error\" role=\"alert\">\n            {{ formErrors.latencyMode }}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n}\n","import { CommonModule } from '@angular/common'\nimport { ChangeDetectorRef, Component, inject, NgZone, OnDestroy, OnInit } from '@angular/core'\nimport { AbstractControl, FormArray, FormControl, FormGroup, FormsModule, ReactiveFormsModule, Validators } from '@angular/forms'\nimport { Router, RouterLink } from '@angular/router'\nimport { ConfirmService, HooksService, Notifier, PluginService, ServerService } from '@app/core'\nimport { BuildFormArgument, BuildFormValidator } from '@app/shared/form-validators/form-validator.model'\nimport {\n  VIDEO_CATEGORY_VALIDATOR,\n  VIDEO_CHANNEL_VALIDATOR,\n  VIDEO_DESCRIPTION_VALIDATOR,\n  VIDEO_LANGUAGE_VALIDATOR,\n  VIDEO_LICENCE_VALIDATOR,\n  VIDEO_NAME_VALIDATOR,\n  VIDEO_PASSWORD_VALIDATOR,\n  VIDEO_PRIVACY_VALIDATOR,\n  VIDEO_SCHEDULE_PUBLICATION_AT_VALIDATOR,\n  VIDEO_SUPPORT_VALIDATOR,\n  VIDEO_TAGS_ARRAY_VALIDATOR\n} from '@app/shared/form-validators/video-validators'\nimport { DynamicFormFieldComponent } from '@app/shared/shared-forms/dynamic-form-field.component'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport { FormValidatorService } from '@app/shared/shared-forms/form-validator.service'\nimport { InputTextComponent } from '@app/shared/shared-forms/input-text.component'\nimport { MarkdownTextareaComponent } from '@app/shared/shared-forms/markdown-textarea.component'\nimport { PeertubeCheckboxComponent } from '@app/shared/shared-forms/peertube-checkbox.component'\nimport { SelectChannelComponent } from '@app/shared/shared-forms/select/select-channel.component'\nimport { SelectOptionsComponent } from '@app/shared/shared-forms/select/select-options.component'\nimport { SelectTagsComponent } from '@app/shared/shared-forms/select/select-tags.component'\nimport { PeerTubeTemplateDirective } from '@app/shared/shared-main/common/peertube-template.directive'\nimport { InstanceService } from '@app/shared/shared-main/instance/instance.service'\nimport { VideoService } from '@app/shared/shared-main/video/video.service'\nimport {\n  HTMLServerConfig,\n  RegisterClientFormFieldOptions,\n  RegisterClientVideoFieldOptions,\n  VideoConstant,\n  VideoPrivacy,\n  VideoPrivacyType\n} from '@peertube/peertube-models'\nimport { logger } from '@root-helpers/logger'\nimport { PluginInfo } from '@root-helpers/plugins-manager'\nimport debug from 'debug'\nimport { CalendarModule } from 'primeng/calendar'\nimport { forkJoin, Subscription } from 'rxjs'\nimport { map } from 'rxjs/operators'\nimport { SelectChannelItem } from 'src/types/select-options-item.model'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { MarkdownHintComponent } from '../../../shared/shared-main/text/markdown-hint.component'\nimport { I18nPrimengCalendarService } from '../common/i18n-primeng-calendar.service'\nimport { ThumbnailManagerComponent } from '../common/thumbnail-manager.component'\nimport { VideoEdit, VideoEditPrivacyType } from '../common/video-edit.model'\nimport { VideoManageType } from '../common/video-manage.type'\nimport { VideoManageController } from '../video-manage-controller.service'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype PluginField = {\n  pluginInfo: PluginInfo\n  commonOptions: RegisterClientFormFieldOptions\n  videoFormOptions: RegisterClientVideoFieldOptions\n}\n\ntype Form = {\n  name: FormControl<string>\n  privacy: FormControl<VideoEditPrivacyType>\n  videoPassword: FormControl<string>\n  channelId: FormControl<number>\n  waitTranscoding: FormControl<boolean>\n  category: FormControl<number>\n  licence: FormControl<number>\n  language: FormControl<string>\n  description: FormControl<string>\n  tags: FormArray<FormControl<string>>\n  previewfile: FormControl<Blob>\n  support: FormControl<string>\n  schedulePublicationAt: FormControl<Date>\n  pluginData: FormGroup\n}\n\n@Component({\n  selector: 'my-video-main-info',\n  styleUrls: [\n    '../common/video-manage-page-common.scss'\n  ],\n  templateUrl: './video-main-info.component.html',\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    DynamicFormFieldComponent,\n    PeerTubeTemplateDirective,\n    SelectTagsComponent,\n    MarkdownTextareaComponent,\n    SelectChannelComponent,\n    SelectOptionsComponent,\n    InputTextComponent,\n    CalendarModule,\n    PeertubeCheckboxComponent,\n    ThumbnailManagerComponent,\n    GlobalIconComponent,\n    MarkdownHintComponent,\n    RouterLink\n  ]\n})\nexport class VideoMainInfoComponent implements OnInit, OnDestroy {\n  private formValidatorService = inject(FormValidatorService)\n  private formReactiveService = inject(FormReactiveService)\n  private videoService = inject(VideoService)\n  private serverService = inject(ServerService)\n  private pluginService = inject(PluginService)\n  private instanceService = inject(InstanceService)\n  private i18nPrimengCalendarService = inject(I18nPrimengCalendarService)\n  private ngZone = inject(NgZone)\n  private hooks = inject(HooksService)\n  private cd = inject(ChangeDetectorRef)\n  private manageController = inject(VideoManageController)\n  private confirmService = inject(ConfirmService)\n  private notifier = inject(Notifier)\n  private router = inject(Router)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  forbidScheduledPublication: boolean\n  hideWaitTranscoding: boolean\n\n  videoPrivacies: VideoConstant<VideoEditPrivacyType>[] = []\n  videoCategories: VideoConstant<number>[] = []\n  videoLicences: VideoConstant<number>[] = []\n  videoLanguages: VideoConstant<string>[] = []\n\n  pluginDataFormGroup: FormGroup\n\n  schedulePublicationSelected = false\n  passwordProtectionSelected = false\n\n  calendarLocale: any = {}\n  minScheduledDate = new Date()\n\n  calendarTimezone: string\n  calendarDateFormat: string\n  myYearRange: string\n\n  serverConfig: HTMLServerConfig\n\n  pluginFields: PluginField[] = []\n\n  manageType: VideoManageType\n\n  firstPatchDone = false\n\n  userChannels: SelectChannelItem[] = []\n  privacies: VideoPrivacyType[] = []\n  videoEdit: VideoEdit\n\n  private schedulerInterval: any\n  private updatedSub: Subscription\n\n  constructor () {\n    this.calendarTimezone = this.i18nPrimengCalendarService.getTimezone()\n    this.calendarDateFormat = this.i18nPrimengCalendarService.getDateFormat()\n    this.myYearRange = this.i18nPrimengCalendarService.getVideoPublicationYearRange()\n  }\n\n  ngOnInit () {\n    this.serverConfig = this.serverService.getHTMLConfig()\n\n    const { videoEdit, userChannels } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n    this.userChannels = userChannels\n\n    const { manageType, hideWaitTranscoding, forbidScheduledPublication } = this.manageController.getConfig()\n    this.manageType = manageType\n    this.hideWaitTranscoding = hideWaitTranscoding\n    this.forbidScheduledPublication = forbidScheduledPublication\n\n    this.buildForm()\n\n    this.pluginService.ensurePluginsAreLoaded('video-edit')\n      .then(() => this.updatePluginFields())\n\n    this.serverService.getVideoCategories()\n      .subscribe(res => this.videoCategories = res)\n\n    this.serverService.getVideoLicences()\n      .subscribe(res => this.videoLicences = res)\n\n    this.buildLanguages()\n    this.buildPrivacies()\n\n    this.ngZone.runOutsideAngular(() => {\n      this.schedulerInterval = setInterval(() => this.minScheduledDate = new Date(), 1000 * 60) // Update every minute\n    })\n\n    const updateFormForPlugins = (values: any) => {\n      this.form.patchValue(values)\n      this.cd.detectChanges()\n    }\n    this.hooks.runAction('action:video-edit.init', 'video-edit', { type: this.manageType, updateForm: updateFormForPlugins })\n\n    this.form.valueChanges.subscribe(() => {\n      const formValues = this.form.value\n\n      this.hooks.runAction('action:video-edit.form.updated', 'video-edit', { type: this.manageType, formValues })\n\n      this.manageController.setFormError($localize`Main information`, '.', this.formErrors)\n\n      debugLogger('Updating form values', formValues)\n\n      this.videoEdit.loadFromCommonForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.form.patchValue(this.videoEdit.toCommonFormPatch())\n    })\n\n    this.manageController.registerSaveHook(async () => {\n      await this.formReactiveService.waitPendingCheck(this.form)\n      this.formReactiveService.forceCheck(this.form, this.formErrors, this.validationMessages)\n      this.manageController.setFormError($localize`Main information`, '.', this.formErrors)\n    })\n  }\n\n  ngOnDestroy () {\n    if (this.schedulerInterval) clearInterval(this.schedulerInterval)\n\n    this.updatedSub?.unsubscribe()\n    this.manageController.unregisterSaveHook()\n    this.videoEdit.disableCheckPluginChanges()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  private buildLanguages () {\n    forkJoin([\n      this.instanceService.getAbout(),\n      this.serverService.getVideoLanguages()\n    ]).pipe(map(([ about, languages ]) => ({ about, languages })))\n      .subscribe(({ about, languages }) => {\n        this.videoLanguages = [\n          ...languages.filter(l => about.instance.languages.includes(l.id)),\n\n          languages.find(l => l.id === 'zxx'),\n\n          ...languages.filter(l => !about.instance.languages.includes(l.id) && l.id !== 'zxx')\n        ]\n      })\n  }\n\n  private buildPrivacies () {\n    const { privacies } = this.manageController.getStore()\n    this.videoPrivacies = this.videoService.explainedPrivacyLabels(privacies).videoPrivacies\n\n    // Can't schedule publication if private privacy is not available (could be deleted by a plugin)\n    const hasPrivatePrivacy = this.videoPrivacies.some(p => p.id === VideoPrivacy.PRIVATE)\n    if (this.forbidScheduledPublication || !hasPrivatePrivacy) return\n\n    this.videoPrivacies.push({\n      id: VideoEdit.SPECIAL_SCHEDULED_PRIVACY,\n      label: $localize`Scheduled`,\n      description: $localize`Hide the video until a specific date`\n    })\n  }\n\n  private buildForm () {\n    const defaultValues = this.videoEdit.toCommonFormPatch()\n    const obj: BuildFormArgument = {\n      name: VIDEO_NAME_VALIDATOR,\n      privacy: VIDEO_PRIVACY_VALIDATOR,\n      videoPassword: VIDEO_PASSWORD_VALIDATOR,\n      channelId: VIDEO_CHANNEL_VALIDATOR,\n      waitTranscoding: null,\n      category: VIDEO_CATEGORY_VALIDATOR,\n      licence: VIDEO_LICENCE_VALIDATOR,\n      language: VIDEO_LANGUAGE_VALIDATOR,\n      description: VIDEO_DESCRIPTION_VALIDATOR,\n      tags: VIDEO_TAGS_ARRAY_VALIDATOR,\n      previewfile: null,\n      support: VIDEO_SUPPORT_VALIDATOR,\n      schedulePublicationAt: VIDEO_SCHEDULE_PUBLICATION_AT_VALIDATOR\n    }\n\n    const {\n      form,\n      formErrors,\n      validationMessages\n    } = this.formReactiveService.buildForm<Form>(obj, defaultValues)\n\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.updateScheduleRelatedControls(defaultValues.privacy, true)\n\n    this.trackChannelChange()\n    this.trackPrivacyChange()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  getChannelUpdateUrl () {\n    const channelId = this.form.value.channelId\n    const channel = this.userChannels.find(c => c.id === channelId)\n\n    if (!channel) return ''\n\n    return [ '/my-library/video-channels/update/', channel.name ]\n  }\n\n  // ---------------------------------------------------------------------------\n\n  isPluginFieldHidden (pluginField: PluginField) {\n    if (typeof pluginField.commonOptions.hidden !== 'function') return false\n\n    return pluginField.commonOptions.hidden({\n      formValues: this.form.value,\n      videoToUpdate: this.videoEdit,\n      liveVideo: this.videoEdit.getLive()\n    })\n  }\n\n  getPluginsFields (tab: 'main' | 'plugin-settings') {\n    return this.pluginFields.filter(p => {\n      const wanted = p.videoFormOptions.tab ?? 'plugin-settings'\n\n      return wanted === tab\n    })\n  }\n\n  private async updatePluginFields () {\n    this.pluginFields = this.pluginService.getRegisteredVideoFormFields(this.manageType)\n    if (this.pluginFields.length === 0) return\n\n    const { pluginData } = this.videoEdit.toCommonFormPatch()\n\n    const pluginObj: { [id: string]: BuildFormValidator } = {}\n    const pluginValidationMessages: FormReactiveValidationMessages = {}\n    const pluginFormErrors: FormReactiveErrors = {}\n    const pluginDefaults: Record<string, string | boolean> = {}\n\n    for (const setting of this.pluginFields) {\n      await this.pluginService.translateSetting(setting.pluginInfo.plugin.npmName, setting.commonOptions)\n\n      // Not a form input, just a HTML tag\n      if (setting.commonOptions.type === 'html') continue\n\n      const validator = async (control: AbstractControl) => {\n        if (!setting.commonOptions.error) return null\n\n        const error = await setting.commonOptions.error({ formValues: this.form.value, value: control.value })\n\n        return error?.error ? { [setting.commonOptions.name]: error.text } : null\n      }\n\n      const name = setting.commonOptions.name\n\n      pluginObj[name] = {\n        ASYNC_VALIDATORS: [ validator ],\n        VALIDATORS: [],\n        MESSAGES: {}\n      }\n\n      pluginDefaults[name] = pluginData?.[name] ?? setting.commonOptions.default\n    }\n\n    this.pluginDataFormGroup = new FormGroup<any>({})\n    this.formValidatorService.updateFormGroup(\n      this.pluginDataFormGroup,\n      pluginFormErrors,\n      pluginValidationMessages,\n      pluginObj,\n      pluginDefaults\n    )\n\n    this.videoEdit.loadPluginDataDefaults(pluginDefaults)\n    this.videoEdit.enableCheckPluginChanges()\n\n    this.form.addControl('pluginData', this.pluginDataFormGroup)\n    this.formErrors['pluginData'] = pluginFormErrors\n    this.validationMessages['pluginData'] = pluginValidationMessages\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.cd.detectChanges()\n\n    // Plugins may need other control values to calculate potential errors\n    this.form.valueChanges.subscribe(() => this.formValidatorService.updateTreeValidity(this.pluginDataFormGroup))\n  }\n\n  // ---------------------------------------------------------------------------\n\n  private trackPrivacyChange () {\n    // We will update the schedule input and the wait transcoding checkbox validators\n    this.form.controls['privacy']\n      .valueChanges\n      .subscribe(newPrivacyId => this.updateScheduleRelatedControls(newPrivacyId))\n  }\n\n  private updateScheduleRelatedControls (newPrivacyId: number, isInitialPatch = false) {\n    this.schedulePublicationSelected = newPrivacyId === VideoEdit.SPECIAL_SCHEDULED_PRIVACY\n\n    const scheduleControl = this.form.get('schedulePublicationAt')\n    const waitTranscodingControl = this.form.get('waitTranscoding')\n\n    if (this.schedulePublicationSelected) {\n      scheduleControl.setValidators([ Validators.required ])\n\n      waitTranscodingControl.disable()\n      if (!isInitialPatch) waitTranscodingControl.setValue(false)\n    } else {\n      scheduleControl.clearValidators()\n      waitTranscodingControl.enable()\n\n      // Do not update the control value on first patch (values come from the server)\n      if (!isInitialPatch) waitTranscodingControl.setValue(true)\n    }\n\n    scheduleControl.updateValueAndValidity()\n    waitTranscodingControl.updateValueAndValidity()\n\n    this.passwordProtectionSelected = newPrivacyId === VideoPrivacy.PASSWORD_PROTECTED\n    const videoPasswordControl = this.form.get('videoPassword')\n\n    if (this.passwordProtectionSelected) videoPasswordControl.setValidators([ Validators.required, ...VIDEO_PASSWORD_VALIDATOR.VALIDATORS ])\n    else videoPasswordControl.clearValidators()\n\n    videoPasswordControl.updateValueAndValidity()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  private trackChannelChange () {\n    // We will update the \"support\" field depending on the channel\n    this.form.controls.channelId\n      .valueChanges\n      .subscribe(newChannelId => this.updateSupportFromChannel(newChannelId))\n  }\n\n  private updateSupportFromChannel (newChannelId: number) {\n    const newChannel = this.userChannels.find(c => c.id === newChannelId)\n    if (!newChannel) return\n\n    const currentSupport = this.form.value.support\n\n    const oldChannelId = this.form.value.channelId\n    const oldChannel = this.userChannels.find(c => c.id === oldChannelId)\n    if (!newChannel || !oldChannel) {\n      logger.error('Cannot find new or old channel.')\n      return\n    }\n\n    // Same channel, no need to update\n    if (oldChannelId === newChannel.id) return\n\n    // If the current support text is not the same than the old channel, the user updated it.\n    // We don't want the user to lose his text, so stop here\n    if (currentSupport && currentSupport !== oldChannel.support) return\n\n    // Update the support text with our new channel\n    this.updateSupportField(newChannel.support)\n  }\n\n  private updateSupportField (support: string) {\n    return this.form.patchValue({ support: support || '' })\n  }\n\n  // ---------------------------------------------------------------------------\n\n  canBeDeleted () {\n    return !!this.videoEdit.getVideoAttributes().id\n  }\n\n  async deleteVideo () {\n    const video = this.videoEdit.getVideoAttributes()\n    const message = $localize`Are you sure you want to delete your video \"${video.name}?`\n\n    const res = await this.confirmService.confirm(message, $localize`Delete`)\n    if (res === false) return\n\n    this.videoService.removeVideo(video.id)\n      .subscribe({\n        next: () => {\n          this.notifier.success($localize`\"${video.name}\" deleted`)\n\n          this.router.navigate([ '/my-library/videos' ])\n        },\n\n        error: err => this.notifier.error(err.message)\n      })\n  }\n}\n","import { Directive, HostBinding, HostListener, output } from '@angular/core'\n\n@Directive({\n  selector: '[myDragDrop]',\n  standalone: true\n})\nexport class DragDropDirective {\n  readonly fileDropped = output<FileList>()\n\n  @HostBinding('class.dragover')\n  dragover = false\n\n  @HostListener('dragover', [ '$event' ])\n  onDragOver (e: Event) {\n    e.preventDefault()\n    e.stopPropagation()\n    this.dragover = true\n  }\n\n  @HostListener('dragleave', [ '$event' ])\n  public onDragLeave (e: Event) {\n    e.preventDefault()\n    e.stopPropagation()\n    this.dragover = false\n  }\n\n  @HostListener('drop', [ '$event' ])\n  public ondrop (e: DragEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n    this.dragover = false\n    const files = e.dataTransfer.files\n    if (files.length > 0) this.fileDropped.emit(files)\n  }\n}\n","<div class=\"root\" myDragDrop (fileDropped)=\"onFileDropped($event)\">\n\n  @if (selectingFromVideo) {\n    <my-embed #embed [video]=\"videoEdit().getVideoAttributes()\" enableAPI=\"true\" mute=\"true\" autoplay=\"true\"></my-embed>\n\n    <div class=\"mt-3\">\n      <button i18n type=\"button\" class=\"peertube-button primary-button me-2\" (click)=\"selectFrame()\">Use this frame</button>\n\n      <button i18n type=\"button\" i18n class=\"peertube-button secondary-button\" (click)=\"resetSelectFromVideo()\">Cancel</button>\n    </div>\n  } @else {\n    <div class=\"preview-container\">\n      @if (imageSrc) {\n        <img [src]=\"imageSrc\" alt=\"Current thumbnail\" i18n-alt />\n\n        <div class=\"muted-2 fs-8 mt-1\">Current thumbnail</div>\n      } @else {\n        <div class=\"no-image\">\n          <svg width=\"28\" height=\"20\" viewBox=\"0 0 28 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M6.07133 1.61298L24.1845 4.56992C25.1509 4.72768 25.8511 5.6793 25.6766 6.74787L24.0362 16.7967C23.8617 17.8652 22.8953 18.5448 21.9289 18.387L3.81571 15.4301C2.84933 15.2723 2.14915 14.3207 2.32359 13.2521L3.96404 3.20333C4.13848 2.13476 5.10494 1.45522 6.07133 1.61298Z\" stroke=\"currentColor\" stroke-width=\"2\"/>\n            <path d=\"M11.5786 6.21294L10.4508 13.1215L16.9362 10.6345L11.5786 6.21294Z\" fill=\"currentColor\"/>\n          </svg>\n        </div>\n      }\n    </div>\n\n    <div class=\"mt-3\">\n      <div class=\"muted-1\">\n        <strong>Drag and drop your thumbnail here</strong> or click on the button below to modify it:\n      </div>\n\n      <div class=\"muted-2 fs-7\">\n        <div i18n>In {{ videoImageExtensions }} formats, {{ maxVideoImageSizeInBytes }} maximum.</div>\n        <div i18n>Recommended size: 1280x720px.</div>\n      </div>\n\n      <div class=\"d-flex flex-wrap mt-4 justify-content-center gap-3\">\n        <my-reactive-file\n          class=\"d-inline-block me-3\"\n          inputName=\"uploadNewThumbnail\" i18n-inputLabel inputLabel=\"Upload\" [extensions]=\"videoImageExtensions\"\n          [maxFileSize]=\"maxVideoImageSize\" placement=\"right\" (fileChanged)=\"onFileChanged($event)\"\n          theme=\"secondary\" icon=\"upload\"\n        >\n        </my-reactive-file>\n\n        @if (canSelectFromVideo()) {\n          <my-button icon=\"film\" theme=\"secondary\" i18n (click)=\"selectFromVideo()\">\n            Select from video\n          </my-button>\n        }\n      </div>\n    </div>\n  }\n</div>\n","import { CommonModule } from '@angular/common'\nimport {\n  Component,\n  EnvironmentInjector,\n  OnInit,\n  afterNextRender,\n  forwardRef,\n  inject,\n  input,\n  runInInjectionContext,\n  viewChild\n} from '@angular/core'\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms'\nimport { DragDropDirective } from '@app/+videos-publish-manage/+video-publish/shared/drag-drop.directive'\nimport { Notifier, ServerService } from '@app/core'\nimport { ReactiveFileComponent } from '@app/shared/shared-forms/reactive-file.component'\nimport { BytesPipe } from '@app/shared/shared-main/common/bytes.pipe'\nimport { EmbedComponent } from '@app/shared/shared-main/video/embed.component'\nimport { HTMLServerConfig, VideoState } from '@peertube/peertube-models'\nimport { imageToDataURL } from '@root-helpers/images'\nimport { PeerTubePlayer } from '../../../../standalone/embed-player-api/player'\nimport { ButtonComponent } from '../../../shared/shared-main/buttons/button.component'\nimport { VideoEdit } from './video-edit.model'\n\n@Component({\n  selector: 'my-thumbnail-manager',\n  styleUrls: [ './thumbnail-manager.component.scss' ],\n  templateUrl: './thumbnail-manager.component.html',\n  imports: [ CommonModule, ReactiveFileComponent, EmbedComponent, DragDropDirective, ButtonComponent ],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => ThumbnailManagerComponent),\n      multi: true\n    }\n  ]\n})\nexport class ThumbnailManagerComponent implements OnInit, ControlValueAccessor {\n  private serverService = inject(ServerService)\n  private notifier = inject(Notifier)\n  private environmentInjector = inject(EnvironmentInjector)\n\n  readonly embed = viewChild<EmbedComponent>('embed')\n\n  readonly videoEdit = input.required<VideoEdit>()\n\n  imageSrc: string\n  allowedExtensionsMessage = ''\n\n  serverConfig: HTMLServerConfig\n  bytesPipe: BytesPipe\n  imageFile: Blob\n\n  selectingFromVideo = false\n\n  player: PeerTubePlayer\n\n  constructor () {\n    this.bytesPipe = new BytesPipe()\n  }\n\n  // ---------------------------------------------------------------------------\n  // Upload\n  // ---------------------------------------------------------------------------\n\n  get videoImageExtensions () {\n    return this.serverConfig.video.image.extensions\n  }\n\n  get maxVideoImageSize () {\n    return this.serverConfig.video.image.size.max\n  }\n\n  get maxVideoImageSizeInBytes () {\n    return this.bytesPipe.transform(this.maxVideoImageSize)\n  }\n\n  canSelectFromVideo () {\n    const videoEdit = this.videoEdit()\n    if (!videoEdit) return\n\n    const attrs = videoEdit.getVideoAttributes()\n\n    return !attrs.isLive && attrs.state === VideoState.PUBLISHED\n  }\n\n  ngOnInit () {\n    this.serverConfig = this.serverService.getHTMLConfig()\n\n    this.allowedExtensionsMessage = this.videoImageExtensions.join(', ')\n  }\n\n  onFileChanged (file: Blob) {\n    this.imageFile = file\n\n    this.propagateChange(this.imageFile)\n    this.updatePreview()\n  }\n\n  onFileDropped (files: FileList) {\n    return this.onFileChanged(files[0])\n  }\n\n  propagateChange = (_: any) => {\n    // empty\n  }\n\n  writeValue (file: Blob) {\n    this.imageFile = file\n    this.updatePreview()\n  }\n\n  registerOnChange (fn: (_: any) => void) {\n    this.propagateChange = fn\n  }\n\n  registerOnTouched () {\n    // Unused\n  }\n\n  private updatePreview () {\n    if (this.imageFile) {\n      imageToDataURL(this.imageFile).then(result => this.imageSrc = result)\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n  // Select from frame\n  // ---------------------------------------------------------------------------\n\n  selectFromVideo () {\n    this.selectingFromVideo = true\n\n    runInInjectionContext(this.environmentInjector, () => {\n      afterNextRender(() => {\n        try {\n          this.player = new PeerTubePlayer(this.embed().getIframe())\n        } catch (err) {\n          this.notifier.error('Error creating PeerTube embed: ' + err.message)\n          this.selectingFromVideo = false\n          return\n        }\n      })\n    })\n  }\n\n  resetSelectFromVideo () {\n    if (this.player) {\n      this.player.destroy()\n      this.player = undefined\n    }\n\n    this.selectingFromVideo = false\n  }\n\n  async selectFrame () {\n    const dataUrl: string = await this.player.getImageDataUrl()\n\n    // Checking for an empty data URL\n    if (dataUrl.length <= 6) {\n      return\n    }\n\n    this.imageSrc = dataUrl\n\n    const blob: Blob = this.dataURItoBlob(dataUrl)\n\n    const file = new File([ blob ], 'preview-file-from-frame.jpg', { type: 'image/jpeg' })\n\n    this.imageFile = file\n\n    this.propagateChange(this.imageFile)\n\n    this.resetSelectFromVideo()\n  }\n\n  // Credit: https://stackoverflow.com/a/7261048/1030669\n  private dataURItoBlob (dataURI: string) {\n    const byteString = atob(dataURI.split(',')[1])\n    const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]\n\n    const ab = new ArrayBuffer(byteString.length)\n\n    const ia = new Uint8Array(ab)\n\n    for (let i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i)\n    }\n\n    return new Blob([ ab ], { type: mimeString })\n  }\n}\n","import { getOriginUrl } from '@app/helpers'\nimport { exists, omit, pick, secondsToTime } from '@peertube/peertube-core-utils'\nimport {\n  HTMLServerConfig,\n  LiveVideo,\n  LiveVideoCreate,\n  LiveVideoUpdate,\n  NSFWFlag,\n  VideoCaption,\n  VideoChapter,\n  VideoCreate,\n  VideoDetails,\n  VideoImportCreate,\n  VideoPrivacy,\n  VideoPrivacyType,\n  VideoScheduleUpdate,\n  VideoSource,\n  VideoState,\n  VideoStateType,\n  VideoStudioTask,\n  VideoStudioTaskCut,\n  VideoUpdate\n} from '@peertube/peertube-models'\nimport { logger } from '@root-helpers/logger'\nimport debug from 'debug'\nimport { Jsonify, SharedUnionFieldsDeep } from 'type-fest'\nimport { VideoCaptionWithPathEdit } from './video-caption-edit.model'\nimport { VideoChaptersEdit } from './video-chapters-edit.model'\n\nconst debugLogger = debug('peertube:video-manage:video-edit')\n\nexport type VideoEditPrivacyType = VideoPrivacyType | typeof VideoEdit.SPECIAL_SCHEDULED_PRIVACY\n\ntype CommonUpdateForm =\n  & Omit<\n    VideoUpdate,\n    'privacy' | 'videoPasswords' | 'thumbnailfile' | 'scheduleUpdate' | 'commentsEnabled' | 'originallyPublishedAt' | 'nsfwFlags'\n  >\n  & {\n    schedulePublicationAt?: Date\n    originallyPublishedAt?: Date\n    privacy?: VideoEditPrivacyType\n    videoPassword?: string\n\n    nsfwFlagViolent?: boolean\n    nsfwFlagSex?: boolean\n  }\n\ntype LiveUpdateForm = Omit<LiveVideoUpdate, 'replaySettings'> & {\n  replayPrivacy?: VideoPrivacyType\n  liveStreamKey?: string\n}\n\ntype ReplaceFileForm = {\n  replaceFile?: File\n}\n\ntype StudioForm = {\n  'cut'?: { start?: number, end?: number }\n  'add-intro'?: { file?: File }\n  'add-outro'?: { file?: File }\n  'add-watermark'?: { file?: File }\n}\n\n// ---------------------------------------------------------------------------\n\ntype LoadFromPublishOptions = Required<Pick<VideoCreate, 'channelId' | 'support'>> & Partial<Pick<VideoCreate, 'name'>>\n\ntype CreateFromUploadOptions = LoadFromPublishOptions & Required<Pick<VideoCreate, 'name'>>\n\ntype CreateFromImportOptions = LoadFromPublishOptions & Pick<VideoImportCreate, 'magnetUri' | 'torrentfile' | 'targetUrl'>\n\ntype CreateFromLiveOptions =\n  & CreateFromUploadOptions\n  & Required<Pick<LiveVideoCreate, 'permanentLive' | 'latencyMode' | 'saveReplay' | 'replaySettings'>>\n\ntype UpdateFromAPIOptions = {\n  video?: Pick<\n    VideoDetails,\n    | 'id'\n    | 'uuid'\n    | 'shortUUID'\n    | 'name'\n    | 'channel'\n    | 'privacy'\n    | 'category'\n    | 'licence'\n    | 'language'\n    | 'description'\n    | 'tags'\n    | 'nsfw'\n    | 'nsfwFlags'\n    | 'nsfwSummary'\n    | 'waitTranscoding'\n    | 'support'\n    | 'commentsPolicy'\n    | 'downloadEnabled'\n    | 'pluginData'\n    | 'scheduledUpdate'\n    | 'originallyPublishedAt'\n    | 'duration'\n    | 'likes'\n    | 'aspectRatio'\n    | 'views'\n    | 'blacklisted'\n    | 'previewPath'\n    | 'state'\n    | 'isLive'\n  >\n  live?: LiveVideo\n  chapters?: VideoChapter[]\n  captions?: VideoCaption[]\n  videoPasswords?: string[]\n  videoSource?: VideoSource\n}\n\n// ---------------------------------------------------------------------------\n\ntype CommonUpdate = Omit<VideoUpdate, 'thumbnailfile' | 'originallyPublishedAt' | 'scheduleUpdate'> & {\n  originallyPublishedAt?: string\n  scheduleUpdate?: {\n    updateAt: string\n    privacy?: VideoScheduleUpdate['privacy']\n  }\n}\n\nexport class VideoEdit {\n  static readonly SPECIAL_SCHEDULED_PRIVACY = -1\n\n  private isNewVideo = false\n  private common: CommonUpdate = {}\n  private captions: VideoCaptionWithPathEdit[] = []\n  private chapters: VideoChaptersEdit = new VideoChaptersEdit()\n  private live: LiveVideoUpdate\n  private replaceFile: File\n  private studioTasks: VideoStudioTask[] = []\n\n  private videoImport: Pick<VideoImportCreate, 'magnetUri' | 'torrentfile' | 'targetUrl'>\n\n  private metadata: Partial<{\n    id: number\n    uuid: string\n    shortUUID: string\n    state: VideoStateType\n    isLive: boolean\n    views: number\n    aspectRatio: number\n    duration: number\n    likes: number\n    blacklisted: boolean\n\n    live: Pick<LiveVideo, 'rtmpUrl' | 'rtmpsUrl' | 'streamKey'>\n    videoSource: VideoSource\n  }> = {}\n\n  private videoAttributes: {\n    id: number\n    shortUUID: string\n    uuid: string\n    name: string\n    state: VideoStateType\n    privacy: VideoEditPrivacyType\n    isLive: boolean\n    aspectRatio: number\n    duration: number\n    views: number\n    likes: number\n\n    blacklisted: boolean\n\n    live?: Pick<LiveVideo, 'rtmpUrl' | 'rtmpsUrl' | 'streamKey'>\n  }\n\n  private saveStore: {\n    common?: Omit<CommonUpdate, 'pluginData' | 'previewfile'>\n    previewfile?: { size: number }\n\n    live?: LiveVideoUpdate\n\n    pluginData?: any\n    pluginDefaults?: Record<string, string | boolean>\n  } = {}\n  private checkPluginChanges = false\n\n  private serverConfig: HTMLServerConfig\n\n  private constructor (serverConfig: HTMLServerConfig, isNewVideo = false) {\n    this.serverConfig = serverConfig\n    this.isNewVideo = isNewVideo\n  }\n\n  // ---------------------------------------------------------------------------\n\n  static createFromUpload (serverConfig: HTMLServerConfig, options: CreateFromUploadOptions) {\n    const videoEdit = new VideoEdit(serverConfig, true)\n    videoEdit.loadFromPublish(options, false)\n\n    return videoEdit\n  }\n\n  // ---------------------------------------------------------------------------\n\n  static createFromImport (serverConfig: HTMLServerConfig, options: CreateFromImportOptions) {\n    const videoEdit = new VideoEdit(serverConfig, true)\n    videoEdit.loadFromImport(options)\n\n    return videoEdit\n  }\n\n  private loadFromImport (options: CreateFromImportOptions) {\n    this.loadFromPublish(options, false)\n\n    this.videoImport = {\n      targetUrl: options.targetUrl,\n      magnetUri: options.magnetUri,\n      torrentfile: options.torrentfile\n    }\n\n    this.updateAfterChange()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  static createFromLive (serverConfig: HTMLServerConfig, options: CreateFromLiveOptions) {\n    const videoEdit = new VideoEdit(serverConfig, true)\n    videoEdit.loadFromLive(options)\n\n    return videoEdit\n  }\n\n  private loadFromLive (options: CreateFromLiveOptions) {\n    this.loadFromPublish(options, true)\n\n    this.live = {\n      latencyMode: options.latencyMode,\n      permanentLive: options.permanentLive,\n\n      saveReplay: options.saveReplay,\n      replaySettings: options.replaySettings\n        ? { privacy: options.replaySettings.privacy }\n        : undefined\n    }\n\n    this.updateAfterChange()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  private loadFromPublish (options: LoadFromPublishOptions, isLive: boolean) {\n    const serverDefaults = this.serverConfig.defaults\n\n    this.common.name = options.name\n    this.common.channelId = options.channelId\n    this.common.support = options.support\n    this.metadata.isLive = isLive\n\n    this.common.privacy = serverDefaults.publish.privacy\n    this.common.downloadEnabled = serverDefaults.publish.downloadEnabled\n    this.common.licence = serverDefaults.publish.licence\n    this.common.commentsPolicy = serverDefaults.publish.commentsPolicy\n    this.common.nsfw = this.serverConfig.instance.isNSFW\n\n    this.common.waitTranscoding = true\n    this.common.tags = []\n    this.common.pluginData = {}\n\n    this.metadata.views = 0\n    this.metadata.likes = 0\n\n    this.updateAfterChange()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  static async createFromAPI (serverConfig: HTMLServerConfig, options: UpdateFromAPIOptions) {\n    const videoEdit = new VideoEdit(serverConfig)\n    await videoEdit.loadFromAPI(options)\n\n    return videoEdit\n  }\n\n  async loadFromAPI (options: UpdateFromAPIOptions) {\n    const { video, videoPasswords, live, chapters, captions, videoSource } = options\n\n    debugLogger('Load from API', options)\n\n    this.loadVideo({ video, videoPasswords, saveInStore: true })\n    this.loadLive(live)\n\n    if (captions !== undefined) {\n      this.captions = captions\n    }\n\n    if (chapters !== undefined) {\n      this.chapters = new VideoChaptersEdit()\n      if (chapters) this.chapters.loadFromAPI(chapters)\n    }\n\n    if (videoSource !== undefined) {\n      this.metadata.videoSource = videoSource\n    }\n\n    await this.loadPreview(video)\n\n    this.updateAfterChange()\n  }\n\n  private loadVideo (options: {\n    video: UpdateFromAPIOptions['video']\n    videoPasswords?: string[]\n    saveInStore: boolean\n  }) {\n    const { video, saveInStore, videoPasswords = [] } = options\n\n    if (video === undefined) return\n\n    const buildObj: () => CommonUpdate = () => {\n      return {\n        ...this.common,\n\n        name: video.name || '',\n        privacy: video.privacy?.id ?? null,\n        channelId: video.channel?.id ?? null,\n        category: video.category?.id ?? null,\n        licence: video.licence?.id ?? null,\n        language: video.language?.id ?? null,\n        description: video.description ?? '',\n        tags: video.tags ?? [],\n        nsfw: video.nsfw ?? null,\n        nsfwSummary: video.nsfwSummary ?? null,\n        nsfwFlags: video.nsfwFlags ?? NSFWFlag.NONE,\n        waitTranscoding: video.waitTranscoding ?? null,\n        support: video.support ?? '',\n        commentsPolicy: video.commentsPolicy?.id ?? null,\n\n        downloadEnabled: video.downloadEnabled ?? null,\n\n        pluginData: video.pluginData ?? {},\n\n        scheduleUpdate: video.scheduledUpdate\n          ? { updateAt: new Date(video.scheduledUpdate.updateAt).toISOString(), privacy: video.scheduledUpdate.privacy }\n          : null,\n\n        originallyPublishedAt: video.originallyPublishedAt\n          ? new Date(video.originallyPublishedAt).toISOString()\n          : null,\n\n        videoPasswords: videoPasswords ?? []\n      }\n    }\n\n    this.common = buildObj()\n\n    if (saveInStore) {\n      const obj = buildObj()\n      this.saveStore.common = omit(obj, [ 'pluginData', 'previewfile' ])\n\n      // Apply plugin defaults so we correctly detect changes\n      const pluginDefaults = this.saveStore.pluginDefaults || {}\n      this.saveStore.pluginData = { ...pluginDefaults, ...obj.pluginData }\n    }\n\n    // ---------------------------------------------------------------------------\n\n    this.metadata.id = video.id\n    this.metadata.uuid = video.uuid\n    this.metadata.shortUUID = video.shortUUID\n\n    this.metadata.state = video.state.id\n    this.metadata.duration = video.duration\n    this.metadata.views = video.views\n    this.metadata.likes = video.likes\n    this.metadata.aspectRatio = video.aspectRatio\n    this.metadata.blacklisted = video.blacklisted\n\n    this.metadata.isLive = video.isLive\n  }\n\n  loadPluginDataDefaults (pluginDefaults: Record<string, string | boolean>) {\n    this.saveStore.pluginDefaults = pluginDefaults\n\n    if (this.saveStore?.pluginData) {\n      this.saveStore.pluginData = { ...this.saveStore.pluginDefaults, ...this.saveStore.pluginData }\n    }\n  }\n\n  private async loadPreview (video: UpdateFromAPIOptions['video']) {\n    if (!video?.previewPath) return\n\n    try {\n      const response = await fetch(getOriginUrl() + video.previewPath)\n\n      this.common.previewfile = await response.blob()\n      this.saveStore.previewfile = { size: this.common.previewfile.size }\n    } catch (err) {\n      logger.error('Failed to fetch video preview', err)\n    }\n  }\n\n  private loadLive (live: UpdateFromAPIOptions['live']) {\n    if (live === undefined) {\n      this.metadata.isLive = false\n      return\n    }\n\n    const buildObj = () => {\n      return {\n        permanentLive: live.permanentLive,\n        latencyMode: live.latencyMode,\n        saveReplay: live.saveReplay,\n\n        replaySettings: live.replaySettings\n          ? { privacy: live.replaySettings.privacy }\n          : undefined\n      }\n    }\n\n    this.metadata.isLive = true\n    this.live = buildObj()\n    this.saveStore.live = buildObj()\n\n    this.metadata.live = pick(live, [ 'rtmpUrl', 'rtmpsUrl', 'streamKey' ])\n  }\n\n  loadAfterPublish (options: {\n    video: Pick<VideoDetails, 'id' | 'uuid' | 'shortUUID'>\n  }) {\n    this.metadata.id = options.video.id\n    this.metadata.uuid = options.video.uuid\n    this.metadata.shortUUID = options.video.shortUUID\n\n    this.updateAfterChange()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  loadFromCommonForm (values: CommonUpdateForm) {\n    if (values.name !== undefined) this.common.name = values.name\n    if (values.channelId !== undefined) this.common.channelId = values.channelId\n    if (values.category !== undefined) this.common.category = values.category\n    if (values.licence !== undefined) this.common.licence = values.licence\n    if (values.language !== undefined) this.common.language = values.language\n    if (values.description !== undefined) this.common.description = values.description\n    if (values.tags !== undefined) this.common.tags = values.tags\n    if (values.waitTranscoding !== undefined) this.common.waitTranscoding = values.waitTranscoding\n    if (values.support !== undefined) this.common.support = values.support\n    if (values.commentsPolicy !== undefined) this.common.commentsPolicy = values.commentsPolicy\n    if (values.downloadEnabled !== undefined) this.common.downloadEnabled = values.downloadEnabled\n    if (values.previewfile !== undefined) this.common.previewfile = values.previewfile\n    if (values.pluginData !== undefined) this.common.pluginData = values.pluginData\n\n    // ---------------------------------------------------------------------------\n    // NSFW\n    // ---------------------------------------------------------------------------\n\n    if (values.nsfw !== undefined) this.common.nsfw = values.nsfw\n\n    if (this.common.nsfw) {\n      if (values.nsfwFlagSex !== undefined) {\n        this.common.nsfwFlags = values.nsfwFlagSex\n          ? this.common.nsfwFlags | NSFWFlag.EXPLICIT_SEX\n          : this.common.nsfwFlags & ~NSFWFlag.EXPLICIT_SEX\n      }\n\n      if (values.nsfwFlagViolent !== undefined) {\n        this.common.nsfwFlags = values.nsfwFlagViolent\n          ? this.common.nsfwFlags | NSFWFlag.VIOLENT\n          : this.common.nsfwFlags & ~NSFWFlag.VIOLENT\n      }\n\n      if (values.nsfwSummary !== undefined) {\n        this.common.nsfwSummary = values.nsfwSummary\n      }\n    } else {\n      this.common.nsfwSummary = null\n      this.common.nsfwFlags = NSFWFlag.NONE\n    }\n\n    // ---------------------------------------------------------------------------\n\n    if (values.videoPassword !== undefined) {\n      this.common.videoPasswords = values.privacy === VideoPrivacy.PASSWORD_PROTECTED && values.videoPassword\n        ? [ values.videoPassword ]\n        : []\n    }\n\n    if (values.privacy !== undefined) {\n      // If schedule publication, the video is private and will be changed to public privacy\n      if (values.privacy === VideoEdit.SPECIAL_SCHEDULED_PRIVACY) {\n        const updateAt = new Date(values.schedulePublicationAt)\n        updateAt.setSeconds(0)\n\n        this.common.privacy = VideoPrivacy.PRIVATE\n\n        this.common.scheduleUpdate = {\n          updateAt: values.schedulePublicationAt\n            ? updateAt.toISOString()\n            : undefined,\n          privacy: VideoPrivacy.PUBLIC\n        }\n      } else {\n        this.common.privacy = values.privacy\n        this.common.scheduleUpdate = null\n      }\n    }\n\n    // Convert originallyPublishedAt to string so that function objectToFormData() works correctly\n    if (values.originallyPublishedAt !== undefined) {\n      this.common.originallyPublishedAt = values.originallyPublishedAt\n        ? new Date(values.originallyPublishedAt).toISOString()\n        : null\n    }\n\n    this.updateAfterChange()\n  }\n\n  toCommonFormPatch () {\n    const json: Required<CommonUpdateForm> = {\n      category: this.common.category,\n      licence: this.common.licence,\n      language: this.common.language,\n      description: this.common.description,\n      support: this.common.support,\n      name: this.common.name,\n      tags: this.common.tags,\n\n      nsfw: this.common.nsfw,\n      nsfwFlagSex: (this.common.nsfwFlags & NSFWFlag.EXPLICIT_SEX) === NSFWFlag.EXPLICIT_SEX,\n      nsfwFlagViolent: (this.common.nsfwFlags & NSFWFlag.VIOLENT) === NSFWFlag.VIOLENT,\n      nsfwSummary: this.common.nsfwSummary,\n\n      commentsPolicy: this.common.commentsPolicy,\n      waitTranscoding: this.common.waitTranscoding,\n      channelId: this.common.channelId,\n      privacy: this.common.privacy,\n\n      pluginData: this.common.pluginData,\n\n      previewfile: this.common.previewfile,\n\n      videoPassword: this.common.videoPasswords && this.common.videoPasswords.length !== 0\n        ? this.common.videoPasswords[0]\n        : null,\n\n      downloadEnabled: this.common.downloadEnabled,\n\n      originallyPublishedAt: this.common.originallyPublishedAt\n        ? new Date(this.common.originallyPublishedAt)\n        : null,\n\n      schedulePublicationAt: undefined\n    }\n\n    // Special case if we scheduled an update\n    if (this.common.scheduleUpdate) {\n      Object.assign(json, {\n        privacy: VideoEdit.SPECIAL_SCHEDULED_PRIVACY,\n        schedulePublicationAt: new Date(this.common.scheduleUpdate.updateAt.toString())\n      })\n    }\n\n    return json\n  }\n\n  toVideoUpdate (): Required<Omit<VideoUpdate, 'commentsEnabled'>> {\n    return {\n      ...this.toVideoCreateOrUpdate(),\n\n      pluginData: this.common.pluginData\n    }\n  }\n\n  toVideoCreate (overriddenPrivacy: VideoPrivacyType): Required<Omit<VideoCreate, 'commentsEnabled' | 'generateTranscription'>> {\n    return {\n      ...this.toVideoCreateOrUpdate(),\n\n      privacy: overriddenPrivacy\n    }\n  }\n\n  private toVideoCreateOrUpdate (): Required<Omit<SharedUnionFieldsDeep<VideoCreate | VideoUpdate>, 'commentsEnabled'>> {\n    return {\n      name: this.common.name,\n      category: this.common.category || null,\n      licence: this.common.licence || null,\n      language: this.common.language || null,\n      support: this.common.support || null,\n      description: this.common.description || null,\n      channelId: this.common.channelId,\n      privacy: this.common.privacy,\n\n      videoPasswords: this.common.privacy === VideoPrivacy.PASSWORD_PROTECTED\n        ? this.common.videoPasswords\n        : undefined,\n\n      tags: this.common.tags,\n      nsfw: this.common.nsfw,\n      nsfwFlags: this.common.nsfwFlags,\n      nsfwSummary: this.common.nsfwSummary || null,\n      waitTranscoding: this.common.waitTranscoding,\n      commentsPolicy: this.common.commentsPolicy,\n      downloadEnabled: this.common.downloadEnabled,\n      thumbnailfile: this.common.previewfile,\n      previewfile: this.common.previewfile,\n      scheduleUpdate: this.common.scheduleUpdate || null,\n      originallyPublishedAt: this.common.originallyPublishedAt || null\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n\n  loadFromLiveForm (values: LiveUpdateForm) {\n    if (values.permanentLive !== undefined) this.live.permanentLive = values.permanentLive\n    if (values.latencyMode !== undefined) this.live.latencyMode = values.latencyMode\n    if (values.saveReplay !== undefined) this.live.saveReplay = values.saveReplay\n\n    if (values.replayPrivacy !== undefined) {\n      this.live.replaySettings = values.replayPrivacy\n        ? { privacy: values.replayPrivacy }\n        : undefined\n    }\n\n    this.updateAfterChange()\n  }\n\n  toLiveFormPatch (): Required<LiveUpdateForm> {\n    return {\n      liveStreamKey: this.metadata.live.streamKey,\n      permanentLive: this.live.permanentLive,\n      latencyMode: this.live.latencyMode,\n      saveReplay: this.live.saveReplay,\n\n      replayPrivacy: this.live.replaySettings\n        ? this.live.replaySettings.privacy\n        : VideoPrivacy.PRIVATE\n    }\n  }\n\n  toLiveUpdate (): LiveVideoUpdate {\n    return {\n      permanentLive: this.live.permanentLive,\n      saveReplay: this.live.saveReplay,\n      replaySettings: this.live.saveReplay\n        ? this.live.replaySettings\n        : undefined,\n      latencyMode: this.live.latencyMode\n    }\n  }\n\n  toLiveCreate (overriddenPrivacy: VideoPrivacyType): LiveVideoCreate {\n    return {\n      ...this.toVideoCreate(overriddenPrivacy),\n\n      permanentLive: this.live.permanentLive,\n      latencyMode: this.live.latencyMode,\n      saveReplay: this.live.saveReplay,\n      replaySettings: this.live.replaySettings\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n\n  toVideoImportCreate (overriddenPrivacy: VideoPrivacyType): VideoImportCreate {\n    const base: VideoImportCreate = this.toVideoCreate(overriddenPrivacy)\n\n    if (this.videoImport.targetUrl) base.targetUrl = this.videoImport.targetUrl\n    if (this.videoImport.magnetUri) base.magnetUri = this.videoImport.magnetUri\n    if (this.videoImport.torrentfile) base.torrentfile = this.videoImport.torrentfile\n\n    return base\n  }\n\n  // ---------------------------------------------------------------------------\n\n  loadFromReplaceFileForm (values: ReplaceFileForm) {\n    this.replaceFile = values.replaceFile\n\n    this.updateAfterChange()\n  }\n\n  toReplaceFileFormPatch (): Required<ReplaceFileForm> {\n    return { replaceFile: this.replaceFile }\n  }\n\n  resetReplaceFile () {\n    this.replaceFile = undefined\n  }\n\n  // ---------------------------------------------------------------------------\n\n  loadFromStudioForm (values: StudioForm) {\n    const duration = this.getVideoAttributes().duration\n    this.studioTasks = []\n\n    const cut = values.cut\n    if ((exists(cut.start) && cut.start !== 0) || (exists(cut.end) && cut.end !== duration)) {\n      const options: VideoStudioTaskCut['options'] = {}\n\n      if (exists(cut.start) && cut.start !== 0) options.start = cut.start\n      if (exists(cut.end) && cut.end !== duration) options.end = cut.end\n\n      this.studioTasks.push({ name: 'cut', options })\n    }\n\n    if (values['add-intro']?.['file']) {\n      this.studioTasks.push({\n        name: 'add-intro',\n        options: {\n          file: values['add-intro']['file']\n        }\n      })\n    }\n\n    if (values['add-outro']?.['file']) {\n      this.studioTasks.push({\n        name: 'add-outro',\n        options: {\n          file: values['add-outro']['file']\n        }\n      })\n    }\n\n    if (values['add-watermark']?.['file']) {\n      this.studioTasks.push({\n        name: 'add-watermark',\n        options: {\n          file: values['add-watermark']['file']\n        }\n      })\n    }\n  }\n\n  toStudioFormPatch (): Required<StudioForm> {\n    const cut = this.studioTasks.find(t => t.name === 'cut')\n    const addIntro = this.studioTasks.find(t => t.name === 'add-intro')\n    const addOutro = this.studioTasks.find(t => t.name === 'add-outro')\n    const addWatermark = this.studioTasks.find(t => t.name === 'add-watermark')\n\n    return {\n      'cut': {\n        start: cut?.options?.start ?? 0,\n        end: cut?.options?.end ?? this.metadata.duration\n      },\n      'add-intro': { file: addIntro?.options?.file as File ?? null },\n      'add-outro': { file: addOutro?.options?.file as File },\n      'add-watermark': { file: addWatermark?.options?.file as File }\n    }\n  }\n\n  resetStudio () {\n    this.studioTasks = []\n  }\n\n  // ---------------------------------------------------------------------------\n\n  getVideoSource () {\n    return this.metadata.videoSource\n  }\n\n  getLive () {\n    return this.metadata.live\n  }\n\n  getVideoAttributes () {\n    return this.videoAttributes\n  }\n\n  getChaptersEdit () {\n    return this.chapters\n  }\n\n  getReplaceFile (): File {\n    return this.replaceFile\n  }\n\n  getCaptionsEdit () {\n    return this.captions\n  }\n\n  getStudioTasks () {\n    return this.studioTasks\n  }\n\n  getStudioTasksSummary () {\n    return this.getStudioTasks().map(t => {\n      if (t.name === 'add-intro') {\n        return $localize`\"${(t.options.file as File).name}\" will be added at the beginning of the video`\n      }\n\n      if (t.name === 'add-outro') {\n        return $localize`\"${(t.options.file as File).name}\" will be added at the end of the video`\n      }\n\n      if (t.name === 'add-watermark') {\n        return $localize`\"${(t.options.file as File).name}\" image watermark will be added to the video`\n      }\n\n      if (t.name === 'cut') {\n        const { start, end } = t.options\n\n        if (start !== undefined && end !== undefined) {\n          return $localize`Video will begin at ${secondsToTime(start)} and stop at ${secondsToTime(end)}`\n        }\n\n        if (start !== undefined) {\n          return $localize`Video will begin at ${secondsToTime(start)}`\n        }\n\n        if (end !== undefined) {\n          return $localize`Video will stop at ${secondsToTime(end)}`\n        }\n      }\n\n      return ''\n    })\n  }\n\n  // ---------------------------------------------------------------------------\n\n  hasCommonChanges () {\n    if (this.isNewVideo) return true\n    if (!this.saveStore.common) return true\n\n    let changes = !this.areSameObjects(omit(this.common, [ 'previewfile', 'pluginData' ]), this.saveStore.common)\n\n    // Compare preview file\n    if (changes !== true && (this.common.previewfile || this.saveStore.previewfile)) {\n      changes = this.common.previewfile?.size !== this.saveStore.previewfile?.size\n    }\n\n    debugLogger('Check if has common changes', {\n      changes,\n      common: this.common,\n      saveCommon: this.saveStore.common,\n      savePreview: this.saveStore.previewfile\n    })\n\n    return changes\n  }\n\n  hasPluginDataChanges () {\n    if (!this.checkPluginChanges) return false\n    if (!this.saveStore.pluginData) return true\n\n    const current = this.common.pluginData\n    const changes = !this.areSameObjects(current, this.saveStore.pluginData)\n\n    debugLogger('Check if has plugin data changes', {\n      changes,\n      pluginData: current,\n      savePluginData: this.saveStore.pluginData\n    })\n\n    return changes\n  }\n\n  hasCaptionChanges () {\n    const changes = this.captions.some(caption => !!caption.action)\n\n    debugLogger('Check if caption has changes', { captions: this.captions, changes })\n\n    return changes\n  }\n\n  hasChaptersChanges () {\n    const changes = this.chapters.hasChanges()\n\n    debugLogger('Check if chapters has changes', { chapters: this.chapters, changes })\n\n    return changes\n  }\n\n  hasLiveChanges () {\n    if (!this.live) return false\n    if (!this.saveStore.live) return true\n\n    const changes = !this.areSameObjects(this.live, this.saveStore.live)\n\n    debugLogger('Check if live has changes', { live: this.live, saveLive: this.saveStore.live, changes })\n\n    return changes\n  }\n\n  hasReplaceFile () {\n    const changes = !!this.replaceFile\n\n    debugLogger('Check if replace file has changes', { replaceFile: this.replaceFile, changes })\n\n    return changes\n  }\n\n  hasStudioTasks () {\n    const changes = this.studioTasks.length !== 0\n\n    debugLogger('Check if studio has changes', { studioTasks: this.studioTasks, changes })\n\n    return changes\n  }\n\n  // ---------------------------------------------------------------------------\n\n  hasPendingChanges () {\n    return this.hasCaptionChanges() ||\n      this.hasLiveChanges() ||\n      this.hasReplaceFile() ||\n      this.hasStudioTasks() ||\n      this.hasChaptersChanges() ||\n      this.hasCommonChanges() ||\n      this.hasPluginDataChanges()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  isPublishedVOD () {\n    return !this.metadata.isLive && this.metadata.state === VideoState.PUBLISHED\n  }\n\n  private updateAfterChange () {\n    this.videoAttributes = {\n      id: this.metadata.id,\n      shortUUID: this.metadata.shortUUID,\n      uuid: this.metadata.uuid,\n      name: this.common.name,\n      state: this.metadata.state,\n      privacy: this.common.privacy,\n      isLive: this.metadata.isLive,\n      aspectRatio: this.metadata.aspectRatio,\n      views: this.metadata.views,\n      likes: this.metadata.likes,\n      duration: this.metadata.duration,\n      blacklisted: this.metadata.blacklisted,\n\n      live: this.metadata.live\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n\n  areSameObjects<T, U> (a: Jsonify<T>, b: Jsonify<U>) {\n    // Allow '' === null\n    if (typeof a === 'string') return a === b || !a && b === null\n    if (typeof b === 'string') return a === b || !b && a === null\n\n    // Allow null === undefined\n    if (a === undefined) return !exists(b)\n    if (b === undefined) return !exists(a)\n\n    if (a as any === b as any) return true\n\n    if (typeof a !== 'object' || typeof b !== 'object' || a === null || b === null) {\n      return false\n    }\n\n    const keysA = Object.keys(a)\n    const keysB = Object.keys(b)\n\n    if (keysA.length !== keysB.length) return false\n\n    for (const key of keysA) {\n      if (!keysB.includes(key)) return false\n\n      if (!this.areSameObjects((a as any)[key], (b as any)[key])) return false\n    }\n\n    return true\n  }\n\n  // ---------------------------------------------------------------------------\n\n  onSave () {\n    this.isNewVideo = false\n  }\n\n  enableCheckPluginChanges () {\n    this.checkPluginChanges = true\n  }\n\n  disableCheckPluginChanges () {\n    this.checkPluginChanges = false\n  }\n}\n","import { simpleObjectsDeepEqual, sortBy } from '@peertube/peertube-core-utils'\nimport { VideoChapter } from '@peertube/peertube-models'\n\nexport class VideoChaptersEdit {\n  private chaptersFromAPI: VideoChapter[] = []\n  private chapters: VideoChapter[] = []\n\n  loadFromAPI (chapters: VideoChapter[]) {\n    this.chapters = chapters || []\n\n    this.chaptersFromAPI = chapters\n  }\n\n  loadFromForm (values: { chapters?: { timecode?: number, title?: string }[] }) {\n    const chapters = values.chapters || []\n\n    this.chapters = chapters.map((c: any) => {\n      return {\n        timecode: c.timecode || 0,\n        title: c.title\n      }\n    })\n  }\n\n  toFormPatch () {\n    return { chapters: this.chapters }\n  }\n\n  getChaptersForUpdate (): VideoChapter[] {\n    return this.chapters.filter(c => !!c.title)\n  }\n\n  hasChanges () {\n    return simpleObjectsDeepEqual(sortBy(this.getChaptersForUpdate(), 'timecode'), this.chaptersFromAPI) !== true\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"film\"></my-global-icon>\n\n  <ng-container i18n>Main information</ng-container>\n</h2>\n\n<div [formGroup]=\"form\">\n\n  <ng-template #pluginSettingTemplate let-pluginSetting>\n    <div [hidden]=\"isPluginFieldHidden(pluginSetting)\">\n      <my-dynamic-form-field [form]=\"pluginDataFormGroup\" [formErrors]=\"formErrors['pluginData']\" [setting]=\"pluginSetting.commonOptions\"></my-dynamic-form-field>\n    </div>\n  </ng-template>\n\n  <div class=\"form-columns\">\n    <div>\n      <div class=\"form-group\">\n        <label i18n for=\"name\">Video title</label>\n        <input type=\"text\" id=\"name\" class=\"form-control\" formControlName=\"name\" />\n        <div *ngIf=\"formErrors.name\" class=\"form-error\" role=\"alert\">{{ formErrors.name }}</div>\n      </div>\n\n      <div class=\"form-group\">\n        <label i18n for=\"description\">Description</label>\n\n        <div class=\"form-group-description\">\n          <div i18n>\n            You can format your description using the <my-markdown-hint helpType=\"markdownText\">Markdown Language</my-markdown-hint>:\n          </div>\n\n          <ul>\n            <li i18n>For example, to put <strong>text in bold</strong> (**text in bold**) or <em>text in italic</em> (*text in italic*)</li>\n            <li i18n>You can also create a link to a specific timecode of the video (e.g. <span class=\"fake-link\">00:05</span> by simply writing 00:05) or <span class=\"fake-link\">a classic link</span> ([title of my link](https://example.com))</li>\n          </ul>\n        </div>\n\n        <my-markdown-textarea\n          inputId=\"description\"\n          formControlName=\"description\" [markdownVideo]=\"videoEdit.getVideoAttributes()\"\n          [formError]=\"formErrors.description\" withEmoji=\"true\" withShowMoreButton=\"true\"\n        ></my-markdown-textarea>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"label-tags\" i18n class=\"label-tags\">Tags</label>\n        <div class=\"form-group-description\">\n          <ng-container i18n>Maximum of 5 tags to suggest relevant recommendations.</ng-container>\n        </div>\n\n        <my-select-tags inputId=\"label-tags\" formControlName=\"tags\" class=\"d-block w-100\"></my-select-tags>\n        <div *ngIf=\"formErrors.tags\" class=\"form-error\" role=\"alert\">{{ formErrors.tags }}</div>\n      </div>\n\n      <div class=\"form-group mb-5\">\n        <label i18n for=\"support\">Support button</label>\n\n        <div class=\"form-group-description\" i18n>\n          This is text that helps people watching your video <strong>understand how to support you</strong>. You can use <my-markdown-hint helpType=\"markdownText\">Markdown Language</my-markdown-hint>, including <strong>links to your fundraising tools</strong>.\n        </div>\n\n        <my-markdown-textarea\n          inputId=\"support\" formControlName=\"support\" markdownType=\"enhanced\"\n          [formError]=\"formErrors['support']\" withEmoji=\"true\" withHtml=\"true\"\n        ></my-markdown-textarea>\n\n        <div class=\"form-group-description mt-3\" i18n>\n          Do you want to use the same text for all your videos? You can define <strong>a default text and support button</strong> in your <a [routerLink]=\"getChannelUpdateUrl()\" target=\"_blank\" rel=\"noopener noreferrer\">channel settings</a>.\n        </div>\n      </div>\n\n      <ng-container\n        *ngFor=\"let pluginSetting of getPluginsFields('main')\"\n        [ngTemplateOutlet]=\"pluginSettingTemplate\" [ngTemplateOutletContext]=\"{ $implicit: pluginSetting }\"\n      ></ng-container>\n\n      <ng-container\n        *ngFor=\"let pluginSetting of getPluginsFields('plugin-settings')\"\n        [ngTemplateOutlet]=\"pluginSettingTemplate\" [ngTemplateOutletContext]=\"{ $implicit: pluginSetting }\"\n      ></ng-container>\n    </div>\n\n    <div>\n      <div class=\"form-group\">\n        <label i18n for=\"channel\">Channel</label>\n        <my-select-channel class=\"d-block\" inputId=\"channel\" [items]=\"userChannels\" formControlName=\"channelId\"></my-select-channel>\n      </div>\n\n      <div class=\"form-group\">\n        <label i18n for=\"previewfile\">Thumbnail</label>\n\n        <my-thumbnail-manager id=\"previewfile\" formControlName=\"previewfile\" [videoEdit]=\"videoEdit\"></my-thumbnail-manager>\n      </div>\n\n      <div class=\"form-group\">\n        <label i18n for=\"privacy\">Privacy</label>\n        <my-select-options inputId=\"privacy\" [items]=\"videoPrivacies\" formControlName=\"privacy\"></my-select-options>\n\n        <div *ngIf=\"formErrors.privacy\" class=\"form-error\" role=\"alert\">\n          {{ formErrors.privacy }}\n        </div>\n      </div>\n\n      <div *ngIf=\"passwordProtectionSelected\" class=\"form-group\">\n        <label i18n for=\"videoPassword\">Password</label>\n        <my-input-text formControlName=\"videoPassword\" inputId=\"videoPassword\" [withCopy]=\"true\" [formError]=\"formErrors['videoPassword']\"></my-input-text>\n      </div>\n\n      <div *ngIf=\"schedulePublicationSelected\" class=\"form-group\">\n        <label i18n for=\"schedulePublicationAt\">Schedule publication ({{ calendarTimezone }})</label>\n        <p-calendar\n          id=\"schedulePublicationAt\" formControlName=\"schedulePublicationAt\" [dateFormat]=\"calendarDateFormat\"\n          [firstDayOfWeek]=\"0\" [minDate]=\"minScheduledDate\" [showTime]=\"true\" [hideOnDateTimeSelect]=\"true\"\n          baseZIndex=\"20000\"\n        >\n      </p-calendar>\n\n      <div *ngIf=\"formErrors.schedulePublicationAt\" class=\"form-error\" role=\"alert\">\n        {{ formErrors.schedulePublicationAt }}\n      </div>\n    </div>\n\n    <div class=\"form-group\">\n      <label i18n for=\"licence\">Licence</label>\n\n      <div class=\"form-group-description\" i18n>\n        <a href=\"https://chooser-beta.creativecommons.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Choose</a> the appropriate licence for your work.\n      </div>\n\n      <my-select-options inputId=\"licence\" [items]=\"videoLicences\" formControlName=\"licence\" clearable=\"true\"></my-select-options>\n\n      <div *ngIf=\"formErrors.licence\" class=\"form-error\" role=\"alert\">\n        {{ formErrors.licence }}\n      </div>\n    </div>\n\n    <div class=\"form-group\">\n      <label i18n for=\"category\">Category</label>\n      <my-select-options inputId=\"category\" [items]=\"videoCategories\" formControlName=\"category\" clearable=\"true\"></my-select-options>\n\n      <div *ngIf=\"formErrors.category\" class=\"form-error\" role=\"alert\">\n        {{ formErrors.category }}\n      </div>\n    </div>\n\n    <div class=\"form-group\">\n      <label i18n for=\"language\">Language</label>\n      <my-select-options\n        inputId=\"language\" [items]=\"videoLanguages\" formControlName=\"language\"\n        clearable=\"true\" filter=\"true\" virtualScroll=\"true\"\n      ></my-select-options>\n\n      <div *ngIf=\"formErrors.language\" class=\"form-error\" role=\"alert\">\n        {{ formErrors.language }}\n      </div>\n    </div>\n\n    <my-peertube-checkbox *ngIf=\"!hideWaitTranscoding\" inputName=\"waitTranscoding\" formControlName=\"waitTranscoding\" helpPlacement=\"bottom-right\">\n      <ng-template ptTemplate=\"label\">\n        <ng-container i18n>Publish video after transcoding</ng-container>\n      </ng-template>\n\n      <ng-template ptTemplate=\"help\">\n        <ng-container i18n>The video may be unplayable during the transcoding process. It's the reason why we prefer to publish publicly the video after transcoding.</ng-container>\n      </ng-template>\n    </my-peertube-checkbox>\n  </div>\n</div>\n\n<div *ngIf=\"canBeDeleted()\">\n  <div class=\"danger-zone mt-5\">\n    <h3 class=\"mb-3\" i18n>DANGER ZONE</h3>\n\n    <div class=\"form-group\">\n      <label i18n for=\"deleteVideo\">Delete your video</label>\n      <div class=\"form-group-description\" i18n>Warning: this is a definitive action!</div>\n\n      <button class=\"peertube-button danger-button\" (click)=\"deleteVideo()\" i18n>Delete</button>\n    </div>\n  </div>\n</div>\n","import { CommonModule } from '@angular/common'\nimport { Component, OnDestroy, OnInit, inject } from '@angular/core'\nimport { FormControl, FormGroup, FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { RouterLink } from '@angular/router'\nimport { ServerService } from '@app/core'\nimport { BuildFormArgument } from '@app/shared/form-validators/form-validator.model'\nimport { VIDEO_NSFW_SUMMARY_VALIDATOR } from '@app/shared/form-validators/video-validators'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport { HTMLServerConfig, VideoCommentPolicyType, VideoConstant } from '@peertube/peertube-models'\nimport debug from 'debug'\nimport { CalendarModule } from 'primeng/calendar'\nimport { Subscription } from 'rxjs'\nimport { PeertubeCheckboxComponent } from '../../../shared/shared-forms/peertube-checkbox.component'\nimport { SelectRadioComponent } from '../../../shared/shared-forms/select/select-radio.component'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { PeerTubeTemplateDirective } from '../../../shared/shared-main/common/peertube-template.directive'\nimport { VideoManageController } from '../video-manage-controller.service'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype Form = {\n  nsfw: FormControl<boolean>\n\n  nsfwFlagViolent: FormControl<boolean>\n  nsfwFlagSex: FormControl<boolean>\n  nsfwSummary: FormControl<string>\n\n  commentPolicies: FormControl<VideoCommentPolicyType>\n}\n\n@Component({\n  selector: 'my-video-moderation',\n  styleUrls: [\n    '../common/video-manage-page-common.scss'\n  ],\n  templateUrl: './video-moderation.component.html',\n  imports: [\n    CommonModule,\n    RouterLink,\n    FormsModule,\n    ReactiveFormsModule,\n    PeerTubeTemplateDirective,\n    CalendarModule,\n    PeertubeCheckboxComponent,\n    GlobalIconComponent,\n    SelectRadioComponent\n  ]\n})\nexport class VideoModerationComponent implements OnInit, OnDestroy {\n  private formReactiveService = inject(FormReactiveService)\n  private serverService = inject(ServerService)\n  private manageController = inject(VideoManageController)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  commentPolicies: VideoConstant<VideoCommentPolicyType>[] = []\n  serverConfig: HTMLServerConfig\n\n  private updatedSub: Subscription\n\n  ngOnInit () {\n    this.serverConfig = this.serverService.getHTMLConfig()\n\n    this.buildForm()\n\n    this.serverService.getCommentPolicies()\n      .subscribe(res => this.commentPolicies = res)\n  }\n\n  ngOnDestroy () {\n    this.updatedSub?.unsubscribe()\n  }\n\n  private buildForm () {\n    const videoEdit = this.manageController.getStore().videoEdit\n\n    const defaultValues = videoEdit.toCommonFormPatch()\n    const obj: BuildFormArgument = {\n      commentsPolicy: null,\n      nsfw: null,\n      nsfwFlagViolent: null,\n      nsfwFlagSex: null,\n      nsfwSummary: VIDEO_NSFW_SUMMARY_VALIDATOR\n    }\n\n    const {\n      form,\n      formErrors,\n      validationMessages\n    } = this.formReactiveService.buildForm<Form>(obj, defaultValues)\n\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.form.valueChanges.subscribe(() => {\n      this.manageController.setFormError($localize`Moderation`, 'moderation', this.formErrors)\n\n      const formValues = this.form.value\n      debugLogger('Updating form values', formValues)\n\n      videoEdit.loadFromCommonForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.form.patchValue(videoEdit.toCommonFormPatch())\n    })\n\n    this.updateNSFWControls(videoEdit.toCommonFormPatch().nsfw)\n    this.trackNSFWChange()\n  }\n\n  private trackNSFWChange () {\n    this.form.controls.nsfw\n      .valueChanges\n      .subscribe(newNSFW => this.updateNSFWControls(newNSFW))\n  }\n\n  private updateNSFWControls (nsfw: boolean) {\n    const controls = [\n      this.form.controls.nsfwFlagViolent,\n      this.form.controls.nsfwFlagSex,\n      this.form.controls.nsfwSummary\n    ]\n\n    if (!nsfw) {\n      for (const control of controls) {\n        control.disable()\n      }\n\n      return\n    }\n\n    for (const control of controls) {\n      control.enable()\n    }\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"moderation\"></my-global-icon>\n\n  <ng-container i18n>Moderation</ng-container>\n</h2>\n\n<div [formGroup]=\"form\">\n\n  <div class=\"form-columns\">\n    <div>\n      <div class=\"form-group\">\n        <my-select-radio\n          i18n-label label=\"Comments policy\"\n          [items]=\"commentPolicies\"\n          inputId=\"commentsPolicy\"\n          formControlName=\"commentsPolicy\"\n        >\n          <div class=\"form-group-description\" i18n>\n            You can require comments to be approved depending on <a routerLink=\"/my-account/auto-tag-policies\" target=\"_blank\">your auto-tags policies</a>\n          </div>\n        </my-select-radio>\n      </div>\n\n      <my-peertube-checkbox inputName=\"nsfw\" formControlName=\"nsfw\">\n        <ng-template ptTemplate=\"label\">\n          <ng-container i18n>Your video contains sensitive content</ng-container>\n        </ng-template>\n\n        <ng-container ngProjectAs=\"extra\">\n          <div class=\"form-group\">\n            <label i18n for=\"nsfwSummary\">Describe what makes your content sensitive</label>\n            <input type=\"text\" id=\"nsfwSummary\" class=\"form-control\" formControlName=\"nsfwSummary\" [ngClass]=\"{ 'input-error': formErrors.nsfwSummary }\" />\n\n            <div *ngIf=\"formErrors.nsfwSummary\" class=\"form-error\" role=\"alert\">{{ formErrors.nsfwSummary }}</div>\n          </div>\n\n          <div class=\"label\" i18n>Help viewers to identify your sensitive content</div>\n\n          <my-peertube-checkbox inputName=\"nsfwFlagViolent\" formControlName=\"nsfwFlagViolent\">\n            <ng-template ptTemplate=\"label\">\n              <ng-container i18n>Some images may be violent</ng-container>\n            </ng-template>\n          </my-peertube-checkbox>\n\n          <my-peertube-checkbox inputName=\"nsfwFlagSex\" formControlName=\"nsfwFlagSex\">\n            <ng-template ptTemplate=\"label\">\n              <ng-container i18n>Content may be perceived as sexually explicit material</ng-container>\n            </ng-template>\n          </my-peertube-checkbox>\n\n\n       </ng-container>\n\n      </my-peertube-checkbox>\n    </div>\n  </div>\n</div>\n","import { CommonModule } from '@angular/common'\nimport { Component, inject, OnDestroy, OnInit, ViewChild } from '@angular/core'\nimport { FormControl, FormGroup, FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { ServerService } from '@app/core'\nimport { BuildFormArgument } from '@app/shared/form-validators/form-validator.model'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport debug from 'debug'\nimport { Subscription } from 'rxjs'\nimport { ReactiveFileComponent } from '../../../shared/shared-forms/reactive-file.component'\nimport { GlobalIconComponent } from '../../../shared/shared-icons/global-icon.component'\nimport { AlertComponent } from '../../../shared/shared-main/common/alert.component'\nimport { getReplaceFileUnavailability } from '../common/unavailable-features'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoUploadService } from '../common/video-upload.service'\nimport { VideoManageController } from '../video-manage-controller.service'\nimport { DragDropDirective } from '@app/+videos-publish-manage/+video-publish/shared/drag-drop.directive'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype Form = {\n  replaceFile: FormControl<File>\n}\n\n@Component({\n  selector: 'my-video-replace-file',\n  styleUrls: [\n    '../common/video-manage-page-common.scss',\n    './video-replace-file.component.scss'\n  ],\n  templateUrl: './video-replace-file.component.html',\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ReactiveFileComponent,\n    AlertComponent,\n    GlobalIconComponent,\n    DragDropDirective\n  ]\n})\nexport class VideoReplaceFileComponent implements OnInit, OnDestroy {\n  private formReactiveService = inject(FormReactiveService)\n  private videoUploadService = inject(VideoUploadService)\n  private manageController = inject(VideoManageController)\n  private server = inject(ServerService)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  videoEdit: VideoEdit\n\n  replaceFileEnabled: boolean\n  instanceName: string\n\n  private updatedSub: Subscription\n\n  ngOnInit () {\n    this.videoEdit = this.manageController.getStore().videoEdit\n\n    const config = this.server.getHTMLConfig()\n    this.replaceFileEnabled = config.videoFile.update.enabled === true\n    this.instanceName = config.instance.name\n\n    const defaultValues = this.videoEdit.toReplaceFileFormPatch()\n    const obj: BuildFormArgument = { replaceFile: null }\n\n    const {\n      form,\n      formErrors,\n      validationMessages\n    } = this.formReactiveService.buildForm<Form>(obj, defaultValues)\n\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.form.valueChanges.subscribe(() => {\n      this.manageController.setFormError($localize`Replace file`, 'replace-file', this.formErrors)\n\n      const formValues = this.form.value\n      debugLogger('Updating form values', formValues)\n\n      this.videoEdit.loadFromReplaceFileForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.form.patchValue(this.videoEdit.toReplaceFileFormPatch())\n    })\n  }\n\n  ngOnDestroy (): void {\n    this.updatedSub?.unsubscribe()\n  }\n\n  @ViewChild('reactiveFileInput')\n  reactiveFile: ReactiveFileComponent\n  onFileDropped (files: FileList) {\n    this.reactiveFile.fileChange({ target: { files } })\n    // this.onFileChanged(files[0])\n  }\n\n  onFileChanged (file: File | Blob) {\n    if (!file) return\n\n    if (!(file instanceof File)) {\n      // console.error('Received unexpected non-File:', file)\n      return\n    }\n\n    // Put the file in the form control to activate the save button\n    this.form.controls.replaceFile.setValue(file)\n    this.form.controls.replaceFile.markAsDirty()\n    this.form.markAsDirty()\n    this.form.updateValueAndValidity()\n  }\n\n  getVideoExtensions () {\n    return this.videoUploadService.getVideoExtensions()\n  }\n\n  getUnavailability () {\n    return getReplaceFileUnavailability({\n      ...this.videoEdit.getVideoAttributes(),\n\n      instanceName: this.instanceName,\n      replaceFileEnabled: this.replaceFileEnabled\n    })\n  }\n}\n","import { canVideoFileBeEdited } from '@peertube/peertube-core-utils'\nimport { VideoState, VideoStateType } from '@peertube/peertube-models'\n\nexport function getReplaceFileUnavailability (options: {\n  isLive: boolean\n  replaceFileEnabled: boolean\n  state: VideoStateType\n  instanceName: string\n}) {\n  const { isLive, replaceFileEnabled, state, instanceName } = options\n\n  if (!replaceFileEnabled) return $localize`File replacement is not enabled on ${instanceName}.`\n\n  if (!canVideoFileBeEdited(state)) {\n    if (isLive) return $localize`File replacement is not available on a live.`\n    if (state === VideoState.TO_TRANSCODE) return $localize`File replacement is not available while the video is being transcoded.`\n    if (state === VideoState.TO_EDIT) return $localize`File replacement is not available while the video is being edited.`\n    if (state === VideoState.TO_IMPORT) return $localize`File replacement is not available while the video is being imported.`\n\n    return $localize`File replacement is not available.`\n  }\n\n  return ''\n}\n\nexport function getStudioUnavailability (options: {\n  isLive: boolean\n  studioEnabled: boolean\n  state: VideoStateType\n  instanceName: string\n}) {\n  const { isLive, studioEnabled, state, instanceName } = options\n\n  if (!studioEnabled) return $localize`Studio is not enabled on ${instanceName}.`\n\n  if (!canVideoFileBeEdited(state)) {\n    if (isLive) return $localize`Studio is not available on a live.`\n    if (state === VideoState.TO_TRANSCODE) return $localize`Studio is not available while the video is being transcoded.`\n    if (state === VideoState.TO_EDIT) return $localize`Studio is not available while the video is being edited.`\n    if (state === VideoState.TO_IMPORT) return $localize`Studio is not available while the video is being imported.`\n\n    return $localize`Studio is not available.`\n  }\n\n  return ''\n}\n","<h2>\n  <my-global-icon iconName=\"upload\"></my-global-icon>\n\n  <ng-container i18n>Replace file</ng-container>\n</h2>\n\n@if (getUnavailability()) {\n  <my-alert type=\"primary\" i18n>{{ getUnavailability() }}</my-alert>\n} @else {\n  <div class=\"root\" myDragDrop (fileDropped)=\"onFileDropped($event)\">\n    <div *ngIf=\"videoEdit.getVideoSource()\" class=\"current-filename\">\n      <div class=\"fs-7\" i18n>Current uploaded file:</div>\n\n      <strong class=\"fs-5\">{{ videoEdit.getVideoSource().filename }}</strong>\n    </div>\n\n    <div class=\"mt-3\">\n      <div class=\"muted-1\">\n        <strong>Drag and drop your new video file here</strong> or click on the button below to replace your video:\n      </div>\n\n      <div class=\"muted-2 fs-7\">\n        <div i18n class=\"form-group-description\"> Uploading a new version of your video will completely erase the current version</div>\n      </div>\n\n      <div class=\"d-flex flex-wrap mt-4 justify-content-center gap-3\">\n        <my-reactive-file #reactiveFileInput class=\"d-inline-block me-3\" inputName=\"videoFile\" i18n-inputLabel\n          inputLabel=\"Upload\" (fileChanged)=\"onFileChanged($event)\" [extensions]=\"getVideoExtensions()\"\n          [displayFilename]=\"true\" [displayReset]=\"false\" placement=\"right\" theme=\"secondary\" icon=\"upload\">\n        </my-reactive-file>\n      </div>\n    </div>\n  </div>\n}\n","/*!\n* chartjs-plugin-zoom v2.2.0\n* https://www.chartjs.org/chartjs-plugin-zoom/2.2.0/\n * (c) 2016-2024 chartjs-plugin-zoom Contributors\n * Released under the MIT License\n */\nimport Hammer from 'hammerjs';\nimport { each, valueOrDefault, almostEquals, callback, sign, getRelativePosition, _isPointInArea } from 'chart.js/helpers';\nconst getModifierKey = opts => opts && opts.enabled && opts.modifierKey;\nconst keyPressed = (key, event) => key && event[key + 'Key'];\nconst keyNotPressed = (key, event) => key && !event[key + 'Key'];\nfunction directionEnabled(mode, dir, chart) {\n  if (mode === undefined) {\n    return true;\n  } else if (typeof mode === 'string') {\n    return mode.indexOf(dir) !== -1;\n  } else if (typeof mode === 'function') {\n    return mode({\n      chart\n    }).indexOf(dir) !== -1;\n  }\n  return false;\n}\nfunction directionsEnabled(mode, chart) {\n  if (typeof mode === 'function') {\n    mode = mode({\n      chart\n    });\n  }\n  if (typeof mode === 'string') {\n    return {\n      x: mode.indexOf('x') !== -1,\n      y: mode.indexOf('y') !== -1\n    };\n  }\n  return {\n    x: false,\n    y: false\n  };\n}\nfunction debounce(fn, delay) {\n  let timeout;\n  return function () {\n    clearTimeout(timeout);\n    timeout = setTimeout(fn, delay);\n    return delay;\n  };\n}\nfunction getScaleUnderPoint({\n  x,\n  y\n}, chart) {\n  const scales = chart.scales;\n  const scaleIds = Object.keys(scales);\n  for (let i = 0; i < scaleIds.length; i++) {\n    const scale = scales[scaleIds[i]];\n    if (y >= scale.top && y <= scale.bottom && x >= scale.left && x <= scale.right) {\n      return scale;\n    }\n  }\n  return null;\n}\nfunction getEnabledScalesByPoint(options, point, chart) {\n  const {\n    mode = 'xy',\n    scaleMode,\n    overScaleMode\n  } = options || {};\n  const scale = getScaleUnderPoint(point, chart);\n  const enabled = directionsEnabled(mode, chart);\n  const scaleEnabled = directionsEnabled(scaleMode, chart);\n  if (overScaleMode) {\n    const overScaleEnabled = directionsEnabled(overScaleMode, chart);\n    for (const axis of ['x', 'y']) {\n      if (overScaleEnabled[axis]) {\n        scaleEnabled[axis] = enabled[axis];\n        enabled[axis] = false;\n      }\n    }\n  }\n  if (scale && scaleEnabled[scale.axis]) {\n    return [scale];\n  }\n  const enabledScales = [];\n  each(chart.scales, function (scaleItem) {\n    if (enabled[scaleItem.axis]) {\n      enabledScales.push(scaleItem);\n    }\n  });\n  return enabledScales;\n}\nconst chartStates = new WeakMap();\nfunction getState(chart) {\n  let state = chartStates.get(chart);\n  if (!state) {\n    state = {\n      originalScaleLimits: {},\n      updatedScaleLimits: {},\n      handlers: {},\n      panDelta: {},\n      dragging: false,\n      panning: false\n    };\n    chartStates.set(chart, state);\n  }\n  return state;\n}\nfunction removeState(chart) {\n  chartStates.delete(chart);\n}\nfunction zoomDelta(val, min, range, newRange) {\n  const minPercent = Math.max(0, Math.min(1, (val - min) / range || 0));\n  const maxPercent = 1 - minPercent;\n  return {\n    min: newRange * minPercent,\n    max: newRange * maxPercent\n  };\n}\nfunction getValueAtPoint(scale, point) {\n  const pixel = scale.isHorizontal() ? point.x : point.y;\n  return scale.getValueForPixel(pixel);\n}\nfunction linearZoomDelta(scale, zoom, center) {\n  const range = scale.max - scale.min;\n  const newRange = range * (zoom - 1);\n  const centerValue = getValueAtPoint(scale, center);\n  return zoomDelta(centerValue, scale.min, range, newRange);\n}\nfunction logarithmicZoomRange(scale, zoom, center) {\n  const centerValue = getValueAtPoint(scale, center);\n  if (centerValue === undefined) {\n    return {\n      min: scale.min,\n      max: scale.max\n    };\n  }\n  const logMin = Math.log10(scale.min);\n  const logMax = Math.log10(scale.max);\n  const logCenter = Math.log10(centerValue);\n  const logRange = logMax - logMin;\n  const newLogRange = logRange * (zoom - 1);\n  const delta = zoomDelta(logCenter, logMin, logRange, newLogRange);\n  return {\n    min: Math.pow(10, logMin + delta.min),\n    max: Math.pow(10, logMax - delta.max)\n  };\n}\nfunction getScaleLimits(scale, limits) {\n  return limits && (limits[scale.id] || limits[scale.axis]) || {};\n}\nfunction getLimit(state, scale, scaleLimits, prop, fallback) {\n  let limit = scaleLimits[prop];\n  if (limit === 'original') {\n    const original = state.originalScaleLimits[scale.id][prop];\n    limit = valueOrDefault(original.options, original.scale);\n  }\n  return valueOrDefault(limit, fallback);\n}\nfunction linearRange(scale, pixel0, pixel1) {\n  const v0 = scale.getValueForPixel(pixel0);\n  const v1 = scale.getValueForPixel(pixel1);\n  return {\n    min: Math.min(v0, v1),\n    max: Math.max(v0, v1)\n  };\n}\nfunction fixRange(range, {\n  min,\n  max,\n  minLimit,\n  maxLimit\n}, originalLimits) {\n  const offset = (range - max + min) / 2;\n  min -= offset;\n  max += offset;\n  const origMin = originalLimits.min.options ?? originalLimits.min.scale;\n  const origMax = originalLimits.max.options ?? originalLimits.max.scale;\n  const epsilon = range / 1e6;\n  if (almostEquals(min, origMin, epsilon)) {\n    min = origMin;\n  }\n  if (almostEquals(max, origMax, epsilon)) {\n    max = origMax;\n  }\n  if (min < minLimit) {\n    min = minLimit;\n    max = Math.min(minLimit + range, maxLimit);\n  } else if (max > maxLimit) {\n    max = maxLimit;\n    min = Math.max(maxLimit - range, minLimit);\n  }\n  return {\n    min,\n    max\n  };\n}\nfunction updateRange(scale, {\n  min,\n  max\n}, limits, zoom = false) {\n  const state = getState(scale.chart);\n  const {\n    options: scaleOpts\n  } = scale;\n  const scaleLimits = getScaleLimits(scale, limits);\n  const {\n    minRange = 0\n  } = scaleLimits;\n  const minLimit = getLimit(state, scale, scaleLimits, 'min', -Infinity);\n  const maxLimit = getLimit(state, scale, scaleLimits, 'max', Infinity);\n  if (zoom === 'pan' && (min < minLimit || max > maxLimit)) {\n    return true;\n  }\n  const scaleRange = scale.max - scale.min;\n  const range = zoom ? Math.max(max - min, minRange) : scaleRange;\n  if (zoom && range === minRange && scaleRange <= minRange) {\n    return true;\n  }\n  const newRange = fixRange(range, {\n    min,\n    max,\n    minLimit,\n    maxLimit\n  }, state.originalScaleLimits[scale.id]);\n  scaleOpts.min = newRange.min;\n  scaleOpts.max = newRange.max;\n  state.updatedScaleLimits[scale.id] = newRange;\n  return scale.parse(newRange.min) !== scale.min || scale.parse(newRange.max) !== scale.max;\n}\nfunction zoomNumericalScale(scale, zoom, center, limits) {\n  const delta = linearZoomDelta(scale, zoom, center);\n  const newRange = {\n    min: scale.min + delta.min,\n    max: scale.max - delta.max\n  };\n  return updateRange(scale, newRange, limits, true);\n}\nfunction zoomLogarithmicScale(scale, zoom, center, limits) {\n  const newRange = logarithmicZoomRange(scale, zoom, center);\n  return updateRange(scale, newRange, limits, true);\n}\nfunction zoomRectNumericalScale(scale, from, to, limits) {\n  updateRange(scale, linearRange(scale, from, to), limits, true);\n}\nconst integerChange = v => v === 0 || isNaN(v) ? 0 : v < 0 ? Math.min(Math.round(v), -1) : Math.max(Math.round(v), 1);\nfunction existCategoryFromMaxZoom(scale) {\n  const labels = scale.getLabels();\n  const maxIndex = labels.length - 1;\n  if (scale.min > 0) {\n    scale.min -= 1;\n  }\n  if (scale.max < maxIndex) {\n    scale.max += 1;\n  }\n}\nfunction zoomCategoryScale(scale, zoom, center, limits) {\n  const delta = linearZoomDelta(scale, zoom, center);\n  if (scale.min === scale.max && zoom < 1) {\n    existCategoryFromMaxZoom(scale);\n  }\n  const newRange = {\n    min: scale.min + integerChange(delta.min),\n    max: scale.max - integerChange(delta.max)\n  };\n  return updateRange(scale, newRange, limits, true);\n}\nfunction scaleLength(scale) {\n  return scale.isHorizontal() ? scale.width : scale.height;\n}\nfunction panCategoryScale(scale, delta, limits) {\n  const labels = scale.getLabels();\n  const lastLabelIndex = labels.length - 1;\n  let {\n    min,\n    max\n  } = scale;\n  const range = Math.max(max - min, 1);\n  const stepDelta = Math.round(scaleLength(scale) / Math.max(range, 10));\n  const stepSize = Math.round(Math.abs(delta / stepDelta));\n  let applied;\n  if (delta < -stepDelta) {\n    max = Math.min(max + stepSize, lastLabelIndex);\n    min = range === 1 ? max : max - range;\n    applied = max === lastLabelIndex;\n  } else if (delta > stepDelta) {\n    min = Math.max(0, min - stepSize);\n    max = range === 1 ? min : min + range;\n    applied = min === 0;\n  }\n  return updateRange(scale, {\n    min,\n    max\n  }, limits) || applied;\n}\nconst OFFSETS = {\n  second: 500,\n  minute: 30 * 1000,\n  hour: 30 * 60 * 1000,\n  day: 12 * 60 * 60 * 1000,\n  week: 3.5 * 24 * 60 * 60 * 1000,\n  month: 15 * 24 * 60 * 60 * 1000,\n  quarter: 60 * 24 * 60 * 60 * 1000,\n  year: 182 * 24 * 60 * 60 * 1000\n};\nfunction panNumericalScale(scale, delta, limits, pan = false) {\n  const {\n    min: prevStart,\n    max: prevEnd,\n    options\n  } = scale;\n  const round = options.time && options.time.round;\n  const offset = OFFSETS[round] || 0;\n  const newMin = scale.getValueForPixel(scale.getPixelForValue(prevStart + offset) - delta);\n  const newMax = scale.getValueForPixel(scale.getPixelForValue(prevEnd + offset) - delta);\n  if (isNaN(newMin) || isNaN(newMax)) {\n    return true;\n  }\n  return updateRange(scale, {\n    min: newMin,\n    max: newMax\n  }, limits, pan ? 'pan' : false);\n}\nfunction panNonLinearScale(scale, delta, limits) {\n  return panNumericalScale(scale, delta, limits, true);\n}\nconst zoomFunctions = {\n  category: zoomCategoryScale,\n  default: zoomNumericalScale,\n  logarithmic: zoomLogarithmicScale\n};\nconst zoomRectFunctions = {\n  default: zoomRectNumericalScale\n};\nconst panFunctions = {\n  category: panCategoryScale,\n  default: panNumericalScale,\n  logarithmic: panNonLinearScale,\n  timeseries: panNonLinearScale\n};\nfunction shouldUpdateScaleLimits(scale, originalScaleLimits, updatedScaleLimits) {\n  const {\n    id,\n    options: {\n      min,\n      max\n    }\n  } = scale;\n  if (!originalScaleLimits[id] || !updatedScaleLimits[id]) {\n    return true;\n  }\n  const previous = updatedScaleLimits[id];\n  return previous.min !== min || previous.max !== max;\n}\nfunction removeMissingScales(limits, scales) {\n  each(limits, (opt, key) => {\n    if (!scales[key]) {\n      delete limits[key];\n    }\n  });\n}\nfunction storeOriginalScaleLimits(chart, state) {\n  const {\n    scales\n  } = chart;\n  const {\n    originalScaleLimits,\n    updatedScaleLimits\n  } = state;\n  each(scales, function (scale) {\n    if (shouldUpdateScaleLimits(scale, originalScaleLimits, updatedScaleLimits)) {\n      originalScaleLimits[scale.id] = {\n        min: {\n          scale: scale.min,\n          options: scale.options.min\n        },\n        max: {\n          scale: scale.max,\n          options: scale.options.max\n        }\n      };\n    }\n  });\n  removeMissingScales(originalScaleLimits, scales);\n  removeMissingScales(updatedScaleLimits, scales);\n  return originalScaleLimits;\n}\nfunction doZoom(scale, amount, center, limits) {\n  const fn = zoomFunctions[scale.type] || zoomFunctions.default;\n  callback(fn, [scale, amount, center, limits]);\n}\nfunction doZoomRect(scale, from, to, limits) {\n  const fn = zoomRectFunctions[scale.type] || zoomRectFunctions.default;\n  callback(fn, [scale, from, to, limits]);\n}\nfunction getCenter(chart) {\n  const ca = chart.chartArea;\n  return {\n    x: (ca.left + ca.right) / 2,\n    y: (ca.top + ca.bottom) / 2\n  };\n}\nfunction zoom(chart, amount, transition = 'none', trigger = 'api') {\n  const {\n    x = 1,\n    y = 1,\n    focalPoint = getCenter(chart)\n  } = typeof amount === 'number' ? {\n    x: amount,\n    y: amount\n  } : amount;\n  const state = getState(chart);\n  const {\n    options: {\n      limits,\n      zoom: zoomOptions\n    }\n  } = state;\n  storeOriginalScaleLimits(chart, state);\n  const xEnabled = x !== 1;\n  const yEnabled = y !== 1;\n  const enabledScales = getEnabledScalesByPoint(zoomOptions, focalPoint, chart);\n  each(enabledScales || chart.scales, function (scale) {\n    if (scale.isHorizontal() && xEnabled) {\n      doZoom(scale, x, focalPoint, limits);\n    } else if (!scale.isHorizontal() && yEnabled) {\n      doZoom(scale, y, focalPoint, limits);\n    }\n  });\n  chart.update(transition);\n  callback(zoomOptions.onZoom, [{\n    chart,\n    trigger\n  }]);\n}\nfunction zoomRect(chart, p0, p1, transition = 'none', trigger = 'api') {\n  const state = getState(chart);\n  const {\n    options: {\n      limits,\n      zoom: zoomOptions\n    }\n  } = state;\n  const {\n    mode = 'xy'\n  } = zoomOptions;\n  storeOriginalScaleLimits(chart, state);\n  const xEnabled = directionEnabled(mode, 'x', chart);\n  const yEnabled = directionEnabled(mode, 'y', chart);\n  each(chart.scales, function (scale) {\n    if (scale.isHorizontal() && xEnabled) {\n      doZoomRect(scale, p0.x, p1.x, limits);\n    } else if (!scale.isHorizontal() && yEnabled) {\n      doZoomRect(scale, p0.y, p1.y, limits);\n    }\n  });\n  chart.update(transition);\n  callback(zoomOptions.onZoom, [{\n    chart,\n    trigger\n  }]);\n}\nfunction zoomScale(chart, scaleId, range, transition = 'none', trigger = 'api') {\n  const state = getState(chart);\n  storeOriginalScaleLimits(chart, state);\n  const scale = chart.scales[scaleId];\n  updateRange(scale, range, undefined, true);\n  chart.update(transition);\n  callback(state.options.zoom?.onZoom, [{\n    chart,\n    trigger\n  }]);\n}\nfunction resetZoom(chart, transition = 'default') {\n  const state = getState(chart);\n  const originalScaleLimits = storeOriginalScaleLimits(chart, state);\n  each(chart.scales, function (scale) {\n    const scaleOptions = scale.options;\n    if (originalScaleLimits[scale.id]) {\n      scaleOptions.min = originalScaleLimits[scale.id].min.options;\n      scaleOptions.max = originalScaleLimits[scale.id].max.options;\n    } else {\n      delete scaleOptions.min;\n      delete scaleOptions.max;\n    }\n    delete state.updatedScaleLimits[scale.id];\n  });\n  chart.update(transition);\n  callback(state.options.zoom.onZoomComplete, [{\n    chart\n  }]);\n}\nfunction getOriginalRange(state, scaleId) {\n  const original = state.originalScaleLimits[scaleId];\n  if (!original) {\n    return;\n  }\n  const {\n    min,\n    max\n  } = original;\n  return valueOrDefault(max.options, max.scale) - valueOrDefault(min.options, min.scale);\n}\nfunction getZoomLevel(chart) {\n  const state = getState(chart);\n  let min = 1;\n  let max = 1;\n  each(chart.scales, function (scale) {\n    const origRange = getOriginalRange(state, scale.id);\n    if (origRange) {\n      const level = Math.round(origRange / (scale.max - scale.min) * 100) / 100;\n      min = Math.min(min, level);\n      max = Math.max(max, level);\n    }\n  });\n  return min < 1 ? min : max;\n}\nfunction panScale(scale, delta, limits, state) {\n  const {\n    panDelta\n  } = state;\n  const storedDelta = panDelta[scale.id] || 0;\n  if (sign(storedDelta) === sign(delta)) {\n    delta += storedDelta;\n  }\n  const fn = panFunctions[scale.type] || panFunctions.default;\n  if (callback(fn, [scale, delta, limits])) {\n    panDelta[scale.id] = 0;\n  } else {\n    panDelta[scale.id] = delta;\n  }\n}\nfunction pan(chart, delta, enabledScales, transition = 'none') {\n  const {\n    x = 0,\n    y = 0\n  } = typeof delta === 'number' ? {\n    x: delta,\n    y: delta\n  } : delta;\n  const state = getState(chart);\n  const {\n    options: {\n      pan: panOptions,\n      limits\n    }\n  } = state;\n  const {\n    onPan\n  } = panOptions || {};\n  storeOriginalScaleLimits(chart, state);\n  const xEnabled = x !== 0;\n  const yEnabled = y !== 0;\n  each(enabledScales || chart.scales, function (scale) {\n    if (scale.isHorizontal() && xEnabled) {\n      panScale(scale, x, limits, state);\n    } else if (!scale.isHorizontal() && yEnabled) {\n      panScale(scale, y, limits, state);\n    }\n  });\n  chart.update(transition);\n  callback(onPan, [{\n    chart\n  }]);\n}\nfunction getInitialScaleBounds(chart) {\n  const state = getState(chart);\n  storeOriginalScaleLimits(chart, state);\n  const scaleBounds = {};\n  for (const scaleId of Object.keys(chart.scales)) {\n    const {\n      min,\n      max\n    } = state.originalScaleLimits[scaleId] || {\n      min: {},\n      max: {}\n    };\n    scaleBounds[scaleId] = {\n      min: min.scale,\n      max: max.scale\n    };\n  }\n  return scaleBounds;\n}\nfunction getZoomedScaleBounds(chart) {\n  const state = getState(chart);\n  const scaleBounds = {};\n  for (const scaleId of Object.keys(chart.scales)) {\n    scaleBounds[scaleId] = state.updatedScaleLimits[scaleId];\n  }\n  return scaleBounds;\n}\nfunction isZoomedOrPanned(chart) {\n  const scaleBounds = getInitialScaleBounds(chart);\n  for (const scaleId of Object.keys(chart.scales)) {\n    const {\n      min: originalMin,\n      max: originalMax\n    } = scaleBounds[scaleId];\n    if (originalMin !== undefined && chart.scales[scaleId].min !== originalMin) {\n      return true;\n    }\n    if (originalMax !== undefined && chart.scales[scaleId].max !== originalMax) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction isZoomingOrPanning(chart) {\n  const state = getState(chart);\n  return state.panning || state.dragging;\n}\nconst clamp = (x, from, to) => Math.min(to, Math.max(from, x));\nfunction removeHandler(chart, type) {\n  const {\n    handlers\n  } = getState(chart);\n  const handler = handlers[type];\n  if (handler && handler.target) {\n    handler.target.removeEventListener(type, handler);\n    delete handlers[type];\n  }\n}\nfunction addHandler(chart, target, type, handler) {\n  const {\n    handlers,\n    options\n  } = getState(chart);\n  const oldHandler = handlers[type];\n  if (oldHandler && oldHandler.target === target) {\n    return;\n  }\n  removeHandler(chart, type);\n  handlers[type] = event => handler(chart, event, options);\n  handlers[type].target = target;\n  const passive = type === 'wheel' ? false : undefined;\n  target.addEventListener(type, handlers[type], {\n    passive\n  });\n}\nfunction mouseMove(chart, event) {\n  const state = getState(chart);\n  if (state.dragStart) {\n    state.dragging = true;\n    state.dragEnd = event;\n    chart.update('none');\n  }\n}\nfunction keyDown(chart, event) {\n  const state = getState(chart);\n  if (!state.dragStart || event.key !== 'Escape') {\n    return;\n  }\n  removeHandler(chart, 'keydown');\n  state.dragging = false;\n  state.dragStart = state.dragEnd = null;\n  chart.update('none');\n}\nfunction getPointPosition(event, chart) {\n  if (event.target !== chart.canvas) {\n    const canvasArea = chart.canvas.getBoundingClientRect();\n    return {\n      x: event.clientX - canvasArea.left,\n      y: event.clientY - canvasArea.top\n    };\n  }\n  return getRelativePosition(event, chart);\n}\nfunction zoomStart(chart, event, zoomOptions) {\n  const {\n    onZoomStart,\n    onZoomRejected\n  } = zoomOptions;\n  if (onZoomStart) {\n    const point = getPointPosition(event, chart);\n    if (callback(onZoomStart, [{\n      chart,\n      event,\n      point\n    }]) === false) {\n      callback(onZoomRejected, [{\n        chart,\n        event\n      }]);\n      return false;\n    }\n  }\n}\nfunction mouseDown(chart, event) {\n  if (chart.legend) {\n    const point = getRelativePosition(event, chart);\n    if (_isPointInArea(point, chart.legend)) {\n      return;\n    }\n  }\n  const state = getState(chart);\n  const {\n    pan: panOptions,\n    zoom: zoomOptions = {}\n  } = state.options;\n  if (event.button !== 0 || keyPressed(getModifierKey(panOptions), event) || keyNotPressed(getModifierKey(zoomOptions.drag), event)) {\n    return callback(zoomOptions.onZoomRejected, [{\n      chart,\n      event\n    }]);\n  }\n  if (zoomStart(chart, event, zoomOptions) === false) {\n    return;\n  }\n  state.dragStart = event;\n  addHandler(chart, chart.canvas.ownerDocument, 'mousemove', mouseMove);\n  addHandler(chart, window.document, 'keydown', keyDown);\n}\nfunction applyAspectRatio({\n  begin,\n  end\n}, aspectRatio) {\n  let width = end.x - begin.x;\n  let height = end.y - begin.y;\n  const ratio = Math.abs(width / height);\n  if (ratio > aspectRatio) {\n    width = Math.sign(width) * Math.abs(height * aspectRatio);\n  } else if (ratio < aspectRatio) {\n    height = Math.sign(height) * Math.abs(width / aspectRatio);\n  }\n  end.x = begin.x + width;\n  end.y = begin.y + height;\n}\nfunction applyMinMaxProps(rect, chartArea, points, {\n  min,\n  max,\n  prop\n}) {\n  rect[min] = clamp(Math.min(points.begin[prop], points.end[prop]), chartArea[min], chartArea[max]);\n  rect[max] = clamp(Math.max(points.begin[prop], points.end[prop]), chartArea[min], chartArea[max]);\n}\nfunction getRelativePoints(chart, pointEvents, maintainAspectRatio) {\n  const points = {\n    begin: getPointPosition(pointEvents.dragStart, chart),\n    end: getPointPosition(pointEvents.dragEnd, chart)\n  };\n  if (maintainAspectRatio) {\n    const aspectRatio = chart.chartArea.width / chart.chartArea.height;\n    applyAspectRatio(points, aspectRatio);\n  }\n  return points;\n}\nfunction computeDragRect(chart, mode, pointEvents, maintainAspectRatio) {\n  const xEnabled = directionEnabled(mode, 'x', chart);\n  const yEnabled = directionEnabled(mode, 'y', chart);\n  const {\n    top,\n    left,\n    right,\n    bottom,\n    width: chartWidth,\n    height: chartHeight\n  } = chart.chartArea;\n  const rect = {\n    top,\n    left,\n    right,\n    bottom\n  };\n  const points = getRelativePoints(chart, pointEvents, maintainAspectRatio && xEnabled && yEnabled);\n  if (xEnabled) {\n    applyMinMaxProps(rect, chart.chartArea, points, {\n      min: 'left',\n      max: 'right',\n      prop: 'x'\n    });\n  }\n  if (yEnabled) {\n    applyMinMaxProps(rect, chart.chartArea, points, {\n      min: 'top',\n      max: 'bottom',\n      prop: 'y'\n    });\n  }\n  const width = rect.right - rect.left;\n  const height = rect.bottom - rect.top;\n  return {\n    ...rect,\n    width,\n    height,\n    zoomX: xEnabled && width ? 1 + (chartWidth - width) / chartWidth : 1,\n    zoomY: yEnabled && height ? 1 + (chartHeight - height) / chartHeight : 1\n  };\n}\nfunction mouseUp(chart, event) {\n  const state = getState(chart);\n  if (!state.dragStart) {\n    return;\n  }\n  removeHandler(chart, 'mousemove');\n  const {\n    mode,\n    onZoomComplete,\n    drag: {\n      threshold = 0,\n      maintainAspectRatio\n    }\n  } = state.options.zoom;\n  const rect = computeDragRect(chart, mode, {\n    dragStart: state.dragStart,\n    dragEnd: event\n  }, maintainAspectRatio);\n  const distanceX = directionEnabled(mode, 'x', chart) ? rect.width : 0;\n  const distanceY = directionEnabled(mode, 'y', chart) ? rect.height : 0;\n  const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);\n  state.dragStart = state.dragEnd = null;\n  if (distance <= threshold) {\n    state.dragging = false;\n    chart.update('none');\n    return;\n  }\n  zoomRect(chart, {\n    x: rect.left,\n    y: rect.top\n  }, {\n    x: rect.right,\n    y: rect.bottom\n  }, 'zoom', 'drag');\n  state.dragging = false;\n  state.filterNextClick = true;\n  callback(onZoomComplete, [{\n    chart\n  }]);\n}\nfunction wheelPreconditions(chart, event, zoomOptions) {\n  if (keyNotPressed(getModifierKey(zoomOptions.wheel), event)) {\n    callback(zoomOptions.onZoomRejected, [{\n      chart,\n      event\n    }]);\n    return;\n  }\n  if (zoomStart(chart, event, zoomOptions) === false) {\n    return;\n  }\n  if (event.cancelable) {\n    event.preventDefault();\n  }\n  if (event.deltaY === undefined) {\n    return;\n  }\n  return true;\n}\nfunction wheel(chart, event) {\n  const {\n    handlers: {\n      onZoomComplete\n    },\n    options: {\n      zoom: zoomOptions\n    }\n  } = getState(chart);\n  if (!wheelPreconditions(chart, event, zoomOptions)) {\n    return;\n  }\n  const rect = event.target.getBoundingClientRect();\n  const speed = zoomOptions.wheel.speed;\n  const percentage = event.deltaY >= 0 ? 2 - 1 / (1 - speed) : 1 + speed;\n  const amount = {\n    x: percentage,\n    y: percentage,\n    focalPoint: {\n      x: event.clientX - rect.left,\n      y: event.clientY - rect.top\n    }\n  };\n  zoom(chart, amount, 'zoom', 'wheel');\n  callback(onZoomComplete, [{\n    chart\n  }]);\n}\nfunction addDebouncedHandler(chart, name, handler, delay) {\n  if (handler) {\n    getState(chart).handlers[name] = debounce(() => callback(handler, [{\n      chart\n    }]), delay);\n  }\n}\nfunction addListeners(chart, options) {\n  const canvas = chart.canvas;\n  const {\n    wheel: wheelOptions,\n    drag: dragOptions,\n    onZoomComplete\n  } = options.zoom;\n  if (wheelOptions.enabled) {\n    addHandler(chart, canvas, 'wheel', wheel);\n    addDebouncedHandler(chart, 'onZoomComplete', onZoomComplete, 250);\n  } else {\n    removeHandler(chart, 'wheel');\n  }\n  if (dragOptions.enabled) {\n    addHandler(chart, canvas, 'mousedown', mouseDown);\n    addHandler(chart, canvas.ownerDocument, 'mouseup', mouseUp);\n  } else {\n    removeHandler(chart, 'mousedown');\n    removeHandler(chart, 'mousemove');\n    removeHandler(chart, 'mouseup');\n    removeHandler(chart, 'keydown');\n  }\n}\nfunction removeListeners(chart) {\n  removeHandler(chart, 'mousedown');\n  removeHandler(chart, 'mousemove');\n  removeHandler(chart, 'mouseup');\n  removeHandler(chart, 'wheel');\n  removeHandler(chart, 'click');\n  removeHandler(chart, 'keydown');\n}\nfunction createEnabler(chart, state) {\n  return function (recognizer, event) {\n    const {\n      pan: panOptions,\n      zoom: zoomOptions = {}\n    } = state.options;\n    if (!panOptions || !panOptions.enabled) {\n      return false;\n    }\n    const srcEvent = event && event.srcEvent;\n    if (!srcEvent) {\n      return true;\n    }\n    if (!state.panning && event.pointerType === 'mouse' && (keyNotPressed(getModifierKey(panOptions), srcEvent) || keyPressed(getModifierKey(zoomOptions.drag), srcEvent))) {\n      callback(panOptions.onPanRejected, [{\n        chart,\n        event\n      }]);\n      return false;\n    }\n    return true;\n  };\n}\nfunction pinchAxes(p0, p1) {\n  const pinchX = Math.abs(p0.clientX - p1.clientX);\n  const pinchY = Math.abs(p0.clientY - p1.clientY);\n  const p = pinchX / pinchY;\n  let x, y;\n  if (p > 0.3 && p < 1.7) {\n    x = y = true;\n  } else if (pinchX > pinchY) {\n    x = true;\n  } else {\n    y = true;\n  }\n  return {\n    x,\n    y\n  };\n}\nfunction handlePinch(chart, state, e) {\n  if (state.scale) {\n    const {\n      center,\n      pointers\n    } = e;\n    const zoomPercent = 1 / state.scale * e.scale;\n    const rect = e.target.getBoundingClientRect();\n    const pinch = pinchAxes(pointers[0], pointers[1]);\n    const mode = state.options.zoom.mode;\n    const amount = {\n      x: pinch.x && directionEnabled(mode, 'x', chart) ? zoomPercent : 1,\n      y: pinch.y && directionEnabled(mode, 'y', chart) ? zoomPercent : 1,\n      focalPoint: {\n        x: center.x - rect.left,\n        y: center.y - rect.top\n      }\n    };\n    zoom(chart, amount, 'zoom', 'pinch');\n    state.scale = e.scale;\n  }\n}\nfunction startPinch(chart, state, event) {\n  if (state.options.zoom.pinch.enabled) {\n    const point = getRelativePosition(event, chart);\n    if (callback(state.options.zoom.onZoomStart, [{\n      chart,\n      event,\n      point\n    }]) === false) {\n      state.scale = null;\n      callback(state.options.zoom.onZoomRejected, [{\n        chart,\n        event\n      }]);\n    } else {\n      state.scale = 1;\n    }\n  }\n}\nfunction endPinch(chart, state, e) {\n  if (state.scale) {\n    handlePinch(chart, state, e);\n    state.scale = null;\n    callback(state.options.zoom.onZoomComplete, [{\n      chart\n    }]);\n  }\n}\nfunction handlePan(chart, state, e) {\n  const delta = state.delta;\n  if (delta) {\n    state.panning = true;\n    pan(chart, {\n      x: e.deltaX - delta.x,\n      y: e.deltaY - delta.y\n    }, state.panScales);\n    state.delta = {\n      x: e.deltaX,\n      y: e.deltaY\n    };\n  }\n}\nfunction startPan(chart, state, event) {\n  const {\n    enabled,\n    onPanStart,\n    onPanRejected\n  } = state.options.pan;\n  if (!enabled) {\n    return;\n  }\n  const rect = event.target.getBoundingClientRect();\n  const point = {\n    x: event.center.x - rect.left,\n    y: event.center.y - rect.top\n  };\n  if (callback(onPanStart, [{\n    chart,\n    event,\n    point\n  }]) === false) {\n    return callback(onPanRejected, [{\n      chart,\n      event\n    }]);\n  }\n  state.panScales = getEnabledScalesByPoint(state.options.pan, point, chart);\n  state.delta = {\n    x: 0,\n    y: 0\n  };\n  handlePan(chart, state, event);\n}\nfunction endPan(chart, state) {\n  state.delta = null;\n  if (state.panning) {\n    state.panning = false;\n    state.filterNextClick = true;\n    callback(state.options.pan.onPanComplete, [{\n      chart\n    }]);\n  }\n}\nconst hammers = new WeakMap();\nfunction startHammer(chart, options) {\n  const state = getState(chart);\n  const canvas = chart.canvas;\n  const {\n    pan: panOptions,\n    zoom: zoomOptions\n  } = options;\n  const mc = new Hammer.Manager(canvas);\n  if (zoomOptions && zoomOptions.pinch.enabled) {\n    mc.add(new Hammer.Pinch());\n    mc.on('pinchstart', e => startPinch(chart, state, e));\n    mc.on('pinch', e => handlePinch(chart, state, e));\n    mc.on('pinchend', e => endPinch(chart, state, e));\n  }\n  if (panOptions && panOptions.enabled) {\n    mc.add(new Hammer.Pan({\n      threshold: panOptions.threshold,\n      enable: createEnabler(chart, state)\n    }));\n    mc.on('panstart', e => startPan(chart, state, e));\n    mc.on('panmove', e => handlePan(chart, state, e));\n    mc.on('panend', () => endPan(chart, state));\n  }\n  hammers.set(chart, mc);\n}\nfunction stopHammer(chart) {\n  const mc = hammers.get(chart);\n  if (mc) {\n    mc.remove('pinchstart');\n    mc.remove('pinch');\n    mc.remove('pinchend');\n    mc.remove('panstart');\n    mc.remove('pan');\n    mc.remove('panend');\n    mc.destroy();\n    hammers.delete(chart);\n  }\n}\nfunction hammerOptionsChanged(oldOptions, newOptions) {\n  const {\n    pan: oldPan,\n    zoom: oldZoom\n  } = oldOptions;\n  const {\n    pan: newPan,\n    zoom: newZoom\n  } = newOptions;\n  if (oldZoom?.zoom?.pinch?.enabled !== newZoom?.zoom?.pinch?.enabled) {\n    return true;\n  }\n  if (oldPan?.enabled !== newPan?.enabled) {\n    return true;\n  }\n  if (oldPan?.threshold !== newPan?.threshold) {\n    return true;\n  }\n  return false;\n}\nvar version = \"2.2.0\";\nfunction draw(chart, caller, options) {\n  const dragOptions = options.zoom.drag;\n  const {\n    dragStart,\n    dragEnd\n  } = getState(chart);\n  if (dragOptions.drawTime !== caller || !dragEnd) {\n    return;\n  }\n  const {\n    left,\n    top,\n    width,\n    height\n  } = computeDragRect(chart, options.zoom.mode, {\n    dragStart,\n    dragEnd\n  }, dragOptions.maintainAspectRatio);\n  const ctx = chart.ctx;\n  ctx.save();\n  ctx.beginPath();\n  ctx.fillStyle = dragOptions.backgroundColor || 'rgba(225,225,225,0.3)';\n  ctx.fillRect(left, top, width, height);\n  if (dragOptions.borderWidth > 0) {\n    ctx.lineWidth = dragOptions.borderWidth;\n    ctx.strokeStyle = dragOptions.borderColor || 'rgba(225,225,225)';\n    ctx.strokeRect(left, top, width, height);\n  }\n  ctx.restore();\n}\nvar plugin = {\n  id: 'zoom',\n  version,\n  defaults: {\n    pan: {\n      enabled: false,\n      mode: 'xy',\n      threshold: 10,\n      modifierKey: null\n    },\n    zoom: {\n      wheel: {\n        enabled: false,\n        speed: 0.1,\n        modifierKey: null\n      },\n      drag: {\n        enabled: false,\n        drawTime: 'beforeDatasetsDraw',\n        modifierKey: null\n      },\n      pinch: {\n        enabled: false\n      },\n      mode: 'xy'\n    }\n  },\n  start: function (chart, _args, options) {\n    const state = getState(chart);\n    state.options = options;\n    if (Object.prototype.hasOwnProperty.call(options.zoom, 'enabled')) {\n      console.warn('The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`.');\n    }\n    if (Object.prototype.hasOwnProperty.call(options.zoom, 'overScaleMode') || Object.prototype.hasOwnProperty.call(options.pan, 'overScaleMode')) {\n      console.warn('The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired).');\n    }\n    if (Hammer) {\n      startHammer(chart, options);\n    }\n    chart.pan = (delta, panScales, transition) => pan(chart, delta, panScales, transition);\n    chart.zoom = (args, transition) => zoom(chart, args, transition);\n    chart.zoomRect = (p0, p1, transition) => zoomRect(chart, p0, p1, transition);\n    chart.zoomScale = (id, range, transition) => zoomScale(chart, id, range, transition);\n    chart.resetZoom = transition => resetZoom(chart, transition);\n    chart.getZoomLevel = () => getZoomLevel(chart);\n    chart.getInitialScaleBounds = () => getInitialScaleBounds(chart);\n    chart.getZoomedScaleBounds = () => getZoomedScaleBounds(chart);\n    chart.isZoomedOrPanned = () => isZoomedOrPanned(chart);\n    chart.isZoomingOrPanning = () => isZoomingOrPanning(chart);\n  },\n  beforeEvent(chart, {\n    event\n  }) {\n    if (isZoomingOrPanning(chart)) {\n      return false;\n    }\n    if (event.type === 'click' || event.type === 'mouseup') {\n      const state = getState(chart);\n      if (state.filterNextClick) {\n        state.filterNextClick = false;\n        return false;\n      }\n    }\n  },\n  beforeUpdate: function (chart, args, options) {\n    const state = getState(chart);\n    const previousOptions = state.options;\n    state.options = options;\n    if (hammerOptionsChanged(previousOptions, options)) {\n      stopHammer(chart);\n      startHammer(chart, options);\n    }\n    addListeners(chart, options);\n  },\n  beforeDatasetsDraw(chart, _args, options) {\n    draw(chart, 'beforeDatasetsDraw', options);\n  },\n  afterDatasetsDraw(chart, _args, options) {\n    draw(chart, 'afterDatasetsDraw', options);\n  },\n  beforeDraw(chart, _args, options) {\n    draw(chart, 'beforeDraw', options);\n  },\n  afterDraw(chart, _args, options) {\n    draw(chart, 'afterDraw', options);\n  },\n  stop: function (chart) {\n    removeListeners(chart);\n    if (Hammer) {\n      stopHammer(chart);\n    }\n    removeState(chart);\n  },\n  panFunctions,\n  zoomFunctions,\n  zoomRectFunctions\n};\nexport { plugin as default, pan, resetZoom, zoom, zoomRect, zoomScale };","import { catchError } from 'rxjs'\nimport { environment } from 'src/environments/environment'\nimport { HttpClient, HttpParams } from '@angular/common/http'\nimport { Injectable, inject } from '@angular/core'\nimport { RestExtractor } from '@app/core'\nimport {\n  VideoStatsOverall,\n  VideoStatsRetention,\n  VideoStatsTimeserie,\n  VideoStatsTimeserieMetric,\n  VideoStatsUserAgent\n} from '@peertube/peertube-models'\nimport { VideoService } from '@app/shared/shared-main/video/video.service'\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class VideoStatsService {\n  private authHttp = inject(HttpClient)\n  private restExtractor = inject(RestExtractor)\n\n  static BASE_VIDEO_STATS_URL = environment.apiUrl + '/api/v1/videos/'\n\n  getOverallStats (options: {\n    videoId: string\n    startDate?: Date\n    endDate?: Date\n  }) {\n    const { videoId, startDate, endDate } = options\n\n    let params = new HttpParams()\n    if (startDate) params = params.append('startDate', startDate.toISOString())\n    if (endDate) params = params.append('endDate', endDate.toISOString())\n\n    return this.authHttp.get<VideoStatsOverall>(VideoService.BASE_VIDEO_URL + '/' + videoId + '/stats/overall', { params })\n      .pipe(catchError(err => this.restExtractor.handleError(err)))\n  }\n\n  getTimeserieStats (options: {\n    videoId: string\n    metric: VideoStatsTimeserieMetric\n    startDate?: Date\n    endDate?: Date\n  }) {\n    const { videoId, metric, startDate, endDate } = options\n\n    let params = new HttpParams()\n    if (startDate) params = params.append('startDate', startDate.toISOString())\n    if (endDate) params = params.append('endDate', endDate.toISOString())\n\n    return this.authHttp.get<VideoStatsTimeserie>(VideoService.BASE_VIDEO_URL + '/' + videoId + '/stats/timeseries/' + metric, { params })\n      .pipe(catchError(err => this.restExtractor.handleError(err)))\n  }\n\n  getRetentionStats (videoId: string) {\n    return this.authHttp.get<VideoStatsRetention>(VideoService.BASE_VIDEO_URL + '/' + videoId + '/stats/retention')\n      .pipe(catchError(err => this.restExtractor.handleError(err)))\n  }\n\n  getUserAgentStats (options: {\n    videoId: string\n    startDate?: Date\n    endDate?: Date\n  }) {\n    const { videoId, startDate, endDate } = options\n\n    let params = new HttpParams()\n    if (startDate) params = params.append('startDate', startDate.toISOString())\n    if (endDate) params = params.append('endDate', endDate.toISOString())\n\n    return this.authHttp.get<VideoStatsUserAgent>(VideoService.BASE_VIDEO_URL + '/' + videoId + '/stats/user-agent', { params })\n      .pipe(catchError(err => this.restExtractor.handleError(err)))\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"stats\"></my-global-icon>\n\n  <ng-container i18n>Statistics</ng-container>\n</h2>\n\n<div class=\"stats-embed\">\n  <div class=\"global-stats\">\n    <div *ngFor=\"let card of globalStatsCards\" class=\"card stats-card\">\n      <div class=\"label\">\n        {{ card.label }}\n\n        <my-help *ngIf=\"card.help\">\n          {{ card.help }}\n        </my-help>\n      </div>\n      <div class=\"value\">{{ card.value }}</div>\n      <div *ngIf=\"card.moreInfo\" class=\"more-info\">{{ card.moreInfo }}</div>\n    </div>\n  </div>\n\n  <my-embed [video]=\"videoEdit.getVideoAttributes()\"></my-embed>\n</div>\n\n<div class=\"stats-with-date\">\n\n  <div class=\"overall-stats\">\n    <h2>{{ getViewersStatsTitle() }}</h2>\n\n    <div class=\"date-filter-wrapper\">\n      <label class=\"visually-hidden\" for=\"date-filter\">Filter viewers stats by date</label>\n      <my-select-options inputId=\"date-filter\" [(ngModel)]=\"currentDateFilter\" (ngModelChange)=\"onDateFilterChange()\" [items]=\"dateFilters\"></my-select-options>\n    </div>\n\n    <div class=\"cards\">\n      <div *ngFor=\"let card of overallStatCards\" class=\"card stats-card\">\n        <div class=\"label\">{{ card.label }}</div>\n        <div class=\"value\">{{ card.value }}</div>\n        <div *ngIf=\"card.moreInfo\" class=\"more-info\">{{ card.moreInfo }}</div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"timeseries\">\n    <div ngbNav #nav=\"ngbNav\" [activeId]=\"activeGraphId\" (activeIdChange)=\"onChartChange($event)\" class=\"nav-tabs\">\n\n      <ng-container *ngFor=\"let availableChart of availableCharts\" [ngbNavItem]=\"availableChart.id\">\n        <a ngbNavLink>\n          <span>{{ availableChart.label }}</span>\n        </a>\n\n        <ng-template ngbNavContent>\n          <div class=\"chart-container\">\n            <p-chart\n              *ngIf=\"chartOptions[availableChart.id]\"\n              [height]=\"chartHeight\" [width]=\"chartWidth\"\n              [type]=\"chartOptions[availableChart.id].type\" [options]=\"chartOptions[availableChart.id].options\" [data]=\"chartOptions[availableChart.id].data\"\n              [plugins]=\"chartPlugins\"\n            ></p-chart>\n          </div>\n\n          <div class=\"zoom-container\">\n            <span *ngIf=\"!hasZoom() && availableChart.zoomEnabled\" i18n class=\"description\">You can select a part of the graph to zoom in</span>\n\n            <my-button i18n *ngIf=\"hasZoom()\" (click)=\"resetZoom()\">Reset zoom</my-button>\n          </div>\n        </ng-template>\n      </ng-container>\n    </div>\n\n    <div [ngbNavOutlet]=\"nav\"></div>\n  </div>\n</div>\n","import { NgFor, NgIf } from '@angular/common'\nimport { Component, LOCALE_ID, OnInit, inject } from '@angular/core'\nimport { FormsModule } from '@angular/forms'\nimport { ActivatedRoute } from '@angular/router'\nimport { Notifier, PeerTubeRouterService } from '@app/core'\nimport { GlobalIconComponent } from '@app/shared/shared-icons/global-icon.component'\nimport { NumberFormatterPipe } from '@app/shared/shared-main/common/number-formatter.pipe'\nimport { LiveVideoService } from '@app/shared/shared-video-live/live-video.service'\nimport { NgbNav, NgbNavContent, NgbNavItem, NgbNavLink, NgbNavLinkBase, NgbNavOutlet } from '@ng-bootstrap/ng-bootstrap'\nimport { secondsToTime } from '@peertube/peertube-core-utils'\nimport {\n  HttpStatusCode,\n  LiveVideoSession,\n  VideoStatsOverall,\n  VideoStatsRetention,\n  VideoStatsTimeserie,\n  VideoStatsTimeserieMetric,\n  VideoStatsUserAgent\n} from '@peertube/peertube-models'\nimport { ChartConfiguration, ChartData, defaults as ChartJSDefaults, ChartOptions, PluginOptionsByType, Scale, TooltipItem } from 'chart.js'\nimport zoomPlugin from 'chartjs-plugin-zoom'\nimport { ChartModule } from 'primeng/chart'\nimport { Observable, of } from 'rxjs'\nimport { SelectOptionsItem } from 'src/types'\nimport { SelectOptionsComponent } from '../../../shared/shared-forms/select/select-options.component'\nimport { ButtonComponent } from '../../../shared/shared-main/buttons/button.component'\nimport { HelpComponent } from '../../../shared/shared-main/buttons/help.component'\nimport { EmbedComponent } from '../../../shared/shared-main/video/embed.component'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoManageController } from '../video-manage-controller.service'\nimport { VideoStatsService } from './video-stats.service'\n\nconst BAR_GRAPHS = [ 'countries', 'regions', 'clients', 'devices', 'operatingSystems' ] as const\ntype BarGraphs = typeof BAR_GRAPHS[number]\ntype ActiveGraphId = VideoStatsTimeserieMetric | 'retention' | BarGraphs\n\ntype GeoData = { name: string, viewers: number }[]\n\ntype ChartIngestData = VideoStatsTimeserie | VideoStatsRetention | GeoData | VideoStatsUserAgent\ntype ChartBuilderResult = {\n  type: 'line' | 'bar'\n\n  options?: ChartOptions<'bar'>\n\n  plugins: Partial<PluginOptionsByType<'line' | 'bar'>>\n  data: ChartData<'line' | 'bar'>\n  displayLegend: boolean\n}\n\ntype Card = { label: string, value: string | number, moreInfo?: string, help?: string }\n\nconst isBarGraph = (graphId: ActiveGraphId): graphId is BarGraphs => BAR_GRAPHS.some(graph => graph === graphId)\n\nChartJSDefaults.backgroundColor = getComputedStyle(document.body).getPropertyValue('--bg')\nChartJSDefaults.borderColor = getComputedStyle(document.body).getPropertyValue('--bg-secondary-500')\nChartJSDefaults.color = getComputedStyle(document.body).getPropertyValue('--fg')\n\n@Component({\n  templateUrl: './video-stats.component.html',\n  styleUrls: [\n    '../common/video-manage-page-common.scss',\n    './video-stats.component.scss'\n  ],\n  providers: [ NumberFormatterPipe ],\n  imports: [\n    NgFor,\n    NgIf,\n    HelpComponent,\n    EmbedComponent,\n    SelectOptionsComponent,\n    FormsModule,\n    NgbNav,\n    NgbNavItem,\n    NgbNavLink,\n    NgbNavLinkBase,\n    NgbNavContent,\n    ChartModule,\n    ButtonComponent,\n    NgbNavOutlet,\n    GlobalIconComponent\n  ]\n})\nexport class VideoStatsComponent implements OnInit {\n  private localeId = inject(LOCALE_ID)\n  private route = inject(ActivatedRoute)\n  private notifier = inject(Notifier)\n  private statsService = inject(VideoStatsService)\n  private peertubeRouter = inject(PeerTubeRouterService)\n  private numberFormatter = inject(NumberFormatterPipe)\n  private liveService = inject(LiveVideoService)\n  private manageController = inject(VideoManageController)\n\n  // Cannot handle date filters\n  globalStatsCards: Card[] = []\n  // Can handle date filters\n  overallStatCards: Card[] = []\n\n  chartOptions: { [id in ActiveGraphId]?: ChartConfiguration<'line' | 'bar'> } = {}\n  chartHeight = '300px'\n  chartWidth: string = null\n\n  availableCharts: { id: ActiveGraphId, label: string, zoomEnabled: boolean }[] = []\n  activeGraphId: ActiveGraphId = 'viewers'\n\n  videoEdit: VideoEdit\n\n  countries: GeoData = []\n  regions: GeoData = []\n\n  chartPlugins = [ zoomPlugin ]\n\n  currentDateFilter = 'all'\n  dateFilters: SelectOptionsItem[] = [\n    {\n      id: 'all',\n      label: $localize`Since the video publication`\n    }\n  ]\n\n  private statsStartDate: Date\n  private statsEndDate: Date\n\n  private chartIngestData: { [id in ActiveGraphId]?: ChartIngestData } = {}\n\n  ngOnInit () {\n    this.videoEdit = this.manageController.getStore().videoEdit\n\n    this.availableCharts = [\n      {\n        id: 'viewers',\n        label: $localize`Viewers`,\n        zoomEnabled: true\n      },\n      {\n        id: 'aggregateWatchTime',\n        label: $localize`Watch time`,\n        zoomEnabled: true\n      },\n      {\n        id: 'countries',\n        label: $localize`Countries`,\n        zoomEnabled: false\n      },\n      {\n        id: 'regions',\n        label: $localize`Regions`,\n        zoomEnabled: false\n      },\n      {\n        id: 'clients',\n        label: $localize`Clients`,\n        zoomEnabled: false\n      },\n      {\n        id: 'devices',\n        label: $localize`Devices`,\n        zoomEnabled: false\n      },\n      {\n        id: 'operatingSystems',\n        label: $localize`Operating systems`,\n        zoomEnabled: false\n      }\n    ]\n\n    if (!this.videoEdit.getVideoAttributes().isLive) {\n      this.availableCharts.push({\n        id: 'retention',\n        label: $localize`Retention`,\n        zoomEnabled: false\n      })\n    }\n\n    const snapshotQuery = this.route.snapshot.queryParams\n    if (snapshotQuery.startDate || snapshotQuery.endDate) {\n      this.addAndSelectCustomDateFilter()\n    }\n\n    this.route.queryParams.subscribe(params => {\n      this.statsStartDate = params.startDate\n        ? new Date(params.startDate)\n        : undefined\n\n      this.statsEndDate = params.endDate\n        ? new Date(params.endDate)\n        : undefined\n\n      this.loadChart()\n      this.loadOverallStats()\n    })\n\n    this.loadDateFilters()\n  }\n\n  hasCountries () {\n    return this.countries.length !== 0\n  }\n\n  hasRegions () {\n    return this.regions.length !== 0\n  }\n\n  onChartChange (newActive: ActiveGraphId) {\n    this.activeGraphId = newActive\n\n    if (newActive === 'countries') {\n      this.chartHeight = `${Math.max(this.countries.length * 20, 300)}px`\n    } else if (newActive === 'regions') {\n      this.chartHeight = `${Math.max(this.regions.length * 20, 300)}px`\n    } else {\n      this.chartHeight = '300px'\n    }\n\n    this.loadChart()\n  }\n\n  resetZoom () {\n    this.peertubeRouter.silentNavigate([], {})\n    this.removeAndResetCustomDateFilter()\n  }\n\n  hasZoom () {\n    return !!this.statsStartDate && this.isTimeserieGraph(this.activeGraphId)\n  }\n\n  getViewersStatsTitle () {\n    if (this.statsStartDate && this.statsEndDate) {\n      return $localize`Viewers stats between ${this.toMediumDate(this.statsStartDate)} and ${this.toMediumDate(this.statsEndDate)}`\n    }\n\n    return $localize`Viewers stats`\n  }\n\n  onDateFilterChange () {\n    if (this.currentDateFilter === 'all') {\n      return this.resetZoom()\n    }\n\n    const idParts = this.currentDateFilter.split('|')\n    if (idParts.length === 2) {\n      return this.peertubeRouter.silentNavigate([], { startDate: idParts[0], endDate: idParts[1] })\n    }\n  }\n\n  private isTimeserieGraph (graphId: ActiveGraphId) {\n    return graphId === 'aggregateWatchTime' || graphId === 'viewers'\n  }\n\n  private loadOverallStats () {\n    const uuid = this.videoEdit.getVideoAttributes().uuid\n\n    this.statsService.getOverallStats({ videoId: uuid, startDate: this.statsStartDate, endDate: this.statsEndDate })\n      .subscribe({\n        next: res => {\n          this.countries = res.countries.map(c => ({\n            name: this.countryCodeToName(c.isoCode),\n            viewers: c.viewers\n          }))\n\n          this.regions = res.subdivisions\n\n          this.buildOverallStatCard(res)\n        },\n\n        error: err => this.notifier.error(err.message)\n      })\n  }\n\n  private loadDateFilters () {\n    if (this.videoEdit.getVideoAttributes().isLive) return this.loadLiveDateFilters()\n\n    return this.loadVODDateFilters()\n  }\n\n  private loadLiveDateFilters () {\n    this.liveService.listSessions(this.videoEdit.getVideoAttributes().id)\n      .subscribe({\n        next: ({ data }) => {\n          const newFilters = data.map(session => this.buildLiveFilter(session))\n\n          this.dateFilters = this.dateFilters.concat(newFilters)\n        },\n\n        error: err => this.notifier.error(err.message)\n      })\n  }\n\n  private loadVODDateFilters () {\n    this.liveService.findLiveSessionFromVOD(this.videoEdit.getVideoAttributes().id)\n      .subscribe({\n        next: session => {\n          this.dateFilters = this.dateFilters.concat([ this.buildLiveFilter(session) ])\n        },\n\n        error: err => {\n          if (err.status === HttpStatusCode.NOT_FOUND_404) return\n\n          this.notifier.error(err.message)\n        }\n      })\n  }\n\n  private buildLiveFilter (session: LiveVideoSession) {\n    return {\n      id: session.startDate + '|' + session.endDate,\n      label: $localize`Live as of ${this.toMediumDate(new Date(session.startDate))}`\n    }\n  }\n\n  private addAndSelectCustomDateFilter () {\n    const exists = this.dateFilters.some(d => d.id === 'custom')\n\n    if (!exists) {\n      this.dateFilters = this.dateFilters.concat([\n        {\n          id: 'custom',\n          label: $localize`Custom dates`\n        }\n      ])\n    }\n\n    this.currentDateFilter = 'custom'\n  }\n\n  private removeAndResetCustomDateFilter () {\n    this.dateFilters = this.dateFilters.filter(d => d.id !== 'custom')\n\n    this.currentDateFilter = 'all'\n  }\n\n  private buildOverallStatCard (overallStats: VideoStatsOverall) {\n    this.globalStatsCards = [\n      {\n        label: $localize`Views`,\n        value: this.numberFormatter.transform(this.videoEdit.getVideoAttributes().views),\n        help: $localize`A view means that someone watched the video for several seconds (10 seconds by default)`\n      },\n      {\n        label: $localize`Likes`,\n        value: this.numberFormatter.transform(this.videoEdit.getVideoAttributes().likes)\n      }\n    ]\n\n    this.overallStatCards = [\n      {\n        label: $localize`Average watch time`,\n        value: secondsToTime({ seconds: overallStats.averageWatchTime, format: 'locale-string' })\n      },\n      {\n        label: $localize`Total watch time`,\n        value: secondsToTime({ seconds: overallStats.totalWatchTime, format: 'locale-string' })\n      },\n      {\n        label: $localize`Peak viewers`,\n        value: this.numberFormatter.transform(overallStats.viewersPeak),\n        moreInfo: overallStats.viewersPeak !== 0\n          ? $localize`at ${this.toMediumDate(new Date(overallStats.viewersPeakDate))}`\n          : undefined\n      },\n      {\n        label: $localize`Unique viewers`,\n        value: this.numberFormatter.transform(overallStats.totalViewers)\n      }\n    ]\n\n    if (overallStats.countries.length !== 0) {\n      this.overallStatCards.push({\n        label: $localize`Countries`,\n        value: this.numberFormatter.transform(overallStats.countries.length)\n      })\n    }\n\n    if (overallStats.subdivisions.length !== 0) {\n      this.overallStatCards.push({\n        label: $localize`Regions`,\n        value: this.numberFormatter.transform(overallStats.subdivisions.length)\n      })\n    }\n  }\n\n  private loadChart () {\n    const videoId = this.videoEdit.getVideoAttributes().uuid\n\n    const obsBuilders: { [id in ActiveGraphId]: Observable<ChartIngestData> } = {\n      retention: this.statsService.getRetentionStats(videoId),\n\n      clients: this.statsService.getUserAgentStats({ videoId }),\n      devices: this.statsService.getUserAgentStats({ videoId }),\n      operatingSystems: this.statsService.getUserAgentStats({ videoId }),\n\n      aggregateWatchTime: this.statsService.getTimeserieStats({\n        videoId,\n        startDate: this.statsStartDate,\n        endDate: this.statsEndDate,\n        metric: 'aggregateWatchTime'\n      }),\n      viewers: this.statsService.getTimeserieStats({\n        videoId,\n        startDate: this.statsStartDate,\n        endDate: this.statsEndDate,\n        metric: 'viewers'\n      }),\n\n      countries: of(this.countries),\n\n      regions: of(this.regions)\n    }\n\n    obsBuilders[this.activeGraphId].subscribe({\n      next: res => {\n        this.chartIngestData[this.activeGraphId] = res\n\n        this.chartOptions[this.activeGraphId] = this.buildChartOptions(this.activeGraphId)\n      },\n\n      error: err => this.notifier.error(err.message)\n    })\n  }\n\n  private buildChartOptions (graphId: ActiveGraphId): ChartConfiguration<'line' | 'bar'> {\n    const dataBuilders: {\n      [id in ActiveGraphId]: (rawData: ChartIngestData) => ChartBuilderResult\n    } = {\n      clients: (rawData: VideoStatsUserAgent) => this.buildUserAgentChartOptions(rawData, 'clients'),\n      devices: (rawData: VideoStatsUserAgent) => this.buildUserAgentChartOptions(rawData, 'devices'),\n      operatingSystems: (rawData: VideoStatsUserAgent) => this.buildUserAgentChartOptions(rawData, 'operatingSystems'),\n      retention: (rawData: VideoStatsRetention) => this.buildRetentionChartOptions(rawData),\n      aggregateWatchTime: (rawData: VideoStatsTimeserie) => this.buildTimeserieChartOptions(rawData),\n      viewers: (rawData: VideoStatsTimeserie) => this.buildTimeserieChartOptions(rawData),\n      countries: (rawData: GeoData) => this.buildGeoChartOptions(rawData),\n      regions: (rawData: GeoData) => this.buildGeoChartOptions(rawData)\n    }\n\n    const { type, data, displayLegend, plugins, options } = dataBuilders[graphId](this.chartIngestData[graphId])\n\n    const self = this\n\n    return {\n      type,\n      data,\n\n      options: {\n        ...options,\n\n        responsive: true,\n\n        scales: {\n          x: {\n            ticks: {\n              stepSize: isBarGraph(graphId) ? 1 : undefined,\n              callback: function (value) {\n                return self.formatXTick({\n                  graphId,\n                  value,\n                  data: self.chartIngestData[graphId] as VideoStatsTimeserie,\n                  scale: this\n                })\n              }\n            }\n          },\n\n          y: {\n            beginAtZero: true,\n\n            max: this.activeGraphId === 'retention'\n              ? 100\n              : undefined,\n\n            ticks: {\n              callback: function (value) {\n                return self.formatYTick({ graphId, value, scale: this })\n              }\n            }\n          }\n        },\n\n        plugins: {\n          legend: {\n            display: displayLegend\n          },\n          tooltip: {\n            callbacks: {\n              title: items => this.formatTooltipTitle({ graphId, items }),\n              label: value => this.formatYTick({ graphId, value: value.raw as number | string })\n            }\n          },\n\n          ...plugins\n        }\n      }\n    }\n  }\n\n  private buildRetentionChartOptions (rawData: VideoStatsRetention): ChartBuilderResult {\n    const labels: string[] = []\n    const data: number[] = []\n\n    for (const d of rawData.data) {\n      labels.push(secondsToTime(d.second))\n      data.push(Math.round(d.retentionPercent))\n    }\n\n    return {\n      type: 'line' as 'line',\n\n      displayLegend: false,\n\n      plugins: {\n        ...this.buildDisabledZoomPlugin()\n      },\n\n      data: {\n        labels,\n        datasets: [\n          {\n            data,\n            borderColor: this.buildChartColor()\n          }\n        ]\n      }\n    }\n  }\n\n  private buildTimeserieChartOptions (rawData: VideoStatsTimeserie): ChartBuilderResult {\n    const labels: string[] = []\n    const data: number[] = []\n\n    for (const d of rawData.data) {\n      labels.push(d.date)\n      data.push(d.value)\n    }\n\n    return {\n      type: 'line' as 'line',\n\n      displayLegend: false,\n\n      plugins: {\n        zoom: {\n          zoom: {\n            wheel: {\n              enabled: false\n            },\n            drag: {\n              enabled: true\n            },\n            pinch: {\n              enabled: true\n            },\n            mode: 'x',\n            onZoomComplete: ({ chart }) => {\n              const { min, max } = chart.scales.x\n\n              const startDate = rawData.data[min].date\n              const endDate = max === rawData.data.length - 1\n                ? (this.statsEndDate || new Date()).toISOString()\n                : rawData.data[max + 1].date\n\n              this.peertubeRouter.silentNavigate([], { startDate, endDate })\n              this.addAndSelectCustomDateFilter()\n            }\n          },\n          limits: {\n            x: {\n              minRange: 2\n            }\n          }\n        }\n      },\n\n      data: {\n        labels,\n        datasets: [\n          {\n            data,\n            borderColor: this.buildChartColor()\n          }\n        ]\n      }\n    }\n  }\n\n  private buildUserAgentChartOptions (rawData: VideoStatsUserAgent, type: 'clients' | 'devices' | 'operatingSystems'): ChartBuilderResult {\n    const labels: string[] = []\n    const data: number[] = []\n\n    for (const d of rawData[type]) {\n      const name = d.name?.charAt(0).toUpperCase() + d.name?.slice(1)\n      labels.push(name)\n      data.push(d.viewers)\n    }\n\n    return {\n      type: 'bar' as 'bar',\n\n      options: {\n        indexAxis: 'y'\n      },\n\n      displayLegend: true,\n\n      plugins: {\n        ...this.buildDisabledZoomPlugin()\n      },\n\n      data: {\n        labels,\n        datasets: [\n          {\n            label: $localize`Viewers`,\n            backgroundColor: this.buildChartColor(),\n            maxBarThickness: 20,\n            data\n          }\n        ]\n      }\n    }\n  }\n\n  private buildGeoChartOptions (rawData: GeoData): ChartBuilderResult {\n    const labels: string[] = []\n    const data: number[] = []\n\n    for (const d of rawData) {\n      labels.push(d.name)\n      data.push(d.viewers)\n    }\n\n    return {\n      type: 'bar' as 'bar',\n\n      options: {\n        indexAxis: 'y'\n      },\n\n      displayLegend: true,\n\n      plugins: {\n        ...this.buildDisabledZoomPlugin()\n      },\n\n      data: {\n        labels,\n        datasets: [\n          {\n            label: $localize`Viewers`,\n            backgroundColor: this.buildChartColor(),\n            maxBarThickness: 20,\n            data\n          }\n        ]\n      }\n    }\n  }\n\n  private buildChartColor () {\n    return getComputedStyle(document.body).getPropertyValue('--border-primary')\n  }\n\n  private formatXTick (options: {\n    graphId: ActiveGraphId\n    value: number | string\n    data: VideoStatsTimeserie\n    scale: Scale\n  }) {\n    const { graphId, value, data, scale } = options\n\n    const label = scale.getLabelForValue(value as number)\n\n    if (!this.isTimeserieGraph(graphId)) {\n      return label\n    }\n\n    const date = new Date(label)\n\n    if (data.groupInterval.match(/ months?$/)) {\n      return date.toLocaleDateString([], { year: '2-digit', month: 'numeric' })\n    }\n\n    if (data.groupInterval.match(/ days?$/)) {\n      return date.toLocaleDateString([], { month: 'numeric', day: 'numeric' })\n    }\n\n    if (data.groupInterval.match(/ hours?$/)) {\n      return date.toLocaleTimeString([], { month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric' })\n    }\n\n    return date.toLocaleTimeString([], { hour: 'numeric', minute: 'numeric' })\n  }\n\n  private formatYTick (options: {\n    graphId: ActiveGraphId\n    value: number | string\n    scale?: Scale\n  }) {\n    const { graphId, value, scale } = options\n\n    if (graphId === 'retention') return value + ' %'\n    if (graphId === 'aggregateWatchTime') return secondsToTime(+value)\n    if (isBarGraph(graphId) && scale) return scale.getLabelForValue(value as number)\n\n    return value.toLocaleString(this.localeId)\n  }\n\n  private formatTooltipTitle (options: {\n    graphId: ActiveGraphId\n    items: TooltipItem<any>[]\n  }) {\n    const { graphId, items } = options\n    const item = items[0]\n\n    if (this.isTimeserieGraph(graphId)) {\n      return this.toMediumDate(new Date(item.label))\n    }\n\n    return item.label\n  }\n\n  private countryCodeToName (code: string) {\n    const intl: any = Intl\n    if (!intl.DisplayNames) return code\n\n    const regionNames = new intl.DisplayNames([], { type: 'region' })\n\n    return regionNames.of(code)\n  }\n\n  private buildDisabledZoomPlugin () {\n    return {\n      zoom: {\n        zoom: {\n          wheel: {\n            enabled: false\n          },\n          drag: {\n            enabled: false\n          },\n          pinch: {\n            enabled: false\n          }\n        }\n      }\n    }\n  }\n\n  private toMediumDate (d: Date) {\n    return new Date(d).toLocaleString(this.localeId, {\n      day: 'numeric',\n      month: 'short',\n      year: 'numeric',\n      hour: 'numeric',\n      minute: 'numeric',\n      second: 'numeric'\n    })\n  }\n}\n","import { NgFor, NgIf } from '@angular/common'\nimport { Component, OnDestroy, OnInit, inject } from '@angular/core'\nimport { FormControl, FormGroup, FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { ServerService } from '@app/core'\nimport { FormReactiveErrors, FormReactiveService, FormReactiveValidationMessages } from '@app/shared/shared-forms/form-reactive.service'\nimport { ReactiveFileComponent } from '@app/shared/shared-forms/reactive-file.component'\nimport { TimestampInputComponent } from '@app/shared/shared-forms/timestamp-input.component'\nimport { GlobalIconComponent } from '@app/shared/shared-icons/global-icon.component'\nimport { EmbedComponent } from '@app/shared/shared-main/video/embed.component'\nimport debug from 'debug'\nimport { Subscription } from 'rxjs'\nimport { AlertComponent } from '../../../shared/shared-main/common/alert.component'\nimport { getStudioUnavailability } from '../common/unavailable-features'\nimport { VideoEdit } from '../common/video-edit.model'\nimport { VideoManageController } from '../video-manage-controller.service'\n\nconst debugLogger = debug('peertube:video-manage')\n\ntype Form = {\n  'cut': FormGroup<{ start: FormControl<number>, end: FormControl<number> }>\n  'add-intro': FormGroup<{ file: FormControl<File> }>\n  'add-outro': FormGroup<{ file: FormControl<File> }>\n  'add-watermark': FormGroup<{ file: FormControl<File> }>\n}\n\n@Component({\n  selector: 'my-video-studio',\n  templateUrl: './video-studio.component.html',\n  styleUrls: [\n    '../common/video-manage-page-common.scss',\n    './video-studio.component.scss'\n  ],\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    TimestampInputComponent,\n    ReactiveFileComponent,\n    EmbedComponent,\n    NgIf,\n    NgFor,\n    GlobalIconComponent,\n    AlertComponent\n  ]\n})\nexport class VideoStudioEditComponent implements OnInit, OnDestroy {\n  private formReactiveService = inject(FormReactiveService)\n  private serverService = inject(ServerService)\n  private manageController = inject(VideoManageController)\n\n  form: FormGroup<Form>\n  formErrors: FormReactiveErrors = {}\n  validationMessages: FormReactiveValidationMessages = {}\n\n  isRunningEdit = false\n\n  videoEdit: VideoEdit\n\n  studioEnabled: boolean\n  instanceName: string\n\n  private updatedSub: Subscription\n\n  ngOnInit () {\n    this.videoEdit = this.manageController.getStore().videoEdit\n\n    const config = this.serverService.getHTMLConfig()\n    this.studioEnabled = config.videoStudio.enabled === true\n    this.instanceName = config.instance.name\n\n    const { form, formErrors, validationMessages } = this.formReactiveService.buildForm<Form>({\n      'cut': {\n        start: null,\n        end: null\n      },\n      'add-intro': {\n        file: null\n      },\n      'add-outro': {\n        file: null\n      },\n      'add-watermark': {\n        file: null\n      }\n    }, this.videoEdit.toStudioFormPatch())\n\n    this.form = form\n    this.formErrors = formErrors\n    this.validationMessages = validationMessages\n\n    this.form.valueChanges.subscribe(() => {\n      this.manageController.setFormError($localize`Studio`, 'studio', this.formErrors)\n\n      const formValues = this.form.value\n      debugLogger('Updating form values', formValues)\n\n      this.videoEdit.loadFromStudioForm(formValues)\n    })\n\n    this.formReactiveService.markAllAsDirty(this.form.controls)\n\n    this.updatedSub = this.manageController.getUpdatedObs().subscribe(() => {\n      this.form.patchValue(this.videoEdit.toStudioFormPatch())\n    })\n  }\n\n  ngOnDestroy (): void {\n    this.updatedSub?.unsubscribe()\n  }\n\n  get videoExtensions () {\n    return this.serverService.getHTMLConfig().video.file.extensions\n  }\n\n  get imageExtensions () {\n    return this.serverService.getHTMLConfig().video.image.extensions\n  }\n\n  getIntroOutroTooltip () {\n    return $localize`(extensions: ${this.videoExtensions.join(', ')})`\n  }\n\n  getWatermarkTooltip () {\n    return $localize`(extensions: ${this.imageExtensions.join(', ')})`\n  }\n\n  noEdit () {\n    return this.videoEdit.getStudioTasks().length === 0\n  }\n\n  getUnavailability () {\n    return getStudioUnavailability({\n      ...this.videoEdit.getVideoAttributes(),\n\n      instanceName: this.instanceName,\n      studioEnabled: this.studioEnabled\n    })\n  }\n}\n","<h2>\n  <my-global-icon iconName=\"studio\"></my-global-icon>\n\n  <ng-container i18n>Studio</ng-container>\n</h2>\n\n@if (getUnavailability()) {\n  <my-alert type=\"primary\">{{ getUnavailability() }}</my-alert>\n} @else {\n  <div class=\"grid-container\">\n    <form [formGroup]=\"form\">\n\n      <div class=\"section cut\" formGroupName=\"cut\">\n        <h3 class=\"section-label\" i18n>CUT VIDEO</h3>\n\n        <div i18n class=\"description\">Set a new start/end.</div>\n\n        <div class=\"form-group\">\n          <label i18n for=\"cutStart\">New start</label>\n          <my-timestamp-input inputName=\"cutStart\" enableBorder=\"true\" [maxTimestamp]=\"videoEdit.getVideoAttributes().duration\" formControlName=\"start\"></my-timestamp-input>\n        </div>\n\n        <div class=\"form-group\">\n          <label i18n for=\"cutEnd\">New end</label>\n          <my-timestamp-input inputName=\"cutEnd\" enableBorder=\"true\" [maxTimestamp]=\"videoEdit.getVideoAttributes().duration\" formControlName=\"end\"></my-timestamp-input>\n        </div>\n      </div>\n\n      <div class=\"section\" formGroupName=\"add-intro\">\n        <h3 class=\"section-label\" i18n>ADD INTRO</h3>\n\n        <div i18n class=\"description\">Concatenate a file at the beginning of the video.</div>\n\n        <div class=\"form-group\">\n          <my-reactive-file\n            formControlName=\"file\" inputName=\"addIntroFile\" i18n-inputLabel inputLabel=\"Select the intro video file\"\n            [extensions]=\"videoExtensions\" [displayFilename]=\"true\" [displayReset]=\"true\"\n            [buttonTooltip]=\"getIntroOutroTooltip()\"\n          ></my-reactive-file>\n        </div>\n      </div>\n\n      <div class=\"section\" formGroupName=\"add-outro\">\n        <h3 class=\"section-label\" i18n>ADD OUTRO</h3>\n\n        <div i18n class=\"description\">Concatenate a file at the end of the video.</div>\n\n        <div class=\"form-group\">\n          <my-reactive-file\n            formControlName=\"file\" inputName=\"addOutroFile\" i18n-inputLabel inputLabel=\"Select the outro video file\"\n            [extensions]=\"videoExtensions\" [displayFilename]=\"true\" [displayReset]=\"true\"\n            [buttonTooltip]=\"getIntroOutroTooltip()\"\n          ></my-reactive-file>\n        </div>\n      </div>\n\n      <div class=\"section\" formGroupName=\"add-watermark\">\n        <h3 class=\"section-label\" i18n>ADD WATERMARK</h3>\n\n        <div i18n class=\"description\">Add a watermark image to the video.</div>\n\n        <div class=\"form-group\">\n          <my-reactive-file\n            formControlName=\"file\" inputName=\"addWatermarkFile\" i18n-inputLabel inputLabel=\"Select watermark image file\"\n            [extensions]=\"imageExtensions\" [displayFilename]=\"true\" [displayReset]=\"true\"\n            [buttonTooltip]=\"getWatermarkTooltip()\"\n          ></my-reactive-file>\n        </div>\n      </div>\n    </form>\n\n    <div class=\"embed-container\">\n      <div class=\"mb-1 fw-bold\" i18n>Original video</div>\n      <my-embed [video]=\"videoEdit.getVideoAttributes()\"></my-embed>\n    </div>\n\n    <div class=\"tasks-container\" *ngIf=\"!noEdit()\">\n      <div class=\"mb-1 fw-bold\" i18n>Edits to apply:</div>\n\n      <ol>\n        <li *ngFor=\"let task of videoEdit.getStudioTasksSummary()\">{{ task }}</li>\n      </ol>\n    </div>\n  </div>\n}\n","import { Routes } from '@angular/router'\nimport { VideoCaptionsComponent } from './captions/video-captions.component'\nimport { VideoChaptersComponent } from './chapters/video-chapters.component'\nimport { VideoCustomizationComponent } from './customization/video-customization.component'\nimport { VideoLiveSettingsComponent } from './live-settings/video-live-settings.component'\nimport { VideoMainInfoComponent } from './main-info/video-main-info.component'\nimport { VideoModerationComponent } from './moderation/video-moderation.component'\nimport { VideoReplaceFileComponent } from './replace-file/video-replace-file.component'\nimport { VideoStatsComponent } from './stats/video-stats.component'\nimport { VideoStudioEditComponent } from './studio/video-studio.component'\n\nexport const manageRoutes = [\n  {\n    path: '',\n    component: VideoMainInfoComponent\n  },\n  {\n    path: 'main-info',\n    component: VideoMainInfoComponent\n  },\n  {\n    path: 'captions',\n    component: VideoCaptionsComponent\n  },\n  {\n    path: 'chapters',\n    component: VideoChaptersComponent\n  },\n  {\n    path: 'customization',\n    component: VideoCustomizationComponent\n  },\n  {\n    path: 'live-settings',\n    component: VideoLiveSettingsComponent\n  },\n  {\n    path: 'moderation',\n    component: VideoModerationComponent\n  },\n  {\n    path: 'replace-file',\n    component: VideoReplaceFileComponent\n  },\n  {\n    path: 'stats',\n    component: VideoStatsComponent\n  },\n  {\n    path: 'studio',\n    component: VideoStudioEditComponent\n  }\n] satisfies Routes\n","<my-alert type=\"warning\">\n  <div i18n>There are errors in your video settings.</div>\n\n  @for (errorRoot of getAllErrors(); track errorRoot) {\n    <div class=\"mt-3\">\n      <a i18n class=\"alert-link\" [routerLink]=\"errorRoot.path\">{{ errorRoot.page }} page</a>\n\n      <ul class=\"mb-0\">\n        @for (error of errorRoot.errors; track error) {\n          <li>{{ error }}</li>\n        }\n      </ul>\n    </div>\n  }\n</my-alert>\n","import { Component, inject } from '@angular/core'\nimport { VideoManageController } from '../video-manage-controller.service'\nimport { AlertComponent } from '../../../shared/shared-main/common/alert.component'\nimport { RouterModule } from '@angular/router'\n\n@Component({\n  selector: 'my-manage-errors',\n  templateUrl: 'manage-errors.component.html',\n  imports: [ RouterModule, AlertComponent ]\n})\nexport class ManageErrorsComponent {\n  private readonly manageController = inject(VideoManageController)\n\n  getAllErrors () {\n    return this.manageController.getFormErrors()\n  }\n}\n","import { CommonModule } from '@angular/common'\nimport { Component, input } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { RouterModule } from '@angular/router'\nimport { NgbTooltipModule } from '@ng-bootstrap/ng-bootstrap'\nimport { HelpComponent } from '../../shared/shared-main/buttons/help.component'\n\n@Component({\n  selector: 'my-unavailable-menu-entry',\n  templateUrl: './unavailable-menu-entry.component.html',\n  styleUrls: [ './unavailable-menu-entry.component.scss' ],\n  imports: [\n    CommonModule,\n    RouterModule,\n    FormsModule,\n    ReactiveFormsModule,\n    NgbTooltipModule,\n    HelpComponent\n  ]\n})\nexport class UnavailableMenuEntryComponent {\n  readonly help = input.required<string>()\n}\n","<div class=\"unavailable\">\n  <ng-content select=\".icon\"></ng-content>\n\n  <div>\n    <div>\n      <ng-content select=\".label\"></ng-content>\n    </div>\n\n    <div class=\"badge-help\">\n      <div class=\"pt-badge badge-secondary-on-secondary\" i18n>UNAVAILABLE</div>\n\n      <my-help i18n-helpTitle helpTitle=\"Feature unavailable\" container=\"body\">\n        {{ help() }}\n      </my-help>\n    </div>\n  </div>\n</div>\n","<div class=\"menu\">\n  <h1 i18n>MANAGE MY VIDEO</h1>\n\n  <ul class=\"ul-unstyle\">\n    <li>\n      <a routerLink=\".\" queryParamsHandling=\"merge\" routerLinkActive=\"active\" [routerLinkActiveOptions]=\"{ exact: true }\">\n        <div class=\"global-icon-wrapper\">\n          <my-global-icon iconName=\"film\"></my-global-icon>\n        </div>\n\n        <span i18n>Main information</span>\n      </a>\n    </li>\n\n    <li *ngIf=\"getVideo().isLive\">\n      <a routerLink=\"live-settings\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n        <div class=\"global-icon-wrapper\">\n          <my-global-icon iconName=\"live\"></my-global-icon>\n        </div>\n\n        <span i18n>Live settings</span>\n      </a>\n    </li>\n\n    <div class=\"separator\">\n      <div></div>\n    </div>\n\n    <li>\n      <a routerLink=\"customization\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n        <div class=\"global-icon-wrapper\">\n          <my-global-icon iconName=\"cog\"></my-global-icon>\n        </div>\n\n        <span i18n>Customization</span>\n      </a>\n    </li>\n\n    <li>\n      <a routerLink=\"moderation\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n        <div class=\"global-icon-wrapper\">\n          <my-global-icon iconName=\"moderation\"></my-global-icon>\n        </div>\n\n        <span i18n>Moderation</span>\n      </a>\n    </li>\n\n    @if (!getVideo().isLive) {\n      <li>\n        <a routerLink=\"captions\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n          <div class=\"global-icon-wrapper\">\n            <my-global-icon iconName=\"captions\"></my-global-icon>\n          </div>\n\n          <span i18n>Captions</span>\n        </a>\n      </li>\n\n      <li>\n        <a routerLink=\"chapters\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n          <div class=\"global-icon-wrapper\">\n            <my-global-icon iconName=\"chapters\"></my-global-icon>\n          </div>\n\n          <span i18n>Chapters</span>\n        </a>\n      </li>\n\n      <div class=\"separator\">\n        <div></div>\n      </div>\n\n      <li>\n        <ng-template #iconStudio>\n          <div class=\"global-icon-wrapper\">\n            <my-global-icon iconName=\"studio\"></my-global-icon>\n          </div>\n        </ng-template>\n\n        <ng-template #labelStudio>\n          <span i18n>Studio</span>\n        </ng-template>\n\n        @if (studioUnavailable()) {\n          <my-unavailable-menu-entry [help]=\"studioUnavailable()\">\n            <span class=\"icon\" *ngTemplateOutlet=\"iconStudio\"></span>\n            <span class=\"label\" *ngTemplateOutlet=\"labelStudio\"></span>\n          </my-unavailable-menu-entry>\n        } @else {\n          <a routerLink=\"studio\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n            <ng-container *ngTemplateOutlet=\"iconStudio\"></ng-container>\n            <ng-container *ngTemplateOutlet=\"labelStudio\"></ng-container>\n          </a>\n        }\n      </li>\n\n      <li>\n        <ng-template #iconReplaceFile>\n          <div class=\"global-icon-wrapper\">\n            <my-global-icon iconName=\"upload\"></my-global-icon>\n          </div>\n        </ng-template>\n\n        <ng-template #labelReplaceFile>\n          <span i18n>Replace file</span>\n        </ng-template>\n\n        @if (replaceFileUnavailable()) {\n          <my-unavailable-menu-entry [help]=\"replaceFileUnavailable()\">\n            <span class=\"icon\" *ngTemplateOutlet=\"iconReplaceFile\"></span>\n            <span class=\"label\" *ngTemplateOutlet=\"labelReplaceFile\"></span>\n          </my-unavailable-menu-entry>\n        } @else {\n          <a routerLink=\"replace-file\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n            <ng-container *ngTemplateOutlet=\"iconReplaceFile\"></ng-container>\n            <ng-container *ngTemplateOutlet=\"labelReplaceFile\"></ng-container>\n          </a>\n        }\n      </li>\n    }\n\n    @if (canWatch()) {\n      <div class=\"separator\">\n        <div></div>\n      </div>\n\n      <li>\n        <a routerLink=\"stats\" queryParamsHandling=\"merge\" routerLinkActive=\"active\">\n          <div class=\"global-icon-wrapper\">\n            <my-global-icon iconName=\"stats\"></my-global-icon>\n          </div>\n\n          <span i18n>Statistics</span>\n        </a>\n      </li>\n    }\n  </ul>\n</div>\n\n<div class=\"menu-placeholder\"></div>\n","import { CommonModule } from '@angular/common'\nimport { booleanAttribute, Component, inject, input, OnInit } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { RouterModule } from '@angular/router'\nimport { ServerService } from '@app/core'\nimport { NgbTooltipModule } from '@ng-bootstrap/ng-bootstrap'\nimport { GlobalIconComponent } from '../../shared/shared-icons/global-icon.component'\nimport { getReplaceFileUnavailability, getStudioUnavailability } from './common/unavailable-features'\nimport { VideoEdit } from './common/video-edit.model'\nimport { UnavailableMenuEntryComponent } from './unavailable-menu-entry.component'\nimport { VideoManageController } from './video-manage-controller.service'\n\n@Component({\n  selector: 'my-video-manage-menu',\n  styleUrls: [ './video-manage-menu.component.scss' ],\n  templateUrl: './video-manage-menu.component.html',\n  imports: [\n    CommonModule,\n    RouterModule,\n    FormsModule,\n    ReactiveFormsModule,\n    NgbTooltipModule,\n    GlobalIconComponent,\n    UnavailableMenuEntryComponent\n  ]\n})\nexport class VideoManageMenuComponent implements OnInit {\n  private serverService = inject(ServerService)\n  private manageController = inject(VideoManageController)\n\n  readonly canWatch = input.required<boolean, string | boolean>({ transform: booleanAttribute })\n\n  private videoEdit: VideoEdit\n  private replaceFileEnabled: boolean\n  private studioEnabled: boolean\n  private instanceName: string\n\n  ngOnInit (): void {\n    const config = this.serverService.getHTMLConfig()\n    this.studioEnabled = config.videoStudio.enabled === true\n    this.instanceName = config.instance.name\n    this.replaceFileEnabled = config.videoFile.update.enabled === true\n\n    const { videoEdit } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n  }\n\n  getVideo () {\n    return this.videoEdit.getVideoAttributes()\n  }\n\n  studioUnavailable () {\n    return getStudioUnavailability({\n      ...this.videoEdit.getVideoAttributes(),\n\n      instanceName: this.instanceName,\n      studioEnabled: this.studioEnabled\n    })\n  }\n\n  replaceFileUnavailable () {\n    return getReplaceFileUnavailability({\n      ...this.videoEdit.getVideoAttributes(),\n\n      instanceName: this.instanceName,\n      replaceFileEnabled: this.replaceFileEnabled\n    })\n  }\n}\n","<div class=\"root\">\n  <div>\n    <my-video-manage-menu [canWatch]=\"canWatch()\"></my-video-manage-menu>\n  </div>\n\n  <div class=\"w-100 min-width-0\">\n\n    <div class=\"video-actions-container\">\n      <div class=\"video-actions video-header-block\">\n        <my-button class=\"cancel-button\" icon=\"arrow-left\" theme=\"secondary\" i18n [ptRouterLink]=\"cancelLink()\">Cancel</my-button>\n\n        <h2>{{ getVideo().name }}</h2>\n\n        <div class=\"watch-save\">\n          <my-button *ngIf=\"canWatch()\" class=\"watch-button\" icon=\"external-link\" theme=\"secondary\" class=\"me-3\" [href]=\"getWatchUrl()\">\n            <span i18n class=\"watch-button-label\">Watch the video</span>\n          </my-button>\n\n          <my-button\n            theme=\"primary\" class=\"save-button\"\n            icon=\"circle-tick\"\n            [disabled]=\"!canUpdate() || !hasPendingChanges()\"  (click)=\"onWantToUpdate()\"\n          >\n            @if (hasStudioTasks()) {\n              <ng-container i18n>Save and run studio tasks</ng-container>\n            } @else if (hasReplaceFile()) {\n              <ng-container i18n>Save and replace file</ng-container>\n            } @else {\n              <ng-container i18n>Save</ng-container>\n            }\n          </my-button>\n        </div>\n      </div>\n    </div>\n\n    <div *ngIf=\"getStateWarning()?.title\" class=\"video-state video-header-block mt-2\">\n      <div class=\"alert-title\">{{ getStateWarning().title }}</div>\n\n      <strong class=\"me-1\">{{ getStateWarning().manageMain }}</strong>\n      <span>{{ getStateWarning().manageSecondary }}</span>\n    </div>\n\n    <my-manage-errors *ngIf=\"displayFormErrorsMsg && hasFormErrors()\" class=\"d-block mt-2\"></my-manage-errors>\n\n    <my-upload-progress\n      class=\"d-block mt-2\"\n      [isUploading]=\"isUploadingFile()\"\n      [uploadPercents]=\"getUploadPercents()\" [error]=\"getUploadError()\" [uploaded]=\"hasUploadedFile()\"\n      [enableRetryAfterError]=\"canRetryUpload\" (retry)=\"retryUpload()\"\n      [uploadedLabel]=\"uploadedLabel()\"\n    >\n    </my-upload-progress>\n\n    <div class=\"mt-2\">\n      <ng-content></ng-content>\n    </div>\n\n    <div class=\"mt-3\">\n      <router-outlet></router-outlet>\n    </div>\n  </div>\n</div>\n","import { CommonModule } from '@angular/common'\nimport { HttpErrorResponse } from '@angular/common/http'\nimport { booleanAttribute, Component, inject, input, OnDestroy, OnInit, output } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { RouterModule } from '@angular/router'\nimport { Notifier, ScreenService } from '@app/core'\nimport { HeaderService } from '@app/header/header.service'\nimport { Video } from '@app/shared/shared-main/video/video.model'\nimport { VideoStateMessageService } from '@app/shared/shared-video/video-state-message.service'\nimport { NgbTooltipModule } from '@ng-bootstrap/ng-bootstrap'\nimport { ButtonComponent } from '../../shared/shared-main/buttons/button.component'\nimport { UploadProgressComponent } from '../../shared/standalone-upload/upload-progress.component'\nimport { ManageErrorsComponent } from './common/manage-errors.component'\nimport { VideoEdit } from './common/video-edit.model'\nimport { VideoManageController } from './video-manage-controller.service'\nimport { VideoManageMenuComponent } from './video-manage-menu.component'\n\n@Component({\n  selector: 'my-video-manage-container',\n  styleUrls: [ './video-manage-container.component.scss' ],\n  templateUrl: './video-manage-container.component.html',\n  imports: [\n    CommonModule,\n    RouterModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ButtonComponent,\n    ManageErrorsComponent,\n    NgbTooltipModule,\n    UploadProgressComponent,\n    VideoManageMenuComponent\n  ]\n})\nexport class VideoManageContainerComponent implements OnInit, OnDestroy {\n  private manageController = inject(VideoManageController)\n  private notifier = inject(Notifier)\n  private headerService = inject(HeaderService)\n  private screenService = inject(ScreenService)\n  private videoStateMessage = inject(VideoStateMessageService)\n\n  readonly canWatch = input.required<boolean, string | boolean>({ transform: booleanAttribute })\n  readonly canUpdate = input.required<boolean, string | boolean>({ transform: booleanAttribute })\n\n  readonly uploadedLabel = input<string>()\n  readonly cancelLink = input<string>()\n\n  readonly videoUpdated = output()\n\n  displayFormErrorsMsg = false\n\n  canRetryUpload = true\n\n  private isUpdating = false\n  private videoEdit: VideoEdit\n\n  ngOnInit (): void {\n    if (this.screenService.isInMobileView()) {\n      this.headerService.setSearchHidden(true)\n    }\n\n    const { videoEdit } = this.manageController.getStore()\n    this.videoEdit = videoEdit\n  }\n\n  ngOnDestroy (): void {\n    this.headerService.setSearchHidden(false)\n  }\n\n  // ---------------------------------------------------------------------------\n\n  hasFormErrors () {\n    return this.manageController.hasFormErrors()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  getStateWarning () {\n    return this.videoStateMessage.buildWarn(this.videoEdit.getVideoAttributes().state)\n  }\n\n  // ---------------------------------------------------------------------------\n\n  hasPendingChanges () {\n    return this.manageController.hasPendingChanges()\n  }\n\n  hasReplaceFile () {\n    return this.manageController.hasReplaceFile()\n  }\n\n  hasStudioTasks () {\n    return this.manageController.hasStudioTasks()\n  }\n\n  // ---------------------------------------------------------------------------\n\n  async onWantToUpdate () {\n    this.displayFormErrorsMsg = false\n\n    await this.manageController.runSaveHook()\n\n    if (this.hasFormErrors()) {\n      this.displayFormErrorsMsg = true\n      return\n    }\n\n    if (this.isUpdating) return\n    this.isUpdating = true\n\n    if (\n      !await this.manageController.checkAndConfirmVideoFileReplacement() ||\n      !await this.manageController.checkAndConfirmStudioTasks()\n    ) {\n      this.isUpdating = false\n      return\n    }\n\n    this.manageController.updateVideo()\n      .subscribe({\n        next: () => {\n          this.isUpdating = false\n\n          return this.videoUpdated.emit()\n        },\n\n        error: (err: HttpErrorResponse) => {\n          this.isUpdating = false\n\n          this.notifier.error(err.message)\n        }\n      })\n  }\n\n  getUploadPercents () {\n    return this.manageController.getUploadPercents()\n  }\n\n  getUploadError () {\n    return this.manageController.getUploadError()\n  }\n\n  isUploadingFile () {\n    return this.manageController.isUploadingFile()\n  }\n\n  hasUploadedFile () {\n    return this.manageController.hasUploadedFile()\n  }\n\n  getWatchUrl () {\n    return Video.buildWatchUrl(this.videoEdit.getVideoAttributes())\n  }\n\n  getVideo () {\n    return this.videoEdit.getVideoAttributes()\n  }\n\n  retryUpload () {\n    this.canRetryUpload = false\n\n    this.manageController.cancelUploadIfNeeded()\n    this.manageController.retryUpload()\n  }\n}\n"]}