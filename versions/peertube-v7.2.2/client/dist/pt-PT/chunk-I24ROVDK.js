import{b as yt}from"./chunk-FWCJKVBG.js";import{a as ft,b as Tt,c as Mt,e as Ct,f as bt,i as ht,j as vt,k as It,l as Pt}from"./chunk-5BBSIJ6K.js";import{c as Lt}from"./chunk-SS3SQE34.js";import{a as Ee}from"./chunk-GUE2RQOD.js";import{b as ut,c as k,d as Se,f as gt,g as St,h as Ae,i as Et}from"./chunk-DUA2DJQ3.js";import{a as At}from"./chunk-FJ2ZROHN.js";import{a as Rt}from"./chunk-APIXYPUO.js";import{c as pt}from"./chunk-BFVCLNOF.js";import{a as De}from"./chunk-6TRYPH2T.js";import{b as me,c as ge}from"./chunk-25AA3I7H.js";import{d as Be}from"./chunk-UI5MIAKJ.js";import{E as tt,s as pe}from"./chunk-RT7DTAS6.js";import{B as ce,C as de,c as ie,g as ae,h as re,n as se,q as le,t as _e}from"./chunk-WO4VNXA3.js";import{a as U}from"./chunk-PE7TFI7A.js";import{$f as Ht,Ab as he,B as Re,Bb as b,Bc as V,Cb as c,Cc as Le,Cd as G,Cf as $e,Da as z,Db as qe,Dc as F,Ea as ve,Eb as Qe,Ha as a,Mb as D,Na as O,Nb as H,Ng as _t,Og as ct,Pb as A,Pg as dt,Qb as v,Qg as mt,Rb as h,Sa as $,Sg as Oe,Ua as Ie,Uf as it,Vf as xe,Wa as L,Xc as Ke,Xf as w,Y as je,Ya as p,Yb as X,Zb as I,_b as We,aa as m,bg as at,eb as s,ef as nt,fc as ne,ff as ot,gc as Ye,ha as M,hc as Pe,ia as C,jc as oe,kd as Je,kg as rt,l as Xe,la as P,lf as ye,lg as st,nb as l,ob as _,od as Ze,pb as u,pd as et,pf as Ne,pg as ue,qb as y,rb as x,sa as K,sg as lt,ta as N,tb as B,vb as J,wb as Z,xb as g,yb as ee,zb as te}from"./chunk-F7FAPFPY.js";import{g as Bt,i as E,j as Y}from"./chunk-AI7IVZV2.js";var no=(()=>{let i=class i{authHttp=m(Ke);restExtractor=m(rt);requestTwoFactor(e){let{userId:o,currentPassword:r}=e,S=Oe.BASE_USERS_URL+o+"/two-factor/request";return this.authHttp.post(S,{currentPassword:r}).pipe(Re(d=>this.restExtractor.handleError(d)));}confirmTwoFactorRequest(e){let{userId:o,requestToken:r,otpToken:S}=e,d=Oe.BASE_USERS_URL+o+"/two-factor/confirm-request";return this.authHttp.post(d,{requestToken:r,otpToken:S}).pipe(Re(f=>this.restExtractor.handleError(f)));}disableTwoFactor(e){let{userId:o,currentPassword:r}=e,S=Oe.BASE_USERS_URL+o+"/two-factor/disable";return this.authHttp.post(S,{currentPassword:r}).pipe(Re(d=>this.restExtractor.handleError(d)));}};E(i,"\u0275fac",function(o){return new(o||i)();}),E(i,"\u0275prov",je({token:i,factory:i.Éµfac}));let t=i;return t;})();var $t=Bt(Ht());var fe=()=>["."],Te=t=>({search:t});function Ft(t,i){if(t&1&&(l(0,"div",22)(1,"span",14),g(2,1),_(),l(3,"span",23)(4,"a",24),u(5,"my-actor-avatar",25),l(6,"span",26),A(7),_()(),l(8,"a",27),J(9,2),u(10,"my-global-icon",28),Z(),_()()()),t&2){let n=c();a(4),s("routerLink",X(8,fe))("queryParams",I(9,Te,'reporter:"'+n.abuse().reporterAccount.displayName+'"')),a(),s("actor",n.abuse().reporterAccount),a(2),v(n.abuse().reporterAccount.nameWithHost),a(),s("routerLink",X(11,fe))("queryParams",I(12,Te,'reporter:"'+n.abuse().reporterAccount.displayName+'"')),a(2),ee(n.abuse().countReportsForReporter)(n.abuse().countReportsForReporter),te(9);}}function wt(t,i){if(t&1&&(l(0,"a",27),J(1,4),u(2,"my-global-icon",28),Z(),_()),t&2){let n=c(2);s("routerLink",X(4,fe))("queryParams",I(5,Te,'reportee:"'+n.abuse().flaggedAccount.displayName+'"')),a(2),ee(n.abuse().countReportsForReportee)(n.abuse().countReportsForReportee),te(1);}}function Ut(t,i){if(t&1&&(l(0,"div",22)(1,"span",14),g(2,3),_(),l(3,"span",23)(4,"a",24),u(5,"my-actor-avatar",25),l(6,"span",26),A(7),_()(),p(8,wt,3,7,"a",29),_()()),t&2){let n=c();a(4),s("routerLink",X(5,fe))("queryParams",I(6,Te,'reportee:"'+n.abuse().flaggedAccount.displayName+'"')),a(),s("actor",n.abuse().flaggedAccount),a(2),v(n.abuse().flaggedAccount?n.abuse().flaggedAccount.nameWithHost:""),a(),s("ngIf",n.isAdminView());}}function kt(t,i){if(t&1&&(l(0,"div",22)(1,"span",14),g(2,5),_(),l(3,"time",30),A(4),ne(5,"ptDate"),_()()),t&2){let n=c();a(4),v(Pe(5,1,n.abuse().updatedAt,"medium"));}}function Gt(t,i){if(t&1&&(l(0,"a",33)(1,"div"),A(2),_()()),t&2){let n=i.$implicit;s("routerLink",X(3,fe))("queryParams",I(4,Te,"tag:"+n.id)),a(2),v(n.label);}}function zt(t,i){if(t&1&&(l(0,"div",31)(1,"span"),p(2,Gt,3,6,"a",32),_()()),t&2){let n=c();a(2),s("ngForOf",n.predefinedReasons);}}function Vt(t,i){if(t&1&&(y(0),A(1),x()),t&2){let n=c(2);a(),h(" - ",n.endAt,"");}}function Xt(t,i){if(t&1&&(l(0,"div",31)(1,"span",14),g(2,6),_(),l(3,"span"),A(4),p(5,Vt,2,1,"ng-container",20),_()()),t&2){let n=c();a(4),h(" ",n.startAt,""),a(),s("ngIf",n.abuse().video.endAt);}}function jt(t,i){if(t&1&&(l(0,"div",13)(1,"span",14),g(2,7),_(),u(3,"span",34),_()),t&2){let n=c();a(3),s("innerHTML",n.abuse().moderationCommentHtml,z);}}function qt(t,i){t&1&&(l(0,"div"),g(1,8),_());}function Qt(t,i){if(t&1&&u(0,"my-embed",36),t&2){let n=c(2);s("video",n.abuse().video);}}function Wt(t,i){if(t&1&&(l(0,"div"),p(1,qt,2,0,"div",20)(2,Qt,1,1,"my-embed",35),_()),t&2){let n=c();a(),s("ngIf",n.abuse().video.deleted),a(),s("ngIf",!n.abuse().video.deleted);}}function Yt(t,i){if(t&1&&(l(0,"div",37)(1,"div")(2,"strong"),g(3,9),_()(),u(4,"div",38),_()),t&2){let n=c();a(4),s("innerHTML",n.abuse().commentHTML,z);}}var xt=(()=>{let i=class i{abuse=N(void 0);isAdminView=N(void 0);predefinedReasons;predefinedReasonsTranslations;constructor(){this.predefinedReasonsTranslations={violentOrRepulsive:"Violento ou repulsivo",hatefulOrAbusive:"Odioso ou abusivo",spamOrMisleading:"Spam ou enganoso",privacy:"Privacidade",rights:"Direitos autorais",serverRules:"Regras do servidor",thumbnails:"Miniaturas",captions:"Legendas"};}ngOnInit(){let e=this.abuse();e.predefinedReasons&&(this.predefinedReasons=e.predefinedReasons.map(o=>({id:o,label:this.predefinedReasonsTranslations[o]})));}get startAt(){return $e(this.abuse().video.startAt);}get endAt(){return $e(this.abuse().video.endAt);}};E(i,"\u0275fac",function(o){return new(o||i)();}),E(i,"\u0275cmp",$({type:i,selectors:[["my-abuse-details"]],inputs:{abuse:[1,"abuse"],isAdminView:[1,"isAdminView"]},decls:18,vars:15,consts:()=>{let e;e="Denunciar";let o;o="Denunciante";let r;r="{VAR_PLURAL, plural, =1 {1 den\xFAncia} other {{INTERPOLATION} den\xFAncias}}",r=he(r,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let S;S="\n          "+r+"\n          "+"\uFFFD#10\uFFFD"+"\n          "+"\uFFFD/#10\uFFFD"+"\n        ";let d;d="Den\xFAnciador";let f;f="{VAR_PLURAL, plural, =1 {1 den\xFAncia} other {{INTERPOLATION} den\xFAncias}}",f=he(f,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let Me;Me="\n          "+f+"\n          "+"\uFFFD#2\uFFFD"+"\n          "+"\uFFFD/#2\uFFFD"+"\n        ";let Ce;Ce="Actualizado";let q;q="Parte relatada";let be;be="Observa\xE7\xE3o";let Q;Q="O v\xEDdeo foi deletado";let W;return W="Coment\xE1rio:",[e,o,S,d,Me,Ce,q,be,Q,W,[1,"d-flex","moderation-expanded"],[1,"left"],["class","d-flex",4,"ngIf"],[1,"mt-3","d-flex"],[1,"moderation-expanded-label"],[1,"ms-1","muted",3,"routerLink","queryParams"],[1,"moderation-expanded-text",3,"innerHTML"],["class","mt-2 d-flex",4,"ngIf"],["class","mt-3 d-flex",4,"ngIf"],[1,"right"],[4,"ngIf"],["class","comment-html",4,"ngIf"],[1,"d-flex"],[1,"moderation-expanded-text"],[1,"chip","me-1",3,"routerLink","queryParams"],["size","18","actorType","account",3,"actor"],[1,"muted"],[1,"ms-auto","muted","abuse-details-links",3,"routerLink","queryParams"],["iconName","flag"],["class","ms-auto muted abuse-details-links",3,"routerLink","queryParams",4,"ngIf"],[1,"moderation-expanded-text","abuse-details-date-updated"],[1,"mt-2","d-flex"],["class","pt-badge badge-secondary",3,"routerLink","queryParams",4,"ngFor","ngForOf"],[1,"pt-badge","badge-secondary",3,"routerLink","queryParams"],[1,"moderation-expanded-text","d-block",3,"innerHTML"],[3,"video",4,"ngIf"],[3,"video"],[1,"comment-html"],[3,"innerHTML"]];},template:function(o,r){if(o&1&&(l(0,"div",10)(1,"div",11),p(2,Ft,11,14,"div",12)(3,Ut,9,8,"div",12)(4,kt,6,4,"div",12),l(5,"div",13)(6,"span",14),y(7),g(8,0),x(),l(9,"a",15),A(10),_()(),u(11,"span",16),_(),p(12,zt,3,1,"div",17)(13,Xt,6,2,"div",17)(14,jt,4,1,"div",18),_(),l(15,"div",19),p(16,Wt,3,2,"div",20)(17,Yt,5,1,"div",21),_()()),o&2){let S;a(2),s("ngIf",r.isAdminView()&&r.abuse().reporterAccount),a(),s("ngIf",r.abuse().flaggedAccount),a(),s("ngIf",r.abuse().updatedAt),a(5),s("routerLink",X(12,fe))("queryParams",I(13,Te,"#"+r.abuse().id)),a(),h("#",r.abuse().id,""),a(),s("innerHTML",r.abuse().reasonHtml,z),a(),s("ngIf",r.predefinedReasons),a(),s("ngIf",(S=r.abuse().video)==null?null:S.startAt),a(),s("ngIf",r.isAdminView()&&r.abuse().moderationComment),a(2),s("ngIf",r.abuse().video),a(),s("ngIf",r.abuse().comment);}},dependencies:[F,et,De,U,Le,At,Ee],styles:[`.moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 1000px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{text-decoration:none;color:var(--fg)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 1000px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}
/*# sourceMappingURL=moderation-RQPVRH5V.css.map */`,`.comment-html[_ngcontent-%COMP%]{background-color:var(--bg-secondary-400);padding:10px}.abuse-details-date-updated[_ngcontent-%COMP%]{font-size:90%;margin-top:.1rem}.abuse-details-links[_ngcontent-%COMP%], .abuse-details-links[_ngcontent-%COMP%]:hover, .abuse-details-links[_ngcontent-%COMP%]:focus, .abuse-details-links[_ngcontent-%COMP%]:active{text-decoration:none}.abuse-details-links[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}my-global-icon[iconName=flag][_ngcontent-%COMP%]{display:inline-block;width:15px;height:15px;line-height:15px}
/*# sourceMappingURL=abuse-details.component-LV5XFPGQ.css.map */`]}));let t=i;return t;})();var Kt=["modal"],Jt=t=>({"input-error":t}),Zt=(t,i)=>({"by-moderator":t,"by-me":i});function en(t,i){t&1&&(y(0),g(1,1),x());}function tn(t,i){t&1&&(y(0),g(1,2),x());}function nn(t,i){if(t&1&&(l(0,"div",19)(1,"div",20),A(2),_(),l(3,"div",21),u(4,"div",22),l(5,"div",23),A(6),ne(7,"ptDate"),_()()()),t&2){let n=i.$implicit,e=c(2);s("ngClass",We(6,Zt,n.byModerator,e.isMessageByMe(n))),a(2),v(n.account.name),a(2),s("innerHTML",n.messageHtml,z),a(2),v(Ye(7,4,n.createdAt));}}function on(t,i){t&1&&(l(0,"div",24),g(1,3),_());}function an(t,i){if(t&1&&(l(0,"div",25),A(1),_()),t&2){let n=c(2);a(),h(" ",n.formErrors.message," ");}}function rn(t,i){if(t&1){let n=B();l(0,"div",4)(1,"h4",5),p(2,en,2,0,"ng-container",6)(3,tn,2,0,"ng-container",6),_(),l(4,"button",7),b("click",function(){M(n);let o=c();return C(o.hide());}),u(5,"my-global-icon",8),_()(),l(6,"div",9)(7,"div",10),p(8,nn,8,9,"div",11),_(),p(9,on,2,0,"div",12),l(10,"form",13),b("ngSubmit",function(){M(n);let o=c();return C(o.addMessage());}),l(11,"div",14),u(12,"textarea",15),p(13,an,2,1,"div",16),_(),l(14,"div",17),u(15,"input",18),_()()();}if(t&2){let n=c();a(2),s("ngIf",n.isAdminView()),a(),s("ngIf",!n.isAdminView()),a(5),s("ngForOf",n.abuseMessages),a(),s("ngIf",n.noResults),a(),s("formGroup",n.form),a(2),s("placeholder",n.getPlaceholderMessage())("ngClass",I(9,Jt,n.formErrors.message)),a(),s("ngIf",n.formErrors.message),a(2),s("disabled",!n.form.valid||n.sendingMessage);}}var Dt=(()=>{let i=class i extends ge{formReactiveService=m(me);modalService=m(pe);htmlRenderer=m(_t);auth=m(st);notifier=m(w);abuseService=m(Ae);modal=O("modal");isAdminView=N(void 0);countMessagesUpdated=K();abuseMessages=[];textareaMessage;sendingMessage=!1;noResults=!1;openedModal;abuse;ngOnInit(){this.buildForm({message:St});}openModal(e){this.abuse=e,this.openedModal=this.modalService.open(this.modal(),{centered:!0}),this.loadMessages();}hide(){this.abuseMessages=[],this.openedModal.close();}addMessage(){this.sendingMessage=!0,this.abuseService.addAbuseMessage(this.abuse,this.form.value.message).subscribe({next:()=>{this.form.reset(),this.sendingMessage=!1,this.countMessagesUpdated.emit({abuseId:this.abuse.id,countMessages:this.abuseMessages.length+1}),this.loadMessages();},error:e=>{this.sendingMessage=!1,ye.error(e),this.notifier.error("Sorry but you cannot send this message. Please retry later");}});}deleteMessage(e){this.abuseService.deleteAbuseMessage(this.abuse,e).subscribe({next:()=>{this.countMessagesUpdated.emit({abuseId:this.abuse.id,countMessages:this.abuseMessages.length-1}),this.abuseMessages=this.abuseMessages.filter(o=>o.id!==e.id);},error:o=>this.notifier.error(o.message)});}isMessageByMe(e){return this.auth.getUser().account.id===e.account.id;}getPlaceholderMessage(){return this.isAdminView()?"Adicione uma mensagem para se comunicar com o rep\xF3rter":"Adicione uma mensagem para se comunicar com a equipe de modera\xE7\xE3o";}loadMessages(){this.abuseService.listAbuseMessages(this.abuse).subscribe({next:e=>{this.abuseMessages=[];for(let o of e.data)this.abuseMessages.push(Object.assign(o,{messageHtml:this.htmlRenderer.convertToBr(o.message)}));this.noResults=this.abuseMessages.length===0,setTimeout(()=>{let o=document.querySelector(".messages");o.scroll(0,o.scrollHeight);});},error:e=>this.notifier.error(e.message)});}};E(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=P(i)))(r||i);};})()),E(i,"\u0275cmp",$({type:i,selectors:[["my-abuse-message-modal"]],viewQuery:function(o,r){o&1&&D(r.modal,Kt,5),o&2&&H();},inputs:{isAdminView:[1,"isAdminView"]},outputs:{countMessagesUpdated:"countMessagesUpdated"},features:[L],decls:2,vars:0,consts:()=>{let e;e="Feche este modal";let o;o="Adicionar uma mensagem";let r;r="Mensagens com o rep\xF3rter";let S;S="Mensagens com a equipe de modera\xE7\xE3o";let d;return d="Nenhuma mensagem por enquanto.",[["modal",""],r,S,d,[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],[1,"messages"],["class","message-block",3,"ngClass",4,"ngFor","ngForOf"],["class","no-messages",4,"ngIf"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","message","ngbAutofocus","",1,"form-control",3,"placeholder","ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","inputs"],["type","submit","value",o,1,"peertube-button","primary-button",3,"disabled"],[1,"message-block",3,"ngClass"],[1,"author"],[1,"bubble"],[1,"content",3,"innerHTML"],[1,"date"],[1,"no-messages"],["role","alert",1,"form-error"]];},template:function(o,r){o&1&&p(0,rn,16,11,"ng-template",null,0,oe);},dependencies:[F,U,Le,V,ce,se,ie,ae,re,de,le,_e,Ee],styles:[`form[_ngcontent-%COMP%]{margin:20px 20px 0 0}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:first-child{min-height:125px}textarea[_ngcontent-%COMP%]{margin-top:20px;font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:70px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}.messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:scroll;max-height:50vh}.no-messages[_ngcontent-%COMP%]{display:flex;justify-content:center}.message-block[_ngcontent-%COMP%]{margin:0 5px 10px 0;max-width:60%}.message-block[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{color:var(--fg-300);font-size:14px;padding:0 0 3px 10px}.message-block[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]{border-radius:10px;padding:5px 10px;color:var(--fg);background-color:var(--bg-secondary-400)}.message-block[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:13px;color:var(--fg-300)}.message-block.by-me[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]{color:var(--on-primary-400);background-color:var(--primary-400)}.message-block.by-me[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:var(--on-primary-400)}.message-block.by-moderator[_ngcontent-%COMP%]{align-self:flex-end}
/*# sourceMappingURL=abuse-message-modal.component-MOCJ3A2I.css.map */`]}));let t=i;return t;})();var sn=["modal"],ln=t=>({"input-error":t});function _n(t,i){if(t&1&&(l(0,"div",15),A(1),_()),t&2){let n=c(2);a(),h(" ",n.formErrors.moderationComment," ");}}function cn(t,i){if(t&1){let n=B();l(0,"div",3)(1,"h4",4),g(2,1),_(),l(3,"button",5),b("click",function(){M(n);let o=c();return C(o.hide());}),u(4,"my-global-icon",6),_()(),l(5,"div",7)(6,"form",8),b("ngSubmit",function(){M(n);let o=c();return C(o.banUser());}),l(7,"div",9)(8,"textarea",10),A(9,"        "),_(),p(10,_n,2,1,"div",11),_(),l(11,"div",9),g(12,2),_(),l(13,"div",12)(14,"input",13),b("click",function(){M(n);let o=c();return C(o.hide());})("key.enter",function(){M(n);let o=c();return C(o.hide());}),_(),u(15,"input",14),_()()();}if(t&2){let n=c();a(6),s("formGroup",n.form),a(2),s("ngClass",I(4,ln,n.formErrors.moderationComment)),a(2),s("ngIf",n.formErrors.moderationComment),a(5),s("disabled",!n.form.valid);}}var Nt=(()=>{let i=class i extends ge{formReactiveService=m(me);modalService=m(pe);notifier=m(w);abuseService=m(Ae);modal=O("modal");commentUpdated=K();abuseToComment;openedModal;ngOnInit(){this.buildForm({moderationComment:gt});}openModal(e){this.abuseToComment=e,this.openedModal=this.modalService.open(this.modal(),{centered:!0}),this.form.patchValue({moderationComment:this.abuseToComment.moderationComment});}hide(){this.abuseToComment=void 0,this.openedModal.close(),this.form.reset();}banUser(){let e=this.form.value.moderationComment;this.abuseService.updateAbuse(this.abuseToComment,{moderationComment:e}).subscribe({next:()=>{this.notifier.success("Coment\xE1rio atualizado."),this.commentUpdated.emit(e),this.hide();},error:o=>this.notifier.error(o.message)});}};E(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=P(i)))(r||i);};})()),E(i,"\u0275cmp",$({type:i,selectors:[["my-moderation-comment-modal"]],viewQuery:function(o,r){o&1&&D(r.modal,sn,5),o&2&&H();},outputs:{commentUpdated:"commentUpdated"},features:[L],decls:2,vars:0,consts:()=>{let e;e="Feche este modal";let o;o="Cancelar";let r;r="Atualizar este coment\xE1rio";let S;S="Coment\xE1rio de modera\xE7\xE3o";let d;return d="\n        Este coment\xE1rio s\xF3 pode ser visto por voc\xEA ou outros moderadores.\n      ",[["modal",""],S,d,[1,"modal-header"],[1,"modal-title"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","moderationComment","ngbAutofocus","","i18-placeholder","","placeholder","Comment this report\u2026",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",o,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit","value",r,1,"peertube-button","primary-button",3,"disabled"],["role","alert",1,"form-error"]];},template:function(o,r){o&1&&p(0,cn,16,6,"ng-template",null,0,oe);},dependencies:[U,ce,se,ie,ae,re,de,le,_e,V,F],styles:[`textarea[_ngcontent-%COMP%]{font-size:16px;padding:var(--input-y-padding) var(--input-x-padding);width:100%;max-width:100%;color:var(--input-fg);background-color:var(--input-bg);border:1px solid var(--input-border-color);border-radius:var(--input-border-radius);line-height:24px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder);font-size:14px}textarea[readonly][_ngcontent-%COMP%]{color:var(--fg-300)}textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--fg-100);outline:0}textarea[disabled][_ngcontent-%COMP%]{color:var(--fg-300);opacity:.8}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}textarea[_ngcontent-%COMP%]{color:var(--textarea-fg)!important;background-color:var(--textarea-bg)!important;height:100px;padding:var(--textarea-y-padding) var(--textarea-x-padding)}
/*# sourceMappingURL=moderation-comment-modal.component-7L7FRHYS.css.map */`]}));let t=i;return t;})();var dn=["abuseMessagesModal"],mn=["moderationCommentModal"],pn=t=>({show:t});function un(t,i){if(t&1){let n=B();l(0,"div",26)(1,"div",27)(2,"my-advanced-input-filter",28),b("search",function(o){M(n);let r=c();return C(r.onSearch(o));}),_()()();}if(t&2){let n=c();a(2),s("filters",n.inputFilters);}}function gn(t,i){t&1&&(l(0,"th",40),g(1,8),_());}function Sn(t,i){t&1&&(l(0,"th",41),g(1,9),_());}function An(t,i){if(t&1&&(l(0,"tr")(1,"th",29)(2,"span",30),g(3,2),_()(),l(4,"th",31)(5,"span",30),g(6,3),_()(),p(7,gn,2,0,"th",32),l(8,"th",33),g(9,4),_(),l(10,"th",34),J(11,5),u(12,"p-sortIcon",35),Z(),_(),l(13,"th",36),J(14,6),u(15,"p-sortIcon",37),Z(),_(),l(16,"th",38),g(17,7),_(),p(18,Sn,2,0,"th",39),_()),t&2){let n=c();a(7),s("ngIf",n.isAdminView()),a(3),s("ngbTooltip",n.sortTooltip),a(3),s("ngbTooltip",n.sortTooltip),a(5),s("ngIf",n.isAdminView());}}function En(t,i){if(t&1&&(l(0,"a",55)(1,"div",56),u(2,"my-actor-avatar",57),l(3,"div"),A(4),l(5,"span"),A(6),_()()()()),t&2){let n=c(2).$implicit;s("href",n.reporterAccount.url,ve),a(2),s("actor",n.reporterAccount),a(2),h(" ",n.reporterAccount.displayName," "),a(2),v(n.reporterAccount.nameWithHost);}}function fn(t,i){t&1&&(l(0,"span"),g(1,10),_());}function Tn(t,i){if(t&1&&(l(0,"td"),p(1,En,7,4,"a",54)(2,fn,2,0,"span",46),_()),t&2){let n=c().$implicit;a(),s("ngIf",n.reporterAccount),a(),s("ngIf",!n.reporterAccount);}}function Mn(t,i){if(t&1&&(l(0,"span",62),g(1,11),_()),t&2){let n=c(3).$implicit;a(),ee(n.count)(n.count),te(1);}}function Cn(t,i){t&1&&(l(0,"span",63),g(1,12),_());}function bn(t,i){if(t&1&&(l(0,"td")(1,"my-video-cell",59)(2,"div"),p(3,Mn,2,2,"span",60)(4,Cn,2,0,"span",61),_()()()),t&2){let n=c(2).$implicit;a(),s("video",n.video),a(2),s("ngIf",n.count>1),a(),s("ngIf",n.video.blacklisted);}}function hn(t,i){if(t&1&&(l(0,"td",47)(1,"div",64)(2,"div",65)(3,"div"),A(4),l(5,"span",66),g(6,13),_()(),l(7,"div",67),g(8,14),_()()()()),t&2){let n=c(2).$implicit;s("pRowToggler",n),a(4),h(" ",n.video.name," "),a(4),ee(n.video.channel==null?null:n.video.channel.displayName)(n.video.channel==null?null:n.video.channel.host),te(8);}}function Rn(t,i){if(t&1&&(y(0),p(1,bn,5,3,"td",46)(2,hn,9,4,"td",58),x()),t&2){let n=c().$implicit;a(),s("ngIf",!n.video.deleted),a(),s("ngIf",n.video.deleted);}}function vn(t,i){if(t&1&&(l(0,"div",70),A(1),_()),t&2){let n=c(2).$implicit;a(),h("by ",n.flaggedAccount.displayName,"");}}function In(t,i){if(t&1&&(y(0),l(1,"td"),u(2,"a",68),p(3,vn,2,1,"div",69),_(),x()),t&2){let n=c().$implicit,e=c();a(2),s("href",e.getCommentUrl(n),ve)("innerHTML",n.commentHTML,z)("title",n.comment.video.name),a(),s("ngIf",n.flaggedAccount);}}function Pn(t,i){if(t&1&&(l(0,"td")(1,"a",71)(2,"span"),A(3),_(),l(4,"span",72),A(5),_()()()),t&2){let n=c(2).$implicit,e=c();a(),s("href",e.getAccountUrl(n),ve),a(2),v(n.flaggedAccount.displayName),a(2),v(n.flaggedAccount.nameWithHostForced);}}function Ln(t,i){t&1&&(l(0,"td"),g(1,15),_());}function yn(t,i){if(t&1&&(y(0),p(1,Pn,6,3,"td",46)(2,Ln,2,0,"td",46),x()),t&2){let n=c().$implicit;a(),s("ngIf",n.flaggedAccount),a(),s("ngIf",!n.flaggedAccount);}}function xn(t,i){if(t&1&&(l(0,"div",73),u(1,"my-global-icon",74),_()),t&2){let n=c().$implicit;s("title",n.state.label);}}function On(t,i){if(t&1&&(l(0,"div",75),u(1,"my-global-icon",76),_()),t&2){let n=c().$implicit;s("title",n.state.label);}}function Dn(t,i){if(t&1){let n=B();l(0,"button",77),b("click",function(){M(n);let o=c().$implicit,r=c();return C(r.openAbuseMessagesModal(o));}),A(1),u(2,"my-global-icon",78),_();}if(t&2){let n=c().$implicit,e=c();s("ariaLabel",e.getSendMessageButtonLabel(n))("title",e.getSendMessageButtonLabel(n)),a(),h(" ",n.countMessages," ");}}function Nn(t,i){if(t&1&&(l(0,"td",79),A(1),_()),t&2){let n=c().$implicit;s("ngbTooltip",n.moderationComment),a(),h(" ",n.moderationComment," ");}}function $n(t,i){if(t&1&&(l(0,"tr")(1,"td",42),u(2,"my-table-expander-icon",43),_(),l(3,"td",44),u(4,"my-action-dropdown",45),_(),p(5,Tn,3,2,"td",46)(6,Rn,3,2,"ng-container",46)(7,In,4,4,"ng-container",46)(8,yn,3,2,"ng-container",46),l(9,"td",47),A(10),ne(11,"ptDate"),_(),l(12,"td",48),p(13,xn,2,1,"div",49)(14,On,2,1,"div",50),_(),l(15,"td",51),p(16,Dn,3,3,"button",52),_(),p(17,Nn,2,2,"td",53),_()),t&2){let n=i.expanded,e=i.$implicit,o=c();a(2),s("pRowToggler",e)("expanded",n),a(2),s("ngClass",I(19,pn,n))("actions",o.abuseActions)("entry",e),a(),s("ngIf",o.isAdminView()),a(),s("ngIf",e.video),a(),s("ngIf",e.comment),a(),s("ngIf",!e.comment&&!e.video),a(),s("pRowToggler",e),a(),v(Pe(11,16,e.createdAt,"short")),a(2),s("pRowToggler",e),a(),s("ngIf",o.isAbuseAccepted(e)),a(),s("ngIf",o.isAbuseRejected(e)),a(2),s("ngIf",o.isLocalAbuse(e)),a(),s("ngIf",o.isAdminView());}}function Bn(t,i){if(t&1&&(l(0,"td",81),u(1,"my-abuse-details",82),_()),t&2){let n=c().$implicit;a(),s("abuse",n)("isAdminView",!0);}}function Hn(t,i){if(t&1&&(l(0,"td",81),u(1,"my-abuse-details",82),_()),t&2){let n=c().$implicit;a(),s("abuse",n)("isAdminView",!1);}}function Fn(t,i){if(t&1&&(l(0,"tr"),p(1,Bn,2,2,"td",80)(2,Hn,2,2,"td",80),_()),t&2){let n=c();a(),s("ngIf",n.isAdminView()),a(),s("ngIf",!n.isAdminView());}}function wn(t,i){t&1&&(y(0),g(1,16),x());}function Un(t,i){t&1&&(y(0),g(1,17),x());}function kn(t,i){if(t&1&&(l(0,"tr")(1,"td",83)(2,"div",84),p(3,wn,2,0,"ng-container",46)(4,Un,2,0,"ng-container",46),_()()()),t&2){let n=c();a(3),s("ngIf",n.search),a(),s("ngIf",!n.search);}}var Gn=(0,$t.default)("peertube:moderation:AbuseListTableComponent"),hi=(()=>{let i=class i extends ue{route=m(Je);router=m(Ze);notifier=m(w);abuseService=m(Ae);blocklistService=m(Se);commentService=m(Lt);videoService=m(pt);videoBlocklistService=m(Et);confirmService=m(lt);markdownRenderer=m(ct);hooks=m(mt);pluginService=m(dt);viewType=N(void 0);abuseMessagesModal=O("abuseMessagesModal");moderationCommentModal=O("moderationCommentModal");abuses=[];totalRecords=0;sort={field:"createdAt",order:1};pagination={count:this.rowsPerPage,start:0};abuseActions=[];inputFilters=[{title:"Filtros avan\xE7ados",children:[{value:"state:pending",label:"Relat\xF3rios n\xE3o resolvidos"},{value:"state:accepted",label:"Relat\xF3rios aceitos"},{value:"state:rejected",label:"Relat\xF3rios recusados"},{value:"videoIs:blacklisted",label:"Relat\xF3rios com v\xEDdeos bloqueados"},{value:"videoIs:deleted",label:"Relat\xF3rios com v\xEDdeos exclu\xEDdos"}]}];ngOnInit(){return Y(this,null,function*(){let e=this.viewType();e==="admin"&&this.pluginService.addAction("admin-abuse-list:load-data",()=>this.reloadDataInternal());let o=[this.buildInternalActions(),this.buildFlaggedAccountActions(),this.buildCommentActions(),this.buildVideoActions(),this.buildAccountActions()];this.initialize(),this.abuseActions=e==="admin"?yield this.hooks.wrapObject(o,"admin-comments","filter:admin-abuse-list.actions.create.result"):o;});}ngOnDestroy(){this.viewType()==="admin"&&this.pluginService.removeAction("admin-abuse-list:load-data");}isAdminView(){return this.viewType()==="admin";}getIdentifier(){return"AbuseListTableComponent";}openModerationCommentModal(e){this.moderationCommentModal().openModal(e);}onModerationCommentUpdated(){this.reloadData();}isAbuseAccepted(e){return e.state.id===G.ACCEPTED;}isAbuseRejected(e){return e.state.id===G.REJECTED;}getVideoUrl(e){return Be.buildWatchUrl(e.video);}getCommentUrl(e){return Be.buildWatchUrl(e.comment.video)+";threadId="+e.comment.threadId;}getAccountUrl(e){return"/a/"+e.flaggedAccount.nameWithHost;}removeAbuse(e){return Y(this,null,function*(){(yield this.confirmService.confirm("Voc\xEA realmente deseja excluir esta den\xFAncia de abuso?","Excluir"))!==!1&&this.abuseService.removeAbuse(e).subscribe({next:()=>{this.notifier.success("Abuso deletado."),this.reloadData();},error:r=>this.notifier.error(r.message)});});}updateAbuseState(e,o){this.abuseService.updateAbuse(e,{state:o}).subscribe({next:()=>this.reloadData(),error:r=>this.notifier.error(r.message)});}onCountMessagesUpdated(e){let o=this.abuses.find(r=>r.id===e.abuseId);if(!o){ye.error(`Cannot find abuse ${e.abuseId}`);return;}o.countMessages=e.countMessages;}openAbuseMessagesModal(e){this.abuseMessagesModal().openModal(e);}isLocalAbuse(e){return this.viewType()==="user"?!0:e.reporterAccount?it.IS_LOCAL(e.reporterAccount.host):!1;}getSendMessageButtonLabel(e){return this.viewType()==="admin"?Ne("Envie uma mensagem ao rep\xF3rter (atualmente {count, plural, =1 {{count} mensagem} outro {{count} mensagens}})",{count:e.countMessages}):Ne("Envie uma mensagem aos administradores/moderadores (atualmente {count, plural, =1 {{count} mensagem} outro {{count} mensagens}})",{count:e.countMessages});}reloadDataInternal(){return Y(this,null,function*(){Gn("Loading data.");let e={pagination:this.pagination,sort:this.sort,search:this.search},o=this.viewType()==="admin"?this.abuseService.getAdminAbuses(e):this.abuseService.getUserAbuses(e);try{let r=yield Xe(o);this.totalRecords=r.total,this.abuses=[];for(let S of r.data){let d=S;d.reasonHtml=yield this.toHtml(d.reason),d.moderationComment&&(d.moderationCommentHtml=yield this.toHtml(d.moderationComment)),d.video&&d.video.channel?.ownerAccount&&(d.video.channel.ownerAccount=new xe(d.video.channel.ownerAccount)),d.comment&&(d.comment.deleted?d.commentHTML="Coment\xE1rio deletado":d.commentHTML=yield this.markdownRenderer.textMarkdownToHTML({markdown:d.comment.text,withHtml:!0})),d.reporterAccount&&(d.reporterAccount=new xe(d.reporterAccount)),d.flaggedAccount&&(d.flaggedAccount=new xe(d.flaggedAccount)),d.updatedAt===d.createdAt&&delete d.updatedAt,this.abuses.push(d);}}catch(r){this.notifier.error(r.message);}});}buildInternalActions(){return[{label:"A\xE7\xF5es internas",isHeader:!0},{label:this.isAdminView()?"Mensagens com rep\xF3rter":"Mensagens com moderadores",handler:e=>this.openAbuseMessagesModal(e),isDisplayed:e=>this.isLocalAbuse(e)},{label:"Atualizar nota interna",handler:e=>this.openModerationCommentModal(e),isDisplayed:e=>this.isAdminView()&&!!e.moderationComment},{label:"Marcar como aceito",handler:e=>this.updateAbuseState(e,G.ACCEPTED),isDisplayed:e=>this.isAdminView()&&!this.isAbuseAccepted(e)},{label:"Marcar como rejeitado",handler:e=>this.updateAbuseState(e,G.REJECTED),isDisplayed:e=>this.isAdminView()&&!this.isAbuseRejected(e)},{label:"Adicionar nota interna",handler:e=>this.openModerationCommentModal(e),isDisplayed:e=>this.isAdminView()&&!e.moderationComment},{label:"Excluir relat\xF3rio",handler:e=>this.removeAbuse(e),isDisplayed:()=>this.isAdminView()}];}buildFlaggedAccountActions(){return this.isAdminView()?[{label:"A\xE7\xF5es para a conta sinalizada",isHeader:!0,isDisplayed:e=>e.flaggedAccount&&!e.comment&&!e.video},{label:"Conta silenciada",isDisplayed:e=>e.flaggedAccount&&!e.comment&&!e.video,handler:e=>this.muteAccountHelper(e.flaggedAccount)},{label:"Conta de servidor silenciada",isDisplayed:e=>e.flaggedAccount&&!e.comment&&!e.video,handler:e=>this.muteServerHelper(e.flaggedAccount.host)}]:[];}buildAccountActions(){return this.isAdminView()?[{label:"A\xE7\xF5es para o rep\xF3rter",isHeader:!0,isDisplayed:e=>!!e.reporterAccount},{label:"Rep\xF3rter mudo",isDisplayed:e=>!!e.reporterAccount,handler:e=>this.muteAccountHelper(e.reporterAccount)},{label:"Servidor mudo",isDisplayed:e=>e.reporterAccount&&!e.reporterAccount.userId,handler:e=>this.muteServerHelper(e.reporterAccount.host)}]:[];}buildVideoActions(){return this.isAdminView()?[{label:"A\xE7\xF5es para o v\xEDdeo",isHeader:!0,isDisplayed:e=>e.video&&!e.video.deleted},{label:"Bloquear v\xEDdeo",isDisplayed:e=>e.video&&!e.video.deleted&&!e.video.blacklisted,handler:e=>{this.videoBlocklistService.blockVideo([{videoId:e.video.id,unfederate:e.video.channel.isLocal}]).subscribe({next:()=>{this.notifier.success("V\xEDdeo bloqueado."),this.updateAbuseState(e,G.ACCEPTED);},error:o=>this.notifier.error(o.message)});}},{label:"Desbloquear v\xEDdeo",isDisplayed:e=>e.video&&!e.video.deleted&&e.video.blacklisted,handler:e=>{this.videoBlocklistService.unblockVideo(e.video.id).subscribe({next:()=>{this.notifier.success("V\xEDdeo desbloqueado."),this.updateAbuseState(e,G.ACCEPTED);},error:o=>this.notifier.error(o.message)});}},{label:"Excluir v\xEDdeo",isDisplayed:e=>e.video&&!e.video.deleted,handler:e=>Y(this,null,function*(){(yield this.confirmService.confirm("Voc\xEA realmente deseja excluir esse v\xEDdeo?","Excluir"))!==!1&&this.videoService.removeVideo(e.video.id).subscribe({next:()=>{this.notifier.success("V\xEDdeo exclu\xEDdo."),this.updateAbuseState(e,G.ACCEPTED);},error:r=>this.notifier.error(r.message)});})}]:[];}buildCommentActions(){return this.isAdminView()?[{label:"A\xE7\xF5es para o coment\xE1rio",isHeader:!0,isDisplayed:e=>e.comment&&!e.comment.deleted},{label:"Excluir coment\xE1rio",isDisplayed:e=>e.comment&&!e.comment.deleted,handler:e=>Y(this,null,function*(){(yield this.confirmService.confirm("Voc\xEA realmente quer apagar este coment\xE1rio?","Excluir"))!==!1&&this.commentService.deleteVideoComment(e.comment.video.id,e.comment.id).subscribe({next:()=>{this.notifier.success("Coment\xE1rio exclu\xEDdo."),this.updateAbuseState(e,G.ACCEPTED);},error:r=>this.notifier.error(r.message)});})}]:[];}muteAccountHelper(e){this.blocklistService.blockAccountByInstance(e).subscribe({next:()=>{this.notifier.success("Account "+e.nameWithHost+" muted by your platform."),e.mutedByInstance=!0;},error:o=>this.notifier.error(o.message)});}muteServerHelper(e){this.blocklistService.blockServerByInstance(e).subscribe({next:()=>{this.notifier.success(""+e+" muted by your platform.");},error:o=>this.notifier.error(o.message)});}toHtml(e){return this.markdownRenderer.textMarkdownToHTML({markdown:e});}};E(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=P(i)))(r||i);};})()),E(i,"\u0275cmp",$({type:i,selectors:[["my-abuse-list-table"]],viewQuery:function(o,r){o&1&&(D(r.abuseMessagesModal,dn,5),D(r.moderationCommentModal,mn,5)),o&2&&H(2);},inputs:{viewType:[1,"viewType"]},features:[L],decls:10,vars:15,consts:()=>{let e;e="Mais informa\xE7\xF5es";let o;o="A\xE7\xF5es";let r;r="V\xEDdeo/Coment\xE1rio/Conta";let S;S="Criado "+"\uFFFD#12\uFFFD"+""+"\uFFFD/#12\uFFFD"+"";let d;d="Estado "+"\uFFFD#15\uFFFD"+""+"\uFFFD/#15\uFFFD"+"";let f;f="Mensagens";let Me;Me="Denunciante";let Ce;Ce="Nota interna";let q;q="Abrir conta em uma nova aba";let be;be="Conta exclu\xEDda";let Q;Q="This video has been reported multiple times";let W;W="The video is blocked";let R;R="{VAR_PLURAL, plural, =1 {1 abuse} other {{INTERPOLATION} abuses}}",R=he(R,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let He;He="\n          "+R+"\n        ";let Fe;Fe="Bloqueade";let we;we="V\xEDdeo foi apagado";let Ue;Ue="Deleted video";let ke;ke="por "+"\uFFFD0\uFFFD"+" em "+"\uFFFD1\uFFFD"+" ";let Ge;Ge="Conta exclu\xEDda";let ze;ze="Nenhum abuso encontrado correspondendo aos filtros atuais.";let Ve;return Ve="Nenhum abuso encontrado.",[["moderationCommentModal",""],["abuseMessagesModal",""],e,o,r,S,d,f,Me,Ce,be,He,Fe,Ue,ke,Ge,ze,Ve,["dataKey","id",3,"onLazyLoad","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","resizableColumns","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],[3,"commentUpdated"],[3,"countMessagesUpdated","isAdminView"],[1,"caption"],[1,"ms-auto"],[3,"search","filters"],["scope","col",2,"width","40px"],[1,"visually-hidden"],["scope","col",2,"width","70px"],["scope","col","style","width: 20%;","pResizableColumn","",4,"ngIf"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],["scope","col","container","body","pSortableColumn","state",2,"width","80px",3,"ngbTooltip"],["field","state"],["scope","col",2,"width","80px"],["scope","col","style","width: 100px;",4,"ngIf"],["scope","col","pResizableColumn","",2,"width","20%"],["scope","col",2,"width","100px"],[1,"expand-cell"],[3,"pRowToggler","expanded"],[1,"action-cell"],["placement","bottom-right top-right left auto","container","body","buttonSize","small",3,"ngClass","actions","entry"],[4,"ngIf"],[1,"c-hand",3,"pRowToggler"],[1,"c-hand","abuse-states",3,"pRowToggler"],["class","pt-badge badge-success",3,"title",4,"ngIf"],["class","pt-badge badge-danger",3,"title",4,"ngIf"],[1,"abuse-messages"],["class","peertube-button secondary-button icon-only",3,"ariaLabel","title","click",4,"ngIf"],["class","internal-note","container","body","placement","left auto",3,"ngbTooltip",4,"ngIf"],["title",q,"target","_blank","rel","noopener noreferrer",3,"href",4,"ngIf"],["title",q,"target","_blank","rel","noopener noreferrer",3,"href"],[1,"chip","two-lines"],["actorType","account","size","32",3,"actor"],["class","c-hand",3,"pRowToggler",4,"ngIf"],["size","small",3,"video"],["class","pt-badge badge-secondary me-1","title",Q,4,"ngIf"],["class","pt-badge badge-red","title",W,4,"ngIf"],["title",Q,1,"pt-badge","badge-secondary","me-1"],["title",W,1,"pt-badge","badge-red"],["title",we,1,"table-video"],[1,"table-video-text"],[1,"pt-badge","badge-secondary","ms-1"],[1,"video-owner"],["target","_blank","rel","noopener noreferrer",1,"table-comment-link","ellipsis-multiline-1",3,"href","innerHTML","title"],["class","comment-flagged-account",4,"ngIf"],[1,"comment-flagged-account"],["target","_blank","rel","noopener noreferrer",1,"table-account-link",3,"href"],[1,"account-flagged-handle"],[1,"pt-badge","badge-success",3,"title"],["iconName","tick"],[1,"pt-badge","badge-danger",3,"title"],["iconName","cross"],[1,"peertube-button","secondary-button","icon-only",3,"click","ariaLabel","title"],["aria-","","iconName","message-circle"],["container","body","placement","left auto",1,"internal-note",3,"ngbTooltip"],["class","expand-cell","myAutoColspan","",4,"ngIf"],["myAutoColspan","",1,"expand-cell"],[3,"abuse","isAdminView"],["myAutoColspan",""],[1,"no-results"]];},template:function(o,r){if(o&1){let S=B();l(0,"p-table",18),b("onLazyLoad",function(f){return M(S),C(r.loadLazy(f));}),p(1,un,3,1,"ng-template",19)(2,An,19,4,"ng-template",20)(3,$n,18,21,"ng-template",21)(4,Fn,3,2,"ng-template",22)(5,kn,5,2,"ng-template",23),_(),l(6,"my-moderation-comment-modal",24,0),b("commentUpdated",function(){return M(S),C(r.onModerationCommentUpdated());}),_(),l(8,"my-abuse-message-modal",25,1),b("countMessagesUpdated",function(f){return M(S),C(r.onCountMessagesUpdated(f));}),_();}o&2&&(s("value",r.abuses)("paginator",r.totalRecords>0)("totalRecords",r.totalRecords)("rows",r.rowsPerPage)("first",r.pagination.start)("rowsPerPageOptions",r.rowsPerPageOptions)("sortField",r.sort.field)("sortOrder",r.sort.order)("resizableColumns",!0)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",r.getPaginationTemplate())("expandedRowKeys",r.expandedRows),a(8),s("isAdminView",r.isAdminView()));},dependencies:[ht,ft,nt,Tt,Ct,bt,Mt,ot,Rt,F,tt,It,ut,V,De,Pt,U,vt,xt,Nt,Dt,Ee],styles:[`.moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 1000px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{text-decoration:none;color:var(--fg)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 1000px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}
/*# sourceMappingURL=moderation-RQPVRH5V.css.map */`,`.comment-flagged-account[_ngcontent-%COMP%], .account-flagged-handle[_ngcontent-%COMP%], .video-owner[_ngcontent-%COMP%]{font-size:11px;color:var(--fg-300)}.abuse-messages[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;top:-1px;display:inline-block;width:22px;height:22px;line-height:22px;margin-inline-start:.1875rem}.table-video-text[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%], my-video-cell[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;top:-2px;display:inline-block;width:15px;height:15px;line-height:15px}
/*# sourceMappingURL=abuse-list-table.component-VT6BHTY7.css.map */`]}));let t=i;return t;})();var xi=(()=>{let i=class i extends ue{notifier=m(w);blocklistService=m(Se);blockedAccounts=[];totalRecords=0;sort={field:"createdAt",order:-1};pagination={count:this.rowsPerPage,start:0};ngOnInit(){this.initialize();}unblockAccount(e){let o=e.blockedAccount;(this.mode===k.Account?this.blocklistService.unblockAccountByUser(o):this.blocklistService.unblockAccountByInstance(o)).subscribe(()=>{this.notifier.success(this.mode===k.Account?"Conta "+o.nameWithHost+" des-silenciada.":"Account "+o.nameWithHost+" unmuted by your platform."),this.reloadData();});}reloadDataInternal(){return(this.mode===k.Account?this.blocklistService.getUserAccountBlocklist({pagination:this.pagination,sort:this.sort,search:this.search}):this.blocklistService.getInstanceAccountBlocklist({pagination:this.pagination,sort:this.sort,search:this.search})).subscribe({next:o=>{this.blockedAccounts=o.data,this.totalRecords=o.total;},error:o=>this.notifier.error(o.message)});}};E(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=P(i)))(r||i);};})()),E(i,"\u0275dir",Ie({type:i,features:[L]}));let t=i;return t;})();var zn=["batchDomainsModal"],Fi=(()=>{let i=class i extends ue{notifier=m(w);blocklistService=m(Se);batchDomainsModal=O("batchDomainsModal");blockedServers=[];totalRecords=0;sort={field:"createdAt",order:-1};pagination={count:this.rowsPerPage,start:0};ngOnInit(){this.initialize();}unblockServer(e){let o=S=>this.mode===k.Account?this.blocklistService.unblockServerByUser(S):this.blocklistService.unblockServerByInstance(S),r=e.blockedServer.host;o(r).subscribe(()=>{this.notifier.success(this.mode===k.Account?""+r+" unmuted.":""+r+" unmuted by your platform."),this.reloadData();});}addServersToBlock(){this.batchDomainsModal().openModal();}onDomainsToBlock(e){let o=r=>this.mode===k.Account?this.blocklistService.blockServerByUser(r):this.blocklistService.blockServerByInstance(r);e.forEach(r=>{o(r).subscribe(()=>{this.notifier.success(this.mode===k.Account?"Platform "+r+" muted.":"Platform "+r+" muted by your platform."),this.reloadData();});});}reloadDataInternal(){return(this.mode===k.Account?this.blocklistService.getUserServerBlocklist({pagination:this.pagination,sort:this.sort,search:this.search}):this.blocklistService.getInstanceServerBlocklist({pagination:this.pagination,sort:this.sort,search:this.search})).subscribe({next:o=>{this.blockedServers=o.data,this.totalRecords=o.total;},error:o=>this.notifier.error(o.message)});}};E(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=P(i)))(r||i);};})()),E(i,"\u0275dir",Ie({type:i,viewQuery:function(o,r){o&1&&D(r.batchDomainsModal,zn,5),o&2&&H();},features:[L]}));let t=i;return t;})();var Vn=["modal"],Xn=[[["warning"]]],jn=["warning"],qn=t=>({"input-error":t});function Qn(t,i){if(t&1&&(l(0,"div"),A(1),_()),t&2){let n=c(3);a(),h(" ",n.form.controls.hosts.errors.validHosts.value," ");}}function Wn(t,i){if(t&1&&(l(0,"div",15),A(1),p(2,Qn,2,1,"div",16),_()),t&2){let n=c(2);a(),h(" ",n.formErrors.hosts," "),a(),s("ngIf",n.form.controls.hosts.errors.validHosts);}}function Yn(t,i){if(t&1){let n=B();l(0,"div",2)(1,"h4",3),A(2),_(),l(3,"button",4),b("click",function(){M(n);let o=c();return C(o.hide());}),u(4,"my-global-icon",5),_()(),l(5,"div",6)(6,"form",7),b("ngSubmit",function(){M(n);let o=c();return C(o.submit());}),l(7,"div",8)(8,"label",9),g(9,1),_(),u(10,"textarea",10),p(11,Wn,3,2,"div",11),_(),Qe(12),l(13,"div",12)(14,"input",13),b("click",function(){M(n);let o=c();return C(o.hide());})("key.enter",function(){M(n);let o=c();return C(o.hide());}),_(),u(15,"input",14),_()()();}if(t&2){let n=c();a(2),v(n.action()),a(4),s("formGroup",n.form),a(4),s("placeholder",n.placeholder())("ngClass",I(7,qn,n.formErrors.hosts)),a(),s("ngIf",n.formErrors.hosts),a(4),s("value",n.action())("disabled",!n.form.valid);}}var Ki=(()=>{let i=class i extends ge{formReactiveService=m(me);modalService=m(pe);modal=O("modal");placeholder=N("example.com");action=N("Dom\xEDnios de processo");domains=K();openedModal;ngOnInit(){this.buildForm({hosts:yt});}openModal(){this.openedModal=this.modalService.open(this.modal(),{centered:!0});}hide(){this.openedModal.close();}submit(){this.domains.emit(at(this.form.controls.hosts.value)),this.form.reset(),this.hide();}};E(i,"\u0275fac",(()=>{let e;return function(r){return(e||(e=P(i)))(r||i);};})()),E(i,"\u0275cmp",$({type:i,selectors:[["my-batch-domains-modal"]],viewQuery:function(o,r){o&1&&D(r.modal,Vn,5),o&2&&H();},inputs:{placeholder:[1,"placeholder"],action:[1,"action"]},outputs:{domains:"domains"},features:[L],ngContentSelectors:jn,decls:2,vars:0,consts:()=>{let e;e="Feche este modal";let o;o="Cancelar";let r;return r="1 host (sem \"http://\") por linha",[["modal",""],r,[1,"modal-header"],[1,"modal-title"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","hosts"],["formControlName","hosts","type","text","id","hosts","name","hosts","ngbAutofocus","",1,"form-control",3,"placeholder","ngClass"],["class","form-error","role","alert",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",o,1,"peertube-button","secondary-button",3,"click","key.enter"],["type","submit",1,"peertube-button","primary-button",3,"value","disabled"],["role","alert",1,"form-error"],[4,"ngIf"]];},template:function(o,r){o&1&&(qe(Xn),p(0,Yn,16,9,"ng-template",null,0,oe));},dependencies:[U,ce,se,ie,ae,re,de,le,_e,V,F],styles:[`textarea[_ngcontent-%COMP%]{height:200px}
/*# sourceMappingURL=batch-domains-modal.component-KPBAT742.css.map */`]}));let t=i;return t;})();export{hi as a,xi as b,Fi as c,Ki as d,no as e};/**i18n:1cf7c077143c4c267fdafbe5508f191afcef21bad6aba22a3a8dc180e1003753*///# sourceMappingURL=chunk-I24ROVDK.js.map